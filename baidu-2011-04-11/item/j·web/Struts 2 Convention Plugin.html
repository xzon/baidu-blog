<html><head><title>Struts 2 Convention Plugin</title></head><body><div id='tit'>Struts 2 Convention Plugin</div><div id='cate'>j&middot;web</div><div id='date'>2009年03月31日 星期二 01:10 P.M.</div><div id='page'>59</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/7f258a5416eebb173a2935d7.html'>http://hi.baidu.com/hxzon/blog/item/7f258a5416eebb173a2935d7.html</a><div id='cnt'><div> 
 <p>Struts 2 Convention Plugin</p> 
 <div>
  Apache Struts 2 Documentation
 </div> 
 <div> 
  <p>Convention Plugin</p> 
  <div>
   Added by 
   <a href="http://cwiki.apache.org/confluence/users/viewuserprofile.action?username=musachy">Musachy Barroso</a>, last edited by 
   <a href="http://cwiki.apache.org/confluence/users/viewuserprofile.action?username=newton.dave@yahoo.com">Dave Newton</a> on Dec 24, 2008 (
   <a href="http://cwiki.apache.org/confluence/pages/diffpages.action?pageId=105613&amp;originalId=106046">view change</a>)
  </div> 
  <div> 
   <div> 
    <div> 
     <ul> 
      <li>1 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Introduction">Introduction</a></li> 
      <li>2 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Setup">Setup</a></li> 
      <li>3 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Helloworld">Hello world</a></li> 
      <li>4 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Codebehindhelloworld">Code behind hello world</a></li> 
      <li>5 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Resultsandresultcodes">Results and result codes</a></li> 
      <li>6 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Chaining">Chaining</a></li> 
      <li>7 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-XWorkpackages">XWork packages</a></li> 
      <li>8 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Annotationreference">Annotation reference</a> 
       <ul> 
        <li>8.1 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Actionannotation">Action annotation</a></li> 
        <li>8.2 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-InterceptorRefannotation">InterceptorRef annotation</a></li> 
        <li>8.3 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Resultannotation">Result annotation</a></li> 
        <li>8.4 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Namespaceannotation">Namespace annotation</a></li> 
        <li>8.5 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-ResultPathannotation">ResultPath annotation</a></li> 
        <li>8.6 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-ParentPackageannotation">ParentPackage annotation</a></li> 
        <li>8.7 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-ExceptionMappingAnnotation">ExceptionMapping Annotation</a></li> 
       </ul> </li> 
      <li>9 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Automaticconfigurationreloading">Automatic configuration reloading</a></li> 
      <li>10 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Troubleshooting">Troubleshooting</a> 
       <ul> 
        <li>10.1 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Tips">Tips</a></li> 
        <li>10.2 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-CommonErrors">Common Errors</a></li> 
       </ul> </li> 
      <li>11 <a href="http://struts.apache.org/2.1.6/docs/convention-plugin.html#ConventionPlugin-Configurationreference">Configuration reference</a></li> 
     </ul> 
    </div> 
    <h1><a name="ConventionPlugin-Introduction"></a>Introduction</h1> 
    <p>The Convention Plugin is bundled with Struts since 2.1 and replaces the <a title="Codebehind Plugin" href="http://struts.apache.org/2.1.6/docs/codebehind-plugin.html">Codebehind Plugin</a> and Zero Config plugins. It provides the following features:</p> 
    <ul> 
     <li>Action location by package naming conventions</li> 
     <li>Result (JSP, FreeMarker, etc) location by naming conventions</li> 
     <li>Class name to URL naming convention</li> 
     <li>Package name to namespace convention</li> 
     <li>SEO compliant URLs (i.e. my-action rather than MyAction)</li> 
     <li>Action name overrides using annotations</li> 
     <li>Interceptor overrides using annotations</li> 
     <li>Namespace overrides using annotations</li> 
     <li>XWork package overrides using annotations</li> 
     <li>Default action and result handling (i.e. /products will try com.example.actions.Products as well as com.example.actions.products.Index)</li> 
    </ul> 
    <p>The Convention Plugin should require no configuration to use. Many of the conventions can be controlled using configuration properties and many of the classes can be extended or overridden.</p> 
    <h1><a name="ConventionPlugin-Setup"></a>Setup</h1> 
    <p>In order to use the Convention plugin, you first need to add the JAR file to the WEB-INF/lib directory of your application (if you package your actions in jar files, make sure that struts.convention.action.disableJarScanning is set to true).</p> 
    <h1><a name="ConventionPlugin-Helloworld"></a>Hello world</h1> 
    <p>Now that the Convention plugin has been added to your application, let's start with a very simple example. This example will use an actionless result that is identified by the URL. By default, the Convention plugin assumes that all of the results are stored in WEB-INF/content. This can be changed by setting the property struts.convention.result.path in the Struts properties file to the new location. Don't worry about trailing slashes, the Convention plugin handles this for you. Here is our hello world JSP:</p> 
    <div> 
     <div>
      WEB-INF/content/hello-world.jsp
     </div> 
     <div> 
      <pre>&lt;html&gt;
&lt;body&gt;
Hello world!
&lt;/body&gt;
&lt;/html&gt;</pre> 
     </div> 
    </div> 
    <p>If you start Tomcat (or whichever J2EE container you are using) and type in <a title="Visit page outside Confluence" rel="nofollow" href="http://localhost:8080/hello-world">http://localhost:8080/hello-world<img border="0" src="image/Struts 2 Convention .linkext7.gif" /><p class="origImg">http://cwiki.apache.org/confluence/images/icons/linkext7.gif</p></a> into your browser you should get this result:</p> 
    <div> 
     <div>
      WEB-INF/content/hello-world.jsp
     </div> 
     <div> 
      <pre>Hello world!</pre> 
     </div> 
    </div> 
    <p>This illustrates that the Convention plugin will find results even when no action exists and it is all based on the URL passed to Struts.</p> 
    <h1><a name="ConventionPlugin-Codebehindhelloworld"></a>Code behind hello world</h1> 
    <p>Let's expand on this example and add a code behind class. In order to do this we need to ensure that the Convention plugin is able to find our action classes. By default, the Convention plugin will find all action classes that implement com.opensymphony.xwork2.Action or whose name ends with the word Action in specific packages.</p> 
    <p>These packages are located by the Convention plugin using a search methodology. First the Convention plugin finds packages named struts, struts2, action or actions. Any packages that match those names are considered the root packages for the Convention plugin. Next, the plugin looks at all of the classes in those packages as well as sub-packages and determines if the classes implement com.opensymphony.xwork2.Action or if their name ends with Action (i.e. FooAction). Here's an example of a few classes that the Convention plugin will find:</p> 
    <div> 
     <div>
      Classes
     </div> 
     <div> 
      <pre>com.example.actions.MainAction
com.example.actions.products.Display (implements com.opensymphony.xwork2.Action)
com.example.struts.company.details.ShowCompanyDetailsAction</pre> 
     </div> 
    </div> 
    <p>Each of the action classes that the plugin finds will be configured to respond to specific URLs. The URL is based on the package name that the class is defined in and the class name itself. First the plugin determines the namespace of the URL using the package names between the root package and the package the class is defined in. For our examples above, the namespaces would be:</p> 
    <div> 
     <div>
      Namespaces
     </div> 
     <div> 
      <pre>com.example.actions.MainAction -&gt; /
com.example.actions.products.Display -&gt; /products
com.example.struts.company.details.ShowCompanyDetailsAction -&gt; /company/details</pre> 
     </div> 
    </div> 
    <p>Next, the plugin determines the URL of the resource using the class name. It first removes the word Action from the end of the class name and then converts camel case names to dashes. In our example the full URLs would be:</p> 
    <div> 
     <div>
      Full URLs
     </div> 
     <div> 
      <pre>com.example.actions.MainAction -&gt; /main
com.example.actions.products.Display -&gt; /products/display
com.example.struts.company.details.ShowCompanyDetailsAction -&gt; /company/details/show-company-details</pre> 
     </div> 
    </div> 
    <p>You can tell the Convention plugin to ignore certain packages using the property struts.convention.exclude.packages. You can also tell the plugin to use different strings to locate root packages using the property struts.convention.package.locators. Finally, you can tell the plugin to search specific root packages using the property struts.convention.action.packages.</p> 
    <p>Here is our code behind action class:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 

public class HelloWorld extends ActionSupport {
  private String message;

  public String getMessage() {
    return message;
  }

  public String execute() {
    message = &quot;Hello World!&quot;;
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <p>If you compile this class and place it into your application in the WEB-INF/classes, the Convention plugin will find the class and map the URL /hello-world to it. Next, we need to update our JSP to print out the message we setup in the action class. Here is the new JSP:</p> 
    <div> 
     <div>
      WEB-INF/content/hello-world.jsp
     </div> 
     <div> 
      <pre>&lt;html&gt;
&lt;body&gt;
The message is ${message}
&lt;/body&gt;
&lt;/html&gt;</pre> 
     </div> 
    </div> 
    <p>If start up the application server and open up <a title="Visit page outside Confluence" rel="nofollow" href="http://localhost:8080/hello-world">http://localhost:8080/hello-world<img border="0" src="image/Struts 2 Convention .linkext7.gif" /><p class="origImg">http://cwiki.apache.org/confluence/images/icons/linkext7.gif</p></a> in our browser, we should get this result:</p> 
    <div> 
     <div>
      Result
     </div> 
     <div> 
      <pre>The message is Hello World!</pre> 
     </div> 
    </div> 
    <h1><a name="ConventionPlugin-Resultsandresultcodes"></a>Results and result codes</h1> 
    <p>The Convention Plugin will pre-configure all of you action classes when Struts is started. By default, this configuration will also contain results for any JSPs that it can find within the application. The JSPs have an additional feature that allows different JSPs to be used based on the result code of the action. Since action methods return Strings and these Strings are traditionally used to locate results for the action, the Convention plugin allows you to define different results based on the result code.</p> 
    <p>Building on our example from above, let's say we want to provide a different result if the result code from our action is the String zero rather than success. First, we update the action class to return different result codes:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 

public class HelloWorld extends ActionSupport {
  private String message;

  public String getMessage() {
    return message;
  }

  public String execute() {
    if (System.currentTimeMillis() % 2 == 0) {
      message = &quot;It's 0&quot;;
      return &quot;zero&quot;;
    }

    message = &quot;It's 1&quot;;
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <p>Next, we add a new JSP to the application named WEB-INF/content/hello-world-zero.jsp. Notice that the first part of the file name is the same as the URL of the action and the last part of the name is the result code. This is the convention that the plugin uses to determine which results to render. Here is our new JSP:</p> 
    <div> 
     <div>
      WEB-INF/content/hello-world.jsp
     </div> 
     <div> 
      <pre>&lt;html&gt;
&lt;body&gt;
The error message is ${message}
&lt;/body&gt;
&lt;/html&gt;</pre> 
     </div> 
    </div> 
    <p>Now, if you compile the action and restart the application, based on the current time, you'll either see the result from WEB-INF/content/hello-world.jsp or WEB-INF/content/hello-world-zero.jsp.</p> 
    <p>The result type is based on the extension of the file. The supported extensions are: jsp,ftl,vm,html,html. Examples of Action and Result to Template mapping:</p> 
    <table class="FCK__ShowTableBorders"> 
     <tbody> 
      <tr> 
       <th>URL</th> 
       <th>Result</th> 
       <th>File that could match</th> 
       <th>Result Type</th> 
      </tr> 
      <tr> 
       <td>/hello</td> 
       <td>success</td> 
       <td>/WEB-INF/content/hello.jsp</td> 
       <td>Dispatcher</td> 
      </tr> 
      <tr> 
       <td>/hello</td> 
       <td>success</td> 
       <td>/WEB-INF/content/hello-success.htm</td> 
       <td>Dispatcher</td> 
      </tr> 
      <tr> 
       <td>/hello</td> 
       <td>success</td> 
       <td>/WEB-INF/content/hello.ftl</td> 
       <td>FreeMarker</td> 
      </tr> 
      <tr> 
       <td>/hello-world</td> 
       <td>input</td> 
       <td>/WEB-INF/content/hello-world-input.vm</td> 
       <td>Velocity</td> 
      </tr> 
      <tr> 
       <td>/test1/test2/hello</td> 
       <td>error</td> 
       <td>/WEB-INF/content/test/test2/hello-error.html</td> 
       <td>Dispatcher</td> 
      </tr> 
     </tbody> 
    </table> 
    <h1><a name="ConventionPlugin-Chaining"></a>Chaining</h1> 
    <p>If one action returns the name of another action in the same package, they will be chained together, if the first action doesn't have any result defined for that code. In the following example:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.Action;
import com.opensymphony.xwork2.ActionSupport; 

public class HelloAction extends ActionSupport {
    @Action(&quot;foo&quot;)
    public String foo() {
        return &quot;bar&quot;;
    }

    @Action(&quot;foo-bar&quot;)
    public String bar() {
        return SUCCESS;
    }
}</pre> 
     </div> 
    </div> 
    <p>The &quot;foo&quot; action will be executed, because no result is found, the Convention plugin tries to find an action named &quot;foo-bar&quot; on the same package where &quot;foo&quot; is defined. If such an action is found, it will be invoked using the &quot;chain&quot; result.</p> 
    <h1><a name="ConventionPlugin-XWorkpackages"></a>XWork packages</h1> 
    <p>Actions are placed on a custom XWork package which prevents conflicts. The name of this package is based on the Java package the action is defined in, the namespace part of the URL for the action and the parent XWork package for the action. The parent XWork package is determined based on the property named struts.convention.default.parent.package(defaults to conventionDefault), which is a custom XWork package that extends strutsDefault.</p> 
    <p>Therefore the naming for XWork packages used by the Convention plugin are in the form:</p> 
    <div> 
     <div>
      XWork package naming
     </div> 
     <div> 
      <pre>&lt;java-package&gt;#&lt;namespace&gt;#&lt;parent-package&gt;</pre> 
     </div> 
    </div> 
    <p>Using our example from above, the XWork package for our action would be:</p> 
    <div> 
     <div>
      XWork package naming
     </div> 
     <div> 
      <pre>com.example.actions#/#conventionDefault</pre> 
     </div> 
    </div> 
    <h1><a name="ConventionPlugin-Annotationreference"></a>Annotation reference</h1> 
    <p>The Convention plugin uses a number of different annotations to override the default conventions that are used to map actions to URLs and locate results. In addition, you can modify the parent XWork package that actions are configured with.</p> 
    <h2><a name="ConventionPlugin-Actionannotation"></a>Action annotation</h2> 
    <p>The Convention plugin allows action classes to change the URL that they are mapped to using the Action annotation. This annotation can also be used inside the Actions annotation to allow multiple URLs to map to a single action class. This annotation must be defined on action methods like this:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 
import org.apache.struts2.convention.annotation.Action;

public class HelloWorld extends ActionSupport {
  @Action(&quot;/different/url&quot;)
  public String execute() {
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <p>Our action class will now map to the URL /different/url rather than /hello-world. If no @Result (see next section) is specified, then the namespace of the action will be used as the path to the result, on our last example it would be &quot;/WEB-INF/content/different/url.jsp&quot;.</p> 
    <p>A single method within an action class can also map to multiple URLs using the Actions annotation like this:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 
import org.apache.struts2.convention.annotation.Action;
import org.apache.struts2.convention.annotation.Actions;

public class HelloWorld extends ActionSupport {
  @Actions({
    @Action(&quot;/different/url&quot;),
    @Action(&quot;/another/url&quot;)
  })
  public String execute() {
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <p>Another usage of the Action or Actions annotation is to define multiple action methods within a single action class, each of which respond to a different URL. Here is an example of multiple action methods:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 
import org.apache.struts2.convention.annotation.Action;
import org.apache.struts2.convention.annotation.Actions;

public class HelloWorld extends ActionSupport {
  @Action(&quot;/different/url&quot;)
  public String execute() {
    return SUCCESS;

  }

  @Action(&quot;url&quot;)
  public String doSomething() {
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <p>The previous example defines a second URL that is not fully qualified. This means that the namespace for the URL is determined using the Java package name rather than the Action annotation.</p> 
    <p>Interceptor and interceptor stacks can be specified using the interceptorRefs attribute. The following example applies the &quot;validation&quot; interceptor and the &quot;defaultStack&quot; interceptor stack to the action:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 
import org.apache.struts2.convention.annotation.Action;
import org.apache.struts2.convention.annotation.Actions;

public class HelloWorld extends ActionSupport {
  @Action(interceptorRefs={@InterceptorRef(&quot;validation&quot;), @InterceptorRef(&quot;defaultStack&quot;)})
  public String execute() {
    return SUCCESS;
  }

  @Action(&quot;url&quot;)
  public String doSomething() {
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <p>Parameters can be passed to results using the params attribute. The value of this attribute is a string array with an even number of elements in the form {&quot;key0&quot;, &quot;value0, &quot;key1&quot;, &quot;value1&quot; ... &quot;keyN&quot;, &quot;valueN&quot;}. For example:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 
import org.apache.struts2.convention.annotation.Action;
import org.apache.struts2.convention.annotation.Actions;

public class HelloWorld extends ActionSupport {
  @Action(interceptorRefs=@InterceptorRef(value=&quot;validation&quot;,params={&quot;programmatic&quot;, &quot;false&quot;, &quot;declarative&quot;, &quot;true}))
  public String execute() {
    return SUCCESS;
  }

  @Action(&quot;url&quot;)
  public String doSomething() {
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <p>If interceptors are not specified, the default stack is applied.</p> 
    <h2><a name="ConventionPlugin-InterceptorRefannotation"></a>InterceptorRef annotation</h2> 
    <p>Interceptors can be specified at the method level, using the Action annotation or at the class level using the InterceptorRefs annotation. Interceptors specified at the class level will be applied to all actions defined on that class. In the following example:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 
import org.apache.struts2.convention.annotation.Action;
import org.apache.struts2.convention.annotation.Actions;

@InterceptorRefs({
    @InterceptorRef(&quot;interceptor-1&quot;),
    @InterceptorRef(&quot;defaultStack&quot;)
})
public class HelloWorld extends ActionSupport {
  @Action(value=&quot;action1&quot;, interceptorRefs=@InterceptorRef(&quot;validation&quot;))
  public String execute() {
    return SUCCESS;
  }

  @Action(value=&quot;action2&quot;)
  public String doSomething() {
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <p>The following interceptors will be applied to &quot;action1&quot;: &quot;interceptor-1&quot;, all interceptors from &quot;defaultStack&quot;, &quot;validation&quot;.<br /> All interceptors from &quot;defaultStack&quot; will be applied to &quot;action2&quot;.</p> 
    <h2><a name="ConventionPlugin-Resultannotation"></a>Result annotation</h2> 
    <p>The Convention plugin allows action classes to define different results for an action. Results fall into two categories, global and local. Global results are shared across all actions defined within the action class. These results are defined as annotations on the action class. Local results apply only to the action method they are defined on. Here is an example of the different types of result annotations:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 
import org.apache.struts2.convention.annotation.Action;
import org.apache.struts2.convention.annotation.Actions;
import org.apache.struts2.convention.annotation.Result;
import org.apache.struts2.convention.annotation.Results;

@Results({
  @Result(name=&quot;failure&quot;, location=&quot;fail.jsp&quot;)
})
public class HelloWorld extends ActionSupport {
  @Action(value=&quot;/different/url&quot;, 
    results={@Result(name=&quot;success&quot;, location=&quot;http://struts.apache.org&quot;, type=&quot;redirect&quot;)}
  )
  public String execute() {
    return SUCCESS;
  }

  @Action(&quot;/another/url&quot;)
  public String doSomething() {
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <p>Parameters can be passed to results using the params attribute. The value of this attribute is a string array with an even number of elements in the form {&quot;key0&quot;, &quot;value0, &quot;key1&quot;, &quot;value1&quot; ... &quot;keyN&quot;, &quot;valueN&quot;}. For example:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 
import org.apache.struts2.convention.annotation.Action;
import org.apache.struts2.convention.annotation.Actions;
import org.apache.struts2.convention.annotation.Result;
import org.apache.struts2.convention.annotation.Results;

public class HelloWorld extends ActionSupport {
  @Action(value=&quot;/different/url&quot;, 
    results={@Result(name=&quot;success&quot;, type=&quot;httpheader&quot;, params={&quot;status&quot;, &quot;500&quot;, &quot;errorMessage&quot;, &quot;Internal Error&quot;})}
  )
  public String execute() {
    return SUCCESS;
  }

  @Action(&quot;/another/url&quot;)
  public String doSomething() {
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <h2><a name="ConventionPlugin-Namespaceannotation"></a>Namespace annotation</h2> 
    <p>The namespace annotation allows the namespace for action classes to be changed instead of using the convention of the Java package name. This annotation can be placed on an action class or within the package-info.java class that allows annotations to be placed on Java packages. When this annotation is put on an action class, it applies to all actions defined in the class, that are not fully qualified action URLs. When this annotation is place in the package-info.java file, it changes the default namespace for all actions defined in the Java package. Here is an example of the annotation on an action class:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 
import org.apache.struts2.convention.annotation.Action;
import org.apache.struts2.convention.annotation.Namespace;

@Namespace(&quot;/custom&quot;)
public class HelloWorld extends ActionSupport {
  @Action(&quot;/different/url&quot;)
  public String execute() {
    return SUCCESS;
  }

  @Action(&quot;url&quot;)
  public String doSomething() {
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <p>In this example, the action will respond to two different URLs /different/url and /custom/url.</p> 
    <p>Here is an example of using this annotation in the package-info.java file:</p> 
    <div> 
     <div>
      com/example/actions/package-info.java
     </div> 
     <div> 
      <pre>@org.apache.struts2.convention.annotation.Namespace(&quot;/custom&quot;)
package com.example.actions;</pre> 
     </div> 
    </div> 
    <p>This changes the default namespace for all actions defined in the package com.example.actions. This annotation however doesn't apply to sub-packages.</p> 
    <h2><a name="ConventionPlugin-ResultPathannotation"></a>ResultPath annotation</h2> 
    <p>The ResultPath annotation allows applications to change the location where results are stored. This annotation can be placed on an action class and also in the package-info.java file. Here is an example of using this annotation:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 
import org.apache.struts2.convention.annotation.Action;
import org.apache.struts2.convention.annotation.ResultPath;

@ResultPath(&quot;/WEB-INF/jsps&quot;)
public class HelloWorld extends ActionSupport {
  public String execute() {
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <p>The result for this class will be located in WEB-INF/jsps rather than the default of WEB-INF/content.</p> 
    <h2><a name="ConventionPlugin-ParentPackageannotation"></a>ParentPackage annotation</h2> 
    <p>The ParentPackage annotation allows applications to define different parent XWork packages for specific action classes or Java packages. Here is an example of using the annotation on an action class:</p> 
    <div> 
     <div>
      com.example.actions.HelloWorld
     </div> 
     <div> 
      <pre>package com.example.actions;

import com.opensymphony.xwork2.ActionSupport; 
import org.apache.struts2.convention.annotation.Action;
import org.apache.struts2.convention.annotation.ParentPackage;

@ParentPackage(&quot;customXWorkPackage&quot;)
public class HelloWorld extends ActionSupport {
  public String execute() {
    return SUCCESS;
  }
}</pre> 
     </div> 
    </div> 
    <h2><a name="ConventionPlugin-ExceptionMappingAnnotation"></a>ExceptionMapping Annotation</h2> 
    <p>This annotation can be used to define exception mappings to actions. See the <a title="Exception Configuration" href="http://struts.apache.org/2.1.6/docs/exception-configuration.html">exception mapping documentation</a> for more details. These mappings can be applied to the class level, in which case they will be applied to all actions defined on that class:</p> 
    <div> 
     <div>
      ExceptionsActionLevelAction.java
     </div> 
     <div> 
      <pre>@ExceptionMappings({
    @ExceptionMapping(exception = &quot;java.lang.NullPointerException&quot;, result = &quot;success&quot;, params = {&quot;param1&quot;, &quot;val1&quot;})
})
public class ExceptionsActionLevelAction {

    public String execute() throws Exception {
        return null;
    }
}</pre> 
     </div> 
    </div> 
    <p>The parameters defined by params are passed to the result. Exception mappings can also be applied to the action level:</p> 
    <div> 
     <div> 
      <pre>public class ExceptionsMethodLevelAction {
    @Action(value = &quot;exception1&quot;, exceptionMappings = {
            @ExceptionMapping(exception = &quot;java.lang.NullPointerException&quot;, result = &quot;success&quot;, params = {&quot;param1&quot;, &quot;val1&quot;})
    })
    public String run1() throws Exception {
        return null;
    }
}</pre> 
     </div> 
    </div> 
    <h1><a name="ConventionPlugin-Automaticconfigurationreloading"></a>Automatic configuration reloading</h1> 
    <p>The Convention plugin can automatically reload configuration changes, made in classes the contain actions, without restarting the container. This is a similar behavior to the automatic xml configuration reloading. To enable this feature, add this to your struts.xml file:</p> 
    <div> 
     <div> 
      <pre>&lt;constant name=&quot;struts.devMode&quot; value=&quot;true&quot;/&gt;
&lt;constant name=&quot;struts.convention.classes.reload&quot; value=&quot;true&quot; /&gt;</pre> 
     </div> 
    </div> 
    <p>This feature is experimental and has not been tested on all container, and it is strongly advised not to use it in production environments.</p> 
    <h1><a name="ConventionPlugin-Troubleshooting"></a>Troubleshooting</h1> 
    <h2><a name="ConventionPlugin-Tips"></a>Tips</h2> 
    <table class="FCK__ShowTableBorders" border="0" cellspacing="8" cellpadding="5"> 
     <colgroup>
      <col />
      <col />
     </colgroup> 
     <tbody> 
      <tr> 
       <td><img border="0" src="image/Struts 2 Convention .check.gif" /><p class="origImg">http://cwiki.apache.org/confluence/images/icons/emoticons/check.gif</p></td> 
       <td>Namespaces and Results<br /> <p>Make sure the namespace of you action is matched by one of the locators. The rest of the namespace after the locator, will be the namespace of the action, and will be used to find the results. For example, a class called &quot;ViewAction&quot; in the package &quot;my.example.actions.orders&quot; will be mapped to the URL /orders/view.action, and the results must be under /WEB-INF/content/orders, like /WEB-INF/content/orders/view-success.jsp.</p> </td> 
      </tr> 
     </tbody> 
    </table> 
    <table class="FCK__ShowTableBorders" border="0" cellspacing="8" cellpadding="5"> 
     <colgroup>
      <col />
      <col />
     </colgroup> 
     <tbody> 
      <tr> 
       <td><img border="0" src="image/Struts 2 Convention .check.gif" /><p class="origImg">http://cwiki.apache.org/confluence/images/icons/emoticons/check.gif</p></td> 
       <td>Use the Configuration Browser Plugin<br /> <p>Add the <a title="Config Browser Plugin" href="http://struts.apache.org/2.1.6/docs/config-browser-plugin.html">Config Browser Plugin</a> plugin to you lib folder or maven dependencies, and then visit: <a title="Visit page outside Confluence" rel="nofollow" href="http://localhost:8080/YOUR_CONTEXT_HERE/config-browser/index.action">http://localhost:8080/YOUR_CONTEXT_HERE/config-browser/index.action<img border="0" src="image/Struts 2 Convention .linkext7.gif" /><p class="origImg">http://cwiki.apache.org/confluence/images/icons/linkext7.gif</p></a>, to see the current action mappings.</p> </td> 
      </tr> 
     </tbody> 
    </table> 
    <table class="FCK__ShowTableBorders" border="0" cellspacing="8" cellpadding="5"> 
     <colgroup>
      <col />
      <col />
     </colgroup> 
     <tbody> 
      <tr> 
       <td><img border="0" src="image/Struts 2 Convention .check.gif" /><p class="origImg">http://cwiki.apache.org/confluence/images/icons/emoticons/check.gif</p></td> 
       <td>Enable trace or debug mode<br /> <p>The Convention plugin can generate a rather verbose output when set to debug mode for logging. Use &quot;Trace&quot; logging level if you are using the JDK logger. If you are using Log4J, you can do something like:</p> <p>log4j.logger.org.apache.struts2.convention=DEBUG</p> </td> 
      </tr> 
     </tbody> 
    </table> 
    <h2><a name="ConventionPlugin-CommonErrors"></a>Common Errors</h2> 
    <ol> 
     <li>I get an error like &quot;There is no Action mapped for namespace /orders and action name view.&quot;. This means that the URL /orders/view.action is not mapping to any action class. Check the namespace and the name of the action.</li> 
     <li>I get an error like &quot;No result defined for action &quot;my.example.actions.orders.ViewAction and result success&quot;. This means that the action was mapped to the right URL, but the Convention plugin was unable to find a success result for it. Check that the result file exists, like /WEB-INF/content/orders/view-success.jsp.</li> 
    </ol> 
    <h1><a name="ConventionPlugin-Configurationreference"></a>Configuration reference</h1> 
    <p>Add a constant element to your struts config file to change the value of a configuration setting, like:</p> 
    <div> 
     <div> 
      <pre>&lt;constant name=&quot;struts.convention.result.path&quot; value=&quot;/WEB-INF/mytemplates/&quot;/&gt;</pre> 
     </div> 
    </div> 
    <table class="FCK__ShowTableBorders"> 
     <tbody> 
      <tr> 
       <th>Name</th> 
       <th>Default Value</th> 
       <th>Description</th> 
      </tr> 
      <tr> 
       <td>struts.convention.action.disableJarScanning</td> 
       <td>true</td> 
       <td>Scan jar files for actions</td> 
      </tr> 
      <tr> 
       <td>struts.convention.action.packages</td> 
       <td> </td> 
       <td>An optional list of action packages that this should create configuration for (they don't need to match a locator pattern)</td> 
      </tr> 
      <tr> 
       <td>struts.convention.result.path</td> 
       <td>/WEB-INF/content/</td> 
       <td>Directory where templates are located</td> 
      </tr> 
      <tr> 
       <td>struts.convention.result.flatLayout</td> 
       <td>true</td> 
       <td>If set to false, the result can be put in its own directory: resultsRoot/namespace/actionName/result.extension</td> 
      </tr> 
      <tr> 
       <td>struts.convention.action.suffix</td> 
       <td>Action</td> 
       <td>Suffix used to find actions based on class names</td> 
      </tr> 
      <tr> 
       <td>struts.convention.action.disableScanning</td> 
       <td>false</td> 
       <td>Scan packages for actions</td> 
      </tr> 
      <tr> 
       <td>struts.convention.action.mapAllMatches</td> 
       <td>false</td> 
       <td>Create action mappings, even if no @Action is found</td> 
      </tr> 
      <tr> 
       <td>struts.convention.action.checkImplementsAction</td> 
       <td>true</td> 
       <td>Check if an action implements com.opensymphony.xwork2.Action to create an action mapping</td> 
      </tr> 
      <tr> 
       <td>struts.convention.default.parent.package</td> 
       <td>convention-default</td> 
       <td>Default parent package for action mappins</td> 
      </tr> 
      <tr> 
       <td>struts.convention.action.name.lowercase</td> 
       <td>true</td> 
       <td>Convert action name to lowercase</td> 
      </tr> 
      <tr> 
       <td>struts.convention.action.name.separator</td> 
       <td>-</td> 
       <td>Separator used to build the action name, MyAction -&gt; my-action. This character is also used as the separator between the action name and the result in templates, like action-result.jsp</td> 
      </tr> 
      <tr> 
       <td>struts.convention.package.locators</td> 
       <td>action,actions,struts,struts2</td> 
       <td>Packages whose name end with one of these strings will be scanned for actions</td> 
      </tr> 
      <tr> 
       <td>struts.convention.package.locators.disable</td> 
       <td>false</td> 
       <td>Disable the scanning of packages based on package locators</td> 
      </tr> 
      <tr> 
       <td>struts.convention.exclude.packages</td> 
       <td>org.apache.struts.*,<br /> org.apache.struts2.*,<br /> org.springframework.web.struts.*,<br /> org.springframework.web.struts2.*,<br /> org.hibernate.*</td> 
       <td>Packages excluded from the action scanning</td> 
      </tr> 
      <tr> 
       <td>struts.convention.package.locators.basePackage</td> 
       <td> </td> 
       <td>If set, only packages that start with its value will be scanned for actions</td> 
      </tr> 
      <tr> 
       <td>struts.convention.relative.result.types</td> 
       <td>dispatcher,velocity,freemarker</td> 
       <td>The list of result types that can have locations that are relative and the result location (which is the resultPath plus the namespace) prepended to them</td> 
      </tr> 
      <tr> 
       <td>struts.convention.redirect.to.slash</td> 
       <td>true</td> 
       <td>A boolean parameter that controls whether or not this will handle unknown actions in the same manner as Apache, Tomcat and other web servers. This handling will send back a redirect for URLs such as /foo to /foo/ if there doesn't exist an action that responds to /foo</td> 
      </tr> 
     </tbody> 
    </table> 
   </div> 
  </div> 
 </div> 
</div></div></body></html>