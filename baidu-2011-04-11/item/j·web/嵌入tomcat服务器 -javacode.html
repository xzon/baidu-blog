<html><head><title>嵌入tomcat服务器 -javacode</title></head><body><div id='tit'>嵌入tomcat服务器 -javacode</div><div id='cate'>j&middot;web</div><div id='date'>2010年10月28日 星期四 11:21 A.M.</div><div id='page'>6</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/5c81d207536e53c27a89472a.html'>http://hi.baidu.com/hxzon/blog/item/5c81d207536e53c27a89472a.html</a><div id='cnt'><p>嵌入tomcat服务器 -javacode</p> 
<p>问题：<br /> java.lang.NoSuchMethodError: javax.persistence.OneToMany.orphanRemoval()Z 。<br /> 解决办法：删除对Java EE 5 Libraries的使用。<br /> 原因：javaee.jar中的部分类与hibernate-jpa-2.0-api-1.0.0.Final.jar存在版本冲突。</p> 
<pre>package embed;<br /><br />import java.net.InetAddress;<br />import java.net.UnknownHostException;<br /><br />import org.apache.catalina.Context;<br />import org.apache.catalina.Engine;<br />import org.apache.catalina.Host;<br />import org.apache.catalina.LifecycleException;<br />import org.apache.catalina.startup.Embedded;<br /><br />public class ServerManager {<br /><br /> private final String tomcatHome = &quot;D:\\develop\\tomcat-6.0.29&quot;;<br /> private Embedded tomcat;<br /><br /> public static void main(String[] args) {<br /><br />  ServerManager manager = new ServerManager();<br />  manager.startServer();<br />  while (true) {<br /><br />  }<br />  // manager.stopServer();<br /> }<br /><br /> public void startServer() {<br /><br />  tomcat = createTomcat(tomcatHome);<br />  try {<br />   tomcat.start();<br />   System.out.println(&quot;---------- Tomcat Server start over. ------------&quot;);<br />  } catch (Exception e) {<br />   e.printStackTrace();<br />  }<br /><br /> }<br /><br /> public void stopServer() {<br />  try {<br />   tomcat.stop();<br />   System.out.println(&quot;---------------- Tomcat Server stoped -----------------&quot;);<br />  } catch (LifecycleException e) {<br />   e.printStackTrace();<br />  }<br /> }<br /><br /> private static Embedded createTomcat(String tomcatHome) {<br />  Embedded tomcat = new Embedded();<br />  tomcat.setCatalinaHome(tomcatHome);<br />  Engine engine = tomcat.createEngine();<br />  engine.setName(&quot;Catalina&quot;);<br />  Host host = tomcat.createHost(&quot;localhost&quot;, tomcat.getCatalinaHome() + &quot;/webapps&quot;);<br />  // host.setAppBase(&quot;webapps&quot;);<br />  host.setAutoDeploy(true);<br />  Context materialApp = tomcat.createContext(&quot;/material&quot;, host.getAppBase() + &quot;/material4&quot;);<br />  host.addChild(materialApp);<br /><br />  engine.addChild(host);<br />  engine.setDefaultHost(host.getName());<br /><br />  tomcat.addEngine(engine);<br />  try {<br />   tomcat.addConnector(tomcat.createConnector(InetAddress.getByName(&quot;127.0.0.1&quot;), 8080, false));<br />  } catch (UnknownHostException e) {<br />   e.printStackTrace();<br />   tomcat = null;<br />  }<br />  return tomcat;<br /> }<br />}</pre> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p></div></body></html>