<html><head><title>利用JDBC连接MS SQL Ser2000+sp2</title></head><body><div id='tit'>利用JDBC连接MS SQL Ser2000+sp2</div><div id='cate'>代码备份</div><div id='date'>2007年11月28日 星期三 09:17 P.M.</div><div id='page'>195</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/3da9758ddff6f311b21bba54.html'>http://hi.baidu.com/hxzon/blog/item/3da9758ddff6f311b21bba54.html</a><div id='cnt'><table class="buttomBorder" cellspacing="3" cellpadding="3" width="100%" border="0"> 
 <tbody> 
  <tr> 
   <td class="contentTitle" align="center">利用JDBC连接MS SQL Ser2000+sp2 
    <hr width="70%" /> </td> 
  </tr> 
  <tr> 
   <td align="center">2005-06-28 来源:CSDN 作者:AndyZhange</td> 
  </tr> 
  <tr> 
   <td class="content" valign="top" align="left"> <p> 我在学习j2ee的时候使用jdbc连接过ms sql server 2000，开始的时候一切都正常，但是后来遇到了一个很头痛的问题，就是我们在从表中读取数据放到ResultSet中后，读取列值的时候一定的按照列的顺序读取。</p> <p> 比如如果表中有三列id, name, address,按条件查询得到的结果放到ResultSet中，显示结果时如果这样写代码：</p> <p> </p>
    <table style="width: 218px; height: 84px" bordercolor="#55aaff" cellspacing="0" cellpadding="0" rules="none" width="218" align="center" bgcolor="#ddedfb" border="1"> 
     <tbody> 
      <tr> 
       <td width="10"> </td> 
       <td> java.sql.ResultSet employees;<br /> while(employees.next()){<br /> employees.getString(&quot;address&quot;);<br /> employees.getString(&quot;name&quot;);<br /> }</td> 
      </tr> 
     </tbody> 
    </table> <br /> <br /> 在运行的时候将会&quot;column can not be re-read&quot;错误，此时把两条语句颠倒就好了（此条只适用于连接MS SQL Server 2000） <p> <strong>连接数据库代码如下：</strong></p> <p> </p>
    <table bordercolor="#55aaff" cellspacing="0" cellpadding="0" rules="none" width="500" align="center" bgcolor="#ddedfb" border="1"> 
     <tbody> 
      <tr> 
       <td width="10"> </td> 
       <td> try {<br /> Class.forName(&quot;com.microsoft.jdbc.sqlserver.SQLServerDriver&quot;);<br /> conn =<br /> DriverManager.getConnection(<br /> &quot;jdbc:microsoft:sqlserver://localhost:1433;DatabaseName=Hotel;User=sa;Password=sa&quot;);<br /> //&nbsp;&nbsp; Class.forName(&quot;sun.jdbc.odbc.JdbcOdbcDriver&quot;);<br /> //&nbsp;&nbsp; conn = DriverManager.getConnection(&quot;jdbc:odbc:hotel&quot;);<br /> } catch (SQLException e) {<br /> System.err.println(e);<br /> } catch (ClassNotFoundException e) {<br /> System.err.println(e);<br /> }</td> 
      </tr> 
     </tbody> 
    </table>  </td> 
  </tr> 
 </tbody> 
</table></div></body></html>