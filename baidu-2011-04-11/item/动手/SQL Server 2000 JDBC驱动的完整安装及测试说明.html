<html><head><title>SQL Server 2000 JDBC驱动的完整安装及测试说明</title></head><body><div id='tit'>SQL Server 2000 JDBC驱动的完整安装及测试说明</div><div id='cate'>动手</div><div id='date'>2007年11月25日 星期日 04:02 P.M.</div><div id='page'>196</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/3874b28f86a156edf11f36c7.html'>http://hi.baidu.com/hxzon/blog/item/3874b28f86a156edf11f36c7.html</a><div id='cnt'><div>
 SQL Server 2000 JDBC驱动的完整安装及测试说明
 <br /> 2007-03-03 17:09
 <br /> 这是我在长沙牛耳软件教育中心做毕业设计时整理一篇文档，最近一些学弟问我，翻箱倒柜总算是把它给搂了出来。里面的数据库是我们当时做的项目的数据库，你可以根据自己的数据库进行修正，当然其他一些资料也需要根据你自己的实际情况进行相应的修改。 
 <br /> 一、下载SQLSERVER2000的jdbc驱动程序。
</div> 
<div> 
</div> 
<div>
 在微软站点就有这个驱动程序：
</div> 
<div> 
</div> 
<div>
 Window操作系统
</div> 
<div> 
</div> 
<div>
 <a href="http://www.uncj.com/upload/files/ms_jdbc_setup.exe">http://www.uncj.com/upload/files/ms_jdbc_setup.exe</a>
</div> 
<div> 
</div> 
<div>
 <a href="http://download.microsoft.com/download/3/0/f/30ff65d3-a84b-4b8a-a570-27366b2271d8/setup.exe">http://download.microsoft.com/download/3/0/f/30ff65d3-a84b-4b8a-a570-27366b2271d8/setup.exe</a>
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 Unix操作系统 Mssqlserver.tar
</div> 
<div> 
</div> 
<div>
 <a href="http://download.microsoft.com/download/3/0/f/30ff65d3-a84b-4b8a-a570-27366b2271d8/mssqlserver.tar">http://download.microsoft.com/download/3/0/f/30ff65d3-a84b-4b8a-a570-27366b2271d8/mssqlserver.tar</a>
</div> 
<div> 
</div> 
<div>
 <br /> 二、安装JDBC
</div> 
<div> 
</div> 
<div>
 执行ms_jdbc_setup.exe可执行文件，一切只需要点击下一步，至到出现finish按钮，完成安装。
</div> 
<div> 
</div> 
<div>
 注：
</div> 
<div> 
</div> 
<div>
 (1) ms_JDBC_setup默认安装路径为：c:\Program Files\Microsoft SQL Server 2000 Driver for JDBC
</div> 
<div> 
</div> 
<div>
 (2)此版(Version 2.2.0022)本仅支持Microsoft SQL Server 2000 Driver for JDBC
</div> 
<div> 
</div> 
<div>
 (3)安装目录\lib\下的三个jar文件即是我们要的JDBC驱动核心
</div> 
<div> 
</div> 
<div>
 msbase.jar
</div> 
<div> 
</div> 
<div>
 mssqlserver.jar
</div> 
<div> 
</div> 
<div>
 msutil.jar
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 三、将以上（3）中指的三个jar文件加入到环境变量中去
</div> 
<div> 
</div> 
<div>
 classpath：
</div> 
<div> 
</div> 
<div>
 d:\webserver\lib\msbase.jar;d:\webserver\lib\mssqlserver.jar;d:\webserver\lib\msutil.jar
</div> 
<div> 
</div> 
<div>
 注：也可以省事的将以上三个文件拷贝至你的jvm机所在的JAVA_HOME\jre\lib\ext目录下，不过不建议这么做。
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 四、测试
</div> 
<div> 
</div> 
<div>
 jsp文件：
</div> 
<div> 
</div> 
<div>
 &lt;%@ page contentType=&quot;text/html;charset=gb2312&quot;%&gt;
</div> 
<div> 
</div> 
<div>
 &lt;%@ page import=&quot;java.sql.*&quot;%&gt;
</div> 
<div> 
</div> 
<div>
 &lt;html&gt;
</div> 
<div> 
</div> 
<div>
 &lt;body&gt;
</div> 
<div> 
</div> 
<div>
 &lt;%
</div> 
<div> 
</div> 
<div>
 Class.forName(&quot;com.microsoft.jdbc.sqlserver.SQLServerDriver&quot;).newInstance();
</div> 
<div> 
</div> 
<div>
 String url=&quot;jdbc:microsoft:sqlserver://localhost:1433;DatabaseName=haiguan&quot;;
</div> 
<div> 
</div> 
<div>
 String user=&quot;sa&quot;;
</div> 
<div> 
</div> 
<div>
 String password=&quot;&quot;;
</div> 
<div> 
</div> 
<div>
 Connection conn= DriverManager.getConnection(url,user,password);
</div> 
<div> 
</div> 
<div>
 Statement stmt=conn.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_UPDATABLE);
</div> 
<div> 
</div> 
<div>
 String sql=&quot;select * from xt_user&quot;;
</div> 
<div> 
</div> 
<div>
 ResultSet rs=stmt.executeQuery(sql);
</div> 
<div> 
</div> 
<div>
 while(rs.next())
</div> 
<div> 
</div> 
<div>
 {
</div> 
<div> 
</div> 
<div>
 %&gt;
</div> 
<div> 
</div> 
<div>
 您的第一个字段内容为：&lt;%=rs.getString(1)%&gt;
</div> 
<div> 
</div> 
<div>
 您的第二个字段内容为：&lt;%=rs.getString(2)%&gt;
</div> 
<div> 
</div> 
<div>
 &lt;%
</div> 
<div> 
</div> 
<div>
 }
</div> 
<div> 
</div> 
<div>
 %&gt;
</div> 
<div> 
</div> 
<div>
 &lt;%out.print(&quot;数据库操作成功，恭喜你&quot;);%&gt;
</div> 
<div> 
</div> 
<div>
 &lt;%
</div> 
<div> 
</div> 
<div>
 rs.close();
</div> 
<div> 
</div> 
<div>
 stmt.close();
</div> 
<div> 
</div> 
<div>
 conn.close();
</div> 
<div> 
</div> 
<div>
 %&gt;
</div> 
<div> 
</div> 
<div>
 &lt;/body&gt;
</div> 
<div> 
</div> 
<div>
 &lt;/html&gt;
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 五、注意事项
</div> 
<div> 
</div> 
<div>
 1. 要保证你的Sql服务是启动状态
</div> 
<div> 
</div> 
<div>
 2. 在Sql 的管理器中能够使用sa或其它用户正常登录；(有些人在安装sql时用了nt用户管理模式，这里可能会有一定问题)
</div> 
<div> 
</div> 
<div>
 3. 第一次配置好环境变量最好能重启一下电脑
</div> 
<div> 
</div> 
<div>
 4. 注意JVM和DataBase的启动顺序：先启动DataBase，再启动JVM机。
</div> 
<div> 
</div> 
<div>
 注：在停止Web服务器后，再重启动，中间最好能有10秒以上的间隔。
</div> 
<div> 
</div> 
<div>
 5. 注意操作系统的网络连通性
</div> 
<div> 
</div> 
<div>
 A.启动了Tcp/IP服务
</div> 
<div> 
</div> 
<div>
 B.配置了相关IP地址,有些人机器可能用的是自动分配IP或有配置IP时，但网络不通可能也找不到IP
</div> 
<div> 
</div> 
<div>
 6. 有些机器在调试明最好能将（四）中的连接地址localhost改成数据库服务器的IP,这也是要注意5的原因
 <br /> 
 <br /> 
 <a href="http://hi.baidu.com/bootini">http://hi.baidu.com/bootini</a>
</div></div></body></html>