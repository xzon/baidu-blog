<html><head><title>解决XP越用越慢的问题</title></head><body><div id='tit'>解决XP越用越慢的问题</div><div id='cate'>动手</div><div id='date'>2007年11月13日 星期二 11:26 A.M.</div><div id='page'>203</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/62dd3f122dc31452f919b8e3.html'>http://hi.baidu.com/hxzon/blog/item/62dd3f122dc31452f919b8e3.html</a><div id='cnt'><p>解决XP越用越慢的问题<br /> <br /> 2004年9月24日 <br /> &nbsp;&nbsp;&nbsp; <br /> 本文来自网上搜集，有兴趣的朋友可以试一下。</p> 
<p>1、减少磁盘空间占用 <br /> 2、终止不常用的系统服务 <br /> 3、安全问题 <br /> 4、另外一些技巧</p> 
<p>首先问一下，你是不是很想激活XP，不。。。准确的说你是不是想在ms的站上能够升级。如果答案是肯定的话，那我们就先来探讨一下安装的问题，目前流行的V4、V5、V6版本我还是比较推荐的，尤其是V5和V6这两个。安装的过程中有个序列号的问题，我建议你先在机子上算好，然后用这个序列号安装，通常这样安装的XP都可以到MS的站点自由更新。 <br /> 如果你是已经安装好的XP了，但用的序列号是里到处流传人人都用的那些，也没关系，我们后面会说用sysrep来重新封装的时候会解决序列号更换的问题。</p> 
<p>我假设你已经安装完XP了，come on baby ~~</p> 
<p>一、瘦身行动</p> 
<p>1、在各种软硬件安装妥当之后，其实XP需要更新文件的时候就很少了。删除系统备份文件吧：开始→运行→sfc.exe /purgecache 近3xxM。</p> 
<p>2、删除驱动备份： %windows%\driver cache\i386目录下的driver.cab文件，通常这个文件是76M。</p> 
<p>3、偶没有看help的习惯，所以保留着%windows%\help目录下的东西对我来说是一种伤害，呵呵。。。都干掉，近4xM。</p> 
<p>4、一会在升级完成后你还会发现%windows%\多了许多类似$NtUninstallQ311889$这些目录，都干掉吧，1x-3xM。</p> 
<p>5、正好硬盘中还有win2000/server等，所以顺便把pagefile.sys文件都指向一个地方：控制面板→系统→性能—高级→虚拟内存→更改，注意要点“设置”才会生效。</p> 
<p>6、卸载不常用组件：用记事本修改\%windows%\inf\sysoc.inf，用查找/替换功能，在查找框中输入,hide，全部替换为空。这样，就把所有的,hide都去掉了，存盘退出后再运行“添加-删除程序”，就会看见“添加/删除 Windows 组件”中多出不少选项；删除掉游戏啊，码表啊等不用的东西。</p> 
<p>7、刪除\windows\ime下不用的輸入法，8xM。我重新安装了自己用的zrm输入法，赫赫。</p> 
<p>8、如果实在空间紧张，启用NTFS的压缩功能，这样还会少用2x% 的空间，不过我没作。</p> 
<p>9、关了系统还原，这破功能对我这样常下载、测试软件的人来说简直是灾难，用鼠标右健单击桌面上的“我的电脑”，选择“属性”，找到“系统还原”，选择“在所有驱动器上关闭系统还原”呵呵，又可以省空间了。</p> 
<p>10、还有几个文件，挺大的，也没什么用。。。。忘了名字 ：（ ，刚安装的系统可以用查找功能查找大于50M的文件来看看，应该能找到的。</p> 
<p>如果你能按照上面的过程做完，你的原本1.4G的XP，完全可以减少到800以下。</p> 
<p>二、加速计划</p> 
<p>WinXP的启动会有许多影响速度的功能，尽管ms说已经作最优化处理过，但对我们来说还是有许多可定制之处。我一般是这样来做的。</p> 
<p>1、修改注册表的run键，取消那几个不常用的东西，比如Windows Messenger 。启用注册表管理器：开始→运行→Regedit→找到“HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\MSMSGS” /BACKGROUND 这个键值，右键→删除，世界清静多了，顺便把那几个什么cfmon的都干掉吧。</p> 
<p>2、修改注册表来减少预读取，减少进度条等待时间，效果是进度条跑一圈就进入登录画面了，开始→运行→regedit启动注册表编辑器，找HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\PrefetchParameters， 有一个键EnablePrefetcher把它的数值改为“1”就可以了。另外不常更换硬件的朋友可以在系统属性中把总线设备上面的设备类型设置为none（无）。</p> 
<p>3、关闭系统属性中的特效，这可是简单有效的提速良方。点击开始→控制面板→系统→高级→性能→设置→在视觉效果中，设置为调整为最佳性能→确定即可。这样桌面就会和win2000很相似的，我还是挺喜欢XP的蓝色窗口，所以在“在窗口和按钮上使用视觉样式”打上勾，这样既能看到漂亮的蓝色界面，又可以加快速度。</p> 
<p>4、我用Windows commadner＋Winrar来管理文件，Win XP的ZIP支持对我而言连鸡肋也不如，因为不管我需不需要，开机系统就打开个zip支持，本来就闲少的系统资源又少了一分，点击开始→运行，敲入：“regsvr32 /u zipfldr.dll”双引号中间的，然后回车确认即可，成功的标志是出现个提示窗口，内容大致为：zipfldr.dll中的Dll UnrgisterServer成功。</p> 
<p>5、据说XP的一个系统服务Qos，这个调度要占用一定的网络带宽，像我这样的一毛不拔的人是无法忍受的，去掉方法是：开始菜单→运行→键入 gpedit.msc ，出现“组策略”窗口， 展开 &quot;管理模板”→“网络” ， 展开 &quot;QoS 数据包调度程序&quot;， 在右边窗右键单击“限制可保留带宽&quot; ，在属性中的“设置”中有“限制可保留带宽&quot; ，选择“已禁用”，确定即可。当上述修改完成并应用后，用户在网络连接的属性对话框内的一般属性标签栏中如果能够看到&quot;QoS Packet Scheduler（QoS 数据包调度程序）&quot;。说明修改成功，否则说明修改失败，顺便把网络属性中的那个Qos 协议也一起干掉（卸载）吧。</p> 
<p>6、快速浏览局域网络的共享 <br /> 通常情况下，Windows XP在连接其它计算机时，会全面检查对方机子上所有预定的任务，这个检查会让你等上30秒钟或更多时间。去掉的方法是开始→运行→Regedit→在注册表中找到HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\Current Version\Explorer\RemoteComputer\NameSpace。在此键值下，会有个{D6277990-4C6A-11CF-87-00AA0060F5BF}键，把它删掉后，重新启动计算机，Windows XP就不再检查预定任务了，hoho~~~ ，速度明显提高啦！</p> 
<p>7、关掉调试器Dr. Watson <br /> 我好像从win95年代开始一次也没用过这东西，可以这样取消：打开册表，找到HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AeDebug子键分支，双击在它下面的Auto键值名称，将其“数值数据”改为0，最后按F5刷新使设置生效，这样就取消它的运行了。沿用这个思路，我们可以把所有具备调试功能的选项取消，比如蓝屏时出现的memory.dmp，在“我的电脑→属性→高级→设置→写入调试信息→选择无”等等。</p> 
<p>8、被我终止的服务列表以及相关说明</p> 
<p>1)alerter 错误警报 <br /> 2)automatic updates windows 自动更新 <br /> 3)background intelligent transfer service 微软说使用空闲的网络带宽传数据 <br /> 4)clipbook 与远程电脑来共享剪贴板内容，我看还是免了吧 <br /> 5)Computer browser 说什么要维护网络更新列表 <br /> 6)DHCP client 我不需要这东西 <br /> 7)Distributed link tracking client 保持局域网连接更新等信息，偶很少用局域网，这东西占用４M左右内存。 <br /> 8)Distributed Transaction coordinator 协调***，和上面的差不多 <br /> 9)DNS Client 我不需要这东西 <br /> 10)Error reporting service 错误报告 <br /> 11)Event Log 系统日志纪录 <br /> 12)Fast user switching compatibility 用户切换 <br /> 13)help and support 帮助 <br /> 14)Human inte***ce device access 据说是智能设备。。。 <br /> 15)IMAPI CD-burning COM service 偶不用这个刻碟 <br /> 16)Indexing service 索引，索引什么呢？ <br /> 17)Internet Connection Firewall(ICF) ICF防火墙 <br /> 18)IPSEC Services 这个我不懂，你想知道问Quack去 <br /> 19)Logical Disk manager administrative service 配置磁盘 <br /> 20)messenger 好像net send 等东西用的就是这个功能 <br /> 21)MS software shadow copy provider 卷复制备份的 <br /> 22)Net Logon 我可不想让黑客远程登录进来，关！ <br /> 23)Netmeeting remote desktop sharing 我不用netmeeting <br /> 24)Network DDE 动态数据交换传输 <br /> 25)Network DDE DSDM 和上面差不多 <br /> 26)Network Location Awareness 关，我的机子不作共享 <br /> 27)NTLM Security support provider－telnet 呵呵，关！ <br /> 28)Performance logs and alert 将系统状态写日志或发警告 <br /> 29)Portable media serial number 关！ <br /> 30)Print Spooler 打印机，不幸的是我的机子不连接Print ~ <br /> 31) QoS RSVP 关！ <br /> 32)Remote desktop help session manager 远程帮助服务 <br /> 33)remote Procedure Call LOCATOR 管理RPC <br /> 34)remote registry 远程管理注册表 <br /> 35)removable storage <br /> 36)routing and remote access 我干脆禁用了它 <br /> 37)security accounts manager 我的系统只是一个客户系统，不用iis。 <br /> 38)smart card <br /> 39)smart card helper 关！！！ <br /> 40)SSDP Discovery service 我用不到这个 <br /> 41)system event notification 如果是服务器肯定要记录的 <br /> 42)system restore service 系统还原服务 <br /> 43)task scheduler windows 计划服务 <br /> 44)Telephony 拨号服务，我不拨号还不行吗？ <br /> 45)telnet <br /> 46)terminal services 终端服务 <br /> 47)uninterruptible power supply UPS，我没有呀 <br /> 48)universal plug and play device host 太先进了点，用不到 <br /> 49)upload manager 关了也能传输文件的 <br /> 50)volume shadow copy 又是备份，晕 <br /> 51)webclient 没用过 <br /> 52)Windows Installer ＭＳＩ服务，我一直关着。 <br /> 53)windows image acquisition (WIA) 数码设备用的 <br /> 54)windows management instrumentation driver extensions 关了 <br /> 55)windows time 时间服务 <br /> 56)wireless zero configuration 无线网络，偶用不到的 <br /> 57)WMI perfromance adapter 关！</p> 
<p>这里面的一些服务是刚开始就是关的，但我忘了，所以只好把现在系统中关闭的服务基本都列了出来。你根据自己的情况酌情处理吧。 <br /> ================================================================</p> 
<p>三、我安全吗</p> 
<p>多了不谈，基本的共享还是得关的：</p> 
<p>修改注册表为以下两个样式： <br /> 去除共享 <br /> —————————————————————— <br /> Windows Registry Editor Version 5.00 <br /> [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\lanmanserver\parameters] <br /> &quot;AutoShareServer&quot;=dword:00000000 <br /> &quot;AutoSharewks&quot;=dword:00000000 <br /> —————————————————————— <br /> 去除IPC$管理 <br /> —————————————————————— <br /> Windows Registry Editor Version 5.00</p> 
<p>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa] <br /> &quot;restrictanonymous&quot;=dword:00000001 <br /> —————————————————————— <br /> 或者将上面两个保存成个.REG文件，然后双击导入就可以了。</p> 
<p>顺便把不要脸的的3721也屏蔽，在hosts文件中加入：</p> 
<p>127.0.0.1 cnsmin.3721.com <br /> 127.0.0.1 <a href="http://www.3721.net/">http://www.3721.net/</a> ;</p> 
<p>四、其他技巧</p> 
<p>1、给鼠标右键增加个复制到.../移动到...功能 <br /> ————————————————————— <br /> Windows Registry Editor Version 5.00</p> 
<p>[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AllFilesystemObjects\shellex]</p> 
<p>[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AllFilesystemObjects\shellex\ContextMenuHandlers]</p> 
<p>[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AllFilesystemObjects\shellex\ContextMenuHandlers\Copy To] <br /> @=&quot;{C2FBB630-2971-11D1-A18C-00C04FD75D13}&quot;</p> 
<p>[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AllFilesystemObjects\shellex\ContextMenuHandlers\Move To] <br /> @=&quot;{C2FBB631-2971-11D1-A18C-00C04FD75D13}&quot; <br /> ———————————————————————— <br /> 将上面内容保存成add.reg文件，然后双击导入就可以了。</p> 
<p>2、关了错误报告，*** ！这东西搞得我像个微软免费的测试员似的：点击控制面板&gt;系统&gt;高级&gt;右下角-&gt;错误报告&gt;禁用错误汇报——&gt;确定！ <br /> 3、取消分组显示：右键单击任务栏的空白区域，在弹出的菜单中选择“属性”，在弹出的窗口中，取消“分组相似任务栏按钮”前面的对钩，确定就可以了。 <br /> 4、找回经典的登录窗口，WinXP默认的登录界面虽然漂亮，但如果你想用一个列表中没有的用户登录，你会发现无从下手，改回经典窗口的方法是：点击“开始”→“控制面板”→“用户账户”→“更改用户登录或注销的方式”→把“使用欢迎屏幕”前面的对钩取消，最后点“应用选项”就OK啦。 <br /> 5、将自己最常用的输入法设置一个快捷键：点击“开始”→“控制面板”→“区域和语言选项”→在弹出的窗口中选择“语言”→“详细信息”→“键设置”在弹出的窗口中找到自己用的输入法，点“更改按键顺序”→在这里选一个快捷键就可以了。 <br /> 6、关闭计算机时自动结束不响应的任务，注册表：HKEY_CURRENT_USER\Control Panel\Desktop 中的“AugoEndTasks”的键值改为“1” <br /> 7、关闭自动更新：右键单击“我的电脑”，点击属性，点击“自动更新”，在“通知设置”一栏选择“关闭自动更新。我将手动更新计算机”一项。 <br /> 8、减少开机磁盘扫描等待时间，开始→运行，键入“chkntfs/t:0”</p> 
<p>然后连接到ms站点顺便升级一次就算优化基本完成，对于XP而言，可以采用许多内部命令来看看优化情况，比如tasklist.exe /svc 可以查看系统服务实际使用情况。 <br /> 优化一个系统，挺麻烦的。所以我们把他保存起来，我们用Ghost生成.GHO文件，这样就可以拿给别人炫耀一下啦，在Ghost之前先要作一个事情，清除系统硬件、注册等信息，否则克隆到不同的机子上将无法启动，在Winxp安装盘上找Deploy.cab 中的sysprep.exe文件。 <br /> 执行sysprep.exe，选择“重新封装”，下面的标记中可以选择“已提前激活”，还可以选择封装完成后是关机还是重新启动。封装完成后，我们再用带有Ghost的系统盘启动，用Ghost来生成备份.GHO镜像，备份完成！ <br /> 在执行封装后，重新开机，XP会让我们输入序列号，文中开头所提到的换序列号的办法就是这样换。</p> 
<p> </p></div></body></html>