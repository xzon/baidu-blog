<html><head><title>Java解析XML文件</title></head><body><div id='tit'>Java解析XML文件</div><div id='cate'>复用代码</div><div id='date'>2008年03月26日 星期三 03:25 P.M.</div><div id='page'>150</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/c25d96520e43930a0df3e375.html'>http://hi.baidu.com/hxzon/blog/item/c25d96520e43930a0df3e375.html</a><div id='cnt'><p>Java解析XML文件</p> 
<p>package com.yc.ycportal.ge.util;</p> 
<p>import java.io.FileInputStream;<br /> import java.util.Enumeration;<br /> import java.util.List;<br /> import java.util.Properties;<br /> import java.util.ResourceBundle;</p> 
<p>import javax.xml.parsers.SAXParser;<br /> import javax.xml.parsers.SAXParserFactory;</p> 
<p>import org.jdom.Document;<br /> import org.jdom.Element;<br /> import org.jdom.input.SAXBuilder;<br /> import org.xml.sax.Attributes;<br /> import org.xml.sax.SAXException;<br /> import org.xml.sax.helpers.DefaultHandler;</p> 
<p>/**<br /> * @author <br /> * 本类的作用是对properties和xml文件的解析，重点在于包括xml文件的两种解析方式<br /> * 现在有三种用于Java的流行xml解析技术，文档对象模型(Document Object Model,DOM),基于W3C的<br /> * 成熟标准，2、用于XML的简单API(Simple API for XML)，第一个被广泛采用的用Java编写的XML API<br /> * 是一个事实上的标准，３、用于XML的数据流API(Straming API for XML,StAX),JSR-173中采用<br /> * 的一个新解析模型<br /> */<br /> public class ParseFile {<br /> <br /> public static ParseFile getInterface(){<br /> &nbsp;&nbsp;&nbsp; return new ParseFile();<br /> }<br /> <br /> /**解析Properties文件获取数据信息*/<br /> /**<br /> &nbsp;&nbsp;&nbsp; *properties的文件格式为<br /> &nbsp;&nbsp;&nbsp; *username=sa<br /> &nbsp;&nbsp;&nbsp; *userpass=123以第一等号为标准,后面为它的值 <br /> &nbsp;&nbsp;&nbsp; */<br /> public List getPropertes(String fileName){<br /> &nbsp;&nbsp;&nbsp; List list = null;<br /> &nbsp;&nbsp;&nbsp; ResourceBundle rb = ResourceBundle.getBundle(fileName);<br /> &nbsp;&nbsp;&nbsp; list.add(rb.getString(&quot;username&quot;));<br /> &nbsp;&nbsp;&nbsp; list.add(rb.getString(&quot;userpass&quot;));<br /> &nbsp;&nbsp;&nbsp; return list;<br /> }<br /> /**用SAX方式解析XML文件获取数据信息,创建一个解析XML文件的内部类解析器*/<br /> class ParseXML extends DefaultHandler{<br /> &nbsp;&nbsp;&nbsp; //所有的方法是子类重写父类的方法<br /> &nbsp;&nbsp;&nbsp; String currentName = null;<br /> &nbsp;&nbsp;&nbsp; StringBuffer currentValue = new StringBuffer();<br /> &nbsp;&nbsp;&nbsp; Properties properties = null;<br /> &nbsp;&nbsp;<br /> &nbsp;&nbsp;&nbsp; //接收元素开始的通知。 <br /> &nbsp;&nbsp;&nbsp; //默认情况下，不执行任何操作。应用程序编写者可以在子类中重写此方法，以便在每个元素的开始处采取特定的操作<br /> &nbsp;&nbsp;&nbsp; public void startElement(String uri,String localName,String qName,Attributes attributes)throws SAXException{<br /> &nbsp;&nbsp;&nbsp;&nbsp; this.currentValue.delete(0, this.currentValue.length());<br /> &nbsp;&nbsp;&nbsp;&nbsp; this.currentName = qName;<br /> &nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp; //接收元素中字符数据的通知<br /> &nbsp;&nbsp;&nbsp; //默认情况下，不执行任何操作。应用程序编写者可以重写此方法，以便对每块字符数据采取特定的措施<br /> &nbsp;&nbsp;&nbsp; //如将该数据添加到节点或缓冲区，或者将该数据打印到文件。<br /> &nbsp;&nbsp;&nbsp; public void characters(char[] ch,int start,int length)throws SAXException{<br /> &nbsp;&nbsp;&nbsp;&nbsp; this.currentValue.append(ch,start,length);<br /> &nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp; //接收元素结束的通知<br /> &nbsp;&nbsp;&nbsp; //默认情况下，不执行任何操作。应用程序编写者可以在子类中重写此方法，以便在每个元素的结束处采取特定的操作<br /> &nbsp;&nbsp;&nbsp; //如，结束树节点或将输出写入文件。<br /> &nbsp;&nbsp;&nbsp; public void endElement(String uri,String localName,String qName)throws SAXException{<br /> &nbsp;&nbsp;&nbsp;&nbsp; this.properties.put(qName.toLowerCase(), this.currentValue.toString().trim());<br /> &nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp; //返回存储XML信息数据的properties<br /> &nbsp;&nbsp;&nbsp; public Properties getProperties(){<br /> &nbsp;&nbsp;&nbsp;&nbsp; return this.properties;<br /> &nbsp;&nbsp;&nbsp; }<br /> }<br /> public List getSAXXml(String fileName)throws Exception{<br /> &nbsp;&nbsp;&nbsp; List list = null;<br /> &nbsp;&nbsp;&nbsp; ParseXML parsexml = new ParseXML();<br /> &nbsp;&nbsp;&nbsp; Properties properties = null;<br /> &nbsp;&nbsp;&nbsp; SAXParserFactory factory = SAXParserFactory.newInstance();<br /> &nbsp;&nbsp;&nbsp; //如果由此代码生成的解析器将提供对 XML 名称空间的支持，则为 true；否则为 false。<br /> &nbsp;&nbsp;&nbsp; factory.setNamespaceAware(false);<br /> &nbsp;&nbsp;&nbsp; //指定由此代码生成的解析器将验证被解析的文档。默认情况下，其值设置为 false<br /> &nbsp;&nbsp;&nbsp; factory.setValidating(false);<br /> &nbsp;&nbsp;&nbsp; SAXParser parser = factory.newSAXParser();<br /> &nbsp;&nbsp;&nbsp; //使用指定的DefaultHandler将指定文件的内容解析为 XML。<br /> &nbsp;&nbsp;&nbsp; parser.parse(fileName, parsexml);<br /> &nbsp;&nbsp;&nbsp; properties = parsexml.getProperties();<br /> &nbsp;&nbsp;&nbsp; Enumeration em = properties.keys();<br /> &nbsp;&nbsp;&nbsp; while(em.hasMoreElements()){<br /> &nbsp;&nbsp;&nbsp;&nbsp; list.add(properties.get(em.nextElement().toString()));<br /> &nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp; return list;<br /> }<br /> /**用Dom方式解析XML文件获取数据信息,比较容易理解和掌握的一种方式very good*/<br /> public List getDOMXml(String fileName)throws Exception{<br /> &nbsp;&nbsp;&nbsp; List list = null;<br /> &nbsp;&nbsp;&nbsp; SAXBuilder builder = new SAXBuilder();<br /> &nbsp;&nbsp;&nbsp; Document document = builder.build(new FileInputStream(fileName));<br /> &nbsp;&nbsp;&nbsp; //document.getRootElement()获取根节点返回一个Element<br /> &nbsp;&nbsp;&nbsp; List listchild = document.getRootElement().getChildren(&quot;table&quot;);<br /> &nbsp;&nbsp;&nbsp; for(int i=0;i&lt;listchild.size();i++){<br /> &nbsp;&nbsp;&nbsp;&nbsp; Element e = (Element)listchild.get(i);<br /> &nbsp;&nbsp;&nbsp;&nbsp; String tableName = e.getChild(&quot;tablename&quot;).getText();<br /> &nbsp;&nbsp;&nbsp;&nbsp; List nextchild = e.getChild(&quot;fields&quot;).getChildren(&quot;field&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp; list.add(tableName);<br /> &nbsp;&nbsp;&nbsp;&nbsp; for(int j=0;j&lt;nextchild.size();j++){<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Element child = (Element)nextchild.get(j);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; list.add(child.getAttributeValue(&quot;name&quot;));<br /> &nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp; //返回的List的结构是以表名为0个索引位置后面依次为表的字段名称,附带XML文件描述<br /> &nbsp;&nbsp;&nbsp; return list;<br /> }<br /> }</p> 
<p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;gb2312&quot; ?&gt;<br /> &lt;tables&gt;<br /> &lt;table&gt; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;tablename&gt;dic_rate_zhwd&lt;/tablename&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;fields&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;field name=&quot;organ_id&quot; type=&quot;string&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;field name=&quot;business_id&quot; type=&quot;string&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;field name=&quot;business_name&quot; type=&quot;string&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;field name=&quot;rate&quot; type=&quot;double&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;/fields&gt;<br /> &lt;/table&gt;<br /> &lt;/tables&gt;</p> 
<p><a href="http://hi.baidu.com/peng_jianming/blog/item/c70a56d73a925adfa144df83.html">http://hi.baidu.com/peng_jianming/blog/item/c70a56d73a925adfa144df83.html</a></p></div></body></html>