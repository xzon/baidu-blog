<html><head><title>BDom4j.java，Dom4j封装类-dom4j-Java源代码</title></head><body><div id='tit'>BDom4j.java，Dom4j封装类-dom4j-Java源代码</div><div id='cate'>存档&middot;垃圾</div><div id='date'>2008年04月04日 星期五 00:05 A.M.</div><div id='page'>144</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/033fd7438244271773f05dda.html'>http://hi.baidu.com/hxzon/blog/item/033fd7438244271773f05dda.html</a><div id='cnt'><div> 
 <p> </p> 
 <p><font size="3">BDom4j.java，Dom4j封装类-dom4j-Java源代码</font></p> 
 <p><font size="3">package org.tju.msnrl.butil;<br /> import java.io.*;<br /> import java.util.*;<br /> import org.dom4j.*;<br /> import org.dom4j.io.XMLWriter;<br /> import org.dom4j.io.SAXReader;<br /> /**<br /> * Dom4j封装类<br /> * &lt;p&gt;Title: 天津大学博士后流动站&lt;/p&gt;<br /> * &lt;p&gt;Description: 天津大学人事处制作维护&lt;/p&gt;<br /> * &lt;p&gt;Copyright: Copyright (c) 2005&lt;/p&gt;<br /> * &lt;p&gt;Company: 天津大学软件学院.NET实验室（MSNRL）&lt;/p&gt;<br /> * @author Jonathan Q. Bo<br /> * @version 1.0<br /> */<br /> public class BDom4j {<br /> /**XML文件路径*/<br /> private String XMLPath = null;<br /> /**XML文档*/<br /> private Document document = null;<br /> public BDom4j() {<br /> }<br /> /**<br /> * 初始化xml文件<br /> * @param XMLPath 文件路径<br /> */<br /> public BDom4j(String XMLPath){<br /> this.XMLPath = XMLPath;<br /> }<br /> /**<br /> * 打开文档<br /> */<br /> public void openXML(){<br /> try{<br /> &nbsp;&nbsp;&nbsp; SAXReader reader = new SAXReader();<br /> &nbsp;&nbsp;&nbsp; this.document = reader.read(this.XMLPath);<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;openXML() successful ...&quot;);<br /> }catch(Exception e){<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;openXML() Exception:&quot; + e.getMessage());<br /> }<br /> }/**<br /> * 创建文档<br /> * @param rootName 根节点名称<br /> */<br /> public void createXML(String rootName){<br /> try{<br /> &nbsp;&nbsp;&nbsp; this.document = DocumentHelper.createDocument();<br /> &nbsp;&nbsp;&nbsp; Element root = document.addElement(rootName);<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;createXML() successful...&quot;);<br /> }catch(Exception e){<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;createXML() Exception:&quot; + e.getMessage());<br /> }<br /> }<br /> /**<br /> * 添加根节点的child<br /> * @param nodeName 节点名<br /> * @param nodeValue 节点值<br /> */<br /> public void addNodeFromRoot(String nodeName, String nodeValue){<br /> Element root = this.document.getRootElement();<br /> Element level1 = root.addElement(nodeName);<br /> level1.addText(nodeValue);<br /> }<br /> /**<br /> * 打开文档<br /> * @param filePath 文档路径<br /> */<br /> public void openXML(String filePath){<br /> try{<br /> &nbsp;&nbsp;&nbsp; SAXReader saxReader = new SAXReader();<br /> &nbsp;&nbsp;&nbsp; this.document = saxReader.read(filePath);<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;openXML(String filePath) successful ...&quot;);<br /> }catch(Exception e){<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;openXML() Exception:&quot; + e.getMessage());<br /> }<br /> }<br /> /**<br /> * 保存文档<br /> */<br /> public void saveXML(){<br /> try{<br /> &nbsp;&nbsp;&nbsp; XMLWriter output = new XMLWriter(new FileWriter(new File(this.XMLPath)));<br /> &nbsp;&nbsp;&nbsp; output.write(document);<br /> &nbsp;&nbsp;&nbsp; output.close();<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;saveXML() successful ...&quot;);<br /> }catch(Exception e1){<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;saveXML() Exception:&quot; + e1.getMessage());<br /> }<br /> }<br /> /**<br /> * 保存文档<br /> * @param toFilePath 保存路径<br /> */<br /> public void saveXML(String toFilePath) {<br /> try {<br /> &nbsp;&nbsp;&nbsp; XMLWriter output = new XMLWriter(new FileWriter(new File(toFilePath)));<br /> &nbsp;&nbsp;&nbsp; output.write(document);<br /> &nbsp;&nbsp;&nbsp; output.close();<br /> }<br /> catch (Exception e1) {<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;saveXML() Exception:&quot; + e1.getMessage());<br /> }<br /> }/**<br /> * 获得某个节点的值<br /> * @param nodeName 节点名称<br /> */<br /> public String getElementValue(String nodeName){<br /> try {<br /> &nbsp;&nbsp;&nbsp; Node node = document.selectSingleNode(&quot;//&quot; + nodeName);<br /> &nbsp;&nbsp;&nbsp; return node.getText();<br /> }<br /> catch (Exception e1) {<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;getElementValue() Exception：&quot; + e1.getMessage());<br /> &nbsp;&nbsp;&nbsp; return null;<br /> }<br /> }<br /> /**<br /> * 获得某个节点的子节点的值<br /> * @param nodeName<br /> * @param childNodeName<br /> * @return<br /> */<br /> public String getElementValue(String nodeName, String childNodeName){<br /> try {<br /> &nbsp;&nbsp;&nbsp; Node node = this.document.selectSingleNode(&quot;//&quot; + nodeName + &quot;/&quot; + childNodeName);<br /> &nbsp;&nbsp;&nbsp; return node.getText();<br /> }<br /> catch (Exception e1) {<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;getElementValue() Exception：&quot; + e1.getMessage());<br /> &nbsp;&nbsp;&nbsp; return null;<br /> }<br /> }<br /> /**<br /> * 设置一个节点的text<br /> * @param nodeName 节点名<br /> * @param nodeValue 节点值<br /> */<br /> public void setElementValue(String nodeName, String nodeValue){<br /> try{<br /> &nbsp;&nbsp;&nbsp; Node node = this.document.selectSingleNode(&quot;//&quot; + nodeName);<br /> &nbsp;&nbsp;&nbsp; node.setText(nodeValue);<br /> }catch(Exception e1){<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;setElementValue() Exception:&quot; + e1.getMessage());<br /> }<br /> }<br /> /**<br /> * 设置一个节点值<br /> * @param nodeName 父节点名<br /> * @param childNodeName 节点名<br /> * @param nodeValue 节点值<br /> */<br /> public void setElementValue(String nodeName, String childNodeName,<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String nodeValue) {<br /> try {<br /> &nbsp;&nbsp;&nbsp; Node node = this.document.selectSingleNode(&quot;//&quot; + nodeName + &quot;/&quot; + childNodeName);<br /> &nbsp;&nbsp;&nbsp; node.setText(nodeValue);<br /> }<br /> catch (Exception e1) {<br /> &nbsp;&nbsp;&nbsp; System.out.println(&quot;setElementValue() Exception:&quot; + e1.getMessage());<br /> }<br /> }<br /> }</font></p> 
</div></div></body></html>