<html><head><title>局域网文件传输软件-Java源代码</title></head><body><div id='tit'>局域网文件传输软件-Java源代码</div><div id='cate'>存档&middot;垃圾</div><div id='date'>2008年03月27日 星期四 00:34 A.M.</div><div id='page'>150</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/1f802e349f09e13f5ab5f526.html'>http://hi.baidu.com/hxzon/blog/item/1f802e349f09e13f5ab5f526.html</a><div id='cnt'><p class="STYLE2"><strong>局域网文件传输软件-Java源代码</strong></p> 
<p class="STYLE3">流程图如下：</p> 
<p class="STYLE2"><img height="432" width="554" src="image/局域网文件传输软件-Java源代码.ht.liuchengtu.gif" /><p class="origImg">http://www.woaijava.cn/code/040404030/liuchengtu.gif</p></p> 
<p class="STYLE3">代码及注释如下：</p> 
<p class="STYLE2">import java.awt.*;<br /> import java.awt.event.*;<br /> import java.io.*; <br /> import java.net.*;<br /> public class lan extends WindowAdapter implements ActionListener<br /> {<br /> //定义元素<br /> public static Frame f;<br /> public static Button b1,b2,b3;<br /> public static Label l1,l2,l3,l4,l5,l16,l17,l18,l19,l20,l21,l22;<br /> public static Label[] l=new Label[5];<br /> public static Label[] ll=new Label[5];<br /> MenuBar menubar1;<br /> Menu menu1;<br /> Menu menu2;<br /> MenuItem item1,item2,item3,item4;<br /> public static TextArea tt1,tt2,tt3,tt4;<br /> public static TextField t1;<br /> public static String filename,filename2,filename1; //发送文件名字和地址和文件加地址<br /> public static int i=0;<br /> public static int j=0;<br /> Dialog d1,d2;<br /> public static String panduan1=&quot;3&quot;;<br /> public static int panduan2=3;<br /> public static int kongzhi=0;</p> 
<p class="STYLE2">//界面 <br /> public void lan()<br /> { <br /> f=new Frame(&quot;JAVA局域网文件传输器&quot;);<br /> f.setSize(450,610);<br /> f.setLayout(new GridBagLayout()); //网格包布局<br /> f.setResizable(false);<br /> d2= new Dialog(f,&quot;关于作者&quot;,true);<br /> d2.addWindowListener(this); <br /> d1= new Dialog(f,&quot;使用说明&quot;,true); <br /> d1.addWindowListener(this);<br /> //构造菜单 <br /> menubar1=new MenuBar();<br /> menu1=new Menu(&quot;文件&quot;);<br /> menu2=new Menu(&quot;帮助&quot;);<br /> item1=new MenuItem(&quot;打开&quot;);<br /> item2=new MenuItem(&quot;退出&quot;);<br /> item3=new MenuItem(&quot;使用说明&quot;);<br /> item4=new MenuItem(&quot;关于作者&quot;);<br /> f.setMenuBar(menubar1);<br /> menubar1.add(menu1);<br /> menu1.add(item1);<br /> menu1.add(item2);<br /> menubar1.add(menu2);<br /> menu2.add(item3);<br /> menu2.add(item4);<br /> //构造其他元素 <br /> l1=new Label(&quot;发送文件列表:&quot;);<br /> l2=new Label(&quot;接收文件列表:&quot;);<br /> l3=new Label(&quot;*****************************************************&quot;);<br /> l5=new Label(&quot;接收文件状态:&quot;);<br /> l4=new Label(&quot;发送文件状态:&quot;);<br /> l[0]=new Label(&quot;file1&quot;);<br /> l[1]=new Label(&quot;file2&quot;);<br /> l[2]=new Label(&quot;file3&quot;);<br /> l[3]=new Label(&quot;file4&quot;);<br /> l[4]=new Label(&quot;file5&quot;);<br /> ll[0]=new Label(&quot;file1&quot;);<br /> ll[1]=new Label(&quot;file2&quot;);<br /> ll[2]=new Label(&quot;file3&quot;);<br /> ll[3]=new Label(&quot;file4&quot;);<br /> ll[4]=new Label(&quot;file5&quot;);<br /> l16=new Label(&quot;目的地&quot;);<br /> l17=new Label(&quot;文件位置&quot;);<br /> l18=new Label(&quot;文件名&quot;);<br /> l19=new Label(&quot;来源地&quot;);<br /> l20=new Label(&quot;存放位置&quot;);<br /> l21=new Label(&quot;文件名&quot;);<br /> l22=new Label(&quot;请输入目的地IP地址（192.168.*.*）：&quot;);<br /> tt1=new TextArea(5,20);<br /> tt1.setEditable(false);<br /> tt2=new TextArea(5,20);<br /> tt2.setEditable(false);<br /> tt3=new TextArea(5,10);<br /> tt3.setEditable(false);<br /> tt4=new TextArea(5,10);<br /> tt4.setEditable(false);<br /> t1=new TextField(13);<br /> b1=new Button(&quot;开始发送&quot;);<br /> b2=new Button(&quot;同意接收&quot;);<br /> b3=new Button(&quot; 拒绝接收 &quot;);<br /> //定义网格包布局的约束条件<br /> GridBagConstraints c=new GridBagConstraints();<br /> c.fill=GridBagConstraints.BOTH; //组件在水平位置和垂直位置两个方向都有扩展<br /> c.insets=new Insets(5,5,5,5); //每个边上都有5个像素的边距<br /> //给各个元素分配位置<br /> c.gridx=0;c.gridy=0;c.gridwidth=1;c.gridheight=1;<br /> f.add(l1,c);<br /> c.gridx=3;c.gridy=0;c.gridwidth=1;c.gridheight=1;<br /> f.add(l4,c);<br /> c.gridx=0;c.gridy=1;c.gridwidth=1;c.gridheight=1;<br /> f.add(l16,c);<br /> c.gridx=1;c.gridy=1;c.gridwidth=1;c.gridheight=1;<br /> f.add(l17,c);<br /> c.gridx=2;c.gridy=1;c.gridwidth=1;c.gridheight=1;<br /> f.add(l18,c);<br /> c.gridx=1;c.gridy=2;c.gridwidth=2;c.gridheight=5;<br /> f.add(tt1,c);<br /> c.gridx=0;c.gridy=2;c.gridwidth=1;c.gridheight=5;<br /> f.add(tt3,c);<br /> c.gridx=3;c.gridy=2;c.gridwidth=1;c.gridheight=1;<br /> f.add(l[0],c);<br /> c.gridx=3;c.gridy=3;c.gridwidth=1;c.gridheight=1;<br /> f.add(l[1],c);<br /> c.gridx=3;c.gridy=4;c.gridwidth=1;c.gridheight=1;<br /> f.add(l[2],c);<br /> c.gridx=3;c.gridy=5;c.gridwidth=1;c.gridheight=1;<br /> f.add(l[3],c);<br /> c.gridx=3;c.gridy=6;c.gridwidth=1;c.gridheight=1;<br /> f.add(l[4],c);<br /> c.gridx=0;c.gridy=7;c.gridwidth=1;c.gridheight=1;<br /> f.add(l2,c);<br /> c.gridx=3;c.gridy=7;c.gridwidth=1;c.gridheight=1;<br /> f.add(l5,c);<br /> c.gridx=0;c.gridy=8;c.gridwidth=1;c.gridheight=1;<br /> f.add(l19,c);<br /> c.gridx=1;c.gridy=8;c.gridwidth=1;c.gridheight=1;<br /> f.add(l20,c);<br /> c.gridx=2;c.gridy=8;c.gridwidth=1;c.gridheight=1;<br /> f.add(l21,c);<br /> c.gridx=1;c.gridy=9;c.gridwidth=2;c.gridheight=5;<br /> f.add(tt2,c);<br /> c.gridx=0;c.gridy=9;c.gridwidth=1;c.gridheight=5;<br /> f.add(tt4,c);<br /> c.gridx=3;c.gridy=9;c.gridwidth=1;c.gridheight=1;<br /> f.add(ll[0],c);<br /> c.gridx=3;c.gridy=10;c.gridwidth=1;c.gridheight=1;<br /> f.add(ll[1],c);<br /> c.gridx=3;c.gridy=11;c.gridwidth=1;c.gridheight=1;<br /> f.add(ll[2],c);<br /> c.gridx=3;c.gridy=12;c.gridwidth=1;c.gridheight=1;<br /> f.add(ll[3],c);<br /> c.gridx=3;c.gridy=13;c.gridwidth=1;c.gridheight=1;<br /> f.add(ll[4],c);<br /> c.gridx=0;c.gridy=14;c.gridwidth=4;c.gridheight=1;<br /> f.add(l3,c);<br /> c.gridx=0;c.gridy=15;c.gridwidth=2;c.gridheight=1;<br /> f.add(l22,c);<br /> c.gridx=3;c.gridy=15;c.gridwidth=1;c.gridheight=1;<br /> f.add(t1,c);<br /> c.gridx=0;c.gridy=16;c.gridwidth=1;c.gridheight=1;<br /> f.add(b1,c);<br /> c.gridx=1;c.gridy=16;c.gridwidth=1;c.gridheight=1;<br /> f.add(b2,c);<br /> c.gridx=2;c.gridy=16;c.gridwidth=1;c.gridheight=1;<br /> f.add(b3,c);<br /> //实现各元素功能<br /> //菜单功能实现,注册事件<br /> f.addWindowListener(this);<br /> item1.addActionListener(this); <br /> item2.addActionListener(this); <br /> item3.addActionListener(this); <br /> item4.addActionListener(this);<br /> b1.addActionListener(this);<br /> b2.addActionListener(this);<br /> b3.addActionListener(this);<br /> f.setVisible(true);<br /> } <br /> public void actionPerformed(ActionEvent e)<br /> {<br /> <br /> if(e.getSource()==item1) <br /> { FileDialog f1=new FileDialog(f,&quot;打开&quot;,FileDialog.LOAD); <br /> f1.show();filename1=f1.getFile();filename2=f1.getDirectory();<br /> if(filename1!=null) <br /> {filename=f1.getDirectory()+f1.getFile(); <br /> tt1.append(filename+&quot;\n&quot;+&quot;\n&quot;+&quot;\n&quot;);<br /> l[i].setText(&quot;准备发送&quot;);<br /> }<br /> }<br /> else if(e.getSource()==item2)<br /> {System.exit(0);} <br /> else if(e.getSource()==item3)<br /> {<br /> TextArea ttt1= new TextArea(&quot;局域网文件传输软件，一用就知道，地球人都知道&quot;);<br /> ttt1.setEditable(false);<br /> d1.add(ttt1); <br /> d1.setSize(300,200);<br /> d1.setVisible(true);<br /> } <br /> else if(e.getSource()==item4)<br /> {<br /> TextArea ttt2= new TextArea(&quot;作者：我爱java网站长&quot;+&quot;\n&quot; +&quot;IMAIL：maliweigege@126.com&quot;);<br /> ttt2.setEditable(false); <br /> d2.add(ttt2); <br /> d2.setSize(300,200); <br /> d2.setVisible(true);<br /> }<br /> else if(e.getSource()==b1)<br /> {<br /> tt3.append(t1.getText()+&quot;\n&quot;+&quot;\n&quot;+&quot;\n&quot;);<br /> l[i].setText(&quot;可以发送&quot;);<br /> kongzhi=1; <br /> }<br /> else if(e.getSource()==b2)<br /> {<br /> panduan2=1;<br /> }<br /> else if(e.getSource()==b3)<br /> {<br /> panduan2=0;<br /> }<br /> }<br /> public void windowClosing(WindowEvent e)<br /> { <br /> if (e.getSource()==f)<br /> {System.exit(0);} <br /> else if (e.getSource()==d1)<br /> {<br /> d1.setVisible(false);<br /> d1.dispose();<br /> }<br /> else if (e.getSource()==d2)<br /> {<br /> d2.setVisible(false);<br /> d2.dispose();<br /> }<br /> }<br /> public static void main(String args[])<br /> {<br /> lan kaishi=new lan();<br /> kaishi.lan();<br /> jieshou j=new jieshou();<br /> j.start();<br /> fasong f=new fasong();<br /> f.start();<br /> <br /> }<br /> }</p> 
<p class="STYLE2">//接收过程<br /> class jieshou extends Thread<br /> { public InetAddress dizhi;<br /> public static String filename3; <br /> public void run(){<br /> <br /> try{<br /> ServerSocket jieshousocket=new ServerSocket(6000);<br /> <br /> while(true)<br /> { <br /> Socket connection1=jieshousocket.accept();<br /> dizhi=connection1.getInetAddress();<br /> InputStream netIn3=connection1.getInputStream();<br /> BufferedInputStream in3=new BufferedInputStream(netIn3); <br /> //创建缓冲区缓冲网络数据<br /> byte[] buf3=new byte[2048];<br /> int num3=in3.read(buf3); <br /> while(num3!=(-1)) //是否读完所有数据<br /> { <br /> num3=in3.read(buf3); //继续从网络中读取文件<br /> }<br /> filename3= new String(buf3);<br /> in3.close();<br /> netIn3.close();<br /> lan.tt2.append(&quot;当前目录:&quot;+filename3 );<br /> lan.tt2.append(&quot;\n&quot;+&quot;\n&quot;+&quot;\n&quot;);<br /> lan.tt4.append(connection1.getInetAddress()+&quot;\n&quot;+&quot;\n&quot;+&quot;\n&quot;);<br /> lan.ll[lan.j].setText(&quot;准备接收&quot;);<br /> connection1.close();<br /> <br /> while(lan.panduan2==3)<br /> {<br /> }<br /> if (lan.panduan2==0)<br /> {<br /> lan.ll[lan.j++].setText(&quot;拒绝接收&quot;);<br /> Socket fapanduan=new Socket(dizhi,6001);<br /> OutputStream netOut4=fapanduan.getOutputStream();<br /> OutputStream doc4=new DataOutputStream(new BufferedOutputStream(netOut4));<br /> //创建文件读取缓冲区<br /> byte[] buf4=new byte[1];<br /> String bian0=Integer.toString(lan.panduan2);<br /> buf4 = bian0.getBytes();<br /> int num4=buf4.length;<br /> doc4.write(buf4,0,num4); //把文件数据写出网络缓冲区<br /> doc4.flush(); //刷新缓冲区把数据写往客户端<br /> doc4.close();<br /> netOut4.close();<br /> fapanduan.close();<br /> lan.panduan2=3;<br /> }<br /> else if (lan.panduan2==1)<br /> { <br /> lan.ll[lan.j].setText(&quot;正在接收&quot;);<br /> Socket fapanduan=new Socket(dizhi,6001);<br /> //创建返回判断给客户端的输出流<br /> OutputStream netOut6=fapanduan.getOutputStream();<br /> BufferedOutputStream doc6=new BufferedOutputStream(netOut6);<br /> //创建文件读取缓冲区<br /> byte[] buf6=new byte[2048];<br /> String bian1=Integer.toString(lan.panduan2);<br /> buf6 = bian1.getBytes();<br /> int num6=buf6.length;<br /> if(num6&gt; 0)<br /> { //是否读完文件<br /> doc6.write(buf6,0,num6); //把文件数据写出网络缓冲区<br /> doc6.flush(); //刷新缓冲区把数据写往客户端<br /> }<br /> doc6.close();<br /> netOut6.close();<br /> File file=new File(filename3);<br /> file.createNewFile();<br /> FileOutputStream out=new FileOutputStream(file);<br /> ServerSocket jieshou3=new ServerSocket(6002);<br /> <br /> Socket jieshou4=jieshou3.accept(); <br /> //创建网络接受流接受对方的文件数据 <br /> InputStream netIn5=jieshou4.getInputStream();<br /> BufferedInputStream in5=new BufferedInputStream(netIn5); <br /> //创建缓冲区<br /> byte[] buf5=new byte[40960];<br /> int num5=in5.read(buf5); <br /> while(num5!=(-1))<br /> { //是否读完所有数据<br /> out.write(buf5,0,num5); //将数据写往文件<br /> //顺序写文件字节<br /> num5=in5.read(buf5); //继续从网络中读取文件<br /> }<br /> <br /> in5.close();<br /> out.close();<br /> netIn5.close(); <br /> jieshou3.close();<br /> jieshou4.close();<br /> lan.ll[lan.j++].setText(&quot;接受完毕&quot;);<br /> lan.panduan2=3;<br /> <br /> }<br /> }<br /> }<br /> catch(Exception e)<br /> {<br /> System.out.println(&quot;接受过程出错&quot;);<br /> }<br /> } <br /> }<br /> <br /> //发送过程<br /> class fasong extends Thread<br /> {<br /> public void run(){<br /> try{<br /> while(true) {<br /> while(lan.kongzhi!=1)<br /> {<br /> }<br /> Socket fasongsocket=new Socket(InetAddress.getByName(lan.t1.getText()),6000);<br /> //创建网络输出流并提供数据包装器<br /> OutputStream netOut=fasongsocket.getOutputStream();<br /> OutputStream doc=new DataOutputStream(new BufferedOutputStream(netOut));<br /> <br /> //创建文件读取缓冲区<br /> byte[] buf=new byte[2048];<br /> buf = lan.filename1.getBytes();<br /> doc.write(buf,0,buf.length); //把文件数据写出网络缓冲区<br /> doc.flush(); //刷新缓冲区把数据写往客户端<br /> doc.close();<br /> netOut.close();<br /> //接收对方回应，判断对方是否同意接收<br /> <br /> ServerSocket jiepanduan=new ServerSocket(6001);<br /> while (lan.panduan1==&quot;3&quot;)<br /> { <br /> Socket jiepanduan2=jiepanduan.accept();<br /> InputStream netIn=jiepanduan2.getInputStream();<br /> BufferedInputStream in1=new BufferedInputStream(netIn); <br /> //创建缓冲区缓冲网络数据<br /> byte[] buf1=new byte[1];<br /> int num1=in1.read(buf1);<br /> lan.panduan1=new String(buf1);<br /> netIn.close();<br /> in1.close();<br /> jiepanduan2.close();<br /> jiepanduan.close();<br /> }<br /> //判断是否该发送</p> 
<p class="STYLE2">while (lan.panduan1.equals(&quot;0&quot;))<br /> <br /> {<br /> lan.l[lan.i++].setText(&quot;对方拒绝&quot;);<br /> fasongsocket.close();<br /> lan.panduan1=&quot;3&quot;;<br /> lan.kongzhi=0;}<br /> while (lan.panduan1.equals(&quot;1&quot;))<br /> {<br /> lan.l[lan.i].setText(&quot;正在发送&quot;);<br /> Socket fasong4=new Socket(InetAddress.getByName(lan.t1.getText()),6002);<br /> File wenjian=new File(lan.filename2,lan.filename1);<br /> FileInputStream fachu=new FileInputStream(wenjian);<br /> OutputStream netOut1 =fasong4.getOutputStream();<br /> BufferedOutputStream doc1=new BufferedOutputStream(netOut1);<br /> //创建文件读取缓冲区<br /> byte[] buf2=new byte[40960];<br /> int num2=fachu.read(buf2);<br /> while(num2!=(-1)){ //是否读完文件<br /> doc1.write(buf2,0,num2); //把文件数据写出网络缓冲区<br /> doc1.flush(); //刷新缓冲区把数据写往客户端<br /> num2=fachu.read(buf2); //继续从文件中读取数据<br /> }<br /> fachu.close();<br /> doc1.close();<br /> netOut.close();<br /> fasong4.close();<br /> lan.l[lan.i++].setText(&quot;发送完成&quot;);<br /> lan.panduan1=&quot;3&quot;;<br /> lan.kongzhi=0;<br /> <br /> }<br /> <br /> }<br /> }<br /> catch(Exception e)<br /> {<br /> System.out.println(&quot;发送过程出错&quot;);<br /> }</p> 
<p class="STYLE2">}<br /> }</p> 
<p class="STYLE3">运行结果图如下：</p> 
<p><img height="611" width="448" src="image/局域网文件传输软件-Java源代码.ht.xiaoguotu.gif" /><p class="origImg">http://www.woaijava.cn/code/040404030/xiaoguotu.gif</p></p> 
<p> </p> 
<p align="right"><em>作者：我爱java站长</em></p></div></body></html>