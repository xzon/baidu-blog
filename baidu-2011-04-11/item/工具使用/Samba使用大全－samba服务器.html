<html><head><title>Samba使用大全－samba服务器</title></head><body><div id='tit'>Samba使用大全－samba服务器</div><div id='cate'>工具使用</div><div id='date'>2009年07月08日 星期三 05:56 P.M.</div><div id='page'>42</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/c48e44a704778d9cd143589c.html'>http://hi.baidu.com/hxzon/blog/item/c48e44a704778d9cd143589c.html</a><div id='cnt'><p>Samba使用大全－samba服务器</p> 
<p>Samba使用大全（一）－samba服务器</p> 
<p>http://LinuxAid.com.cn 01-11-08 22:42 1261p grind<br /> --------------------------------------------------------------------------------</p> 
<p>Samba使用大全（一）－samba服务器<br /> Samba协议基础<br /> 在NetBIOS出现之后，Microsoft就使用NetBIOS实现了一个网络文件/打印服务系统，这个系统基于NetBIOS设定了一套文件共享协议，Microsoft称之为SMB（Server Message Block）协议。这个协议被Microsoft用于它们Lan Manager和Windows NT服务器系统中，实现不同计算机之间共享打印机、串行口和通讯抽象（如命名管道、<a class="channel_keylink" target="_blank" href="http://hack.77169.com/Index.html">邮件</a>插槽等）。<br /> 随着Internet的流行，Microsoft希望将这个协议扩展到Internet上去，成为Inter net上计算机之间相互共享数据的一种标准。因此它将原有的几乎没有多少技术文档的SMB协议进行整理，重新命名为 CIFS（Common Internet File System），并打算将它与NetBIOS相脱离，试图使它成为Internet上的一个标准协议。<br /> 因此，为了让Windows和Unix计算机相集成，最好的办法即是在Unix计算机中安装支持SMB/CIFS协议的软件，这样Windows客户就不需要更改设置，就能如同使用Windows NT服务器一样，使用Unix计算机上的资源了。Samba是用来实现SMB的一种软件，它的工作原理是，让NETBIOS（Windows95网络邻居的通讯协议）和SMB（Server Message Block）这两个协议运行于TCP/IP通信协议之上，并且使用Windows的NETBEUI协议让Unix计算机可以在网络邻居上被Windows计算机看到。它的功能有：<br /> 1.共享Linux磁盘给Win95/NT<br /> 2.共享Win95/NT磁盘给Linux机器<br /> 3.共享Linux打印机给win95/NT<br /> 4.共享win95/NT打印机给Linux机器。<br /> 同时它的文件服务功能比NT系统还高，而且在Windows2000之前就提供了用户磁盘<a class="channel_keylink" target="_blank" href="http://idc.77169.com/">空间</a>限制的功能。<br /> Samba的配置<br /> 在我写这篇文章的时候，Samba的版本已经到了2.2.2了，需要的可以通过ftp://samba.org/pub/samba/Binary_Packages/<a class="channel_keylink" target="_blank" href="http://www.77169.com/LOGO/UploadAdPic/200712/linux/index.html">redhat</a>/RPMS/7.1/samba-2.2.2-20011013.i386.rpm得到最新的rpm安装包。然后执行rpm –Uvh samba-2.2.2-20011013.i386.rpm来安装或者升级它。安装完后，可以看见/etc/samba这么一个目录，里面存放和Samba相关的一些文件，最主要的是smb.conf，现在根据配置文件讲讲它的配置选项：<br /> 全局设置: <br /> workgroup = MYGROUP<br /> 定义该Samba服务器所在的工作组或者域（如果下面的security=domain的话）。<br /> server string = MY Samba Server<br /> 设定机器的描述，当我们通过网络邻居访问的时候可以在备注里面看见这个内容，而且还可以使用samba设定的变量。这里说一下samba定义的变量：<br /> %S = 当前服务名（如果有的话）<br /> %P = 当前服务的根目录（如果有的话）<br /> %u = 当前服务的用户名（如果有的话）<br /> %g = 当前用户说在的主工作组<br /> %U = 当前对话的用户名<br /> %G = 当前对话的用户的主工作组<br /> %H = 当前服务的用户的Home目录<br /> %v = Samba服务的版本号。<br /> %h = 运行Samba服务机器的主机名<br /> %m = 客户机的NETBIOS名称<br /> %L = 服务器的NETBIOS名称<br /> %M = 客户机的主机名<br /> %N = NIS服务器名<br /> %p = NIS服务的Home目录<br /> %R = 说采用的协议等级(值可以是CORE, COREPLUS, LANMAN1, LANMAN2，NT1)<br /> %d = 当前服务进程的ID<br /> %a = 客户机的结构（只能识别几项：Samba，WfWg，WinNT，Win95）<br /> %I = 客户机的IP<br /> %T = 当前日期和时间<br /> hosts allow = 网络或者主机<br /> 这里可以设置允许访问的网络和主机IP，比如允许192.168.1.0/24和192.168.2.1/32访问，就用host allow = 192.168.1. 192.168.2.1 127.0.0.1(网络注意后面加”.”号，各个项目间用空格隔开，记得把本机也加进去)<br /> printcap name = printcapFile<br /> 到printcapFile（一般是/etc/printcap）这个文件中取得打印机的描述信息<br /> load printers = yes|no<br /> 设定是否自动共享打印机而不用设置下面的[printer]一节的相关东西<br /> printing = PrintSystemType<br /> 定义打印系统的类型，缺省是lprng,可选项有：bsd, sysv, plp, lprng, aix, hpux, qnx。<br /> guest account = pcguest<br /> 定义游客帐号，而且需要把这个帐号加入/etc/passwd，不然它就用缺省的nobody<br /> log file = LogFileName<br /> 定义记录文件的位置LogFileName（一般是用/var/log/samba/%m.log）<br /> max log size = size<br /> 定义记录文件的大小size（单位是KB，如果是0的话就不限大小）<br /> security = security_level<br /> 定义Samba的安全级别，按从低到高分为四级：share，user，server，domain。它们对应的验证方式如下：<br /> share:没有安全性的级别，任何用户都可以不要用户名和口令访问服务器上的资源。<br /> user:samba的默认配置，要求用户在访问共享资源之前资源必须先提供用户名和密码进行验证。<br /> server:和user安全级别类似，但用户名和密码是递交到另外一个服务器去验证，比如递交给一台NT服务器。如果递交失败，就退到user安全级。<br /> domain:这个安全级别要求网络上存在一台Windows的主域控制器，samba把用户名和密码递交给它去验证。<br /> 后面三种安全级都要求用户在本Linux机器上也要系统帐户。否则是不能访问的。<br /> password server = &lt;NT-Server-Name&gt;<br /> 当前面的security设定为server或者domain的时候才有必要设定它。<br /> password level = n<br /> 这是设定针对一些SMB客户像OS/2之类而设的，这样的系统在发送用户密码的时候，会把密码转换成大写再发送，这样就和samba的密码不一致，这个参数可以设定密码里允许的大写字母个数，这样samba就根据这个数目对接收到的密码进行大小写重组，以重组过的密码尝试验证密码的正确性。n越大，组合的次数就越多，验证时间就越长，安全性也会因此变得越低。例如n=2，用户的密码是abcd，但发送出去其实是ABCD，samba就会把这个ABCD进行大小写重组，组合后的结果可以是: Abcd, aBcd, abCd, abcD, abcd, ABcd, AbCd, AbcD,aBCd,aBcD,abCD。<br /> 所以如果没有必要，就把n定为是零。这样的话samba只尝试两次，一个是接收到的密码，另一个尝试的是这个密码都是小写的情况。<br /> username level = n<br /> 这个是对于用户名的情况，说明和上面一项类似。<br /> encrypt passwords = yes|no<br /> 设置是否对密码进行<a class="channel_keylink" target="_blank" href="http://hack.77169.com/List/List_46.html">加密</a>，samba本身有一个密码文件/etc/samba/smbpasswd，如果不对密码进行<a class="channel_keylink" target="_blank" href="http://hack.77169.com/List/List_46.html">加密</a>则在验证会话期间客户机和服务器之间传递的是明文密码，samba直接把这个密码和Linux里的/etc/samba/smbpasswd密码文件进行验证。但是在Windows 95 OS/R2以后的版本和Windows NT SP3以后的版本缺省都不传送明文密码，要让这些系统能传送明文密码必须在其注册表里更改，比较麻烦，好的方法就是把这里的这个开关设置为yes。<br /> smb passwd file = smbPasswordFile<br /> 设置存放samba用户密码的文件smbPasswordFile(一般是/etc/samba/smbpasswd)。<br /> ssl CA certFile = sslFile<br /> 当samba编译的时候支持SSL的时候，需要指定SSL的证书的位置（一般在/usr/share/ssl/certs/ca-bundle.crt）。<br /> unix password sync = yes|no<br /> passwd program = /usr/bin/passwd %u<br /> passwd chat = *New*UNIX*password* %n<br /> *ReType*new*UNIX*password* %n<br /> *passwd:*all*authentication*tokens*updated*successfully*<br /> 这三项设置能否从windows的应用程序修改unix系统的用户密码<br /> username map = UsermapFile<br /> 指定用户映射文件（一般是/etc/samba/smbusers），当我们在这个文件里面指定一行root = administrator admin的时候，客户机的用户是admin或者administrator连接时会被当作用户root看待。<br /> include = MachineConfFile<br /> 指定对不同机器的连接采用不同的配置文件MachineConfFile（一般为了灵活管理使用/etc/samba/smb.conf.%m，由于采用了samba的变量，把配置文件和客户机的NETBIOS名称关联起来，能很容易地控制这些客户机的权限和设置）。<br /> socket options = TCP_NODELAY SO_RCVBUF=8192 SO_SNDBUF=8192<br /> 这个是网络socket方面的一些参数，能实现最好的文件传输性能。相关的选项还有SO_KEEPALIVE、 SO_REUSEADDR、SO_BROADCAST、IPTOS_LOWDELAY、IPTOS_THROUGHPUT、SO_SNDLOWAT（*）、SO_RCVLOWAT（*），带*号的要指定数值。一般如果在本地网络，就只用IPTOS_LOWDELAY,如果是有一个本地网络的，就用IPTOS_LOWDELAY TCP_NODELAY，如果是广域网络，就试试IPTOS_THROUGHPUT。<br /> interfaces = interface1 interface2<br /> 如果有多个网络接口，就必须在这里指定。如interface = 192.168.12.2/24 192.168.13.2/24<br /> remote browse sync = host(subnet)<br /> 这里指定浏览列表同步信息从哪里取得， 如果用host（比如192.168.3.25）或者整个子网（192.168.5.255）。<br /> ★这里说明一下什么是浏览（Browse）：<br /> 在SMB协议中，计算机为了访问网络资源，就需要了解网络上存在的资源列表（例如在Windows下使用网络邻居查看可以访问的计算机），这个机制就被称为浏览（Browse）。虽然SMB协议中经常使用广播的方式，但如果每次都使用广播的方式了解当前的网络资源（包括提供服务的计算机和各个计算机上的服务资源），就需要消耗大量的网络资源和浪费较长的查找时间，因此最好在网络中维护一个网络资源的列表，以方便查找网络资源。只有必要的时候，才重新查找资源，例如使用Windows下的查找计算机功能。<br /> 但没有必要每个计算机都维护整个资源列表，维护网络中当前资源列表的任务由网络上的几个特殊计算机完成的，这些计算机被称为Browser，这些Browser通过记录广播数据或查询名字服务器来记录网络上的各种资源。<br /> Browser并不是事先指定的计算机，而是在普通计算机之间通过自动进行的推举产生的。不同的计算机可以按照其提供服务的能力，设置在推举时具备的不同权重。为了保证一个Browser停机时网络浏览仍然正常，网络中常常存在多个Browser，一个为主Browser（Master Browser），其他的为备份Browser。★<br /> remote announce = host(subnet)<br /> 指定这些机器向网络宣告自己，而不是有Browser得到。<br /> local master = yes|no<br /> 这个参数指定nmbd是否试图成为本地主浏览器，默认值是yes，如果设为no则samba服务器就永远都不会成为本地主浏览器。但即使设置了yes，也不等于samba服务器就会成为本地主浏览器。只是参与本地主浏览器选择。<br /> os level = n<br /> n的值是个整数，决定了nmbd是否有机会成为本地广播区域的工作组里的本地主浏览器，默认值是零，零则意味着nmbd失去浏览选择。如果要nmbd更有机会成为本地主浏览器的话，可以设为65。<br /> domain master = yes|no<br /> 这个参数让nmbd成为一个域浏览器，取得各本地主浏览器的浏览列表，并将整个域的浏览列表递交给各本地主浏览器。<br /> preferred master = yes|no<br /> 这个参数指定nmbd是否是工作组里的首要的主浏览器，如果指定为yes，nmbd在启动的时候就强制一个浏览选择。<br /> ★Domain master和local master<br /> 工作组和域这两个概念在进行浏览时具备同样的用处，都是用于区分并维护同一组浏览数据的多个计算机。事实上他们的不同在于认证方式上，工作组中每台计算机都基本上是独立的，独立对客户访问进行认证，而域中将存在一个（或几个）域控制器，保存对整个域中都有效的认证信息，包括用户的认证信息以及域内成员计算机的认证信息。浏览数据的时候，并不需要认证信息，Microsoft将工作组扩展为域，只是为了形成一种分级的目录结构，将原有的浏览和目录服务相结合，以扩大Mircrosoft网络服务范围的一种策略。<br /> 工作组和域都可以跨越多个子网，因此网络中就存在两种Browser，一种为Domain Master Browser ，用于维护整个工作组或域内的浏览数据，另一种为Local Master Browser，用于维护本子网内的浏览数据，它和Domain Master Browser通信以获得所有的可浏览数据。划分这两种Browser 主要是由于浏览数据依赖于本地网广播来获得资源列表，不同子网之间只能通过浏览器之间的交流能力，才能互相交换资源列表。<br /> 但是，为了浏览多个子网的资源，必须使用NBNS名字服务器的解析方式，没有NBNS的帮助，计算机将不能获得子网外计算机的NetBIOS名字。Local Master Browser也需要查询NetBIOS名字服务器以获得Domain Master Browser的名字，以相互交换网络资源信息。<br /> 由于域控制器在域内的特殊性，因此域控制器倾向于被用做Browser，主域控制器应该被用作Domain Master Browser，他们在推举时设置的权重较大。★<br /> preserve case = yes|no<br /> short preserve case = yes|no<br /> 指定拷贝DOS文件的时候保持大小写，缺省是no<br /> default case = lower|upper<br /> 所有的DOS文件的缺省是大写还是小写<br /> case sensitive = yes|no<br /> 大小写敏感，一般是no,不然会出现一些问题。<br /> 共享设置：<br /> ★共享资源:<br /> 每个SMB服务器能对外提供文件或打印服务，每个共享资源需要被给予一个共享名，这个名字将显示在这个服务器的资源列表中。如果一个资源的名字的最后一个字母为$，则这个共享名就为隐藏共享，不能直接表现在浏览列表中，而只能通过直接访问这个名字来进行访问。在SMB协议中，为了获得服务器提供的资源列表，必须使用一个隐藏的资源名字IPC$来访问服务器，否则客户无法获得系统资源的列表。★<br /> 共享设置中有个比较奇怪的段:<br /> [homes]，在smb.conf文件中一般没有对这个目录的设定特定内容比如路径等。当客户机发出服务请求时，就在smb.conf文件的其它部分查找友特定内容的服务。如果没有发现这些服务，并且提供了homes段时，那么就搜索密码文件得到用户的Home目录。通过Homes段，Samba可以得到用户的Home目录并使之共享。下面是这个段的最基本的几个设置。<br /> [homes]<br /> comment=Home Directory<br /> browseable=no<br /> writable=yes<br /> 比较正常的共享的配置如下例：<br /> [MyShare]<br /> comment = grind’s file<br /> path = /home/grind<br /> allow hosts = host(subnet)<br /> deny hosts = host(subnet)<br /> writable = yes|no<br /> user = user(@group)<br /> valid users = user(@group)<br /> invalid users = user(@group)<br /> read list = user(@group)<br /> write list = user(@group)<br /> admin list = user(@group)<br /> public = yes|no<br /> hide dot files = yes|no<br /> create mode = 0755<br /> directory mode = 0755<br /> sync always = yes|no<br /> short preserve case = yes|no<br /> preserve case = yes|no<br /> case sensitive = yes|no<br /> mangle case = yes|no<br /> default case = upper|lower<br /> force user = grind<br /> wide links = yes|no<br /> max connections = 100<br /> delete readonly = yes|no<br /> 其中[]里面的MyShare指定共享名，一般就是网络邻居里面可以看见的文件夹的名字。<br /> comment指的是对改共享的备注。<br /> path指定共享的路径，其中可以配合samba变量使用。比如你可以指定path=/data/%m，这样如果一台机器的NETBIOS名字是grind,它访问MyShare这个共享的时候就是进入/data/grind目录,而对于NETBIOS名是glass的机器，则进入/data/glass目录。<br /> allow hosts和deny hosts和前面的全局设置的方法一样这里不再提及。<br /> writeable指定了这个目录缺省是否可写，也可以用readonly = no来设置可写。<br /> user设置所有可能使用该共享资源的用户，也可以用@group代表group这个组的所有成员，不同的项目之间用空格或者逗号隔开。<br /> valid users指定能够使用该共享资源的用户和组。<br /> invalid users指定不能够使用该共享资源的用户和组。<br /> read list 指定只能读取该共享资源的用户和组。<br /> write list指定能读取和写该共享资源的用户和组。<br /> admin list指定能管理该共享资源（包括读写和权限赋予等）的用户和组。<br /> public指明该共享资源是否能给游客帐号访问，这个开关有时候也叫guest ok，所以有的配置文件中出现guest ok = yes其实和public = yes是一样的。<br /> hide dot files指明是不是像unix那样隐藏以“.”号开头的文件。<br /> create mode指明新建立的文件的属性，一般是0755。<br /> directory mode指明新建立的目录的属性，一般是0755。<br /> sync always指明对该共享资源进行写操作后是否进行同步操作。<br /> short preserve case指明不管文件名大小写。<br /> preserve case指明保持大小写。<br /> case sensitive指明是否对大小写敏感，一般选no,不然可能引起错误。<br /> mangle case指明混合大小写。<br /> default case指明缺省的文件名是全部大写还是小写。<br /> force user强制把建立文件的属主是谁。如果我有一个目录，让guest可以写，那么guest就可以删除，如果我用force user= grind强制建立文件的属主是grind，同时限制create mask = 0755，这样guest就不能删除了。<br /> wide links指明是否允许共享外符号连接，比如共享资源里面有个连接指向非共享资源里面的文件或者目录，如果设置wide links = no将使该连接不可用。<br /> max connections = n设定同时连接数是n。<br /> delete readonly指明能否删除共享资源里面已经被定义为只读的文件。<br /> 有两类特殊的共享，分别是光驱和打印机<br /> 光驱的共享设置:<br /> [cdrom]<br /> comment = grind’s cdrom<br /> path = /mnt/cdrom<br /> public = yes<br /> browseable = yes<br /> root preexec = /bin/mount -t iso9660 /dev/cd0 /mnt/cdrom <br /> root postexec = /bin/umount /mnt/cdrom<br /> 这里root preexec指明了连接时用root的身份运行mount命令，而root postexec则指明了断开时用root身份运行umount,有效实现了对光驱的共享。<br /> 打印机共享的设置：<br /> [printers]<br /> path = /var/spool/samba<br /> writeable = no<br /> guest ok = yes<br /> printable = yes <br /> printer driver = HP LaserJet 5L<br /> 这里printable指明该打印机可以打印， guest ok说明游客也能打印，path指明打印的文件队列暂时放到/var/spool/samba目录下。printer driver的作用是指明该打印机的类型，这样我们在安装网络打印机的时候可以直接自动安装驱动而不必选择。 <br /> 添加用户：<br /> samba添加用户比较方便，一般是用smbadduser，用法是smbadduser unixid:netid，举个例子：如果你的本机有个叫grind的用户，你用smbadduser grind:grind，这样从网上邻居访问的时候用户名就用grind，而如果你用了smbadduser grind:glass的话，网上邻居访问的时候提供的用户名就是glass而不是grind了。</p> 
<p>关于samba服务端的设置基本就是这些，我想一般应用中所要使用的上面几乎都覆盖到了，所以有些不重要的就省略了，如果要更加详细的信息可以用man smb.conf参考。</p> 
<p> </p> 
<p>Samba使用大全（二）－Samba客户端</p> 
<p>http://LinuxAid.com.cn 01-11-08 22:42 1025p grind<br /> --------------------------------------------------------------------------------</p> 
<p>Samba使用大全（二）－Samba客户端<br /> 使用Samba网络打印：<br /> 使用unix网络打印以前的文章比较少涉及，最近试验了一下，效果还是不错的，现在讲讲基本的实现方法：<br /> 比如你要建立一台网络打印机grind，而打印机对应网络上面的//glass/HPLaserj，所有需要配置的文件有下面几个:<br /> 1．/etc/printcap，内容一般为:<br /> grind:<br /> :sh: #禁止提示的header<br /> :ml=0: #打印的文件的长度下限,<br /> :mx=0: #最大的打印文件大小，0为不限制<br /> :sd=/var/spool/lpd/grind: #打印机的spool目录<br /> :lp=|/usr/bin/smbprint: #打印输出需要的设备名或者管道名<br /> :lpd_bounce=true: #强制lpd守护进程过滤打印文件<br /> :if=/usr/share/printconf/mf_wrapper: #过滤命令文件</p> 
<p>2．smbprint这个一般在安装完smb相关的rpm包以后就有了，主要内容是：<br /> eval acct_file=$$#<br /> spool_dir=`dirname $acct_file`<br /> config_file=$spool_dir/.config<br /> eval `cat $config_file`<br /> share=`echo $share | sed &quot;s/[]///g&quot;`<br /> if [ &quot;$user&quot; != &quot;&quot; ]; then<br /> usercmd=&quot;-U&quot;<br /> else<br /> usercmd=&quot;&quot;<br /> fi<br /> if [ &quot;$workgroup&quot; != &quot;&quot; ]; then<br /> workgroupcmd=&quot;-W&quot;<br /> else<br /> workgroupcmd=&quot;&quot;<br /> fi<br /> if [ &quot;$translate&quot; = &quot;yes&quot; ]; then<br /> command=&quot;translate ; print -&quot;<br /> else<br /> command=&quot;print -&quot;<br /> fi<br /> cat | /usr/bin/smbclient &quot;$share&quot; &quot;$password&quot; -E ${hostip:+-I} <br /> $hostip -N -P $usercmd &quot;$user&quot; $workgroupcmd &quot;$workgroup&quot; <br /> -c &quot;$command&quot; 2&gt;/dev/null</p> 
<p>3．mf_wrapper是一个magic filter文件，是相关的一些过滤规则。内容是：<br /> MF_RULE_DIR='/usr/share/printconf/mf_rules'<br /> MF_RULES=$MF_RULE_DIR/mf[[:digit:]][[:digit:]]-*<br /> TMP_FILE=`mktemp /tmp/printconf.XXXXXX`' 'exit 1<br /> cat ./mf.cfg $MF_RULES | m4 &gt; $TMP_FILE<br /> if [ -n &quot;$DEBUG&quot; ]; then<br /> case &quot;$DEBUG&quot; in<br /> 2)<br /> DEBUGSTRING=&quot;--debug --debug&quot;<br /> ;;<br /> 3)<br /> DEBUGSTRING=&quot;--debug --debug --debug&quot;<br /> ;; 4)<br /> DEBUGSTRING=&quot;--debug --debug --debug --debug&quot;<br /> ;;<br /> 5)<br /> DEBUGSTRING=&quot;--debug --debug --debug --debug --debug&quot;<br /> ;;<br /> *)<br /> DEBUGSTRING=&quot;--debug&quot;<br /> ;;<br /> esac<br /> else<br /> DEBUGSTRING=&quot;&quot;<br /> fi<br /> # Run magic filter<br /> /usr/bin/magicfilter-t $TMP_FILE $DEBUGSTRING $* &lt; /dev/stdin<br /> RETVAL=$?<br /> if [ -f $TMP_FILE ]; then<br /> rm -f $TMP_FILE;<br /> fi<br /> ;;<br /> esac<br /> else<br /> DEBUGSTRING=&quot;&quot;<br /> fi<br /> # Run magic filter<br /> /usr/bin/magicfilter-t $TMP_FILE $DEBUGSTRING $* &lt; /dev/stdin<br /> RETVAL=$?<br /> if [ -f $TMP_FILE ]; then<br /> rm -f $TMP_FILE;<br /> fi<br /> if [[ $RETVAL -eq 0 ]]; then<br /> TERMINATION=`grep '^[[:space:]]*#[[:space:]]*TERMINATION=' ./mf.cfg | se<br /> d 's/^[[:space:]]*#[[:space:]]*TERMINATION=//;'`<br /> if [ -n $TERMINATION ]; then<br /> echo -n -e $TERMINATION;<br /> fi<br /> fi<br /> 同时需要在/var/spool/lpd/grind下面有这么两个文件：mf.cfg和script.cfg。<br /> mf.cfg的内容是：<br /> define(TEXTfilter, text &quot;&quot; <br /> 14 )dnl<br /> define(PSfilter, `filter /usr/share/printconf/util/mf_postscript_wrapper --mfomatic -d lj5gray-75168.foo')dnl<br /> script.cfg的内容是：<br /> share=&quot;//glass/HPLaserj&quot; #glass机器上面共享的打印机<br /> hostip=&quot;192.168.1.123&quot; #glass这台机器的IP<br /> user=&quot;&quot;<br /> password=&quot;&quot;<br /> workgroup=&quot;&quot;<br /> translate=&quot;no&quot;<br /> 完成这个工作后，启动lpd进程，然后就能用lpr等命令使用网络打印机打印了。</p> 
<p>使用网络共享文件资源：<br /> 列出网络资源：<br /> 一般可以用smbclient来列出某台机器相关的资源，smbclient的用法参考http://www.linuxaid.com.cn/training/tods/showtod.jsp?i=241。这里讲比较有用的使用方法：<br /> smbclient –L IP或者NETBIOS名称，作用是显示某台提供samba服务的服务器上的共享资源。命令执行效果如下：<br /> smbclient –L glass<br /> Sharename Type Comment<br /> --------- ---- -------<br /> IPC$ IPC 远程 IPC<br /> HPLaserJ Printer HP LaserJet 6P<br /> ADMIN$ Disk 远程管理<br /> littlep Disk<br /> C$ Disk 默认共享<br /> Server Comment<br /> --------- -------<br /> GLASS<br /> GRIND<br /> Workgroup Master<br /> --------- -------<br /> BLUESUN GLASS<br /> WORKGROUP HEIHEI<br /> 第一段列举了该机器（glass）上面的共享资源，第二段列举了glass所在的工作组里面所有提供samba服务的机器，第三列举了其他工作组提供browse服务的Master机器（关于Master和Browse服务可以参考我的前面一篇samba使用大全-samba服务器）。<br /> 使用网络资源：<br /> smbclient //IP或者NETBIOS名称/共享资源名 [-U 用户名]<br /> 命令执行效果如下：<br /> smbclient //glass/littlep<br /> added interface ip=192.168.1.123 bcast=192.168.1.255 nmask=255.255.255.0<br /> Got a positive name query response from 192.168.1.123 (192.168.1.123)<br /> Password:<br /> Domain=[BLUESUN] OS=[Windows 5.0] Server=[Windows 2000 LAN Manager]<br /> smb: &gt; <br /> 接下来的操作和ftp的时候命令一样，用get下载文件而用put上传文件，命令可以用help查看。<br /> 还有一种方法是用文件系统的方式（这种方式要确定你的内核支持smbfs，如果没有支持的话，编译内核的时候必须选中File systems---&gt;Network File Systems---&gt; SMB file system support (to mount Windows shares etc.) ）：<br /> smbmount //IP或者NETBIOS名称/共享资源名 /本地挂接点 [-o option]<br /> 常用的的option有username=&lt;用户名&gt;，password=&lt;密码&gt;，guest（指定为用guest访问，不用提供密码，前面的即使用username=guest参数的话也会要求输入密码），ro（有时候为了系统安全要指定为只读模式），rw，同时多个option的话用逗号隔开。<br /> 或者可以用mount –t smbfs [–o option] //IP或者NETBIOS名称/共享资源名 /本地挂接点来实现同样的功能。<br /> 例子如下：<br /> smbmount //glass/littlep /test -o guest或者mount –t smbfs –o guest //glass/littlep /test，然后就能通过访问/test来使用网络上的资源了。<br /> 如果不需要使用的时候，可以简单地使用smbumount /test或者umount /test来解除这个挂接。<br /> 关于samba的功能（共享Linux磁盘给Win95/NT、共享Linux打印机给win95/NT、共享win95/NT打印机给Linux机器。、共享Win95/NT磁盘给Linux机器），前面两个属于samba服务器的内容而后两个属于samba客户段的内容，在我的两篇文章中都有介绍了他们的实现方法，但是samba实在是一个强大的工具，无法十分详细地介绍它地全部功能，而且限于笔者的知识有限，有不到之处请各位指出，还望各位多多交流。</p> 
<p><a href="http://netadmin.77169.com/HTML/20040209040900.html">http://netadmin.77169.com/HTML/20040209040900.html</a></p></div></body></html>