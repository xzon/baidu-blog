<html><head><title>安装程序制作系统NSIS(Nullsoft Scriptable Install System)</title></head><body><div id='tit'>安装程序制作系统NSIS(Nullsoft Scriptable Install System)</div><div id='cate'>工具使用</div><div id='date'>2009年04月08日 星期三 10:52 P.M.</div><div id='page'>58</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/a97af10399bdffe408fa9381.html'>http://hi.baidu.com/hxzon/blog/item/a97af10399bdffe408fa9381.html</a><div id='cnt'><h2><a href="http://www.blogjava.net/xilaile/archive/2007/03/29/107294.html">安装程序制作系统NSIS(Nullsoft Scriptable Install System)</a></h2> 
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span>NSIS</span> <span>是一个开源免费的</span> <span>Windows</span> <span>安装程序制作系统，</span> <span>通过使用</span> <span>NSIS</span> <span>的脚本语言可以配置安装程序所需的几乎所有功能，比如修改系统设置，读写注册表，文件包解压，</span> <span>卸载等等。其功能非常强大，产生的安装文件却很小，默认配置只有</span> <span>34KB。<br /> </span></p> 
<p style="margin: 0cm 0cm 0pt" class="MsoNormal"><span>NSIS</span> <span>主页 </span><span><a target="_blank" href="http://nsis.sourceforge.net/">http://nsis.sourceforge.net/</a> <br /> <br /> 学习NSIS主要就是学它的脚本的编写，最快的方法当然是看它的脚本例子，遇到不知道的就查它的用户手册。安装NSIS以后，两样您都有了。<br /> <br /> 先看个最简单的例子，NSIS的脚本文件以 <em>.nsi</em> 为扩展名。<br /> </span></p> 
<div style="border-bottom: rgb(204,204,204) 1px solid; border-left: rgb(204,204,204) 1px solid; padding-bottom: 4px; background-color: rgb(238,238,238); padding-left: 4px; width: 93.64%; padding-right: 5px; height: 419px; font-size: 13px; border-top: rgb(204,204,204) 1px solid; border-right: rgb(204,204,204) 1px solid; padding-top: 4px">
 <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" />
 <p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> 
 <span style="color: rgb(0,128,0)">;</span> 
 <span style="color: rgb(0,128,0)">起头的一行是注释</span> 
 <span style="color: rgb(0,128,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,0,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,128,0)">;</span> 
 <span style="color: rgb(0,128,0)">安装程序的名称</span> 
 <span style="color: rgb(0,128,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,0,0)">Name </span>
 <span style="color: rgb(0,0,0)">&quot;</span> 
 <span style="color: rgb(0,0,0)">例子</span> 
 <span style="color: rgb(0,0,0)">&quot;</span> 
 <span style="color: rgb(0,0,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> <br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,128,0)">;</span> 
 <span style="color: rgb(0,128,0)">输出安装程序启动文件</span> 
 <span style="color: rgb(0,128,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,0,0)">OutFile </span>
 <span style="color: rgb(0,0,0)">&quot;</span> 
 <span style="color: rgb(0,0,0)">安装.exe</span> 
 <span style="color: rgb(0,0,0)">&quot;</span> 
 <span style="color: rgb(0,0,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> <br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,128,0)">;</span> 
 <span style="color: rgb(0,128,0)">默认安装目录，$PROGRAMFILES指示Windows的Programm Files目录</span> 
 <span style="color: rgb(0,128,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,0,0)">InstallDir $PROGRAMFILES\例子<br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p></span> 
 <span style="color: rgb(0,128,0)">;</span> 
 <span style="color: rgb(0,128,0)">安装页面, 比如许可证说明页面等等</span> 
 <span style="color: rgb(0,128,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,0,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,128,0)">;</span> 
 <span style="color: rgb(0,128,0)">directory表示选择安装目录的页面</span> 
 <span style="color: rgb(0,128,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,0,0)">Page directory<br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p></span> 
 <span style="color: rgb(0,128,0)">;</span> 
 <span style="color: rgb(0,128,0)">instfiles 表示安装的页面</span> 
 <span style="color: rgb(0,128,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,0,0)">Page instfiles<br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p></span> 
 <span style="color: rgb(0,128,0)">;</span> 
 <span style="color: rgb(0,128,0)">具体要装的东西, 比如拷贝文件</span> 
 <span style="color: rgb(0,128,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,0,0)">Section </span>
 <span style="color: rgb(0,0,0)">&quot;&quot;</span> 
 <span style="color: rgb(0,128,0)">;</span> 
 <span style="color: rgb(0,128,0)">没有components page, 名称不重要</span> 
 <span style="color: rgb(0,0,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
 <span style="color: rgb(0,128,0)">;</span> 
 <span style="color: rgb(0,128,0)">指定输出目录</span> 
 <span style="color: rgb(0,128,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetOutPath $INSTDIR<br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
 <span style="color: rgb(0,128,0)">;</span> 
 <span style="color: rgb(0,128,0)">拷贝一个文件</span> 
 <span style="color: rgb(0,128,0)"><br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p> </span>
 <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File 运行.exe<br /> <img align="top" src="image/安装程序制作系统NSIS(Nullsof.None.gif" /><p class="origImg">http://www.blogjava.net/Images/OutliningIndicators/None.gif</p>SectionEnd</span>
</div> 
<br /> 这个安装程序只拷贝了文件
<em>运行.exe</em> 到安装目录下了。编译这个脚本的时候，
<em>运行.exe</em>要在脚本的同一目录下。NSIS会把
<em>运行.exe</em>做在
<em>安装.exe</em>文件里面，也就是说发布的时候，您只需要提供
<em>安装.exe</em>。
<br /> 
<br /> 怎样编译NSIS的脚本呢？ 非常简单。安装NSIS后，您的文件右键菜单多出两个命令Compile NSIS Script和Compile NSIS Script(Choose Compressor), 要选中一个NSIS的脚本才行。
<br /> 
<br /> 
<p align="center"><img style="width: 575px; height: 371px" border="0" alt="nsis1.jpg" width="625" height="437" src="image/安装程序制作系统NSIS(Nullsof.nsis1.jpg" /><p class="origImg">http://www.blogjava.net/images/blogjava_net/xilaile/nsis1.jpg</p></p> 
<br /> 您只要点一下Compile NSIS Script就OK了，NSIS的Compiler会生成
<em>安装.exe</em>。Compile NSIS Script(Choose Compressor)可以让您选择压缩的方式，NSIS目前支持ZLib, BZip2, LZMA三种方式，大部分情况下LZMA会得到比较好的结果。
<br /> 
<br /> 当然这个例子好比Java的Hello World程序，只是演示了NSIS最简单的使用过程。NSIS还有很多有意思的功能有待您去尝试掌握，举个Java程序员有兴趣的例子，
<a target="_blank" href="http://www.blogjava.net/xilaile/archive/2007/05/13/117039.html">制作Java程序的EXE启动文件的NSIS脚本</a>。
<br /> 
<hr style="width: 100%; height: 2px" /> 转载请保留
<a title="http://www.blogjava.net/xilaile/archive/2007/03/29/107294.html" href="http://www.blogjava.net/xilaile/archive/2007/03/29/107294.html">http://www.blogjava.net/xilaile/archive/2007/03/29/107294.html</a></div></body></html>