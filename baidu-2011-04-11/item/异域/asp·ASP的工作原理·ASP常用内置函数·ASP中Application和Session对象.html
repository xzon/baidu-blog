<html><head><title>asp&middot;ASP的工作原理&middot;ASP常用内置函数&middot;ASP中Application和Session对象</title></head><body><div id='tit'>asp&middot;ASP的工作原理&middot;ASP常用内置函数&middot;ASP中Application和Session对象</div><div id='cate'>异域</div><div id='date'>2007年11月19日 星期一 08:42 P.M.</div><div id='page'>200</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/4128bf01c3764200728da5f1.html'>http://hi.baidu.com/hxzon/blog/item/4128bf01c3764200728da5f1.html</a><div id='cnt'><div> 
 <p>asp&middot;ASP的工作原理&middot;ASP常用内置函数&middot;ASP中Application和Session对象</p> 
 <p>asp<br /> 目录&middot;概述<br /> &middot;ASP的工作原理<br /> &middot;ASP的运行环境<br /> &middot;ASP的意涵与特性<br /> &middot;ASP常用内置函数<br /> &middot;ASP中Application和Session对象</p> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 概述
 <br /> ASP是Active Server Page的缩写，意为“活动服务器网页”。ASP是微软公司开发的代替CGI脚本程序的一种应用,它可以与数据库和其它程序进行交互，是一种简单、方便的编程工具。ASP的网页文件的格式是.asp，现在常用于各种动态网站中。 ASP是一种服务器端脚本编写环境，可以用来创建和运行动态网页或Web应用程序。ASP网页可以包含HTML标记、普通文本、脚本命令以及COM组件等。利用ASP可以向网页中添加交互式内容（如在线表单），也可以创建使用HTML网页作为用户界面的web应用程序。 与HTML相比，ASP网页具有以下特点：
</div> 
<div> 
</div> 
<div>
 （1）利用ASP可以实现突破静态网页的一些功能限制，实现动态网页技术；
</div> 
<div> 
</div> 
<div>
 （2）ASP文件是包含在HTML代码所组成的文件中的，易于修改和测试；
</div> 
<div> 
</div> 
<div>
 （3）服务器上的ASP解释程序会在服务器端制定ASP程序，并将结果以HTML格式传送到客户端浏览器上，因此使用各种浏览器都可以正常浏览ASP所产生的网页；
</div> 
<div> 
</div> 
<div>
 （4）ASP提供了一些内置对象，使用这些对象可以使服务器端脚本功能更强。例如可以从web浏览器中获取用户通过HTML表单提交的信息，并在脚本中对这些信息进行处理，然后向web浏览器发送信息；
</div> 
<div> 
</div> 
<div>
 （5）ASP可以使用服务器端ActiveX组件来执行各种各样的任务，例如存取数据库、发现哦那个Email或访问文件系统等。
</div> 
<div> 
</div> 
<div>
 （6）由于服务器是将ASP程序执行的结果以HTML格式传回客户端浏览器，因此使用者不会看到ASP所编写的原始程序代码，可放置ASP程序代码被窃取。
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 ASP的工作原理
</div> 
<div> 
</div> 
<div>
 <br /> 当在Web站点中融入ASP功能后，将发生以下事情：
</div> 
<div> 
</div> 
<div>
 1、用户向浏览器地址栏输入网址，默认页面的扩展名是.asp。
</div> 
<div> 
</div> 
<div>
 2、浏览器向服务器发出请求。
</div> 
<div> 
</div> 
<div>
 3、服务器引擎开始运行ASP程序。
</div> 
<div> 
</div> 
<div>
 4、ASP文件按照从上到下的顺序开始处理，执行脚本命令，执行HTML页面内容。
</div> 
<div> 
</div> 
<div>
 5、页面信息发送到浏览器。
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 ASP的运行环境
</div> 
<div> 
</div> 
<div>
 <br /> asp需要运行在PWS或IIS下。PWS或IIS服务在windows98或windows2000的光盘上附带着，可以通过“添加/删除程序”中的“添加/删除windows组件”来安装。
</div> 
<div> 
</div> 
<div>
 一般asp需与access数据库或SQL Server数据库结合使用，编出功能强大的程序。
</div> 
<div> 
</div> 
<div>
 能够运行ASP的web服务器软件
</div> 
<div> 
</div> 
<div>
 Windows2000默认安装的是IIS5.0(internet information server)，而windows xp默认安装的是IIS5.1，windows 2003默认安装的IIS6.0。
</div> 
<div> 
</div> 
<div>
 PWS(personal web server)运行在windows98环境下的简单个人网页服务器。
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 ASP的意涵与特性
 <br /> ASP( Application Service Provider,应用软体租赁服务提供者 )即是指「透过网路以租赁方式提供应用软体服务的业者」,即是指业者以应用软体为主体,透过网路一对多地传递服务,这种以服务为主的交易模式促使企业可藉由租赁的方式,以更符合成本效益的方式拥有软体的使用权,并且亦能因为业者集中式的管理而大幅降低企业维护的成本.
 <br /> 基本上,ASP即具有「软体服务化,服务网路化」,「资讯委外服务与网路结合」与「产品通路化,通路产品化」等三大特性,其甚至可以被视为是ISP（Internet Service Provider）与ITS（Information Technology Service）的结合.
</div> 
<div> 
</div> 
<div>
 ASP的英文是Application Service Provider，中文的标准翻译就是“应用服务提 供商”，是指为商业或者个人客户提供管理应用解决方案的公司或者企业。最近 ASP被媒体炒做十分火热，不是IT行业的人面对一堆技术名词专业术语很难弄清楚ASP的内容，本文试图用浅显的语言来为广大的读者揭开ASP神秘的面纱，对于IT行业的大热门ASP领域有一些基本的认识。
</div> 
<div> 
</div> 
<div>
 1. ASP是什么东西？
</div> 
<div> 
</div> 
<div>
 简单地讲，ASP就是为客户提供服务的服务商，它和会计事物所、婚姻介绍所没有什么本质方面的区别。不同的是ASP主要是通过INTERNET（国际互联网络）作为主要工作和业务工具，采用一对多的方式，向企业、公司提供标准化的应用软件以及相关的技术咨询、管理租赁的服务，ASP的概念最早是1998年由美国人提出来的。目前被全球各大IT厂商看好并被认为是可以推动网络经济发展的，有稳固基础的第三种网络商业模式。
</div> 
<div> 
</div> 
<div>
 和传统的外包服务（Outsourcing）相比，ASP的主要区别在于：ASP是一对多的经营模式，提供的服务有兼容性和可协调性，并且ASP的收费方式一般是按月收费。 
 <br /> 业界认为：ASP一般有这样一些“成员”：电信运营商、传统IT服务厂商、互联网络接入服务商（ISP）、独立软件供应商（ISV）、系统集成商和单纯的ASP公司。
</div> 
<div> 
</div> 
<div>
 根据流行的观点，ASP有如下五个核心内涵：
</div> 
<div> 
</div> 
<div>
 a. ASP着重应用为中心，提供对于应用方面的访问和管理。 
 <br /> b. ASP服务可以为用户提供没有在服务器、人员、系统和系统授权等前期资源投入情况下就可以在“定制”的全新应用系统环境进行访问的服务，如ISP，而这样的服务一般按月份ASP收取服务费。 
 <br /> c. ASP采用集中管理的方式---ASP一般都有一个管理中心，所有的客户通过INTERNET来进行远程访问，获得技术支持和咨询服务。 
 <br /> d. 一对多的服务，也就是讲，ASP提供的是标准化的产品包，产品都是最低程度的自定义或者没有实现客户定制化，对于行业用户来讲已经达到实用方便的标准。 
 <br /> e. 按照合同交付，在ASP客户的眼中，ASP是一家根据客户协议内容提供相关服务，保证应用服务系统服务可以得到确实履行的机构。
</div> 
<div> 
</div> 
<div>
 2. ASP为什么会火？
</div> 
<div> 
</div> 
<div>
 从大的方面来讲，困扰国内企业生存、发展的核心问题是管理问题。随着互联网络的普及和应用的深入，企业用户可以随时随地直接租用ASP的服务器和软件系统来进行自己的业务管理，这样做的好处在于；第一，企业可以节省大笔用于IT建设方面的资金，大幅度降低企业管理信息化的成本。第二，ASP的用户可以采用各种方式获得应用和服务，软件类服务产品完全可以通过网络在非常短的时间内组成一个完善的、高效的、先进的企业管理系统，迅速获得企业一体化的运营管理方案。
</div> 
<div> 
</div> 
<div>
 网络经济发展突飞猛进，电子商务一日千里，网络和网站从门户到内容、从注意力到垂直性，目前逐渐转向热衷ASP也是一个主要的原因。
</div> 
<div> 
</div> 
<div>
 笔者资料中，国内最早对ASP触电的是网友“飞鸟”，在1998年6月自发组织了研究、交流和探讨ASP技术的“飞鸟之家”，现在已经发展成为chinaasp.com，成为国内最早的ASP应用技术服务提供商网站。上海的互易网络有限公司结合国内实际情况，推出了为国内企业服务的ASP平台互易网，向企业提供以电子商务为核心的，企业内、外部网络设施和应用的远程构架和托管服务，创造虚拟企业门户（EP）直接将ASP应用到商业增殖环节中去。
</div> 
<div> 
</div> 
<div>
 此外，ISP也全面转向ASP的怀抱，成为ISP进一步发展的产物。软件商对于ASP更是情有独钟。业界最新的消息是，中国第三电信“网通”已经制定ASP发展战略，国内最大的管理咨询公司“汉普”将把旗下八个子公司定位在企业内部资源计划管理（ERP）领域的ASP中，北京“联成互动”瞄准客户关系管理（CRM）领域的ASP，北京“数码方舟”定位在网络办公的ASP，HP正在和中国建设银行讨论共建金融领域的ASP。
</div> 
<div> 
</div> 
<div>
 ASP正在IT经济大潮中显山露水，其发展前景不可估量。
</div> 
<div> 
</div> 
<div>
 3. ASP的发展阶段和面临的问题
</div> 
<div> 
</div> 
<div>
 以网络服务商、软件厂商和ISP为主力的各种IT角色，正在根据自己的优势条件出发对ASP领域进行多种方面的尝试。就目前阶段来讲，ASP提供的服务不计其数五花八门，没有标准化和量化的概念，硬件厂商向ASP的“土壤”和势力方向靠拢，软件厂商和ISP则直接参与到ASP业务的第一线。
</div> 
<div> 
</div> 
<div>
 笔者估计，经过一段时间的试探和发展，ASP将向服务集成方面发展，产品和服务初步的标准化将很快建立起来，接着进入到市场细化和标准制定、ASP产品成熟时期，ASP的稳步增长，最终将成为IT行业商务模式的核心！
</div> 
<div> 
</div> 
<div>
 目前在ASP发展的道路上，主要面临的问题是观念的转变方面：用租赁代替购买，服务集成代替产品经销商、服务经济代替产品经济等等。具体到实际方面来讲，安全和服务的质量是ASP和客户共同关心的头等大事，要实现ASP提出的“租赁高科技”的口号，ASP任重而道远！
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 ASP常用内置函数
</div> 
<div> 
</div> 
<div>
 1，日期/时间函数
</div> 
<div> 
</div> 
<div>
 这些函数包括对“年”、“月”、“日”、“时”、“分”、“秒”、“星期”等的显示。
</div> 
<div> 
</div> 
<div>
 （1）Now函数：根据计算机系统设定的日期和时间，返回当前的日期和时间值。使用方法now()；
</div> 
<div> 
</div> 
<div>
 （2）Date函数：只返回当前计算机系统设定的日期值。使用方法：date()；
</div> 
<div> 
</div> 
<div>
 （3）Time函数：只返回当前计算机系统设定的时间值。使用方法：time()；
</div> 
<div> 
</div> 
<div>
 （4）Year函数：返回一个代表某年的整数。使用方法：year(date)，其中date参数是任意的可以代表日期的参数，比如“year(date())”就表示是从“date()”得出的日期中提取其中“年”的整数。
</div> 
<div> 
</div> 
<div>
 另外，还可以这样应用：“year(#5 20,2006#)”表示提取“2006年5月20日”中“年”的整数值。关于“5 20,2006”，也可使用“5-20-2006”、“5/20/2006”等形式表现，即“某月某日”和“某年”的组合。同时注意使用“#”进行包括以表示日期值。
</div> 
<div> 
</div> 
<div>
 （5）Month函数：返回1到12之间的整数值，表示一年中某月。使用方法：month(date)。关于参数date的说明和year函数相同。但要注意日期的正确性，比如“#13-31-2006#”，根本就没有“13”月，肯定是错误的了。
</div> 
<div> 
</div> 
<div>
 （6）Day函数：返回1到31之间的整数值，表示一个月中的某天。使用方法：day(date)。关于参数date的说明和year函数相同。同样要注意日期的正确性，比如“#2-30-2006#”其中对“2”月定义的“30”日这天就是错误的。
</div> 
<div> 
</div> 
<div>
 （7）Hour函数：返回0到23之间的整数值，表示一天中的某个小时。使用方法：hour(time)。其中参数time是任意的可代表时间的表达式。比如“hour(time())”就表示是从“time()”得出的时间中提取其中“小时”的整数。同样，参数time还可以这样应用“hour(#11:45:50#)”表示从“11”时“45”分“50”秒中提取当前小时数。当然，定义的时间要符合时间的规范。
</div> 
<div> 
</div> 
<div>
 （8）Minute函数：返回0到59之间的整数值，表示一小时中的某分钟。使用方法：minute(time)。time参数的说明和hour函数相同。
</div> 
<div> 
</div> 
<div>
 （9）Second函数：返回0到59之间的整数值，表示一分钟中的某秒。使用方法：second(time)。time参数的说明和hour函数相同。
</div> 
<div> 
</div> 
<div>
 （10）Weekday函数：返回一个星期中某天的整数。使用方法：weekday(date)。关于参数date的说明和year函数相同。该函数返回值为“1”到“7”，分别代表“星期日”、“星期一”……“星期六”。比如当返回值是“4”时就表示“星期三”。
</div> 
<div> 
</div> 
<div>
 （11）WeekDayName函数：返回一个星期中具体某天的字符串。相对weekday函数而言即翻译出“星期几”，使用方法：weekdayname(weekday)。参数weekday即星期中具体某天的数值。比如“weekdayname(weekday(date()))”就表示当前是“星期几”。因为“date()”表示的是当前的时间，而“weekday(date())”就表示的是一星期中具体某天的整数。
</div> 
<div> 
</div> 
<div>
 当然weekdayname函数最终显示的字符串内容还与当前操作系统语系有关，比如中文操作系统将显示“星期一”这类的中文字符，而英文操作系统则显示为“Mon”（Monday简写）。
</div> 
<div> 
</div> 
<div>
 此外，在VBScript中还有一些关于时间间隔的计算函数：
</div> 
<div> 
</div> 
<div>
 （1）DateAdd函数：返回指定时间间隔的日期、时间。可以计算出相隔多少年、或相隔几个月、又或相隔几个小时等的新日期、时间。使用方法：dateadd(interval, number, date)。
</div> 
<div> 
</div> 
<div>
 其中参数interval表示需要添加的时间间隔单位。其是以字符串的形式表达的，比如“yyyy”表示年，“q”表示季度，“m”表示月份，“d”表示天数，“ww”表示周数，“h”表示小时数，“n”表示分钟数，“s”表示秒数。
</div> 
<div> 
</div> 
<div>
 而参数number则表示添加的时间间隔数。其是以数值的形式表达的，可以为负值。参数date则要求是日期、时间的正确格式。
</div> 
<div> 
</div> 
<div>
 比如dateadd(&quot;d&quot;,100,&quot;2006-5-20&quot;)就表示2006年5月20号以后的100天的日期值：2006-8-28。再比如dateadd(&quot;h&quot;,-12,&quot;2005-5-20 10:00:00&quot;)就表示2005年5月20号上午10点前的12小时的日期时间：2005-5-19 22:00:00。
</div> 
<div> 
</div> 
<div>
 （2）DateDiff函数：返回两个日期时间之间的间隔。可计算出两个日期相隔的年代、小时数等。使用方法：datediff(interval,date1,date2)。
</div> 
<div> 
</div> 
<div>
 参数interval和dateadd函数中的interval参数内容描述相同，date1和date2参数分别就是相互比较的两个日期时间。另外，当date1的日期时间值大于date2时，将显示为负值。
</div> 
<div> 
</div> 
<div>
 比如DateDiff(&quot;yyyy&quot;,&quot;1982-7-18&quot;,date)表示某人的出生到现在已经多少年了。又比如DateDiff(&quot;d&quot;,&quot;1982-7-18&quot;,&quot;2062-7-18&quot;)则计算了80年过了多少天：29220。
</div> 
<div> 
</div> 
<div>
 2，字符串处理函数
</div> 
<div> 
</div> 
<div>
 在脚本的功能处理中，通常需要对一些字符串进行一些修饰性处理。比如过滤掉字符串中的敏感字眼以符合最终显示的要求；又比如一段较长的字符串，需要提取开头的几个字符时。
</div> 
<div> 
</div> 
<div>
 （1）Asc函数：返回字符串中第一个字母对应的ANSI字符代码。使用方法：asc(string)。其中string参数表示字符串。
</div> 
<div> 
</div> 
<div>
 （2）Chr函数：返回指定了ANSI 字符代码对应的字符。使用方法：chr(chrcode)。参数chrcode是相关的标识数字。该函数的功能和asc函数形成对应。
</div> 
<div> 
</div> 
<div>
 比如：asc(“a”)表示小写字母“a”的ANSI 字符“97”；同样chr(97)表示的就是“小写字母a”。另外chr(chrcode)中参数chrcode值为0到31的数字时，表示不可打印的ASCII码。比如“chr(10)”表示换行符，“chr(13)”表示回车符等，这常用于输入和显示格式的转换中。
</div> 
<div> 
</div> 
<div>
 （3）Len函数：返回字符串内字符的数目（字节数）。使用方法：len(string)。比如len(“love”)的值就是4。
</div> 
<div> 
</div> 
<div>
 （4）LCase函数：返回所有字符串的小写形式。使用方法：lcase(string)。比如lcase(“CNBruce”)返回为“cnbruce”。
</div> 
<div> 
</div> 
<div>
 （5）UCase函数：返回所有字符串的大写形式。与lcase函数形成对应。同样，ucase(“CNBruce”)返回为“CNBRUCE”。
</div> 
<div> 
</div> 
<div>
 （6）Trim函数、LTrim函数和RTrim函数：分别返回前导和后续不带空格、前导不带空格或后续不带空格的字符串内容。比如：
</div> 
<div> 
</div> 
<div>
 trim(“ cnbruce ”)返回为“cnbruce”，前导和后续都不带空格；
 <br /> ltrim(“ cnbruce ”)返回为“cnbruce ”，前导不带空格;
 <br /> rtrim(“ cnbruce ”)返回为“ cnbruce”，后续不带空格；
</div> 
<div> 
</div> 
<div>
 该函数常用于注册信息中，比如确保注册用户名前或后的空格。
</div> 
<div> 
</div> 
<div>
 （7）Left函数：返回从字符串的左边算起的指定数目的字符。使用方法：left(string,length)。比如left(“brousce”,5)返回为“brous”，即前五位字符。
</div> 
<div> 
</div> 
<div>
 （8）Right函数：返回从字符串的左边算起的指定数目的字符。使用方法：right(string,length)。比如right(“brousce”,4)返回为“usce”，即后四位字符。
</div> 
<div> 
</div> 
<div>
 （9）instr函数：返回某字符串在另一字符串中第一次出现的位置。比如现在查找字母“A”在字符串“A110B121C119D1861”中第一次出现的位置，则可以 instr(my_string,&quot;A110B121C119D1861&quot;)
</div> 
<div> 
</div> 
<div>
 （10）Mid函数：从字符串中返回指定数目的字符。比如现在的“110”则应该是从字符串“A110B121C119D1861”的第2位取得3个单位的值：mid(&quot;A110B121C119D1861&quot;,2,3)
</div> 
<div> 
</div> 
<div>
 （11）Replace函数：在字符串中查找、替代指定的字符串。replace(strtobesearched,strsearchfor,strreplacewith)其中strtobesearched是字符串，strsearchfor是被查找的子字符串，strreplacewith是用来替代的子字符串。比如 replace(rscon,&quot;&amp;lt;&quot;,&quot;&amp;lt;&quot;) 则表示将rscon中所有“&amp;lt;”的字符替换为“&amp;lt;”
</div> 
<div> 
</div> 
<div>
 3，类型转换函数
</div> 
<div> 
</div> 
<div>
 Cbool(string) 转换为布尔值
 <br /> Cbyte(string) 转换为字节类型的值
 <br /> Ccur(string) 转换为货币类值
 <br /> Cdate(string) 转换为日前类型的值
 <br /> Cdbl(string) 转换为双精度值
 <br /> Cint(string) 转换为整数值
 <br /> Clng(string) 转换为长整型的值
 <br /> Csng(string) 转换为单精度的值
 <br /> Cstr(var) 转换为字符串值
 <br /> Str(var) 数值转换为字符串
 <br /> Val(string) 字符串转换为数值
</div> 
<div> 
</div> 
<div>
 4，运算函数
</div> 
<div> 
</div> 
<div>
 Abs(nmb) 返回数子的绝对值
 <br /> Atn(nmb) 返回一个数的反正切
 <br /> Cos(nmb) 返回一个角度的余炫值
 <br /> Exp(nmb) 返回自然指数的次方值
 <br /> Int(nmb) 返回数字的整形（进位）部份
 <br /> Fix(nmb) 返回数字的整形（舍去）部份
 <br /> Formatpercent(表达式) 返回百分比
 <br /> Hex(nmb) 返回数据的16进制数
 <br /> Log(nmb) 返回自然对数
 <br /> Oct(nmb) 返回数字的8进制数
 <br /> Rnd 返回大于“0”而小于“1”的随机数，但此前需 randomize 声明产生随机种子
 <br /> Sgn(nmb) 判断一个数字的正负号
 <br /> Sin(nmb) 返回角度的正铉值
 <br /> Sqr(nmb) 返回数字的二次方根
 <br /> Tan(nmb) 返回一个数的正切值
</div> 
<div> 
</div> 
<div>
 5，其他函数
</div> 
<div> 
</div> 
<div>
 IsArray(var) 判断一个变量是否是数组
 <br /> IsDate(var) 判断一个变量是否是日期
 <br /> IsNull(var) 判断一个变量是否为空
 <br /> IsNumeric(var) 判断表达式是否包含数值
 <br /> IsObject(var) 判断一个变量是否是对象
 <br /> TypeName(var) 返回变量的数据类型
 <br /> Array(list) 返回数组
 <br /> Split(liststr) 从一个列表字符串中返回一个一维数组
 <br /> LBound(arrayP 返回数组的最小索引
 <br /> Ubound(array) 返回数组的最大索引
 <br /> CreateObject(class) 创建一个对象
 <br /> GetObject(pathfilename) 得到文件对象
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 ASP中Application和Session对象
</div> 
<div> 
</div> 
<div>
 一、Application对象的成员概述
</div> 
<div> 
</div> 
<div>
  Application对象成员包括Application对象的集合、方法和事件。
</div> 
<div> 
</div> 
<div>
  ⒈Application对象的集合
</div> 
<div> 
</div> 
<div>
  Contents集合：没有使用元素定义的存储于Applicaiton对象中的所有变量的集合
 <br /> StaticObjects:使用元素定义的存储于Application对象中的所有变量 的集合
 <br /> 例：在default.asp中有如下赋值
 <br /> application(&quot;a&quot;)=&quot;a&quot;
 <br /> application(&quot;b&quot;)=128
 <br /> application(&quot;c&quot;)=false
</div> 
<div> 
</div> 
<div>
  则有contents集合
 <br /> application.contents(1)=&quot;a&quot; '也可写为application.contents(&quot;a&quot;)=&quot;a&quot;
 <br /> application.contents(2)=128 '也可写为application.contents(&quot;b&quot;)=128
 <br /> application.contents(3)=false '也可写为application.contents(&quot;c&quot;)=false
</div> 
<div> 
</div> 
<div>
  在此笔者推荐你在调用时使用类如application.contents(&quot;a&quot;)的方法，因为这样更为直观，如果用序号来表示的话则要考虑赋值的先后顺序。
</div> 
<div> 
</div> 
<div>
  ⒉Application对象的方法
</div> 
<div> 
</div> 
<div>
  Contents.Remove(&quot;变量名&quot;)：从Application.Contents集合中删除指定的变量
 <br /> Contents.RemoveAll() ：把Application.Contents集合中的所有变量删除
 <br /> Lock() ：锁定Application对象，使得只有当前的ASP页对内容能进行访问
 <br /> Unlock() ：解除对Application对象的锁定
 <br /> 例：在default.asp中：
 <br /> application(&quot;a&quot;)=&quot;a&quot;
 <br /> application(&quot;b&quot;)=128
 <br /> application(&quot;c&quot;)=false
 <br /> response.write application.contents(1)&amp;amp;&quot;
 <br /> &quot;
 <br /> response.write application.contents(2)&amp;amp;&quot;
 <br /> &quot;
 <br /> response.write application.contents(3)&amp;amp;&quot;
 <br /> &quot;
 <br /> response.write &quot;After Remove b:&quot;
 <br /> application.contents.remove(&quot;b&quot;)
 <br /> response.write application.contents(1)&amp;amp;&quot;
 <br /> &quot;
 <br /> response.write application.contents(2)&amp;amp;&quot;
 <br /> &quot;
</div> 
<div> 
</div> 
<div>
  执行结果：
 <br /> a
 <br /> 128
 <br /> False
 <br /> After Remove b:
 <br /> a
 <br /> False
 <br /> 如果要删除集合中所有变量用application.contents.removeall即可，至于Lock和Unlock方法在实际中经常用到，读者也比较熟悉，在此就不在累赘。
</div> 
<div> 
</div> 
<div>
  ⒊Application对象事件
</div> 
<div> 
</div> 
<div>
  OnStart：第一个访问服务器的用户第一次访问某一页面时发生
 <br /> OnEnd ：当最后一个用户的会话已经结束并且该会话的OnEnd事件所有代码已经执行完毕后发生，或最后一个用户访问服务器一段时间（一般为20分钟）后仍然没有人访问该服务器产生。
 <br /> 想要定义application对象的OnStart和OnEnd事件里做什么需要将代码写在Global.asa这个文件里（下文有举例），并且将该文件放在站点的根目录下（一般是Inetpub\wwwroot\）
</div> 
<div> 
</div> 
<div>
  二、Session对象的成员概述
</div> 
<div> 
</div> 
<div>
  Session对象的成员比Application对象多一项属性，即：集合、属性、方法、事件
</div> 
<div> 
</div> 
<div>
  ⒈Session对象的集合
</div> 
<div> 
</div> 
<div>
  Contents ：没有使用元素定义的存储于特定Session对象的所有变量的集合。
 <br /> StaticObject：使用元素定义的、存储于Session对象中的所有变量的集合。
 <br /> 例：在default.asp中有如下赋值
 <br /> session(&quot;a&quot;)=&quot;a&quot;
 <br /> session(&quot;b&quot;)=128
 <br /> session(&quot;c&quot;)=false
</div> 
<div> 
</div> 
<div>
  则有contents集合
 <br /> session.contents(1)=&quot;a&quot; '也可写为session.contents(&quot;a&quot;)=&quot;a&quot;
 <br /> session.contents(2)=128 '也可写为session.contents(&quot;b&quot;)=128
 <br /> session.contents(3)=false '也可写为session.contents(&quot;c&quot;)=false
</div> 
<div> 
</div> 
<div>
  ⒉Session对象的属性
</div> 
<div> 
</div> 
<div>
  CodePage: 可读/可写。整型。定义用于在浏览器中显示页内容的代码页。代码页是字符集的数字值，不同的语言使用不同的代码页。例如，ANSI代码页为1252，日文代码页为932，简体中文代码页为936。
 <br /> LCID : 可读/可写。整型。定义发送给浏览器的页面地区标识。LCID是唯一地标识地区的一个国际标准缩写，例如，2057定义当前地区的货币符号是&quot;￡&quot;。
 <br /> SessionID: 只读。长整型。返回本会话的会话标识符。每创建一个会话，由服务器自动分配一个标识符。可以根据它的值判断两个用户是谁先访问服务器。
 <br /> Timeout : 可读/可写。整型。为会话定义以分钟为单位的超时限定。如果用户在这个时间内没有刷新或请求任何一个网页，则该用户产生的会话自动结束。缺省值是20。
 <br /> 以上属性在实际应用中作用不大，而且基本上不需要怎么修改，这几个属性也没什么特殊的地方。
</div> 
<div> 
</div> 
<div>
  ⒊Session对象的方法
</div> 
<div> 
</div> 
<div>
  Contents.Remove(&quot;变量名&quot;): 从Session.contents集合中删除指定的变量
 <br /> Contents.Removeall() : 删除Session.contents集合中的所有变量
 <br /> Abandon() : 结束当前用户会话并且撤消当前Session对象。
 <br /> Session对象的Contents.Remove(&quot;变量名&quot;)和Contents.Removeall()方法与Application对象的基本上没什么区别，为帮助理解，大家可以参照上面的例子将Application改为Session。这里要说明一下的是Contents.Removeall()和Abandon()的区别，执行这两个方法都会释放当前
 <br /> 用户会话的所有Session变量，不同的是Contents.Removeall()单纯地释放Session变量的值而不终止当前的会话，而Abandon()除了释放Session变量外还会终止会话引发Session_OnEnd事件，希望大家注意两者的区别。
</div> 
<div> 
</div> 
<div>
  ⒋Session对象的事件
</div> 
<div> 
</div> 
<div>
  OnStart: 当ASP用户会话产生时触发，一旦有任一用户对本服务器请求任一页面即产生该事件。
 <br /> OnEnd : 当ASP用户会话结束时触发，当使用Abandon()方法或超时也会触发该事件。
 <br /> 这两个事件和Application的OnStart、OnEnd事件一样，也是必须放在Global.asa文件里，下
 <br /> 面就重点和大家研究一下这四个事件的使用。
</div> 
<div> 
</div> 
<div>
  三、Global.asa
</div> 
<div> 
</div> 
<div>
  ASP的Application和Session对象体现了其他ASP内置对象所没有的特征--事件。每一个访客访问服务器时都会触发一个OnStart事件（第一个访客会同时触发Application和Session的OnStart事件，但Application先于Session），每个访客的会话结束时都会触发一个OnEnd事件（最后一个访客会话结束时会同时触发Application和Session的OnEnd事件，但Session先于Application）。
</div> 
<div> 
</div> 
<div>
  OnStart和OnEnd这两个事件一般应用在虚拟社区中统计在线人数、修改用户的在线离线状态等。要具体定义这两个事件，需要将代码写在Global.asa文件，并将该文件放在站点的根目录下（缺省是\Inetpub\wwwroot\）。另外，Application和Session对象规定了在OnEnd事件里除了Application对象外其他ASP内置对象（Response、Request、Server、Session...）一概不能使用。以下举一个虚拟社区统计在线人数的例子来说明如何使用这两个事件。
</div> 
<div> 
</div> 
<div>
  文件说明：
 <br /> global.asa 位于d:\Inetpub\wwwroot\目录下
 <br /> default.asp 位于d:\Inetpub\wwwroot\目录下，虚拟社区登录页面
 <br /> login.asp 位于d:\Inetpub\wwwroot\目录下，用于检测用户输入的用户名及密码
 <br /> index.asp 位于d:\Inetpub\wwwroot\目录下，虚拟社区首页
 <br /> bbs.mdb 位于d:\Inetpub\wwwroot\目录下，存储用户信息的数据库
</div> 
<div> 
</div> 
<div>
  数据库（ACCESS）结构：
 <br /> ===bbs表===
 <br /> id 用户ID，长整型
 <br /> name 用户名，文本型
 <br /> code 密码，文本型
 <br /> online 在线状态，是/否
 <br /> ===global.asa===
 <br /> ＜script LANGUAGE=&quot;VBScript&quot; RUNAT=&quot;Server&quot;＞
 <br /> Sub Application_OnStart
 <br /> application(&quot;online&quot;)=0
 <br /> End Sub 
 <br /> sub Application_OnEnd
 <br /> nd Sub 
 <br /> Sub Session_OnStart 
 <br /> End Sub 
 <br /> Sub Session_OnEnd 
 <br /> if session.contents(&quot;pass&quot;) then '判断是否为登录用户的Session_OnEnd
 <br /> application.lock
 <br /> application(&quot;online&quot;)=application(&quot;online&quot;)-1
 <br /> application.unlock
 <br /> end if
 <br /> End Sub 
 <br /> ＜/script＞
 <br /> ===login.asp===
 <br /> ......'密码验证，连接数据库，检测用户输入的用户名及密码是否正确
 <br /> if 密码验证通过 then
 <br /> session(&quot;name&quot;)=rs(&quot;name&quot;)
 <br /> session(&quot;id&quot;)=rs(&quot;id&quot;)
 <br /> session(&quot;pass&quot;)=true
 <br /> else
 <br /> rs.close
 <br /> conn.close
 <br /> response.write &quot;密码错误！&quot;
 <br /> response.end
 <br /> end if
 <br /> application.lock
 <br /> application(&quot;online&quot;)=application(&quot;online&quot;)+1
 <br /> conn.Execute (&quot;update bbs set online=1 where id=&quot;&amp;amp;session(&quot;id&quot;))'将用户的状态设为在线
 <br /> application.unlock
 <br /> rs.close
 <br /> conn.close
 <br /> response.redirect &quot;index.asp&quot; '初始化数据后跳转到社区首页
 <br /> ===========
</div> 
<div> 
</div> 
<div>
  在本例中，用application(&quot;online&quot;)变量记录已经登录社区的在线人数，因为一旦有用户访问服务器而不管用户是否登录，都会产生OnStart事件，所以不能在OnStart事件里使Applicaiton(&quot;online&quot;)加一。因为不管是否是登录用户的会话结束都会产生OnEnd事件（假如有访客访问了服务器但并不登录社区，他的会话结束后也会产生OnEnd事件），所以在Session_OnEnd事件里用了句if语句来判断是否为已登录用户的OnEnd事件，如果是才将在线人数减一。
 <br /> 这只是一个统计在线人数的简单例子，对于一个完整的虚拟社区来说，仅仅统计有多少人在线是不够的，在本例中数据库里有个online字段是用来记录用户的在线状态，用户登录的时候，在login.asp里将online设为1，但用户离线时并没有将online设为0，要完善它，就要修改一下Session_OnEnd事件，在该事件里将online设为0。
 <br /> ===ｇｌｏｂａｌ．ｓａｓ===
 <br /> ＜script LANGUAGE=&quot;VBScript&quot; RUNAT=&quot;Server&quot;＞
 <br /> Sub Application_OnStart
 <br /> application(&quot;online&quot;)=0
 <br /> set application(&quot;conn&quot;)=Server.CreateObject(&quot;ADODB.Connection&quot;) 
 <br /> application(&quot;db&quot;)=Server.MapPath(&quot;\bbs.mdb&quot;) '此处最好使用绝对路径\bbs.mdb，下文有详细介绍
 <br /> End Sub 
 <br /> sub Application_OnEnd
 <br /> set application(&quot;conn&quot;)=nothing
 <br /> End Sub 
 <br /> Sub Session_OnStart 
 <br /> End Sub 
 <br /> Sub Session_OnEnd 
 <br /> if session.contents(&quot;pass&quot;) then '判断是否为登录用户的Session_OnEnd
 <br /> application(&quot;con&quot;).open =&quot;driver={Microsoft Access Driver (*.mdb)};dbq=&quot;&amp;amp;application(&quot;db&quot;)
 <br /> application.lock
 <br /> application(&quot;online&quot;)=application(&quot;online&quot;)-1
 <br /> application(&quot;con&quot;).Execute (&quot;update friends set online=0 where id=&quot;&amp;amp;session.contents(&quot;id&quot;))
 <br /> application.unlock
 <br /> application(&quot;con&quot;).close
 <br /> end if
 <br /> End Sub 
 <br /> ＜／script＞
 <br /> ==============
</div> 
<div> 
</div> 
<div>
  至此，完整的代码已经完成了。因为在Application和Session的OnEnd事件里不能使用Server对象，所以要将数据库的连接及数据库在服务器上的物理地址（d:\inetpub\wwwroot\bbs.mdb）存储在application变量中，并在Application_OnStart事件中预先处理。同理，在Session_OnEnd事件中不能用session(&quot;pass&quot;)来代替session.contents(&quot;pass&quot;)（以下有详尽说明）。
 <br /> 四、本文实例中值得引起注意的两点
</div> 
<div> 
</div> 
<div>
  ⒈OnEnd事件里的session.contents
 <br /> 刚开始接触global.asa的朋友经常会将上面Session_OnEnd事件里的
 <br /> if session.contents(&quot;pass&quot;) then 写成
 <br /> if session(&quot;pass&quot;) then，
</div> 
<div> 
</div> 
<div>
  这样的话系统不会提示错误，但是永远也不会执行then后面的内容，这是因为在OnEnd事件里禁止使用Session对象，但是可以用Session对象的集合来调用session变量。因为IIS并没提示任何错误信息，所以笔者曾经在这上面浪费了很多时间。在此希望大家引以为鉴！
 <br /> ⒉Application_OnStart事件里用Server.MapPath获取数据库的物理地址时应使用绝对地址为了说明这个问题，大家可以做个实验：将上面Application_OnStart事件里的
 <br /> application(&quot;db&quot;)=Server.MapPath(&quot;\bbs.mdb&quot;)改为:
 <br /> application(&quot;db&quot;)=Server.MapPath(&quot;bbs.mdb&quot;)
</div> 
<div> 
</div> 
<div>
 然后在d:\inetpub\wwwroot\目录下建立一个test子目录，写一个temp.asp在test目录里。
 <br /> ====test.asp====
 <br /> ＜％response.write application(&quot;db&quot;)％＞
 <br /> ================
</div> 
<div> 
</div> 
<div>
 再将temp.asp拷贝一份放在根目录下（d:\inetpub\wwwroot\）。用记事本打开global.asa，再打开两个浏览器，浏览器A输入地址
 <a href="http://localhost/temp.asp">http://localhost/temp.asp</a>，按回车，将在浏览器上输出：
 <br /> d:\inetpub\wwwroot\bbs.mdb
</div> 
<div> 
</div> 
<div>
 然后，在记事本的窗口上点&quot;文件&quot;菜单，选&quot;保存&quot;（使global.asa的修改时间改变，从而使IIS重启动所有服务），再在浏览器B输入地址
 <a href="http://localhost/test/temp.asp">http://localhost/test/temp.asp</a>，按回车，在浏览器上输出的是：
 <br /> d:\inetpub\wwwroot\test\bbs.mdb
</div> 
<div> 
</div> 
<div>
 global.asa文件虽然是放在站点根目录下，但是如果在server.mappath中使用的是相对地址，而触发Application_OnStart事件的用户第一次访问的页面又不是属于根目录的话，得到数据库的物理地址将不会是期望的结果，希望大家要特别小心。
</div> 
<div> 
</div> 
<div>
 类别：Web | 编辑 | 删除
</div> 
<div> 
</div> 
<div>
 | 评论(0) | 浏览(0)
</div> 
<div> 
</div> 
<div>
 全面解析ASP Server对象
 <br /> 2007-07-27 12:40
 <br /> Server对象提供对服务器上访问的方法和属性.大多数方法和属性是作为实用程序的功能提供的。 
 <br /> 语法:
 <br /> Server.property|method
 <br /> 属性（property）
 <br /> Server对象只有一个属性：ScriptTimeout 程序能够运行的最大时间 
 <br /> 方法（Methods）
 <br /> CreateObject 建立一个对象实例. 
 <br /> Execute 执行一个asp文件 
 <br /> GetLastError 返回一个错误代码 
 <br /> HTMLEncode 对指定的HTML代码进行转换. 
 <br /> MapPath 将一个相对路径转化为一个绝对路径. 
 <br /> Transfer 将当前的所有状态信息发送给另一个asp文件 
 <br /> URLEncode 以URL形式转化指定的代码,包括空格 
 <br /> Server对象的方法详细说明
 <br /> CreateObject
 <br /> 语法
 <br /> Server.CreateObject( progID )
 <br /> 参数
 <br /> progID 
 <br /> 指定要创建的组件名称,格式如下: [Vendor.]Component[.Version]. 
 <br /> 要点：
 <br /> 一般来说,用由Server.CreateObject方法创建的对象拥有页面的范围.这就说,当这页的asp程序执行完后,这种对象会自动地消失.
 <br /> 为了创建一个拥有Session或Application范围的对象,你可以在Global.asa文件中使用
 <br /> Execute
 <br /> Execute 方法呼叫一个ASP文件并且执行它就像这个呼叫的ASP文件存在这个ASP文件中一样。这很像许多语言中的类的调用。 
 <br /> 语法
 <br /> Server.Execute( Path )
 <br /> 参数
 <br /> Path 
 <br /> 指定执行的那个asp文件的路径。如是它是一个绝对路径，那么它必须是一个在这个ASP应用程序相同的地方（目录）。 
 <br /> 讲解
 <br /> Server.Execute 方法提供了一种将一个复杂ASP应用程序分化为小块单位来执行的方法。通过这种方法，你能够建一个ASP图书馆，你能够随便在你需要时调用你图书馆中的ASP文件。这个就有点像SSI了！嘿嘿！
 <br /> 当IIS根据指定的ASP文件路径执行完这个ASP文件之后，就会自动返回以前的ASP文件。这个刚刚执行完的ASP文件有可能改变了HTTP head.但是和其它的ASP文件一样，当程序试图改变http head时，就会报错！
 <br /> 这个path参数可以包括一个询问信息。
 <br /> 如果在被呼叫和呼叫的ASP文件中都含有相同的子函数，那么这些子函数只在本ASP文件中起作用。举个例子，如果在下面的ASP1和ASP2两个文件中都含有放弃程序的子函数。首先ASP1呼叫ASP2，那么ASP2中的的OnTransactionAbort开始执行，当ASP2执行完毕，ASP1中的OnTransactionAbort才开始执行。
 <br /> 
 <br /> ASP1:
 <br /> ＜ %@ Transaction=
 <br /> Required
 <br /> %＞
 <br /> ＜ % 
 <br /> Server.Execute (&quot;Page22.asp&quot;) 
 <br /> Sub OnTransactionAbort
 <br /> Sub OnTransactionCommit
 <br /> %＞
 <br /> 
 <br /> Asp2.asp:
 <br /> ＜ %@ 
 <br /> Transaction=Required
 <br /> Sub OnTransactionAbort
 <br /> Sub OnTransactionCommit
 <br /> %＞
</div> 
<div> 
</div> 
<div>
  Example
 <br /> 
 <br /> ASP1
 <br /> ＜ % Response.Write(&quot;I am going to execute ASP2 &quot;)
 <br /> Server.Execute(&quot;/myasps/asp2.asp&quot;)
 <br /> %＞
 <br /> ASP2
 <br /> ＜ % Response.Write(&quot;Here I am&quot;)%＞
</div> 
<div> 
</div> 
<div>
  GetLastError
 <br /> GetLastError 方法返回一个ASPError Object 来描述一个错误信息.这个方法只适用于在asp文件发送任何内容给用户机之前.
 <br /> 语法
 <br /> Server.GetLastError () 
 <br /> 要点
 <br /> 如果一个500;100 用户错误已经被定义在一个asp应用程序中，它是指的一个以.asp为后缀的文件。这种情况下，在这个程序运行时当一个错误发生时，服务器就会自动的以Server.Transfer这种方式传送到这个正在执行的ASP页面。ASP应用程序就会将有效的处理这个错误。另外，这个ASPError Object一定要有效，这样你就能够看到服务器提供给你的错误信息来改这个文件了！
 <br /> 一般的Web Site 都是根据文件\iishelp\common\500-100.asp来构造的。你能够用它来执行一个asp错误，当然你能够自己定义了！。如果你想改变为另外一个asp文件的来执行这些用户错误。那么你可以用IIS中的snap-in. 
 <br /> 注意：当IIS发现了一个asp文件或者global.asa文件中的一个错误，那么一个500;100用户错误产生。以下的程序将不能执行！ 
 <br /> Example
 <br /> 下面的三个例子证明不同的错误会产生的用户错误。三个错误是： 
 <br /> 编译错误 
 <br /> 运行错误 
 <br /> 逻辑错误 
 <br /> 第一个例子证明了一个编译错误，就是当IIS试图包含一个文件时产生的。这个错误会产生是因为在这个包含文件中没有定义所需的参数。第二个例子显示的是一个运行错误，这个程序中断的原因是程序中没有“next&quot;.第三个例子显示的是一个逻辑错误，因为这个程序试图除以一个0. 不行啦！ 
 <br /> 
 <br /> Example 1
 <br /> ＜ %
 <br /> response.write &quot;hello&quot;
 <br /> %＞
 <br /> Example 2
 <br /> ＜ %
 <br /> dim I
 <br /> for i=1 to 1
 <br /> nxt
 <br /> %＞
 <br /> Example 3
</div> 
<div> 
</div> 
<div>
 ＜ %
 <br /> dim i,j
 <br /> dim sum
 <br /> sum=0
 <br /> j=0
 <br /> for i=1 to 10
 <br /> sum=sum+1
 <br /> next
 <br /> sum=sum/j
 <br /> %＞
 <br /> HTMLEncode
 <br /> HTMLEncode方法对指定的字符串进行HTML编码. 
 <br /> 语法
 <br /> Server.HTMLEncode( string )
 <br /> 参数
 <br /> string 要进行编码的字符 
 <br /> 例子
 <br /> 下面的程序:
 <br /> ＜ %= Server.HTMLEncode(&quot;The paragraph tag: &quot;) %＞
</div> 
<div> 
</div> 
<div>
  输出为:
 <br /> The paragraph tag: 
 <br /> 注意 程序执行后在浏览器中看到的是:
 <br /> The paragraph tag: 
 <br /> 但是如果你用&quot;查看源文件&quot;看一下的话,源代码就不是了.
 <br /> MapPath
 <br /> MapPath 方法将相对路径转化为服务器上的物理路径 
 <br /> 语法
 <br /> Server.MapPath( Path )
</div> 
<div> 
</div> 
<div>
  参数 
 <br /> Path 
 <br /> 相对路径。这个路径是以&quot;/&quot;或&quot;\&quot;开头的路径，如果这个路径中没有&quot;\&quot;,那么MapPath方法就会返回以当前目录为基础的路径。 
 <br /> 讲解
 <br /> MapPath 方法不能检查路径在这个服务器下是否存在。因为 MapPath 转化路径时是不管这个路径是否在这个服务器下存在的。 
 <br /> 你能够用它来将一个相对路径转化为一个物理路径，然后再在这个路径下进行各种操作。 
 <br /> Example
 <br /> 在下面的例子中，data.txt文件存在 C:\Inetpub\Wwwroot\Script 目录中，而且一个test.asp 文件包括下面的代码。C:\Inetpub\Wwwroot 是该服务器的主目录 。
 <br /> 下面的例子中，首先用环境变量&quot;PATH_INFO&quot;获得当前文件的物理路径。
 <br /> 下面是Script 代码：
 <br /> ＜ %= server.mappath(Request.ServerVariables(&quot;PATH_INFO&quot;))%＞
</div> 
<div> 
</div> 
<div>
  显示为：
 <br /> c:\inetpub\wwwroot\script\test.asp
 <br /> 因为下面的例子中路径参数没有以&quot;/&quot;开头，所以它是以当前目录转化的，asp文件是放在C:\Inetpub\Wwwroot\Script中的.以下是 scripts的内容：
 <br /> ＜ %= server.mappath(&quot;data.txt&quot;)%＞
 <br /> ＜ %= server.mappath(&quot;script/data.txt&quot;)%＞
</div> 
<div> 
</div> 
<div>
  显示为：
 <br /> c:\inetpub\wwwroot\script\data.txt
 <br /> c:\inetpub\wwwroot\script\script\data.txt
</div> 
<div> 
</div> 
<div>
  以下的两个例子是以&quot;/&quot;开头的.以下是scripts的内容：
 <br /> ＜ %= server.mappath(&quot;\script&quot;)%＞
</div> 
<div> 
</div> 
<div>
  显示为：
 <br /> c:\inetpub\wwwroot\script\data.txt
 <br /> c:\inetpub\wwwroot\script
</div> 
<div> 
</div> 
<div>
  直接用&quot;/&quot;或&quot;\&quot;就会得到服务器的主目录：
 <br /> ＜ %= server.mappath(&quot;\&quot;)%＞
</div> 
<div> 
</div> 
<div>
  显示为：
 <br /> 
 <br /> c:\inetpub\wwwroot
 <br /> c:\inetpub\wwwroot
</div> 
<div> 
</div> 
<div>
  Transfer
 <br /> transfer 方法会把一个正在执行的asp文件的所有信息传给另外一人asp文件。 
 <br /> 语法
 <br /> Server.Transfer (path)
</div> 
<div> 
</div> 
<div>
  参数
 <br /> Path 
 <br /> 将要接收信息的asp文件的位置。 
 <br /> 要点
 <br /> 当你调用Server.Transfer时，所有内建对象的状态信息都会包含在这次传送之中。这就是说，所有在保存在Session或Application中的信息都会被传送，而且，所有当前请求的信息都会被接收信息的asp文件所接受。
 <br /> Example
 <br /> 下面的例子示范了从一个asp文件传送到另一个asp文件例子！
 <br /> ASP1
</div> 
<div> 
</div> 
<div>
 ＜ % Dim sessvar1 Response.Write Session.SessionID
 <br /> Response.Write (&quot;&quot;)
 <br /> Response.Write(&quot;I am going to ASP2 &quot;)
 <br /> Server.
 <br /> Transfer
 <br /> (&quot;/Myasps/ASP2.asp&quot;)
 <br /> % ＞
 <br /> 
 <br /> ASP2
 <br /> ＜ % Response.Write Session.SessionID %＞ 
 <br /> URLEncode
 <br /> URLEncode 方法可以将指定字符串进行URL编码。 
 <br /> 语法
 <br /> Server.URLEncode( string )
</div> 
<div> 
</div> 
<div>
  参数 
 <br /> string 指定要转化的字符串 
 <br /> Example
 <br /> 下面是代码：
 <br /> ＜ % Respones.Write(Server.URLEncode(&quot;
 <a href="http://www.microsoft.com">http://www.microsoft.com</a>&quot;)) % ＞
</div> 
<div> 
</div> 
<div>
  显示为：
 <br /> http%3A%2F%2Fwww%2Emicrosoft%2Ecom 
 <br /> 属性：ScriptTimeout
 <br /> ScriptTimeout 属性规定了程序的最大运行时间。 
 <br /> 语法
 <br /> Server.ScriptTimeout = NumSeconds
</div> 
<div> 
</div> 
<div>
  参数
 <br /> NumSeconds 
 <br /> 规定了程序的最大的运行时间（以秒计算）。缺省值是90秒 
 <br /> Remarks
 <br /> 一个缺省的Scritpt Timeout的值会能过ASPScriptTimeOUT属性来设置在Web sertvic 或 Web server上。在程序中，ScriptTimeout属性的值不能小于这个缺省值。举个例子吧，如果NumSeconds我们设置为10秒，而缺省值为90秒，那么程序就会中止在90秒以后，而不是10秒以后的。同样，如果我们设置ScriptTimeout的值为100秒，那么，程序就会在100秒之后中止，而不是90秒。
 <br /> Example
 <br /> 下面的例了中程序将被设置为100秒后自动中止。
 <br /> ＜ % Server.ScriptTimeout = 100 %＞
</div> 
<div> 
</div> 
<div>
  下面的例子中将重新得到ScriptTimeout的值，然后把它存在Timout变量中
 <br /> ＜ % TimeOut = Server.ScriptTimeout %＞
</div></div></body></html>