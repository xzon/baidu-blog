<html><head><title>Constraints -Schema</title></head><body><div id='tit'>Constraints -Schema</div><div id='cate'>编程基础</div><div id='date'>2009年08月15日 星期六 05:01 P.M.</div><div id='page'>38</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/6379fb1f76c52103314e15c1.html'>http://hi.baidu.com/hxzon/blog/item/6379fb1f76c52103314e15c1.html</a><div id='cnt'><p> </p> 
<p>Constraints -Schema</p> 
<h3><a name="constraints">Constraints</a></h3> 
<h4>Unique</h4> 
<p>W3C XML Schema provides several flexible XPath-based features for describing uniqueness constraints and corresponding references constraints. The first of these, a simple uniqueness declaration, is declared with the <code><font face="新宋体">xs:unique</font></code> element. The following declaration done under the declaration of our book element indicates that the character name must be unique:</p> 
<pre>&lt;xs:unique name=&quot;charName&quot;&gt;
      &lt;xs:selector xpath=&quot;character&quot;/&gt;
      &lt;xs:field xpath=&quot;name&quot;/&gt;
    &lt;/xs:unique&gt;</pre> 
<p>This location of the <code><font face="新宋体">xs:unique</font></code> element in the schema gives the context node in which the constraint holds. By inserting <code><font face="新宋体">xs:unique</font></code> under our book element, we specify that the character has to be unique within the context of this book only.</p> 
<p>The two XPaths defined in the uniqueness constraint are evaluated relative to the context node. The first of these paths is defined by the <code><font face="新宋体">selector</font></code> element. The purpose is to define the element which has the uniqueness constraint -- the node to which the selector points must be an element node.</p> 
<p>The second path, specified in the <code><font face="新宋体">xs:field</font></code> element is evaluated relative to the element identified by the <code><font face="新宋体">xs:selector</font></code>, and can be an element or an attribute node. This is the node whose value will be checked for uniqueness. Combinations of values can be specified by adding other <code><font face="新宋体">xs:field</font></code> elements within <code><font face="新宋体">xs:unique</font></code>.</p> 
<h4>Keys</h4> 
<p>The second construct, <code><font face="新宋体">xs:key</font></code>, is similar to <code><font face="新宋体">xs:unique</font></code> except that the value has to be non null (note that <code><font face="新宋体">xs:unique</font></code> and <code><font face="新宋体">xs:key</font></code> can both be referenced). To use the character name as a key, we can just replace the <code><font face="新宋体">xs:unique</font></code> by <code><font face="新宋体">xs:key</font></code>:</p> 
<pre>&lt;xs:key name=&quot;charName&quot;&gt;
  &lt;xs:selector xpath=&quot;character&quot;/&gt;
  &lt;xs:field xpath=&quot;name&quot;/&gt;
&lt;/xs:key&gt;</pre> 
<h4>Keyref</h4> 
<p>The third construct, <code><font face="新宋体">xs:keyref</font></code>, allows us to define a reference to a <code><font face="新宋体">xs:key</font></code> or a <code><font face="新宋体">xs:unique</font></code>. To show its usage, we will introduce the <code><font face="新宋体">friend-of</font></code> element, to be used against characters:</p> 
<pre>&lt;character&gt;
  &lt;name&gt;Snoopy&lt;/name&gt;
  &lt;friend-of&gt;Peppermint Patty&lt;/friend-of&gt;
  &lt;since&gt;1950-10-04&lt;/since&gt;
  &lt;qualification&gt;
    extroverted beagle
  &lt;/qualification&gt;
&lt;/character&gt;</pre> 
<p>To indicate that <code><font face="新宋体">friend-of</font></code> needs to refer to a character from this same book, we will write, at the same level as we defined our key constraint, the following:</p> 
<pre>&lt;xs:keyref name=&quot;charNameRef&quot; refer=&quot;charName&quot;&gt;
  &lt;xs:selector xpath=&quot;character&quot;/&gt;
  &lt;xs:field xpath=&quot;friend-of&quot;/&gt;
&lt;/xs:keyref&gt;</pre> 
<p>These capabilities are almost independent of the other features in a schema. They are disconnected from the definition of the datatypes. The only point anchoring them to the schema is the place where they are defined, which establishes the scope of the uniqueness constraints.</p> 
<table>
 <tbody>
  <tr> 
  </tr> 
 </tbody>
 <tr>
  <td bgcolor="#5e5dc3" align="center" valign="top"> </td> 
 </tr>
 <p class="headline"><font color="#ffffff"><strong>Table of Contents</strong></font></p> 
 <tr> 
 </tr> 
 <tr>
  <td> </td> 
 </tr>
 <p class="secondary">•<a href="http://www.xml.com/pub/a/2000/11/29/schemas/part1.html?page=1#first_schema">Introducing Our First Schema</a><br /> •<a href="http://www.xml.com/pub/a/2000/11/29/schemas/part1.html?page=2#slicing">Slicing the Schema</a><br /> •<a href="http://www.xml.com/pub/a/2000/11/29/schemas/part1.html?page=3#defining">Defining Named Types</a><br /> •<a href="http://www.xml.com/pub/a/2000/11/29/schemas/part1.html?page=4#groups">Groups, Compositors and Derivation</a><br /> •<a href="http://www.xml.com/pub/a/2000/11/29/schemas/part1.html?page=5#content_types">Content Types</a><br /> •<a href="http://www.xml.com/pub/a/2000/11/29/schemas/part1.html?page=6#constraints">Constraints</a><br /> •<a href="http://www.xml.com/pub/a/2000/11/29/schemas/part1.html?page=7#building_usable">Building Usable and Reusable Schemas</a><br /> •<a href="http://www.xml.com/pub/a/2000/11/29/schemas/part1.html?page=8#namespaces">Namespaces</a><br /> •<a href="http://www.xml.com/pub/a/2000/11/29/schemas/part1.html?page=9#w3c">W3C XML Schema and Instance Documents</a><br /> •<a href="http://www.xml.com/pub/a/2000/11/29/schemas/dataref.html">W3C XML Schema Datatypes Reference</a><br /> •<a href="http://www.xml.com/pub/a/2000/11/29/schemas/structuresref.html">W3C XML Schema Structures Reference</a></p> 
 <p class="secondary"><a href="http://www.xml.com/pub/a/2000/11/29/schemas/part1.html?page=6">http://www.xml.com/pub/a/2000/11/29/schemas/part1.html?page=6</a></p>
</table></div></body></html>