<html><head><title>/*Rsa1.java-pki实验-Java源代码</title></head><body><div id='tit'>/*Rsa1.java-pki实验-Java源代码</div><div id='cate'>计算机&middot;功课</div><div id='date'>2007年12月15日 星期六 11:02 P.M.</div><div id='page'>186</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/7bd4cc80cebffad49023d952.html'>http://hi.baidu.com/hxzon/blog/item/7bd4cc80cebffad49023d952.html</a><div id='cnt'><div>
 /*Rsa1.java-pki实验-Java源代码
 <br /> *
 <br /> *--------------------Configuration: &lt;Default&gt;--------------------
 <br /> 请输入素数p: 
 <br /> 37
 <br /> 请输入素数q: 
 <br /> 44
 <br /> 请输入素数q: 
 <br /> 491
 <br /> 这两个素数的乘积为p*q：18167
 <br /> 所得的小于Ｎ并且与Ｎ互素的整数的个数为m=(p-1)(q-1)：17640
 <br /> 请输入一个公钥的值，这个值要求小于m并且和m互质： 
 <br /> 673
 <br /> gcd:1
 <br /> gcd:1
 <br /> gcd:1
 <br /> gcd:1
 <br /> gcd:1
 <br /> gcd:1
 <br /> gcd:1
 <br /> gcd:1
 <br /> 公钥为：673
 <br /> value:&nbsp;&nbsp;&nbsp; 17641
 <br /> value:&nbsp;&nbsp;&nbsp; 35281
 <br /> value:&nbsp;&nbsp;&nbsp; 52921
 <br /> value:&nbsp;&nbsp;&nbsp; 70561
 <br /> value:&nbsp;&nbsp;&nbsp; 88201
 <br /> value:&nbsp;&nbsp;&nbsp; 105841
 <br /> value:&nbsp;&nbsp;&nbsp; 123481
 <br /> value:&nbsp;&nbsp;&nbsp; 141121
 <br /> value:&nbsp;&nbsp;&nbsp; 158761
 <br /> value:&nbsp;&nbsp;&nbsp; 176401
 <br /> value:&nbsp;&nbsp;&nbsp; 194041
 <br /> value:&nbsp;&nbsp;&nbsp; 211681
 <br /> value:&nbsp;&nbsp;&nbsp; 229321
 <br /> value:&nbsp;&nbsp;&nbsp; 246961
 <br /> value:&nbsp;&nbsp;&nbsp; 264601
 <br /> value:&nbsp;&nbsp;&nbsp; 282241
 <br /> value:&nbsp;&nbsp;&nbsp; 299881
 <br /> value:&nbsp;&nbsp;&nbsp; 317521
 <br /> value:&nbsp;&nbsp;&nbsp; 335161
 <br /> value:&nbsp;&nbsp;&nbsp; 352801
 <br /> value:&nbsp;&nbsp;&nbsp; 370441
 <br /> value:&nbsp;&nbsp;&nbsp; 388081
 <br /> value:&nbsp;&nbsp;&nbsp; 405721
 <br /> value:&nbsp;&nbsp;&nbsp; 423361
 <br /> value:&nbsp;&nbsp;&nbsp; 441001
 <br /> value:&nbsp;&nbsp;&nbsp; 458641
 <br /> value:&nbsp;&nbsp;&nbsp; 476281
 <br /> value:&nbsp;&nbsp;&nbsp; 493921
 <br /> value:&nbsp;&nbsp;&nbsp; 511561
 <br /> value:&nbsp;&nbsp;&nbsp; 529201
 <br /> value:&nbsp;&nbsp;&nbsp; 546841
 <br /> value:&nbsp;&nbsp;&nbsp; 564481
 <br /> value:&nbsp;&nbsp;&nbsp; 582121
 <br /> value:&nbsp;&nbsp;&nbsp; 599761
 <br /> value:&nbsp;&nbsp;&nbsp; 617401
 <br /> value:&nbsp;&nbsp;&nbsp; 635041
 <br /> value:&nbsp;&nbsp;&nbsp; 652681
 <br /> value:&nbsp;&nbsp;&nbsp; 670321
 <br /> value:&nbsp;&nbsp;&nbsp; 687961
 <br /> value:&nbsp;&nbsp;&nbsp; 705601
 <br /> value:&nbsp;&nbsp;&nbsp; 723241
 <br /> value:&nbsp;&nbsp;&nbsp; 740881
 <br /> value:&nbsp;&nbsp;&nbsp; 758521
 <br /> value:&nbsp;&nbsp;&nbsp; 776161
 <br /> value:&nbsp;&nbsp;&nbsp; 793801
 <br /> value:&nbsp;&nbsp;&nbsp; 811441
 <br /> value:&nbsp;&nbsp;&nbsp; 829081
 <br /> value:&nbsp;&nbsp;&nbsp; 846721
 <br /> value:&nbsp;&nbsp;&nbsp; 864361
 <br /> value:&nbsp;&nbsp;&nbsp; 882001
 <br /> value:&nbsp;&nbsp;&nbsp; 899641
 <br /> value:&nbsp;&nbsp;&nbsp; 917281
 <br /> value:&nbsp;&nbsp;&nbsp; 934921
 <br /> value:&nbsp;&nbsp;&nbsp; 952561
 <br /> value:&nbsp;&nbsp;&nbsp; 970201
 <br /> value:&nbsp;&nbsp;&nbsp; 987841
 <br /> value:&nbsp;&nbsp;&nbsp; 1005481
 <br /> value:&nbsp;&nbsp;&nbsp; 1023121
 <br /> value:&nbsp;&nbsp;&nbsp; 1040761
 <br /> value:&nbsp;&nbsp;&nbsp; 1058401
 <br /> value:&nbsp;&nbsp;&nbsp; 1076041
 <br /> value:&nbsp;&nbsp;&nbsp; 1093681
 <br /> value:&nbsp;&nbsp;&nbsp; 1111321
 <br /> value:&nbsp;&nbsp;&nbsp; 1128961
 <br /> value:&nbsp;&nbsp;&nbsp; 1146601
 <br /> value:&nbsp;&nbsp;&nbsp; 1164241
 <br /> value:&nbsp;&nbsp;&nbsp; 1181881
 <br /> value:&nbsp;&nbsp;&nbsp; 1199521
 <br /> value:&nbsp;&nbsp;&nbsp; 1217161
 <br /> value:&nbsp;&nbsp;&nbsp; 1234801
 <br /> value:&nbsp;&nbsp;&nbsp; 1252441
 <br /> value:&nbsp;&nbsp;&nbsp; 1270081
 <br /> value:&nbsp;&nbsp;&nbsp; 1287721
 <br /> value:&nbsp;&nbsp;&nbsp; 1305361
 <br /> value:&nbsp;&nbsp;&nbsp; 1323001
 <br /> value:&nbsp;&nbsp;&nbsp; 1340641
 <br /> value:&nbsp;&nbsp;&nbsp; 1358281
 <br /> value:&nbsp;&nbsp;&nbsp; 1375921
 <br /> value:&nbsp;&nbsp;&nbsp; 1393561
 <br /> value:&nbsp;&nbsp;&nbsp; 1411201
 <br /> value:&nbsp;&nbsp;&nbsp; 1428841
 <br /> value:&nbsp;&nbsp;&nbsp; 1446481
 <br /> value:&nbsp;&nbsp;&nbsp; 1464121
 <br /> value:&nbsp;&nbsp;&nbsp; 1481761
 <br /> value:&nbsp;&nbsp;&nbsp; 1499401
 <br /> value:&nbsp;&nbsp;&nbsp; 1517041
 <br /> value:&nbsp;&nbsp;&nbsp; 1534681
 <br /> value:&nbsp;&nbsp;&nbsp; 1552321
 <br /> value:&nbsp;&nbsp;&nbsp; 1569961
 <br /> value:&nbsp;&nbsp;&nbsp; 1587601
 <br /> value:&nbsp;&nbsp;&nbsp; 1605241
 <br /> value:&nbsp;&nbsp;&nbsp; 1622881
 <br /> value:&nbsp;&nbsp;&nbsp; 1640521
 <br /> value:&nbsp;&nbsp;&nbsp; 1658161
 <br /> value:&nbsp;&nbsp;&nbsp; 1675801
 <br /> value:&nbsp;&nbsp;&nbsp; 1693441
 <br /> value:&nbsp;&nbsp;&nbsp; 1711081
 <br /> value:&nbsp;&nbsp;&nbsp; 1728721
 <br /> value:&nbsp;&nbsp;&nbsp; 1746361
 <br /> value:&nbsp;&nbsp;&nbsp; 1764001
 <br /> value:&nbsp;&nbsp;&nbsp; 1781641
 <br /> value:&nbsp;&nbsp;&nbsp; 1799281
 <br /> value:&nbsp;&nbsp;&nbsp; 1816921
 <br /> value:&nbsp;&nbsp;&nbsp; 1834561
 <br /> value:&nbsp;&nbsp;&nbsp; 1852201
 <br /> value:&nbsp;&nbsp;&nbsp; 1869841
 <br /> value:&nbsp;&nbsp;&nbsp; 1887481
 <br /> value:&nbsp;&nbsp;&nbsp; 1905121
 <br /> value:&nbsp;&nbsp;&nbsp; 1922761
 <br /> 产生的一个私钥为：2857
 <br /> 请输入明文：//字母不成功
 <br /> 12345
 <br /> 输入明文为: 12345
 <br /> 所得的密文为：3806
 <br /> 解密后所得的明文为：12345
</div> 
<div> 
</div> 
<div>
 Process completed.
</div> 
<div> 
</div> 
<div>
 */
</div> 
<div> 
</div> 
<div>
 import java.io.*;
</div> 
<div> 
</div> 
<div>
 public class Rsa1 
 <br /> {
 <br /> private int p=0;
 <br /> private int q=0;
 <br /> private long n=0;
 <br /> private long m=0;
 <br /> &nbsp;&nbsp;&nbsp; 
 <br /> private long public_key=0;//公匙
 <br /> private long private_key=0;//密匙
 <br /> private long text=0;//明文
 <br /> private long secretword=0;//密文
 <br /> private long word=0;//解密后明文
 <br /> //判断是否为素数
 <br /> public boolean primenumber(long t)
 <br /> {
 <br /> long k=0;
 <br /> k=(long)Math.sqrt((double)t);
 <br /> boolean flag=true;
 <br /> outer:for(int i=2;i&lt;=k;i++)
 <br /> {
 <br /> if((t%i)==0)
 <br /> {
 <br /> flag = false;
 <br /> break outer;
 <br /> }
 <br /> }
 <br /> return flag;
 <br /> }
 <br /> //输入PQ
 <br /> public void inputPQ()throws Exception
 <br /> {
 <br /> do{
 <br /> System.out.println(&quot;请输入素数p: &quot;);
 <br /> BufferedReader stdin=new BufferedReader(new InputStreamReader(System.in));
 <br /> String br=stdin.readLine();
 <br /> this.p=Integer.parseInt(br);
 <br /> }
 <br /> while(!primenumber(this.p));
 <br /> do{
 <br /> System.out.println(&quot;请输入素数q: &quot;);
 <br /> BufferedReader stdin=new BufferedReader(new InputStreamReader(System.in));
 <br /> String br=stdin.readLine();
 <br /> this.q=Integer.parseInt(br);
 <br /> }
 <br /> while(!primenumber(this.q));
 <br /> this.n=this.p*this.q;
 <br /> this.m=(p-1)*(q-1);
 <br /> System.out.println(&quot;这两个素数的乘积为p*q：&quot;+this.n);
 <br /> System.out.println(&quot;所得的小于Ｎ并且与Ｎ互素的整数的个数为m=(p-1)(q-1)：&quot;+this.m);
 <br /> }
 <br /> //求最大公约数
 <br /> public long gcd(long a,long b)
 <br /> {
 <br /> long gcd;
 <br /> if(b==0)
 <br /> gcd=a;
 <br /> else
 <br /> gcd=gcd(b,a%b);
 <br /> System.out.println(&quot;gcd:&quot;+gcd);
 <br /> return gcd;
 <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <br /> }
 <br /> //输入公匙
 <br /> public void getPublic_key()throws Exception
 <br /> {
 <br /> do{
 <br /> System.out.println(&quot;请输入一个公钥的值，这个值要求小于m并且和m互质： &quot;);
 <br /> BufferedReader stdin=new BufferedReader(new InputStreamReader(System.in));
 <br /> String br=stdin.readLine();
 <br /> this.public_key=Long.parseLong(br);
 <br /> }
 <br /> while((this.public_key &gt;= this.m) || (this.gcd(this.m,this.public_key)!=1));
 <br /> System.out.println(&quot;公钥为：&quot;+this.public_key);
 <br /> }
 <br /> //计算得到密匙
 <br /> public void getPrivate_key()
 <br /> {
 <br /> long value=1;
 <br /> outer:for(long i=1;;i++)
 <br /> {
 <br /> value=i*this.m+1;
 <br /> System.out.println(&quot;value:&nbsp;&nbsp;&nbsp; &quot;+value);
 <br /> if((value%this.public_key==0)&amp;&amp; (value/this.public_key &lt; this.m))
 <br /> {
 <br /> this.private_key=value/this.public_key;
 <br /> break outer;
 <br /> }
 <br /> }
 <br /> System.out.println(&quot;产生的一个私钥为：&quot;+this.private_key);
 <br /> }
 <br /> //输入明文
 <br /> public void getText()throws Exception
 <br /> {
 <br /> System.out.println(&quot;请输入明文：&quot;);
 <br /> BufferedReader stdin=new BufferedReader(new InputStreamReader(System.in));
 <br /> String br=stdin.readLine();
 <br /> this.text=Long.parseLong(br);
 <br /> }
 <br /> //加密、解密计算
 <br /> public long colum(long y,long n,long key)
 <br /> {
 <br /> long mul;
 <br /> if(key==1)
 <br /> mul=y%n;
 <br /> else 
 <br /> mul=y*this.colum(y,n,key-1)%n;
 <br /> return mul;
 <br /> }
 <br /> &nbsp;&nbsp;&nbsp; 
 <br /> //加密后解密
 <br /> public void pascolum()throws Exception
 <br /> {
 <br /> this.getText();
 <br /> System.out.println(&quot;输入明文为: &quot;+this.text);
 <br /> //加密
 <br /> this.secretword=this.colum(this.text,this.n,this.public_key);
 <br /> System.out.println(&quot;所得的密文为：&quot;+this.secretword);
 <br /> //解密
 <br /> this.word=this.colum(this.secretword,this.n,this.private_key);
 <br /> System.out.println(&quot;解密后所得的明文为：&quot;+this.word);
 <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
 <br /> }
 <br /> public static void main(String []args)throws Exception
 <br /> {
 <br /> Rsa1 t = new Rsa1();
 <br /> t.inputPQ();
 <br /> t.getPublic_key();
 <br /> t.getPrivate_key();
 <br /> t.pascolum();
 <br /> }
 <br /> }
</div></div></body></html>