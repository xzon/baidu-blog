<html><head><title>Diffie-Hellman密钥交换算法及其优化</title></head><body><div id='tit'>Diffie-Hellman密钥交换算法及其优化</div><div id='cate'>计算机&middot;功课</div><div id='date'>2007年12月30日 星期日 12:32 P.M.</div><div id='page'>178</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/72929d50ea72cc668435243b.html'>http://hi.baidu.com/hxzon/blog/item/72929d50ea72cc668435243b.html</a><div id='cnt'><p align="center"><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="Times New Roman" size="5"><strong><font style="background-color: #ffffff"><strong style="color: black; background-color: #ffff66"><font style="background-color: #ffffff">Diffie</font></strong>-</font><strong style="color: black; background-color: #ffff66"><font style="background-color: #ffffff">Hellman</font></strong></strong></font><font face="宋体" size="5"><strong><strong style="color: black; background-color: #ffff66"><font style="background-color: #ffffff">密钥交换</font></strong>算法及其优化</strong></font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="宋体" size="2">首次发表的公开密钥算法出现在</font><font face="Times New Roman" size="2">Diffie</font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">Hellman</font><font face="宋体" size="2">的论文中，这篇影响深远的论文奠定了公开密钥密码编码学。由于该算法本身限于密钥交换的用途，被许多商用产品用作密钥交换技术，因此该算法通常称之为</font><font face="Times New Roman" size="2"></font><font style="background-color: #ffffff"><strong style="color: black; background-color: #ffff66"><font style="background-color: #ffffff">Diffie</font></strong>-</font><strong style="color: black; background-color: #ffff66"><font style="background-color: #ffffff">Hellman</font></strong><font face="宋体" size="2"><strong style="color: black; background-color: #ffff66"><font style="background-color: #ffffff">密钥交换</font></strong>。这种密钥交换技术的目的在于使得两个用户安全地交换一个秘密密钥以便用于以后的报文加密。</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2"><strong style="color: black; background-color: #ffff66"><font style="background-color: #ffffff">Diffie</font></strong>-<strong style="color: black; background-color: #ffff66"><font style="background-color: #ffffff">Hellman</font></strong></font><font face="宋体" size="2"><strong style="color: black; background-color: #ffff66"><font style="background-color: #ffffff">密钥交换</font></strong>算法的有效性依赖于计算离散对数的难度。简言之，可以如下定义离散对数：首先定义一个素数</font><font face="Times New Roman" size="2"><em>p</em></font><font face="宋体" size="2">的原根，为其各次幂产生从</font><font face="Times New Roman" size="2">1 </font><font face="宋体" size="2">到</font><font face="Times New Roman" size="2"><em>p</em>-1</font><font face="宋体" size="2">的所有整数根，也就是说，如果</font><font face="Times New Roman" size="2"><em>a</em></font><font face="宋体" size="2">是素数</font><font face="Times New Roman" size="2"><em>p</em></font><font face="宋体" size="2">的一个原根，那么数值</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em>a</em> mod <em>p</em>, <em>a</em><sup>2</sup> mod <em>p</em>, ..., <em>a</em><sup>p-1</sup> mod <em>p</em></font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">是各不相同的整数，并且以某种排列方式组成了从</font><font face="Times New Roman" size="2">1</font><font face="宋体" size="2">到</font><font face="Times New Roman" size="2"><em>p</em>-1</font><font face="宋体" size="2">的所有整数。</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="宋体" size="2">对于一个整数</font><font face="Times New Roman" size="2"><em>b</em></font><font face="宋体" size="2">和素数</font><font face="Times New Roman" size="2"><em>p</em></font><font face="宋体" size="2">的一个原根</font><font face="Times New Roman" size="2"><em>a</em></font><font face="宋体" size="2">，可以找到惟一的指数</font><font face="Times New Roman" size="2"><em>i</em></font><font face="宋体" size="2">，使得</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em>b</em> = <em>a</em><sup><em>i</em></sup> mod <em>p</em>&nbsp;&nbsp;&nbsp;&nbsp; </font><font face="宋体" size="2">其中</font><font face="Times New Roman" size="2">0 ≤ <em>i </em>≤ (<em>p</em>-1)</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">指数</font><font face="Times New Roman" size="2"><em>i</em></font><font face="宋体" size="2">称为</font><font face="Times New Roman" size="2"><em>b</em></font><font face="宋体" size="2">的以</font><font face="Times New Roman" size="2"><em>a</em></font><font face="宋体" size="2">为基数的模</font><font face="Times New Roman" size="2"><em>p</em></font><font face="宋体" size="2">的离散对数或者指数。该值被记为</font><font face="Times New Roman" size="2">ind<sub><em>a ,p</em></sub>(b)</font><font face="宋体" size="2">。</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="宋体" size="2">基于此背景知识，可以定义</font><font face="Times New Roman" size="2"><strong style="color: black; background-color: #ffff66">Diffie</strong>-<strong style="color: black; background-color: #ffff66">Hellman</strong></font><font face="宋体" size="2"><strong style="color: black; background-color: #ffff66">密钥交换</strong>算法。该算法描述如下：</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">1</font><font face="宋体" size="2">、有两个全局公开的参数，一个素数</font><font face="Times New Roman" size="2"><em>q</em></font><font face="宋体" size="2">和一个整数</font><font face="Symbol" size="2"><em>α</em></font><font face="宋体" size="2">，</font><font face="Symbol" size="2"><em>α</em></font><font face="宋体" size="2">是</font><font face="Times New Roman" size="2"><em>q</em></font><font face="宋体" size="2">的一个原根。</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">2</font><font face="宋体" size="2">、假设用户</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">希望交换一个密钥，用户</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">选择一个作为私有密钥的随机数</font><font face="Times New Roman" size="2">X<sub>A</sub>&lt;<em>q</em></font><font face="宋体" size="2">，并计算公开密钥</font><font face="Times New Roman" size="2">Y<sub>A</sub>=</font><font face="Symbol" size="2"><em>α</em></font><font face="Times New Roman" size="2"><sup>X</sup></font><font face="Times New Roman" size="1"><sup>A</sup></font><font face="Times New Roman" size="2"> mod <em>q</em></font><font face="宋体" size="2">。</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">对</font><font face="Times New Roman" size="2">X<sub>A</sub></font><font face="宋体" size="2">的值保密存放而使</font><font face="Times New Roman" size="2">Y<sub>A</sub></font><font face="宋体" size="2">能被</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">公开获得。类似地，用户</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">选择一个私有的随机数</font><font face="Times New Roman" size="2">X<sub>B</sub>&lt;<em>q</em></font><font face="宋体" size="2">，并计算公开密钥</font><font face="Times New Roman" size="2">Y<sub>B</sub>=</font><font face="Symbol" size="2"><em>α</em></font><font face="Times New Roman" size="2"><sup>X</sup></font><font face="Times New Roman" size="1"><sup>B</sup></font><font face="Times New Roman" size="2"> mod <em>q</em></font><font face="宋体" size="2">。</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">对</font><font face="Times New Roman" size="2">X<sub>B</sub></font><font face="宋体" size="2">的值保密存放而使</font><font face="Times New Roman" size="2">Y<sub>B</sub></font><font face="宋体" size="2">能被</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">公开获得。</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">3</font><font face="宋体" size="2">、用户</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">产生共享秘密密钥的计算方式是</font><font face="Times New Roman" size="2">K = (Y<sub>B</sub>)<sup>X</sup></font><font face="Times New Roman" size="1"><sup>A</sup></font><font face="Times New Roman" size="2"> mod <em>q</em></font><font face="宋体" size="2">。同样，用户</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">产生共享秘密密钥的计算是</font><font face="Times New Roman" size="2">K = (Y<sub>A</sub>)<sup>X</sup></font><font face="Times New Roman" size="1"><sup>B</sup></font><font face="Times New Roman" size="2"> mod <em>q</em></font><font face="宋体" size="2">。这两个计算产生相同的结果：</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; K = (Y<sub>B</sub>)<sup>X</sup></font><font face="Times New Roman" size="1"><sup>A</sup></font><font face="Times New Roman" size="2"> mod <em>q</em></font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = (</font><font face="Symbol" size="2"><em>α</em></font><font face="Times New Roman" size="2"><sup>X</sup></font><font face="Times New Roman" size="1"><sup>B</sup></font><font face="Times New Roman" size="2"> mod <em>q</em>)<sup>X</sup></font><font face="Times New Roman" size="1"><sup>A</sup></font><font face="Times New Roman" size="2"> mod <em>q</em></font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = (</font><font face="Symbol" size="2"><em>α</em></font><font face="Times New Roman" size="2"><sup>X</sup></font><font face="Times New Roman" size="1"><sup>B</sup></font><font face="Times New Roman" size="2">)<sup>X</sup></font><font face="Times New Roman" size="1"><sup>A</sup></font><font face="Times New Roman" size="2"> mod <em>q&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </em></font><font face="宋体" size="2">（根据取模运算规则得到）</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = </font><font face="Symbol" size="2"><strong><em>α</em></strong></font><font face="Times New Roman" size="2"><sup><strong>X</strong></sup></font><font face="Times New Roman" size="1"><sup><strong>B</strong></sup></font><font face="Times New Roman" size="2"><sup><strong>X</strong></sup></font><font face="Times New Roman" size="1"><sup><strong>A</strong></sup></font><font face="Times New Roman" size="2"><strong> mod <em>q</em></strong></font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2"><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </em>= (</font><font face="Symbol" size="2"><em>α</em></font><font face="Times New Roman" size="2"><sup>X</sup></font><font face="Times New Roman" size="1"><sup>A</sup></font><font face="Times New Roman" size="2">)<sup>X</sup></font><font face="Times New Roman" size="1"><sup>B</sup></font><font face="Times New Roman" size="2"> mod <em>q</em></font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = (</font><font face="Symbol" size="2"><em>α</em></font><font face="Times New Roman" size="2"><sup>X</sup></font><font face="Times New Roman" size="1"><sup>A</sup></font><font face="Times New Roman" size="2"> mod <em>q</em>)<sup>X</sup></font><font face="Times New Roman" size="1"><sup>B</sup></font><font face="Times New Roman" size="2"> mod <em>q</em></font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2"><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </em>= (Y<sub>A</sub>)<sup>X</sup></font><font face="Times New Roman" size="1"><sup>B</sup></font><font face="Times New Roman" size="2"> mod <em>q</em></font></p> 
<p align="justify"><font style="background-color: #ffffff" face="宋体" color="#000000" size="2">因此相当于双方已经交换了一个相同的秘密密钥。</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">4</font><font face="宋体" size="2">、因为</font><font face="Times New Roman" size="2">X<sub>A</sub></font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">X<sub>B</sub></font><font face="宋体" size="2">是保密的，一个敌对方可以利用的参数只有</font><font face="Times New Roman" size="2"><em>q</em></font><font face="宋体" size="2">、</font><font face="Symbol" size="2"><em>α</em></font><font face="宋体" size="2">、</font><font face="Times New Roman" size="2">Y<sub>A</sub></font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">Y<sub>B</sub></font><font face="宋体" size="2">。因而敌对方被迫取离散对数来确定密钥。例如，要获取用户</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">的秘密密钥，敌对方必须先计算</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X<sub>B</sub> = ind</font><font face="Symbol" size="2"><sub><em>α</em></sub></font><font face="Times New Roman" size="2"><sub><em> ,q</em></sub>(Y<sub>B</sub>)</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">然后再使用用户</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">采用的同样方法计算其秘密密钥</font><font face="Times New Roman" size="2">K</font><font face="宋体" size="2">。</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2"><strong style="color: black; background-color: #ffff66">Diffie</strong>-<strong style="color: black; background-color: #ffff66">Hellman</strong></font><font face="宋体" size="2"><strong style="color: black; background-color: #ffff66">密钥交换</strong>算法的安全性依赖于这样一个事实：虽然计算以一个素数为模的指数相对容易，但计算离散对数却很困难。对于大的素数，计算出离散对数几乎是不可能的。</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="宋体" size="2">下面给出例子。密钥交换基于素数</font><font face="Times New Roman" size="2"><em>q </em>= 97</font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">97</font><font face="宋体" size="2">的一个原根</font><font face="Symbol" size="2"><em>α</em></font><font face="Times New Roman" size="2"> = 5</font><font face="宋体" size="2">。</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">分别选择私有密钥</font><font face="Times New Roman" size="2">X<sub>A</sub> = 36</font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">X<sub>B</sub> = 58</font><font face="宋体" size="2">。每人计算其公开密钥</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Y<sub>A</sub> = </font><font face="Symbol" size="2">5</font><font face="Times New Roman" size="2"><sup>36</sup> = 50 mod 97</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Y<sub>B</sub> = </font><font face="Symbol" size="2">5</font><font face="Times New Roman" size="2"><sup>58</sup> = 44 mod 97</font></p> 
<p align="justify"><font style="background-color: #ffffff" face="宋体" color="#000000" size="2">在他们相互获取了公开密钥之后，各自通过计算得到双方共享的秘密密钥如下：</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="Times New Roman" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; K = (Y<sub>B</sub>)<sup>X</sup></font><font face="Times New Roman" size="1"><sup>A</sup></font><font face="Times New Roman" size="2"> mod 97 = 44<sup>36</sup> = 75 mod 97</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="Times New Roman" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; K = (Y<sub>A</sub>)<sup>X</sup></font><font face="Times New Roman" size="1"><sup>B</sup></font><font face="Times New Roman" size="2"> mod 97 = 50<sup>58</sup> = 75 mod 97</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">从</font><font face="Times New Roman" size="2">|50</font><font face="宋体" size="2">，</font><font face="Times New Roman" size="2">44|</font><font face="宋体" size="2">出发，攻击者要计算出</font><font face="Times New Roman" size="2">75</font><font face="宋体" size="2">很不容易。</font><font face="Times New Roman" size="2"> </font></p> 
<p align="justify"><font style="background-color: #ffffff" color="#000000">&nbsp;&nbsp;&nbsp;</font><font face="宋体" size="2">下图给出了一个利用</font><font face="Times New Roman" size="2">Diffie-Hellman</font><font face="宋体" size="2">计算的简单协议。</font> <br /> <br /> <br /> </p> 
<p align="justify"><font style="background-color: #ffffff" color="#000000">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2"> </font><br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> </p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="宋体" size="2">假设用户</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">希望与用户</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">建立一个连接，并用一个共享的秘密密钥加密在该连接上传输的报文。用户</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">产生一个一次性的私有密钥</font><font face="Times New Roman" size="2">X</font><font face="Times New Roman" size="1">A</font><font face="宋体" size="2">，并计算出公开密钥</font><font face="Times New Roman" size="2">Y<sub>A</sub></font><font face="宋体" size="2">并将其发送给用户</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">。用户</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">产生一个私有密钥</font><font face="Times New Roman" size="2">X</font><font face="Times New Roman" size="1">B</font><font face="宋体" size="2">，计算出公开密钥</font><font face="Times New Roman" size="2">Y<sub>B</sub></font><font face="宋体" size="2">并将它发送给用户</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">作为响应。必要的公开数值</font><font face="Times New Roman" size="2"><em>q</em></font><font face="宋体" size="2">和</font><font face="Symbol" size="2"><em>α</em></font><font face="宋体" size="2">都需要提前知道。另一种方法是用户</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">选择</font><font face="Times New Roman" size="2"><em>q</em></font><font face="宋体" size="2">和</font><font face="Symbol" size="2"><em>α</em></font><font face="宋体" size="2">的值，并将这些数值包含在第一个报文中。</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="宋体" size="2">下面再举一个使用</font><font face="Times New Roman" size="2">Diffie-Hellman</font><font face="宋体" size="2">算法的例子。假设有一组用户（例如一个局域网上的所有用户），每个人都产生一个长期的私有密钥</font><font face="Times New Roman" size="2">X</font><font face="Times New Roman" size="1">A</font><font face="宋体" size="2">，并计算一个公开密钥</font><font face="Times New Roman" size="2">Y<sub>A</sub></font><font face="宋体" size="2">。这些公开密钥数值，连同全局公开数值</font><font face="Times New Roman" size="2"><em>q</em></font><font face="宋体" size="2">和</font><font face="Symbol" size="2"><em>α</em></font><font face="宋体" size="2">都存储在某个中央目录中。在任何时刻，用户</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">都可以访问用户</font><font face="Times New Roman" size="2">A </font><font face="宋体" size="2">的公开数值，计算一个秘密密钥，并使用这个密钥发送一个加密报文给</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">。如果中央目录是可信任的，那么这种形式的通信就提供了保密性和一定程度的鉴别功能。因为只有</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">可以确定这个密钥，其它用户都无法解读报文（保密性）。接收方</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">知道只有用户</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">才能使用此密钥生成这个报文（鉴别）。</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">Diffie-Hellman</font><font face="宋体" size="2">算法具有两个吸引力的特征：</font></p> 
<ol type="1"> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">仅当需要时才生成密钥，减小了将密钥存储很长一段时间而致使遭受攻击的机会。</font> </li> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">除对全局参数的约定外，密钥交换不需要事先存在的基础结构。</font> </li> 
</ol> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="宋体" size="2">然而，该技术也存在许多不足：</font></p> 
<ol type="1"> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">没有提供双方身份的任何信息。</font> </li> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">它是计算密集性的，因此容易遭受阻塞性攻击，即对手请求大量的密钥。受攻击者花费了相对多的计算资源来求解无用的幂系数而不是在做真正的工作。</font> </li> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">没办法防止重演攻击。</font> </li> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">容易遭受中间人的攻击。第三方</font><font face="Times New Roman" size="2">C</font><font face="宋体" size="2">在和</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">通信时扮演</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">；和</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">通信时扮演</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">。</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">都与</font><font face="Times New Roman" size="2">C</font><font face="宋体" size="2">协商了一个密钥，然后</font><font face="Times New Roman" size="2">C</font><font face="宋体" size="2">就可以监听和传递通信量。中间人的攻击按如下进行：</font> </li> 
</ol> 
<ul> 
 <ol type="1"> 
  <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">在给</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">的报文中发送他的公开密钥。</font> </li> 
 </ol> 
 <ol type="1" start="2"> 
  <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="Times New Roman" size="2">C</font><font face="宋体" size="2">截获并解析该报文。</font><font face="Times New Roman" size="2">C</font><font face="宋体" size="2">将</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">的公开密钥保存下来并给</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">发送报文，该报文具有</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">的用户</font><font face="Times New Roman" size="2">ID</font><font face="宋体" size="2">但使用</font><font face="Times New Roman" size="2">C</font><font face="宋体" size="2">的公开密钥</font><font face="Times New Roman" size="2">Y<sub>C</sub></font><font face="宋体" size="2">，仍按照好像是来自</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">的样子被发送出去。</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">收到</font><font face="Times New Roman" size="2">C</font><font face="宋体" size="2">的报文后，将</font><font face="Times New Roman" size="2">Y<sub>C</sub></font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">的用户</font><font face="Times New Roman" size="2">ID</font><font face="宋体" size="2">存储在一块。类似地，</font><font face="Times New Roman" size="2">C</font><font face="宋体" size="2">使用</font><font face="Times New Roman" size="2">Y<sub>C</sub></font><font face="宋体" size="2">向</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">发送好像来自</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">的报文。</font> </li> 
  <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">基于私有密钥</font><font face="Times New Roman" size="2">X<sub>B</sub></font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">Y<sub>C</sub></font><font face="宋体" size="2">计算秘密密钥</font><font face="Times New Roman" size="2">K<sub>1</sub></font><font face="宋体" size="2">。</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">基于私有密钥</font><font face="Times New Roman" size="2">X<sub>A</sub></font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">Y<sub>C</sub></font><font face="宋体" size="2">计算秘密密钥</font><font face="Times New Roman" size="2">K<sub>2</sub></font><font face="宋体" size="2">。</font><font face="Times New Roman" size="2">C</font><font face="宋体" size="2">使用私有密钥</font><font face="Times New Roman" size="2">X<sub>C</sub></font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">Y<sub>B</sub></font><font face="宋体" size="2">计算</font><font face="Times New Roman" size="2">K<sub>1</sub></font><font face="宋体" size="2">，并使用</font><font face="Times New Roman" size="2">X<sub>C</sub></font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">Y<sub>A</sub></font><font face="宋体" size="2">计算</font><font face="Times New Roman" size="2">K<sub>2</sub></font><font face="宋体" size="2">。</font> </li> 
  <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">从现在开始，</font><font face="Times New Roman" size="2">C</font><font face="宋体" size="2">就可以转发</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">发给</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">的报文或转发</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">发给</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">的报文，在途中根据需要修改它们的密文。使得</font><font face="Times New Roman" size="2">A</font><font face="宋体" size="2">和</font><font face="Times New Roman" size="2">B</font><font face="宋体" size="2">都不知道他们在和</font><font face="Times New Roman" size="2">C</font><font face="宋体" size="2">共享通信。</font> </li> 
 </ol> 
</ul> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">Oakley</font><font face="宋体" size="2">算法是对</font><font face="Times New Roman" size="2"><strong style="color: black; background-color: #ffff66">Diffie</strong>-<strong style="color: black; background-color: #ffff66">Hellman</strong></font><font face="宋体" size="2"><strong style="color: black; background-color: #ffff66">密钥交换</strong>算法的优化，它保留了后者的优点，同时克服了其弱点。</font></p> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">Oakley</font><font face="宋体" size="2">算法具有五个重要特征：</font></p> 
<ol type="1"> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">它采用称为</font><font face="Times New Roman" size="2">cookie</font><font face="宋体" size="2">程序的机制来对抗阻塞攻击。</font> </li> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">它使得双方能够协商一个全局参数集合。</font> </li> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">它使用了现时来保证抵抗重演攻击。</font> </li> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">它能够交换</font><font face="Times New Roman" size="2">Diffie-Hellman</font><font face="宋体" size="2">公开密钥。</font> </li> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">它对</font><font face="Times New Roman" size="2">Diffie-Hellman</font><font face="宋体" size="2">交换进行鉴别以对抗中间人的攻击。</font> </li> 
</ol> 
<p align="justify"><font color="#000000"></font><font style="background-color: #ffffff">&nbsp;&nbsp;&nbsp;</font><font face="Times New Roman" size="2">Oakley</font><font face="宋体" size="2">可以使用三个不同的鉴别方法：</font></p> 
<ol type="1"> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">数字签名：通过签署一个相互可以获得的散列代码来对交换进行鉴别；每一方都使用自己的私钥对散列代码加密。散列代码是在一些重要参数上生成的，如用户</font><font face="Times New Roman" size="2">ID</font><font face="宋体" size="2">和现时。</font> </li> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">公开密钥加密：通过使用发送者的私钥对诸如</font><font face="Times New Roman" size="2">ID</font><font face="宋体" size="2">和现时等参数进行加密来鉴别交换。</font> </li> 
 <li><font color="#000000"></font><font style="background-color: #ffffff"></font><font face="宋体" size="2">对称密钥加密：通过使用某种共享密钥对交换参数进行对称加密，实现交换的鉴别。</font> </li> 
</ol> 
<font style="background-color: #ffffff" color="#000000"><br /> </font></div></body></html>