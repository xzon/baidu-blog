<html><head><title>RFC3560 - Use of the RSAES-OAEP Key Transport Algorithm in Cryptographic Message Syntax (CMS)</title></head><body><div id='tit'>RFC3560 - Use of the RSAES-OAEP Key Transport Algorithm in Cryptographic Message Syntax (CMS)</div><div id='cate'>计算机&middot;功课</div><div id='date'>2007年12月03日 星期一 02:00 A.M.</div><div id='page'>193</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/a688494abee7932009f7ef96.html'>http://hi.baidu.com/hxzon/blog/item/a688494abee7932009f7ef96.html</a><div id='cnt'><p><font color="#000000"><strong>RFC3560 - Use of the RSAES-OAEP Key Transport Algorithm in Cryptographic Message Syntax (CMS)</strong></font></p> 
<p><font color="#000000"><strong>Network Working Group R. Housley<br /> Request for Comments: 3560 Vigil Security<br /> Category: Standards Track July 2003<br /> <br /> Use of the RSAES-OAEP Key Transport Algorithm in<br /> the Cryptographic Message Syntax (CMS)<br /> <br /> Status of this Memo<br /> <br /> This document specifies an Internet standards track protocol for the<br /> Internet community, and requests discussion and suggestions for<br /> improvements. Please refer to the current edition of the &quot;Internet<br /> Official Protocol Standards&quot; (STD 1) for the standardization state<br /> and status of this protocol. Distribution of this memo is unlimited.<br /> <br /> Copyright Notice<br /> <br /> Copyright (C) The Internet Society (2003). All Rights Reserved.<br /> <br /> Abstract<br /> <br /> This document describes the conventions for using the RSAES-OAEP key<br /> transport algorithm with the Cryptographic Message Syntax (CMS). The<br /> CMS specifies the enveloped-data content type, which consists of an<br /> encrypted content and encrypted content-encryption keys for one or<br /> more recipients. The RSAES-OAEP key transport algorithm can be used<br /> to encrypt content-encryption keys for intended recipients.<br /> <br /> Table of Contents<br /> <br /> 1. Introduction . . . . . . . . . . . . . . . . . . . . . . . . . 2<br /> 2. Enveloped-data Conventions . . . . . . . . . . . . . . . . . . 3<br /> 2.1. EnvelopedData Fields . . . . . . . . . . . . . . . . . . 3<br /> 2.2. KeyTransRecipientInfo Fields . . . . . . . . . . . . . . 4<br /> 3. RSAES-OAEP Algorithm Identifiers and Parameters. . . . . . . . 4<br /> 4. Certificate Conventions. . . . . . . . . . . . . . . . . . . . 6<br /> 5. SMIMECapabilities Attribute Conventions. . . . . . . . . . . . 8<br /> 6. Security Considerations. . . . . . . . . . . . . . . . . . . . 9<br /> 7. IANA Considerations. . . . . . . . . . . . . . . . . . . . . . 11<br /> 8. Intellectual Property Rights Statement . . . . . . . . . . . . 11<br /> 9. Acknowledgments. . . . . . . . . . . . . . . . . . . . . . . . 11<br /> 10. References . . . . . . . . . . . . . . . . . . . . . . . . . . 11<br /> 10.1. Normative References. . . . . . . . . . . . . . . . . . 11<br /> 10.2. Informative References. . . . . . . . . . . . . . . . . 12<br /> Appendix A. ASN.1 Module . . . . . . . . . . . . . . . . . . . . . 14<br /> Author's Address . . . . . . . . . . . . . . . . . . . . . . . . . 17<br /> Full Copyright Statement . . . . . . . . . . . . . . . . . . . . . 18<br /> <br /> 1. Introduction<br /> <br /> PKCS #1 Version 1.5 [PKCS#1v1.5] specifies a widely deployed variant<br /> of the RSA key transport algorithm. PKCS #1 Version 1.5 key<br /> transport is vulnerable to adaptive chosen ciphertext attacks,<br /> especially when it is used to for key management in interactive<br /> applications. This attack is often referred to as the &quot;Million<br /> Message Attack,&quot; and it explained in [RSALABS] and [CRYPTO98].<br /> Exploitation of this vulnerability, which reveals the result of a<br /> particular RSA decryption, requires access to an oracle which will<br /> respond to hundreds of thousands of ciphertexts, which are<br /> constructed adaptively in response to previously received replies<br /> that provide information on the successes or failures of attempted<br /> decryption operations.<br /> <br /> The attack is significantly less feasible in store-and-forward<br /> environments, such as S/MIME. </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>3218 [MMA] discussed the<br /> countermeasures to this attack that are available when PKCS #1<br /> Version 1.5 key transport is used in conjunction with the<br /> Cryptographic Message Syntax (CMS) [CMS].<br /> <br /> When PKCS #1 Version 1.5 key transport is applied as an intermediate<br /> encryption layer within an interactive request-response<br /> communications environment, exploitation could be more feasible.<br /> However, Secure Sockets Layer (SSL) [SSL] and Transport Layer<br /> Security (TLS) [TLS] protocol implementations could include<br /> countermeasures that detect and prevent the Million Message Attack<br /> and other chosen-ciphertext attacks. These countermeasures are<br /> performed within the protocol level.<br /> <br /> In the interest of long-term security assurance, it is prudent to<br /> adopt an improved cryptographic technique rather than embedding<br /> countermeasures within protocols. To this end, an updated version of<br /> PKCS #1 has been published. PKCS #1 Version 2.1 [PKCS#1v2.1]<br /> supersedes </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>2313. It preserves support for the PKCS #1 Version<br /> 1.5 encryption padding format, and it also defines a new one. To<br /> resolve the adaptive chosen ciphertext vulnerability, the PKCS #1<br /> Version 2.1 specifies and recommends use of Optimal Asymmetric<br /> Encryption Padding (OAEP) for RSA key transport.<br /> <br /> This document specifies the use of RSAES-OAEP key transport algorithm<br /> in the CMS. The CMS can be used in either a store-and-forward or an<br /> interactive request-response environment.<br /> <br /> The CMS supports variety of architectures for certificate-based key<br /> management, particularly the one defined by the PKIX working group<br /> [PROFILE]. PKCS #1 Version 1.5 and PKCS #1 Version 2.1 require the<br /> same RSA public key information. Thus, a certified RSA public key<br /> may be used with either RSA key transport technique.<br /> <br /> The CMS uses ASN.1 [X.208-88], the Basic Encoding Rules (BER)<br /> [X.209-88], and the Distinguished Encoding Rules (DER) [X.509-88].<br /> <br /> Throughout this document, when the terms &quot;MUST&quot;, &quot;MUST NOT&quot;,<br /> &quot;SHOULD&quot;, and &quot;MAY&quot; are used in capital letters, their use conforms<br /> to the definitions in </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>2119 [STDWORDS]. These key word<br /> definitions help make the intent of standards documents as clear as<br /> possible. These key words are used in this document to help<br /> implementers achieve interoperability.<br /> <br /> 2. Enveloped-data Conventions<br /> <br /> The CMS enveloped-data content type consists of an encrypted content<br /> and wrapped content-encryption keys for one or more recipients. The<br /> RSAES-OAEP key transport algorithm is used to wrap the<br /> content-encryption key for one recipient.<br /> <br /> Compliant software MUST meet the requirements for constructing an<br /> enveloped-data content type stated in [CMS] Section 6,<br /> &quot;Enveloped-data Content Type&quot;.<br /> <br /> A content-encryption key MUST be randomly generated for each instance<br /> of an enveloped-data content type. The content-encryption key is<br /> used to encipher the content.<br /> <br /> 2.1. EnvelopedData Fields<br /> <br /> The enveloped-data content type is ASN.1 encoded using the<br /> EnvelopedData syntax. The fields of the EnvelopedData syntax MUST be<br /> populated as described in this section when RSAES-OAEP key transport<br /> is employed for one or more recipients.<br /> <br /> The EnvelopedData version MUST be 0, 2, or 3.<br /> <br /> The EnvelopedData originatorInfo field is not used for the RSAES-OAEP<br /> key transport algorithm. However, this field MAY be present to<br /> support recipients using other key management algorithms.<br /> <br /> The EnvelopedData recipientInfos CHOICE MUST be<br /> KeyTransRecipientInfo. See section 2.2 for further discussion of<br /> KeyTransRecipientInfo.<br /> <br /> The EnvelopedData encryptedContentInfo contentEncryptionAlgorithm<br /> field MUST be a symmetric encryption algorithm identifier.<br /> <br /> The EnvelopedData unprotectedAttrs MAY be present.<br /> <br /> 2.2. KeyTransRecipientInfo Fields<br /> <br /> The fields of the KeyTransRecipientInfo syntax MUST be populated as<br /> described in this section when RSAES-OAEP key transport is employed<br /> for one or more recipients.<br /> <br /> The KeyTransRecipientInfo version MUST be 0 or 2. If the<br /> RecipientIdentifier uses the issuerAndSerialNumber alternative, then<br /> the version MUST be 0. If the RecipientIdentifier uses the<br /> subjectKeyIdentifier alternative, then the version MUST be 2.<br /> <br /> The KeyTransRecipientInfo RecipientIdentifier provides two<br /> alternatives for specifying the recipient's certificate, and thereby<br /> the recipient's public key. The recipient's certificate MUST contain<br /> a RSA public key. The content-encryption key is encrypted with the<br /> recipient's RSA public key. The issuerAndSerialNumber alternative<br /> identifies the recipient's certificate by the issuer's distinguished<br /> name and the certificate serial number; the subjectKeyIdentifier<br /> identifies the recipient's certificate by the X.509<br /> subjectKeyIdentifier extension value.<br /> <br /> The KeyTransRecipientInfo keyEncryptionAlgorithm specifies use of the<br /> RSAES-OAEP algorithm, and its associated parameters, to encrypt the<br /> content-encryption key for the recipient. The key-encryption process<br /> is described in [PKCS#1v2.1]. See section 3 of this document for the<br /> algorithm identifier and the parameter syntax.<br /> <br /> The KeyTransRecipientInfo encryptedKey is the result of encrypting<br /> the content-encryption key in the recipient's RSA public key using<br /> the RSAES-OAEP algorithm. The RSA public key MUST be at least 1024<br /> bits in length. When using a Triple-DES [3DES] content-encryption<br /> key, implementations MUST adjust the parity bits to ensure odd parity<br /> for each octet of each DES key comprising the Triple-DES key prior to<br /> RSAES-OAEP encryption.<br /> <br /> 3. RSAES-OAEP Algorithm Identifiers and Parameters<br /> <br /> The RSAES-OAEP key transport algorithm is the RSA encryption scheme<br /> defined in </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>3447 [PKCS#1v2.1], where the message to be encrypted<br /> is the content-encryption key. The algorithm identifier for<br /> RSAES-OAEP is:<br /> <br /> id-RSAES-OAEP OBJECT IDENTIFIER ::= { iso(1) member-body(2)<br /> us(840) rsadsi(113549) pkcs(1) pkcs-1(1) 7 }<br /> <br /> The AlgorithmIdentifier parameters field MUST be present, and the<br /> parameters field MUST contain RSAES-OAEP-params. RSAES-OAEP-params<br /> has the following syntax:<br /> <br /> RSAES-OAEP-params ::= SEQUENCE {<br /> hashFunc [0] AlgorithmIdentifier DEFAULT sha1Identifier,<br /> maskGenFunc [1] AlgorithmIdentifier DEFAULT mgf1SHA1Identifier,<br /> pSourceFunc [2] AlgorithmIdentifier DEFAULT<br /> pSpecifiedEmptyIdentifier }<br /> <br /> sha1Identifier AlgorithmIdentifier ::= { id-sha1, NULL }<br /> <br /> mgf1SHA1Identifier AlgorithmIdentifier ::=<br /> { id-mgf1, sha1Identifier }<br /> <br /> pSpecifiedEmptyIdentifier AlgorithmIdentifier ::=<br /> { id-pSpecified, nullOctetString }<br /> <br /> nullOctetString OCTET STRING (SIZE (0)) ::= { ''H }<br /> <br /> id-sha1 OBJECT IDENTIFIER ::= { iso(1)<br /> identified-organization(3) oiw(14)<br /> secsig(3) algorithms(2) 26 }<br /> <br /> pkcs-1 OBJECT IDENTIFIER ::= { iso(1) member-body(2)<br /> us(840) rsadsi(113549) pkcs(1) pkcs-1(1) }<br /> <br /> id-mgf1 OBJECT IDENTIFIER ::= { pkcs-1 8 }<br /> <br /> id-pSpecified OBJECT IDENTIFIER ::= { pkcs-1 9 }<br /> <br /> The fields within RSAES-OAEP-params have the following meanings:<br /> <br /> hashFunc identifies the one-way hash function. Implementations MUST<br /> support SHA-1 [SHA1], and implementations MAY support other one-way<br /> hash functions. The SHA-1 algorithm identifier is comprised of the<br /> id-sha1 object identifier and a parameter of NULL. Implementations<br /> that perform encryption MUST omit the hashFunc field when SHA-1 is<br /> used, indicating that the default algorithm was used.<br /> Implementations that perform decryption MUST recognize both the<br /> id-sha1 object identifier and an absent hashFunc field as an<br /> indication that SHA-1 was used.<br /> <br /> maskGenFunc identifies the mask generation function. Implementations<br /> MUST support MFG1 [PKCS#1v2.1]. MFG1 requires a one-way hash<br /> function, and it is identified in the parameter field of the MFG1<br /> algorithm identifier. Implementations MUST support SHA-1 [SHA1], and<br /> implementations MAY support other one-way hash functions. The MFG1<br /> algorithm identifier is comprised of the id-mgf1 object identifier<br /> and a parameter that contains the algorithm identifier of the one-way<br /> hash function employed with MFG1. The SHA-1 algorithm identifier is<br /> comprised of the id-sha1 object identifier and a parameter of NULL.<br /> Implementations that perform encryption MUST omit the maskGenFunc<br /> field when MFG1 with SHA-1 is used, indicating that the default<br /> algorithm was used. Implementations that perform decryption MUST<br /> recognize both the id-mgf1 and id-sha1 object identifiers as well as<br /> an absent maskGenFunc field as an indication that MFG1 with SHA-1 was<br /> used.<br /> <br /> pSourceFunc identifies the source (and possibly the value) of the<br /> encoding parameters, commonly called P. Implementations MUST<br /> represent P by the algorithm identifier, id-pSpecified, indicating<br /> that P is explicitly provided as an OCTET STRING in the parameters.<br /> The default value for P is an empty string. In this case, pHash in<br /> EME-OAEP contains the hash of a zero length string. Implementations<br /> MUST support a zero length P value. Implementations that perform<br /> encryption MUST omit the pSourceFunc field when a zero length P value<br /> is used, indicating that the default value was used. Implementations<br /> that perform decryption MUST recognize both the id-pSpecified object<br /> identifier and an absent pSourceFunc field as an indication that a<br /> zero length P value was used.<br /> <br /> 4. Certificate Conventions<br /> <br /> </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>3280 [PROFILE] specifies the profile for using X.509 Certificates<br /> in Internet applications. When a RSA public key will be used for<br /> RSAES-OAEP key transport, the conventions specified in this section<br /> augment </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>3280.<br /> <br /> Traditionally, the rsaEncryption object identifier is used to<br /> identify RSA public keys. However, to implement all of the<br /> recommendations described in the Security Considerations section of<br /> this document (see section 6), the certificate user needs to be able<br /> to determine the form of key transport that the RSA private key owner<br /> associates with the public key.<br /> <br /> The rsaEncryption object identifier continues to identify the subject<br /> public key when the RSA private key owner does not wish to limit the<br /> use of the public key exclusively to RSAES-OAEP. In this case, the<br /> <br /> rsaEncryption object identifier MUST be used in the algorithm field<br /> within the subject public key information, and the parameters field<br /> MUST contain NULL.<br /> <br /> rsaEncryption OBJECT IDENTIFIER ::= { pkcs-1 1 }<br /> <br /> Further discussion of the conventions associated with use of the<br /> rsaEncryption object identifier can be found in </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>3279 (see<br /> [CERTALGS], section 2.3.1).<br /> <br /> When the RSA private key owner wishes to limit the use of the public<br /> key exclusively to RSAES-OAEP, then the id-RSAES-OAEP object<br /> identifier MUST be used in the algorithm field within the subject<br /> public key information, and the parameters field MUST contain<br /> RSAES-OAEP-params. The id-RSAES-OAEP object identifier value and the<br /> RSAES-OAEP-params syntax are fully described in section 3 of this<br /> document.<br /> <br /> Regardless of the object identifier used, the RSA public key is<br /> encoded in the same manner in the subject public key information.<br /> The RSA public key MUST be encoded using the type RSAPublicKey type:<br /> <br /> RSAPublicKey ::= SEQUENCE {<br /> modulus INTEGER, -- n<br /> publicExponent INTEGER } -- e<br /> <br /> Here, the modulus is the modulus n, and publicExponent is the public<br /> exponent e. The DER encoded RSAPublicKey is carried in the<br /> subjectPublicKey BIT STRING within the subject public key<br /> information.<br /> <br /> The intended application for the key MAY be indicated in the key<br /> usage certificate extension (see [PROFILE], section 4.2.1.3). If the<br /> keyUsage extension is present in a certificate that conveys an RSA<br /> public key with the id-RSAES-OAEP object identifier, then the key<br /> usage extension MUST contain a combination of the following values:<br /> <br /> keyEncipherment; and<br /> dataEncipherment.<br /> <br /> However, both keyEncipherment and dataEncipherment SHOULD NOT be<br /> present.<br /> <br /> When a certificate that conveys an RSA public key with the<br /> id-RSAES-OAEP object identifier, the certificate user MUST only use<br /> the certified RSA public key for RSAES-OAEP operations, and the<br /> certificate user MUST perform those operations using the parameters<br /> identified in the certificate.<br /> <br /> 5. SMIMECapabilities Attribute Conventions<br /> <br /> </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>2633 [MSG], Section 2.5.2 defines the SMIMECapabilities signed<br /> attribute (defined as a SEQUENCE of SMIMECapability SEQUENCEs) to be<br /> used to specify a partial list of algorithms that the software<br /> announcing the SMIMECapabilities can support. When constructing a<br /> signedData object, compliant software MAY include the<br /> SMIMECapabilities signed attribute announcing that it supports the<br /> RSAES-OAEP algorithm.<br /> <br /> When all of the default settings are selected, the SMIMECapability<br /> SEQUENCE representing RSAES-OAEP MUST include the id-RSAES-OAEP<br /> object identifier in the capabilityID field and MUST include an empty<br /> SEQUENCE in the parameters field. In this case, RSAES-OAEP is<br /> represented by the rSAES-OAEP-Default-Identifier:<br /> <br /> rSAES-OAEP-Default-Identifier AlgorithmIdentifier ::=<br /> { id-RSAES-OAEP,<br /> { sha1Identifier,<br /> mgf1SHA1Identifier,<br /> pSpecifiedEmptyIdentifier } }<br /> <br /> The SMIMECapability SEQUENCE representing rSAES-OAEP-Default-<br /> Identifier MUST be DER-encoded as the following hexadecimal string:<br /> <br /> 30 0D 06 09 2A 86 48 86 F7 0D 01 01 07 30 00<br /> <br /> When settings other than the defaults are selected, the<br /> SMIMECapability SEQUENCE representing RSAES-OAEP MUST include the<br /> id-RSAES-OAEP object identifier in the capabilityID field and MUST<br /> include the RSAES-OAEP-params SEQUENCE that identifies the<br /> non-default settings in the parameters field.<br /> <br /> When SHA-256 is used in the hashFunc and SHA-256 is used with MGF1 in<br /> the maskGenFunc, the SMIMECapability SEQUENCE representing RSAES-OAEP<br /> is the rSAES-OAEP-SHA256-Identifier, as specified in Appendix A. The<br /> SMIMECapability SEQUENCE representing rSAES-OAEP-SHA256-Identifier<br /> MUST be DER-encoded as the following hexadecimal string:<br /> <br /> 30 38 06 09 2A 86 48 86 F7 0D 01 01 07 30 2B 30<br /> 0D 06 09 60 86 48 01 65 03 04 02 01 05 00 30 1A<br /> 06 09 2A 86 48 86 F7 0D 01 01 08 30 0D 06 09 60<br /> 86 48 01 65 03 04 02 01 05 00<br /> <br /> When SHA-384 is used in the hashFunc and SHA-384 is used with MGF1 in<br /> the maskGenFunc, the SMIMECapability SEQUENCE representing RSAES-OAEP<br /> is the rSAES-OAEP-SHA384-Identifier, as specified in Appendix A. The<br /> <br /> SMIMECapability SEQUENCE representing rSAES-OAEP-SHA384-Identifier<br /> MUST be DER-encoded as the following hexadecimal string:<br /> <br /> 30 38 06 09 2A 86 48 86 F7 0D 01 01 07 30 2B 30<br /> 0D 06 09 60 86 48 01 65 03 04 02 02 05 00 30 1A<br /> 06 09 2A 86 48 86 F7 0D 01 01 08 30 0D 06 09 60<br /> 86 48 01 65 03 04 02 02 05 00<br /> <br /> When SHA-512 is used in the hashFunc and SHA-512 is used with MGF1 in<br /> the maskGenFunc, the SMIMECapability SEQUENCE representing RSAES-OAEP<br /> is the rSAES-OAEP-SHA512-Identifier, as specified in Appendix A. The<br /> SMIMECapability SEQUENCE representing rSAES-OAEP-SHA512-Identifier<br /> MUST be DER-encoded as the following hexadecimal string:<br /> <br /> 30 38 06 09 2A 86 48 86 F7 0D 01 01 07 30 2B 30<br /> 0D 06 09 60 86 48 01 65 03 04 02 03 05 00 30 1A<br /> 06 09 2A 86 48 86 F7 0D 01 01 08 30 0D 06 09 60<br /> 86 48 01 65 03 04 02 03 05 00<br /> <br /> 6. Security Considerations<br /> <br /> Implementations must protect the RSA private key and the<br /> content-encryption key. Compromise of the RSA private key may result<br /> in the disclosure of all messages protected with that key.<br /> Compromise of the content-encryption key may result in disclosure of<br /> the associated encrypted content.<br /> <br /> The generation of RSA public/private key pairs relies on a random<br /> numbers. The use of inadequate pseudo-random number generators<br /> (PRNGs) to generate cryptographic keys can result in little or no<br /> security. An attacker may find it much easier to reproduce the PRNG<br /> environment that produced the keys, searching the resulting small set<br /> of possibilities, rather than brute force searching the whole key<br /> space. The generation of quality random numbers is difficult. </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><br /> <font color="#000000"><strong>1750 [RANDOM] offers important guidance in this area.<br /> <br /> Generally, good cryptographic practice employs a given RSA key pair<br /> in only one scheme. This practice avoids the risk that vulnerability<br /> in one scheme may compromise the security of the other, and may be<br /> essential to maintain provable security. While PKCS #1 Version 1.5<br /> [PKCS#1v1.5] has been employed for both key transport and digital<br /> signature without any known bad interactions, such a combined use of<br /> an RSA key pair is not recommended in the future. Therefore, an RSA<br /> key pair used for RSAES-OAEP key transport should not also be used<br /> for other purposes. For similar reasons, one RSA key pair should<br /> always be used with the same RSAES-OAEP parameters.<br /> <br /> This specification requires implementation to support the SHA-1<br /> one-way hash function for interoperability, but support for other<br /> one-way hash function is permitted. At the time of this writing, the<br /> best (known) collision attacks against SHA-1 are generic attacks with<br /> complexity 2^80, where 80 is one-half the bit length of the hash<br /> value. When a one-way hash function is used with a digital signature<br /> scheme, a collision attack is easily translated into a signature<br /> forgery. Therefore, the use of SHA-1 in a digital signature scheme<br /> provides a security level of no more than 80 bits. If a greater<br /> level of security is desired, then a secure one-way hash function<br /> with a longer hash value is needed. SHA-256, SHA-384, and SHA-512<br /> are likely candidates [SHA2].<br /> <br /> The metrics for choosing a one-way hash function for use in digital<br /> signatures do not directly apply to the RSAES-OAEP key transport<br /> algorithm, since a collision attack on the one-way hash function does<br /> not directly translate into an attack on the key transport algorithm,<br /> unless the encoding parameters P varies (in which case a collision<br /> the hash value for different encoding parameters might be exploited).<br /> <br /> Nevertheless, for consistency with the practice for digital signature<br /> schemes, and in case the encoding parameters P is not the empty<br /> string, it is recommended that the same rule of thumb be applied to<br /> selection of a one-way hash function for use with RSAES-OAEP. That<br /> is, the one-way hash function should be selected so that the bit<br /> length of the hash value is at least twice as long as the desired<br /> security level in bits.<br /> <br /> A 1024-bit RSA public key and SHA-1 both provide a security level of<br /> about 80 bits. In [NISTGUIDE], the National Institute of Standards<br /> and Technology suggests that a security level of 80 bits is adequate<br /> for most applications until 2015. If a security level greater than<br /> 80 bits is needed, then a longer RSA public key and a secure one-way<br /> hash function with a longer hash value are needed. Again, SHA-256,<br /> SHA-384, and SHA-512 are likely candidates for such a one-way hash<br /> function. For this reason, the algorithm identifiers for these<br /> one-way hash functions are included in the ASN.1 module in Appendix<br /> A.<br /> <br /> The same one-way hash function should be employed for the hashFunc<br /> and the maskGenFunc, but it is not required. Using the same one-way<br /> hash function reduces the potential for implementation errors.<br /> <br /> 7. IANA Considerations<br /> <br /> Within the CMS, algorithms are identified by object identifiers<br /> (OIDs). All of the OIDs used in this document were assigned in<br /> Public-Key Cryptography Standards (PKCS) documents or by the National<br /> Institute of Standards and Technology (NIST). No further action by<br /> the IANA is necessary for this document or any anticipated updates.<br /> <br /> 8. Intellectual Property Rights Statement<br /> <br /> The IETF takes no position regarding the validity or scope of any<br /> intellectual property or other rights that might be claimed to<br /> pertain to the implementation or use of the technology described in<br /> this document or the extent to which any license under such rights<br /> might or might not be available; neither does it represent that it<br /> has made any effort to identify any such rights. Information on the<br /> IETF's procedures with respect to rights in standards-track and<br /> standards-related documentation can be found in BCP-11. Copies of<br /> claims of rights made available for publication and any assurances of<br /> licenses to be made available, or the result of an attempt made to<br /> obtain a general license or permission for the use of such<br /> proprietary rights by implementors or users of this specification can<br /> be obtained from the IETF Secretariat.<br /> <br /> The IETF invites any interested party to bring to its attention any<br /> copyrights, patents or patent applications, or other proprietary<br /> rights which may cover technology that may be required to practice<br /> this standard. Please address the information to the IETF Executive<br /> Director.<br /> <br /> 9. Acknowledgments<br /> <br /> This document is the result of contributions from many professionals.<br /> I appreciate the hard work of all members of the IETF S/MIME Working<br /> Group. Further, I extend a special thanks to Burt Kaliski, Jakob<br /> Jonsson, Francois Rousseau, and Jim Schaad.<br /> <br /> 10. References<br /> <br /> This section provides normative and informative references.<br /> <br /> 10.1. Normative References<br /> <br /> [3DES] American National Standards Institute. ANSI X9.52-<br /> 1998, Triple Data Encryption Algorithm Modes of<br /> Operation. 1998.<br /> <br /> [CMS] Housley, R., &quot;Cryptographic Message Syntax (CMS)&quot;, </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><br /> <font color="#000000"><strong>3369, August 2002.<br /> <br /> [MSG] Ramsdell, B., &quot;S/MIME Version 3 Message Specification&quot;,<br /> </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>2633, June 1999.<br /> <br /> [PKCS#1v2.1] Jonsson, J. and B. Kaliski, &quot;Public-Key Cryptography<br /> Standards (PKCS) #1: RSA Cryptography Specifications,<br /> Version 2.1&quot;, </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>3447, February 2003.<br /> <br /> [PROFILE] Housley, R., Polk, W., Ford, W. and D. Solo, &quot;Internet<br /> X.509 Public Key Infrastructure: Certificate and<br /> Certificate Revocation List (CRL) Profile&quot;, </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>3280,<br /> April 2002.<br /> <br /> [SHA1] National Institute of Standards and Technology. FIPS<br /> Pub 180-1: &quot;Secure Hash Standard.&quot; April 1995.<br /> <br /> [STDWORDS] Bradner, S., &quot;Key Words for Use in </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>s to Indicate<br /> Requirement Levels&quot;, BCP 14, </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>2119, March 1997.<br /> <br /> [X.208-88] CCITT. Recommendation X.208: Specification of Abstract<br /> Syntax Notation One (ASN.1). 1988.<br /> <br /> [X.209-88] CCITT. Recommendation X.209: Specification of Basic<br /> Encoding Rules for Abstract Syntax Notation One<br /> (ASN.1). 1988.<br /> <br /> [X.509-88] CCITT. Recommendation X.509: The Directory -<br /> Authentication Framework. 1988.<br /> <br /> 10.2. Informative References<br /> <br /> [CERTALGS] Bassham, L., Polk, W. and R. Housley, &quot;Algorithms and<br /> Identifiers for the Internet X.509 Public Key<br /> Infrastructure Certificate and Certificate Revocation<br /> List (CRL) Profile&quot;, </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>3279, April 2002.<br /> <br /> [CRYPTO98] Bleichenbacher, D. &quot;Chosen Ciphertext Attacks Against<br /> Protocols Based on the RSA Encryption Standard PKCS<br /> #1&quot;, in H. Krawczyk (editor), Advances in Cryptology -<br /> CRYPTO '98 Proceedings, Lecture Notes in Computer<br /> Science 1462 (1998), Springer-Verlag, pp. 1-12.<br /> <br /> [MMA] Rescorla, E., &quot;Preventing the Million Message Attack on<br /> Cryptographic Message Syntax&quot;, </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>3218, January 2002.<br /> <br /> [NISTGUIDE] National Institute of Standards and Technology. Second<br /> Draft: &quot;Key Management Guideline, Part 1: General<br /> Guidance.&quot; June 2002.<br /> [</strong></font><a href="http://csrc.nist.gov/encryption/kms/guideline-1.pdf"><font color="#000000"><strong>http://csrc.nist.gov/encryption/kms/guideline-1.pdf</strong></font></a><font color="#000000"><strong>]<br /> <br /> [PKCS#1v1.5] Kaliski, B., &quot;PKCS #1: RSA Encryption, Version 1.5&quot;,<br /> </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>2313, March 1998.<br /> <br /> [RANDOM] Eastlake, D., Crocker, S. and J. Schiller, &quot;Randomness<br /> Recommendations for Security&quot;, </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>1750, December 1994.<br /> <br /> [RSALABS] Bleichenbacher, D., B. Kaliski, and J. Staddon. Recent<br /> Results on PKCS #1: RSA Encryption Standard. RSA<br /> Laboratories' Bulletin No. 7, June 26, 1998.<br /> [</strong></font><a href="http://www.rsasecurity.com/rsalabs/bulletins"><font color="#000000"><strong>http://www.rsasecurity.com/rsalabs/bulletins</strong></font></a><font color="#000000"><strong>]<br /> <br /> [SHA2] National Institute of Standards and Technology. Draft<br /> FIPS Pub 180-2: &quot;Specifications for the Secure Hash<br /> Standard.&quot; May 2001.<br /> [</strong></font><a href="http://csrc.nist.gov/encryption/shs/dfips-180-2.pdf"><font color="#000000"><strong>http://csrc.nist.gov/encryption/shs/dfips-180-2.pdf</strong></font></a><font color="#000000"><strong>]<br /> <br /> [SSL] Freier, A., P. Karlton, and P. Kocher. The SSL<br /> Protocol, Version 3.0. Netscape Communications.<br /> November 1996.<br /> [</strong></font><a href="http://wp.netscape.com/eng/ssl3/draft302.txt"><font color="#000000"><strong>http://wp.netscape.com/eng/ssl3/draft302.txt</strong></font></a><font color="#000000"><strong>]<br /> <br /> [TLS] Dierks, T. and C. Allen, &quot;The TLS Protocol Version<br /> 1.0&quot;, </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>2246, January 1999.<br /> <br /> Appendix A. ASN.1 Module<br /> <br /> CMS-RSAES-OAEP<br /> { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)<br /> pkcs-9(9) smime(16) modules(0) cms-rsaes-oaep(20) }<br /> <br /> DEFINITIONS IMPLICIT TAGS ::= BEGIN<br /> <br /> -- EXPORTS ALL --<br /> <br /> IMPORTS<br /> AlgorithmIdentifier<br /> FROM PKIX1Explicit88 -- </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>3280<br /> { iso(1) identified-organization(3) dod(6) internet(1)<br /> security(5) mechanisms(5) pkix(7) id-mod(0)<br /> id-pkix1-explicit(18) };<br /> <br /> pkcs-1 OBJECT IDENTIFIER ::= { iso(1) member-body(2) us(840)<br /> rsadsi(113549) pkcs(1) pkcs-1(1) }<br /> <br /> rsaEncryption OBJECT IDENTIFIER ::= { pkcs-1 1 }<br /> <br /> id-RSAES-OAEP OBJECT IDENTIFIER ::= { pkcs-1 7 }<br /> <br /> RSAES-OAEP-params ::= SEQUENCE {<br /> hashFunc [0] AlgorithmIdentifier DEFAULT sha1Identifier,<br /> maskGenFunc [1] AlgorithmIdentifier DEFAULT mgf1SHA1Identifier,<br /> pSourceFunc [2] AlgorithmIdentifier DEFAULT<br /> <br /> pSpecifiedEmptyIdentifier }<br /> <br /> sha1Identifier AlgorithmIdentifier ::= { id-sha1, NULL }<br /> <br /> sha256Identifier AlgorithmIdentifier ::= { id-sha256, NULL }<br /> <br /> sha384Identifier AlgorithmIdentifier ::= { id-sha384, NULL }<br /> <br /> sha512Identifier AlgorithmIdentifier ::= { id-sha512, NULL }<br /> <br /> mgf1SHA1Identifier AlgorithmIdentifier ::=<br /> { id-mgf1, sha1Identifier }<br /> <br /> mgf1SHA256Identifier AlgorithmIdentifier ::=<br /> { id-mgf1, sha256Identifier }<br /> <br /> mgf1SHA384Identifier AlgorithmIdentifier ::=<br /> { id-mgf1, sha384Identifier }<br /> <br /> mgf1SHA512Identifier AlgorithmIdentifier ::=<br /> { id-mgf1, sha512Identifier }<br /> <br /> pSpecifiedEmptyIdentifier AlgorithmIdentifier ::=<br /> { id-pSpecified, nullOctetString }<br /> <br /> nullOctetString OCTET STRING (SIZE (0)) ::= { ''H }<br /> <br /> id-sha1 OBJECT IDENTIFIER ::= { iso(1)<br /> identified-organization(3) oiw(14)<br /> secsig(3) algorithms(2) 26 }<br /> <br /> id-sha256 OBJECT IDENTIFIER ::= { joint-iso-itu-t(2)<br /> country(16) us(840) organization(1) gov(101)<br /> csor(3) nistalgorithm(4) hashalgs(2) 1 }<br /> <br /> id-sha384 OBJECT IDENTIFIER ::= { joint-iso-itu-t(2)<br /> country(16) us(840) organization(1) gov(101)<br /> csor(3) nistalgorithm(4) hashalgs(2) 2 }<br /> <br /> id-sha512 OBJECT IDENTIFIER ::= { joint-iso-itu-t(2)<br /> country(16) us(840) organization(1) gov(101)<br /> csor(3) nistalgorithm(4) hashalgs(2) 3 }<br /> <br /> id-mgf1 OBJECT IDENTIFIER ::= { pkcs-1 8 }<br /> <br /> id-pSpecified OBJECT IDENTIFIER ::= { pkcs-1 9 }<br /> <br /> rSAES-OAEP-Default-Identifier AlgorithmIdentifier ::=<br /> { id-RSAES-OAEP,<br /> { sha1Identifier,<br /> mgf1SHA1Identifier,<br /> pSpecifiedEmptyIdentifier } }<br /> <br /> rSAES-OAEP-SHA256-Identifier AlgorithmIdentifier ::=<br /> { id-RSAES-OAEP,<br /> { sha256Identifier,<br /> mgf1SHA256Identifier,<br /> pSpecifiedEmptyIdentifier } }<br /> <br /> rSAES-OAEP-SHA384-Identifier AlgorithmIdentifier ::=<br /> { id-RSAES-OAEP,<br /> { sha384Identifier,<br /> mgf1SHA384Identifier,<br /> pSpecifiedEmptyIdentifier } }<br /> <br /> rSAES-OAEP-SHA512-Identifier AlgorithmIdentifier ::=<br /> { id-RSAES-OAEP,<br /> <br /> { sha512Identifier,<br /> mgf1SHA512Identifier,<br /> pSpecifiedEmptyIdentifier } }<br /> <br /> END<br /> <br /> Author's Address<br /> <br /> Russell Housley<br /> Vigil Security, LLC<br /> 918 Spring Knoll Drive<br /> Herndon, VA 20170<br /> USA<br /> <br /> EMail: </strong></font><a href="mailto:housley@vigilsec.com"><font color="#000000"><strong>housley@vigilsec.com</strong></font></a><br /> <br /> <font color="#000000"><strong>Full Copyright Statement<br /> <br /> Copyright (C) The Internet Society (2003). All Rights Reserved.<br /> <br /> This document and translations of it may be copied and furnished to<br /> others, and derivative works that comment on or otherwise explain it<br /> or assist in its implementation may be prepared, copied, published<br /> and distributed, in whole or in part, without restriction of any<br /> kind, provided that the above copyright notice and this paragraph are<br /> included on all such copies and derivative works. However, this<br /> document itself may not be modified in any way, such as by removing<br /> the copyright notice or references to the Internet Society or other<br /> Internet organizations, except as needed for the purpose of<br /> developing Internet standards in which case the procedures for<br /> copyrights defined in the Internet Standards process must be<br /> followed, or as required to translate it into languages other than<br /> English.<br /> <br /> The limited permissions granted above are perpetual and will not be<br /> revoked by the Internet Society or its successors or assignees.<br /> <br /> This document and the information contained herein is provided on an<br /> &quot;AS IS&quot; basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING<br /> TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING<br /> BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION<br /> HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF<br /> MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.<br /> <br /> Acknowledgement<br /> <br /> Funding for the </strong></font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000"><strong>RFC</strong></font></a><font color="#000000"><strong>Editor function is currently provided by the<br /> Internet Society.<br /> </strong>ftp://ftp.rfc-editor.org/in-notes/rfc3560.txt</font></p></div></body></html>