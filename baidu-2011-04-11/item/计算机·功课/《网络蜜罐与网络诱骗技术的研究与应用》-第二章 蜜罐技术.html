<html><head><title>《网络蜜罐与网络诱骗技术的研究与应用》-第二章 蜜罐技术</title></head><body><div id='tit'>《网络蜜罐与网络诱骗技术的研究与应用》-第二章 蜜罐技术</div><div id='cate'>计算机&middot;功课</div><div id='date'>2008年01月02日 星期三 02:38 A.M.</div><div id='page'>178</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/f2b8b51b923ad91d8718bf7e.html'>http://hi.baidu.com/hxzon/blog/item/f2b8b51b923ad91d8718bf7e.html</a><div id='cnt'><pre></pre>
<h1><strong>
  <center>
   <font color="#ff0000">《网络蜜罐与网络诱骗技术的研究与应用》 <h3><font color="#0000ff"> 美国GeneChiu基金资助</font></h3></font>
  </center></strong></h1>
<h3></h3>
<h2>第二章 蜜罐技术</h2> 1.1 蜜罐技术的发展背景 当今世界，计算机网络的触角已伸向了地球的各个角落，深入各个领域，它正在对人们的生活方式和工作方式产生着 前所未有的影响，如同交通工具和水力、电力一样日益成为人们生活中不可缺少的组成部分。同时，随着网络规模的 不断扩大，人们对网络知识的了解越来越深入，网络上的攻击行为变得越来越多，已经严重威胁到网络与信息的安全。 计算机网络信息安全已成为一个倍受关注的问题。 2.1蜜罐概述 2.1.1 蜜罐的概念 “蜜罐”这一概念最初出现在1990 年出版的一本小说《The Cuckoo’s Egg》中，在这本小说中描述了作者作为一个 公司的网络管理员，如何追踪并发现一起商业间谍案的故事。“蜜网项目组”（The Honeynet Project）的创始人 Lance Spitzner给出了对蜜罐的权威定义[3]：蜜罐是一种安全资源，其价值在于被扫描、攻击和攻陷。这个定义表 明蜜罐并无其他实际作用，因此所有流入/流出蜜罐的网络流量都可能预示了扫描、攻击和攻陷。而蜜罐的核心价值 就在于对这些攻击活动进行监视、检测和分析。蜜罐并非一种安全解决方案，这是因为蜜罐并不会“修理”任何错误。 蜜罐只是一种工具，如何使用这个工具取决于使用者想要做到什么。蜜罐可以仅仅是一个对其他系统和应用的仿真， 可以创建一个监禁环境将攻击者困在其中，还可以是一个标准的产品系统。无论使用者如何建立和使用蜜罐，只有蜜罐 受到攻击，它的作用才能发挥出来。为了方便攻击者攻击，最好是将蜜罐设置成域名服务器（Domain Name Server, DNS）、 Web或电子邮件转发服务等流行应用中的某一种。蜜罐在系统中的一种配置方法如图2-1所示，从中可以看出其在整个 安全防护体系中的地位。 
<center> 
 <img height="330" width="448" src="image/《网络蜜罐与网络诱骗技术的研究与应用》-.tu2-1.jpg" />
 <p class="origImg">http://210.40.7.188/E yan/09/MGXP/tu2-1.jpg</p> 图2-1 蜜罐系统在安全工作中的地位 
</center> 蜜罐是用来被探测、被攻击甚至最后被攻陷的，它不会修补任何东西，这样就为我们提供了额外的、有价值的信息。 蜜罐不会直接提高计算机网络安全，但它却是其他安全策略所不可代替的一种主动防御技术。 2.1.2 蜜罐的发展历程 蜜罐技术的发展历程可以分为以下三个阶段。 从九十年代初蜜罐概念的提出直到1998 年左右，“蜜罐”还仅仅限于一种思想，通常由网络管理人员应用，通过欺骗 黑客达到追踪的目的。这一阶段的蜜罐实质上是一些真正被黑客所攻击的主机和系统。 从1998 年开始，蜜罐技术开始吸引了一些安全研究人员的注意，并开发出一些专门用于欺骗黑客的开源工具， 如Fred Cohen 所开发的DTK（欺骗工具包）、Niels Provos 开发的Honeyd 等，同时也出现了像KFSensor、Specter 等一些商业蜜罐产品。这一阶段的蜜罐可以称为是虚拟蜜罐，即开发的这些蜜罐工具能够模拟成虚拟的操作系统和网络 服务，并对黑客的攻击行为做出回应，从而欺骗黑客。虚拟蜜罐工具的出现也使得部署蜜罐也变得比较方便。 但是由于虚拟蜜罐工具存在着交互程度低，较容易被黑客识别等问题，从2000 年之后，安全研究人员更倾向于使用真实 的主机、操作系统和应用程序搭建蜜罐，但与之前不同的是，融入了更强大的数据捕获、数据分析和数据控制的工具， 并且将蜜罐纳入到一个完整的蜜网体系中，使得研究人员能够更方便地追踪侵入到蜜网中的黑客并对他们的攻击行为进行 分析。 2.1.2 蜜罐的安全价值 蜜罐并不会替代其它安全防护工具，例如防火墙、入侵检测系统等。它们是增强现有安全性的强大工具，是一种可以 了解黑客常用工具和工具策略的有效手段。 安全就是降低各种网络威胁，网络用户永远都不能忽视各种威胁的存在，而安全就是降低组织受到的威胁并保护组织 中的信息资源。下面，根据 Ｂｒｕｃｅ Ｓｃｈｎｅｒｉｅｒ 在“Ｓｅｃｒｅｓｔｓ ａｎｄ Ｌｉｅｓ”中的定义， 从３个方面来研究蜜罐的安全实现价 值[6]。 （１）防护 安全工作者所能做的就是阻止恶意攻击者，尽可能地防止威胁。蜜罐则在防护中做的贡献很少，蜜罐不会将那些试图 攻击的入侵者拒之门外。将入侵者阻挡在外部的安全产品在防护中可以做到最好，比如关闭不需要的或不安全的服务， 而且还可以通过强认证机制来保障只有合法的用户才能访问相应的服务。而蜜罐设计的初衷就是妥协，因此它不会将 入侵者拒绝在系统之外，事实上，蜜罐希望有人闯入系统，从而进行各项记录和分析工作。 有些人认为诱骗也是一种对攻击者进行防护的方法，因为诱骗使攻击者花费大量的时间和资源对蜜罐进行攻击，这就 防止了攻击者对实际资源进行攻击。也就是说，攻击者会被吸引到蜜罐中对它进行攻击演练，从而一定程度上保证了 真正的网络资源不会受到攻击。蜜罐的诱骗在一定程度上的确提供了安全防护的效果，但是，如果想要得到更高和好 的防护效果，人们会主动去选取那些专门进行防护的安全产品。 （２）检测 虽然蜜罐的防护功能偏弱，但是它有很强的检测功能。对于部分组织来说，检测网络攻击是难度系数很大的一件事。 许多组织面临的是大量的正常网络通信与可疑的网络攻击行为混杂在一起的网络，比如千兆比特网络里的系统日志， 想要从大量的网络行为中检测出攻击行为是一件非常困难的事情，甚至检测出哪些系统已经被攻陷也是一件困难的 事情。入侵检测系统（ＩＤＳ）是专门为检测攻击而设计的检测工具，然而 ＩＤＳ 中发生的误报使系统管理员的 工作变得极其繁重。误报是指 ＩＤＳ 的探测器认为那些合法的网络行为具备了入侵攻击行为特征，就向系统管理 员发出警告并要求进行处理。由于误报率很高，ＩＤＳ 系统管理员每天不得花费大量时间来处理不计其数的报警信 息，以至于不能完全处理完报警信息数据当真正的网络攻击行为到来时，系统管理员已经疲于处理过多的“误报”， 而放弃了真正的攻击行为所采取的攻击行动。 高误报率往往使ＩＤＳ失去有效告警的作用，而蜜罐的误报率则远远低于大部分的 ＩＤＳ 工具。 另一个问题是漏报，发生在 ＩＤＳ 没有检测出攻击时。大部分 ＩＤＳ，无论是基于特征匹配的还是基于协议分析 的，都有可能遗漏新型的或未知的攻击。目前的 ＩＤＳ 技术不能够有效地对新型攻击方法进行检测。同时，攻击者 们一直在开发和研究、散布着各种各样的新型的 ＩＤＳ 逃避策略，也在不断开发着各种各样的不能被 ＩＤＳ 检测 出来的攻击，甚至是 ＩＤＳ 本身的攻击技术，比如 Ｋ２的 ＡＤＭＭｕｔａｅ。 蜜罐可以解决漏报问题，因为它们很难躲避也很难被新的攻击方法攻陷。实际上使用蜜罐的首要目标就是在新的攻击 和未知的攻击发生的时候将它们检测出来。蜜罐系统管理员无需担心特征数据库的更新和检测引擎的修订，也无需知 晓对方使用何种攻击策略和攻击工具，因为蜜罐最希望看到的就是攻击是如何进行的。 蜜罐可以简化检测的过程。因为蜜罐没有任何有效的行为，所以所有与蜜罐相联系的网络行为都可以认定为可疑行为。 从原理上来讲，任何连接到蜜罐的连接都应该是侦探、扫描和攻击的一种。无论何时蜜罐发起一个连接，都可以认为 蜜罐系统向攻击者妥协，这样就可以极大地降低误报率和漏报率，从而简化了检测过程。现在有很多蜜罐系统也自己 发起自己的连接，这样做的目的也是为了迷惑攻击者。 其实，从某种意义上讲，蜜罐系统已经成为一个越来越复杂的安全检测工具。在某些技术领域里，而也可被称作为 ＩＤＳ 的一个新型演变。 （３）响应 尽管在一般意义上讲，蜜罐也可以进行响应如果组织内的系统已经被入侵，这之后发生的所有的行为都是与入侵者相关 的“污点证明”数据但是，如果内部用户和系统行为也掺杂到这些记录的数据中，系统管理员就无法知道区别，也就无 法处理了。就如同系统管理员登录到网页服务器上，发现所有登录在网站上的用户都在使用已经被入侵的系统，这时候， 再想收集入侵者的攻击行为证据就是一件很难的事情。 必须解决的问题是那些发生入侵事故的系统在被入侵之后不能脱机工作。否则，这些系统所提供的所有产品服务都将停止。 同时，系统管理员也不能进行合适和全面的鉴定分析。 蜜罐可以解决甚至消除以上两个问题，它提供了一个具有低数据污染的系统，并且这个系统可以随时进行脱机工作。 例如，某组织有 ３ 台服务器，这些服务器都被入侵了，系统管理员也可以进入系统并可以清楚特定问题，但他依然有 可能不知道错误出在何处？系统受到何种程度的破坏？攻击者是否依然存在于系统内部？攻击者使用了何种攻击策略和 行为？此时，如果将其中一台设置为蜜罐系统，系统管理员则可以将该系统置于脱机状态来进行鉴定工作。基于这些分析， 系统管理员不仅能知道入侵者是如何进入系统的，而且还可以知道他做了那些坏事。根据这些经验，系统管理员就可以很 好地解决其它 ２ 台服务器的安全问题，并可以在以后的工作中较好的防止进一步地网络攻击。 2.1.3 蜜罐面临的法律问题 蜜罐能够帮助一个组织发展它的事件响应能力。在过去的几年中，蜜罐已经极大地提高了检测、响应、恢复和分析受侵害 系统的能力。如果管理员发现了一个受到入侵的系统，管理员可以使用各种技术来捕获或者分析入侵者的行为并且不被他 察觉。同时，关于入侵的数据也可以存储在一个攻击特征库中，今后如果在其他事件中发现类似的特征代码，管理员就可 以轻易地判断出攻击方式。但是在发展的过程中，蜜罐也会不可避免地碰到一些法律方面的问题。 尽管蜜罐的最初设计目标是为了起诉攻击者提供证据收集的手段，但是有的国家法律规定，蜜罐收集的证据不能作为起诉 证据。安全专家指出该提议存在漏洞，因为根据这项方案IT部门正当保护他们系统的安全的某些软件和技术也是违法的。 首先，只要谈及蜜罐，就会使人联想到“诱骗”。诱骗的法律定义是：在本没有意图触犯法律的情况下，在法律实施者或 者是其代理人引诱或者劝诱下触犯法律。有人认为，诱骗并不是问题。是诱捕行动是否会触犯法律的问题，诱捕行为仅仅 是一种防御方法，而不是攻击行为，因此诱捕行为不会触犯到法律，这里需要注意的原则是不要对部署的蜜罐进行宣传从 而引诱黑客进行攻击。 其次，可能会涉及到的法律问题是对隐私权的侵犯，在各个国家都制定了许多保护个人隐私权的法律，可能有些法律会保 护个人网络通信的隐私权，但还没有直接针对蜜罐的法律。最可能引发法律纠纷的是黑客利用蜜罐对第三方网络发起攻击 造成破坏后，被攻击的第三方可能会对蜜罐的部署方提出诉讼。因此对黑客利用蜜罐向第三方网络发起的攻击需要采取强 有力的控制措施，必要时完全切断蜜罐的网络连接，从而尽量避免此风险。 蜜罐是用来给黑客入侵的，它必须提供一定的漏洞，但是我们也知道，很多漏洞都属于“高危”级别，稍有不慎就会导致 系统被渗透，一旦蜜罐被破坏，入侵者要做的事情是管理员无法预料的，例如，一个入侵者成功进入了一台蜜罐，并且用 它做“跳板”（指入侵者远程控制一台或多台被入侵的计算机对别的计算机进行入侵行为）去攻击别人，那么这个损失由 谁来负责？设置一台蜜罐必须面对三个问题：设陷技术、隐私、责任。 设陷技术关系到设置这台蜜罐的管理员的技术，一台设置不周全或者隐蔽性不够的蜜罐会被入侵者轻易识破或者破坏，由 此导致的后果将十分严重。 由于蜜罐属于记录设备，所以它有可能会牵涉到隐私权问题，如果一个企业的管理员恶意设计一台蜜罐用于收集公司员工 的活动数据，或者偷偷拦截记录公司网络通讯信息，这样的蜜罐就已经涉及法律问题了。 对于管理员而言，最倒霉的事情就是蜜罐被入侵者成功破坏了。有人也许会认为，既然蜜罐是故意设计来“牺牲”的，那 么它被破坏当然合情合理，用不着小题大做吧。对，蜜罐的确是用来“受虐”的，但是它同时也是一台连接网络的计算机， 如果你做的一台蜜罐被入侵者攻破并“借”来对某大学服务器进行攻击，因此引发的损失恐怕只能由你来承担了。还有一些 责任是谁也说不清的，例如，你做的一台蜜罐不幸引来了Slammer、Sasser、Blaster等大名鼎鼎的“爬虫类”病毒而成了 传播源之一，那么这个责任谁来负担？ 2.2 蜜罐技术基础 在研究和应用蜜罐技术之前，我们必须了解和掌握一些前提知识，下面将具体介绍这些内容，它们包括网络安全面临的威胁、 数据收集的方法、防火墙和IDS。 2.2.1 网络安全面临的威胁 随着因特网的发展，基于网络的应用信息系统也愈来愈多，包括电子商务、电子政务、电子税务、电子银行、电子海关、 电子证券、网络书店、网上拍卖、网络购物、网络防伪、CTI（客户服务中心）、网上交易和网上选举等。网络信息系统在 政治、军事、金融、商业、交通、电信和文教等方面发挥越来越大的作用，社会对网络信息系统的依赖也日益增强。网络与 信息系统变成“金库”，当然就会吸引大批合法或非法的“淘金者”，所以网络信息的安全问题变得越来越重要。 现在，我们的网络资源每天都面临着黑客和自身的威胁，这些威胁来自恶意攻击、安全缺陷、软件漏洞和结构隐患。下面将 对它们进行详细论述。 1. 恶意攻击 人为的恶意攻击是有目的的破坏。恶意攻击可以分为主动攻击和被动攻击。主动攻击是指以各种各样方式有选择地破坏信息 （如修改、删除、伪造、添加、重放、乱序、冒充和病毒等）。被动攻击是指在不干扰网络信息系统正常工作的情况下，进 行侦听、截获、窃取、破译和业务流量分析及电磁泄露等。 人为恶意攻击主要来自有明显企图的操作者，其危害性相当大，给国家安全、知识产权和个人信息带来巨大的威胁。人为恶 意攻击具有以下特征： ? 智能性：从事恶意攻击的人员大都具有相当高的专业技术和熟练的操作技能。他们在攻击前都经过了周密的预谋和精心策划。 ? 严重性：对涉及到金融资产的网络信息进行恶意攻击，往往会由于资金损失巨大，而使金融机构、企业蒙受重大损失，甚至 破产，同时，也给社会带来动荡。 ? 隐蔽性：人为恶意攻击的隐蔽性很强，不易引起怀疑，破案的技术难度大。一般情况下，其犯罪的证据存在于软件的数据和 信息资料之中，若无专业知识很难获取侦破证据。相反，犯罪行为人却可以很容易地毁灭证据。计算机犯罪的现场也不象是 传统犯罪现场那样名明显。 ? 多样性：随着计算机互联网的迅速发展，网络信息系统中的恶意攻击也随之发展变化。出于经济利益的巨大诱惑，近年来， 各种恶意攻击主要集中于电子商务和电子金融领域。攻击手段日新月异，新的攻击目标包括偷税漏税、利用自动结算系统 洗钱以及在网络上进行盈利性的商业间谍活动等等。 因特网上以人为恶意攻击为代表的高技术犯罪的另一大发展趋势是网络犯罪集团化。由于网络上的安全机制不断加强，今后的 网络犯罪将需要更强的技术力量，这种客观要求加上网络上日益增长的经济利益将诱使计算机犯罪集团尤其是跨国犯罪集团将 黑手伸向网络通信系统。这对计算机网络安全提出了更大挑战。 下面简要介绍一些有代表性的恶意攻击： ? 信息战：这是一种以获得控制信息权为目标的无硝烟的战争。信息战可以说是一种国家行为的恶意攻击。信息战的攻击目标 包括各种军事命令、通信、能源、运输和金融等与国家的政治、经济、文化密切相关的系统。在和平时期，信息战处于绝对 隐蔽状态。但是，一旦战争爆发，信息战将出其不意地发挥出巨大的破坏力。美军在伊拉克实施的“沙漠风暴”战争便是典 型的信息战例。 ? 商业间谍：利用因特网收集别国的重要商业情报，其目标是获得有价值的信息、能力、技术和对自身有利的谈判地位。在多 数情况下，商业间谍属于一种集团行为的恶意攻击。 ? 窃听：在广播式网络信息系统中，每个节点都能读取网上的数据。对广播网络的基带同轴电缆或双绞线进行搭线窃听是很容 易的，安装通信监视器和读取网上的信息也很容易。网络体系结构允许监视器接受网上传输的所有数据帧而不考虑帧的传输 目的地址，这种特性使得偷听网上的数据或非授权访问很容易且不易被发现。 ? 流量分析：它能通过对网上信息流的观察和分析推断出网上数据信息，比如有无传输、传输的数量、方向和频率等。因为网 络信息系统的所有节点都能访问全网，所以流量的分析易于完成。由于报头信息不能被加密，所以即使对数据进行了加密处 理，也可以进行有效的流量分析。 ? 破坏完整性：有意或无意地修改或破坏信息系统，或者在非授权和不能监测的情形下对数据进行修改。 ? 重发：重发是重复一份报文或报文的一部分，以便产生一个被授权效果。当节点拷贝发到其他节点的报文并在其重发他们时， 如果不能监测，节点依据此报文的内容接受某些操作，例如报文的内容是关闭网络的命令，则将会出现严重的后果。 ? 假冒：当一个实体假扮成另一个实体时，就发生了假冒。一个非授权节点或一个不被信任的、有危害的授权节点都能冒充一 个授权节点，而且不会有多大困难。很多网络适配器都允许网帧的源地址由节点自己来选取或改变，这就使假冒变得较为容易。 ? 拒绝服务：当一个授权实体不能获得对网络资源的访问或当紧急操作被推迟时，就发生了拒绝服务。拒绝服务可能由网络部件 的物理损坏而引起，也可能由使用不正确的网络协议而引起，也可能由超载而引起。 ? 资源的非法授权使用：即与所定义的安全策略不一致的使用。因常规技术不能限制节点收发信息，也不能限制节点侦听数据， 一个合法节点能访问网络上的所有数据和资源。 ? 干扰：干扰是由一个节点产生数据来扰乱提供给其他节点的服务。干扰也可能由一个已经损坏的并还在继续传送报文的节点 所引起，或由一个已经被故意改变成具有此效果的节点所引起。频繁的令人讨厌的电子邮件信息是最典型的干扰形式之一。 ? 病毒：目前，全世界已经发现了上万种计算机病毒，包括DOS病毒、Windows型、UNIX型、宏病毒、Macitoch型和众多的 E-mail病毒。计算机病毒的数量已有了相当的规模，并且新的病毒还在不断出现。随着计算机技术的不断发展和人们对计算 机系统和网络依赖程度的增加，计算机病毒已经构成了对计算机系统和网络的严重威胁。 ? 诽谤：利用网络信息系统的广泛互联性和匿名性，散布错误的消息以达到诋毁某人或某公司形象和知名度的目的。 2. 安全缺陷 网络信息系统是计算机技术和通信技术的结合。计算机系统的安全缺陷和通信链路的安全缺陷构成了网络信息系统的潜在安全缺陷。 计算机硬件资源易受自然灾害和认为破坏，软件资源和数据信息易受计算机病毒的侵扰，非授权用户的复制、篡改和毁坏。通信链 路易受自然灾害和人为破坏。采用主动攻击和被动攻击可以窃听通信链路的信息并非法进入计算机网络获取有关敏感性重要信息。 网络信息系统的安全缺陷通常包括物理网络的安全缺陷、过程网络的安全缺陷以及通信链路安全缺陷3种。下面介绍一些普遍存在的 安全缺陷、安全问题和安全脆弱性: ? 网络的规模：网络的规模越大，通信链路越长，则网络的脆弱性和安全问题也越多。网络用户数量增加了，网络的安全性威胁也 随之增加。 ? 电磁辐射和电磁泄露：计算机及其外围设备在进行信息处理时会产生电磁泄露，即电磁辐射。电磁辐射分辐射发射和传导发射两种。 计算机网络传输媒介的多样性和网内设备分布的广泛性，使得电磁辐射造成信息泄露的问题变得十分严重。国外一些发达国家研制的 设备能在一公里以外收集计算机站的电磁辐射信息，并且能区分不同计算机终端的信息。因此，电磁辐射已对网络信息的安全构成严 重威胁。 ? 搭线：现行计算机网络的传输媒介主要是同轴电缆和现有电话线路等，这些通信线路很容易进行搭线窃听。搭线窃听的手段主要有 两种：其一，利用磁记录设备和计算机终端从信道中截获有关计算机信息，然后对记录信息进行加工、综合、分析，提取有用信息； 其二，搭线者不仅截获有关信息，而且试图更改、延迟被传送的信息，从而造成更大的威胁。 ? 串音。在有线通信链路中（光纤除外），由于电磁泄露和信道间寄生参数的交叉耦合，当一个信道进行信息传送时，会在另一个或 多个相邻信道感应出信号或噪声即串音。串音也可以在网络交换中心产生。串音不但使网络内的噪声增加，传输的信息发生畸变， 而且会引起传导泄露，对信息保密构成威胁。 ? 由技术被动性引起的安全缺陷。首先，我们的芯片基本依赖于进口，即使是自己开发的芯片也需要到国外加工。其次，为了缩小与 世界先进水平的差距，我国引进了不少外国设备，但这也同时带来了不可轻视的安全缺陷。 ? 人员素质问题引起的安全缺陷。法律靠人去执行，管理靠人去实现，技术靠人去掌握。人是各个安全环节中最重要的因素。全面提 高人员的道德品质和技术水平是网络信息安全的最重要保证。 ? 缺乏系统的安全标准所引起的安全缺陷。缺乏安全标准不但会造成管理上的混乱，而且也会使攻击者更容易得手。 此外，我国加入WTO也会使我们的网络信息更加开放，当然也就引发更多的黑客事件。对此，我们应该有足够的思想准备和技术措施。 3. 软件漏洞 网络信息系统有硬件和软件组成。由于软件程序的复杂性和编程的多样性，在网络信息系统的软件中很容易有意或无意地留下一些 不易被发现的安全漏洞显然会影响网络的安全。下面介绍一些有代表性的软件安全漏洞： （1）陷门及其防范 所谓陷门是一个程序模块的秘密的未记入文档的入口。一般陷门是在程序开发时插入的一小段程序，其目的是测试这个模块或是为了 连接将来的更改和升级程序，或者是为了将来发生故障后，为程序员提供方便等合法用途。通常在程序开发后期将去掉这些陷门，但 是由于各种有意或无意的原因，陷门也可能被保留下来。 陷门一旦被原来的程序员利用，或者被无意或有意的人发现将会带来严重的安全后果。非法利用陷门可以使得原来相互隔离的网络信 息形成某种隐蔽的关联，进而可以非法访问网络，达到窃取、更改、伪造和破坏的目的，甚至有可能造成网络信息系统的大面积瘫痪。 对付陷门的方法可以归纳为： ? 加强程序开发阶段的安全控制，防止有意破坏并改善软件的可靠性； ? 在程序的使用过程中实行科学的安全控制； ? 制定规范的软件开发标准，加强管理，对相关人员的职责进行有效监督，改善软件的可用性和可维护性。 （2）操作系统的安全漏洞与防范 操作系统是硬件和软件应用程序之间接口的程序模块，它是整个网络信息系统的核心控制软件，系统的安全体现在整个操作系统之中。 操作系统的安全漏洞如下： ? 输入/输出（I/O）非法访问； ? 访问控制的混乱； ? 不完全的中介； ? 操作系统陷门。 为了健全安全的操作系统，首先必须构造操作系统的安全模型（单级安全模型、多级安全模型和系统流模型等）和不同的实施方法。 其次应该采取诸如隔离、核化（最小特权等）和环结构（开放设计和完全中介）等安全科学的操作系统设计方法。再者，还需要建 立和完善操作系统的评估标准、评价方法和测试质量。 （3）数据库的安全漏洞与防范 数据库是从操作系统的文件系统基础上派生出来的用于大量数据的管理系统。数据库的全部数据都记录在存储媒体上，并由数据库 管理系统（DBMS）统一管理。DBMS为用户及应用程序提供一种访问数据的方法，并且对数据库进行组织和管理，并对数据库进行维 护和恢复。数据库系统的安全策略，部分由操作系统来完成，部分由强化DBMS自身安全措施来完成。数据系统存放的数据往往比计 算机系统本身的价值大得多，必须加以特别保护。 （4）TCP/IP协议的安全漏洞与防范 尽管TCP/IP技术在网络方面取得了巨大的成功，但也越来越暴露出它的不足之处。TCP/IP通信协议，在设计初期并没有考虑到安全 性问题，而且用户和网络管理员没有足够的精力专注于网络安全控制，加上操作系统和应用程序越来越复杂，开发人员不可能测试 出所有安全漏洞，连接到网络上的计算机系统就可能受到外界的恶意攻击和窃取。在异种机型间资源共享的背后，是既令黑客心动， 又让网络安全专家头痛的一个又一个的漏洞和缺陷，如脆弱的认证机制、容易被窃取或监视、易受欺骗、有缺陷的LAN服务和相互信 任的主机、复杂的设置和控制、基于主机的安全不易扩展、IP地址的不保密性等。 为了尽可能解决TCP/IP的安全问题，INTERNET的技术管理机构IETF研究了一种新版本IP协议，称为Ipv6。新的IP协议地址长度由现在 的32位扩展到128位，增加了安全机制，重点从鉴别和保密两个方面制定了一系列标准，以支持21世纪的应用。此外，国际上一些公 司还相继提出了许多安全协议。比如SSL、S-HTTP、SEEP、SET和IKP等。 （5）网络软件与网络服务的漏洞 比较常见的网络软件与网络服务漏洞如下：Finger的漏洞、匿名FTP、远程登录、电子邮件、口令设置的漏洞等等。 4. 结构隐患 （1）网络拓扑结构的安全漏洞：拓扑逻辑是构成网络的结构方式，是连接在地理位置上分散的各个节点的几何逻辑方式。拓扑逻辑 决定了网络的工作原理及网络信息的传输方式，一旦网络的拓扑逻辑被选定，必定要选择一种适合这种拓扑逻辑的工作方式与信息的 传输方式。如果这种选择和配置不当，将为网络安全埋下隐患。事实上，网络的拓扑结构本身就有可能给网络的安全带来问题。 （2）网络硬件的安全缺陷：作为网络信息系统的躯体，网络硬件的安全隐患也是网络结构缺陷的重要方面。这其中包括网桥和路由器 的安全隐患问题。 2.2.2 数据收集的方法 要进行信息分析，首先要进行数据收集。因此，蜜罐技术离不开数据收集。数据收集有三种方式：基于主机的信息收集、基于网络的 信息收集和主动信息收集方式。 1. 基于主机的信息收集 基于主机收集到数据可以存放在蜜罐中，比如说放在一个隐藏的分区中，这种做法的缺点是系统管理员不能及时研究这些数据。本地 存储的另外一个问题是可能将保留的日志空间用尽，这样系统就会降低交互程度甚至变为不受监控。攻击者也会了解日志区域并且试 图控制它，不管攻击者如何处理日志数据，后果都会使日志文件中的数据不再是可信数据。因此，本地存储数据是不可信的。将攻击 者的信息存放在一个安全的、远程的地方更具有可信度。当然如果攻击者发现有日志记录机制，攻击者可能会制造“假”的日志数据 （或者干脆将日志进程停掉），但他对离开蜜罐的数据将无能为力。将连续数据存储到远程服务器可以通过串行设备、并行设备、 USB或Firewire技术和网络接口（比如说通过网卡发送UDP数据包到远程日志服务器上）。当然也可以考虑使用专门的日志记录硬件设 备，如特殊的PCI卡，但这些方案目前还没有实现。 2. 基于网络的信息收集 基于主机的信息收集定位于主机本身，这就很容易被探测并且一旦探测到就可能被终止。所以，出现了基于网络的信息收集。基于 网络的信息 收集没有将收集机制设于蜜罐上，它以一种不见的方式执行，因为数据只能被分析但不能被更改。基于网络的信息收集比基于主机 的信息收集更安全，因为它很难被探测到而且很难被终止。其中的一些信息可以由防火墙来收集，通过配置防火墙记录特定的数据 甚至是所有的数据。另一个办法是安装IDS，利用IDS检测可疑的数据包。大多数的IDS能够配置成将可疑的对话记录到一个单独的 文件中，同时一些协议能够被解析并以明文的形式记录。 3. 主动方式的信息收集 以上介绍的收集蜜罐中信息的方法都是被动的，信息是网络中的数据或是机器自身的数据，没有信息是通过询问第三方而获取的。 但信息的收集不应该是被动，所以，可以通过询问特殊的服务或机器来获取个人、IP地址或攻击者的信息，这样就可以发现更多 有价值的数据，但这种方式也很危险，因为攻击者会察觉并离开蜜罐。以下是几种常见的可利用的服务：whois、网络通信指纹、 端口扫描和finger。其中的某些方法可能被入侵者检测到，所以要冒的风险相对较大。 2.2.3 蜜罐技术的必备技术—防火墙和IDS 防火墙就是一个位于计算机和它所连接的网络之间的软件。实现防火墙的实际方式各不相同，但是在原则上，防火墙可以被认为是 这样一对机制：一种机制是拦阻传输流通行，另一种机制是允许传输流通过。防火墙对流经它的网络通信进行扫描，这样能够过滤 掉一些攻击，以免其在目标计算机上被执行。防火墙还可以关闭不使用的端口。而且它还能禁止特定端口的流出通信，封锁特洛伊 木马。最后，它可以禁止来自特殊站点的访问，从而防止来自不明入侵者的所有通信。防火墙有不同类型。一个防火墙可以是硬件 自身的一部分，用户可以将因特网连接和计算机都插入其中。防火墙也可以在一个独立的机器上运行，该机器作为它背后网络中所 有计算机的代理和防火墙，直接连在因特网的机器可以使用个人防火墙。 入侵检测技术（IDS，intrusion detection system）是为保证计算机系统的安全而设计与配置的一种能够及时发现并报告系统中未 授权或异常现象的技术，是一种用于检测计算机网络中违反安全策略行为的技术。入侵检测系统能够识别出任何不希望有的活动， 这种活动可能来自于网络外部和内部。入侵检测系统的应用，能使在入侵攻击对系统发生危害前，检测到入侵攻击，并利用报警与 防护系统驱逐入侵攻击。在入侵攻击过程中，能减少入侵攻击所造成的损失。在被入侵攻击后，收集入侵攻击的相关信息，作为防范 系统的知识，添加入知识库内，以增强系统的防范能力。典型的IDS系统模型包括三个功能部件： 1.提供事件记录流的信息源； 2.发现入侵迹象的分析引擎； 3.基于分析引擎的分析结果产生反映的响应部件。 目前的IDS作为只能是网络安全整体解决方案的一个重要部分，需要与其他安全设备之间进行紧密的联系，共同解决网络安全问题。 也许未来的IDS需要一种新的系统体系来克服自身的不足，但目前只能同过将IDS的各个功能模块与其他安全产品有机地融合起来。 共同解决网络的安全问题，这就对引入协同提出了要求。
<p><a href="http://210.40.7.188/E yan/09/MGXP/000.asp">http://210.40.7.188/E'yan/09/MGXP/000.asp</a></p></div></body></html>