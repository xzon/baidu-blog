<html><head><title>权限设计数据库结构表</title></head><body><div id='tit'>权限设计数据库结构表</div><div id='cate'>设计方案</div><div id='date'>2009年08月19日 星期三 10:19 A.M.</div><div id='page'>37</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/c799814428a0db45500ffe69.html'>http://hi.baidu.com/hxzon/blog/item/c799814428a0db45500ffe69.html</a><div id='cnt'><p> </p> 
<p>权限设计数据库结构表</p> 
<ul>
 <li class="alt"><span><span class="comment">--权限许可&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span></span></li> 
 <li><span class="keyword">create</span><span> </span><span class="keyword">table</span><span> res_permission&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>(&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>roleid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">INTEGER</span><span>,&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>resourceid&nbsp;&nbsp; varchar2(30),&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>operationid </span><span class="keyword">integer</span><span>,&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span class="keyword">primary</span><span> </span><span class="keyword">key</span><span>(roleid,resourceid,operationid)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span class="comment">--角色定义&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span></li> 
 <li><span class="keyword">create</span><span> </span><span class="keyword">table</span><span> res_role&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>(&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>roleid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">INTEGER</span><span>,&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>rolename&nbsp;&nbsp;&nbsp;&nbsp; varchar2(30),&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>roledesc&nbsp;&nbsp;&nbsp;&nbsp; varchar2(100),&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span class="keyword">primary</span><span> </span><span class="keyword">key</span><span>(roleid)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span class="comment">--角色权限&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span></li> 
 <li class="alt"><span class="keyword">create</span><span> </span><span class="keyword">table</span><span> res_userrole&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>(&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>roleid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">INTEGER</span><span>,&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>userid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; varchar2(30),</span><span class="comment">--用户名&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span></li> 
 <li class="alt"><span class="keyword">primary</span><span> </span><span class="keyword">key</span><span>(roleid,userid)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span class="comment">--资源&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span></li> 
 <li class="alt"><span class="keyword">create</span><span> </span><span class="keyword">table</span><span> res_resource&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>(&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>resourceid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; varchar2(20),&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>resourcename&nbsp;&nbsp;&nbsp;&nbsp; varchar2(30),&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>resourcedesc&nbsp;&nbsp;&nbsp;&nbsp; varchar2(100),&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span class="keyword">primary</span><span> </span><span class="keyword">key</span><span>(resourceid)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span class="comment">--操作信息&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span></li> 
 <li class="alt"><span class="keyword">create</span><span> </span><span class="keyword">table</span><span> res_operation&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>(&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>operationid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; varchar2(20),&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span>operationname&nbsp;&nbsp;&nbsp;&nbsp; varchar2(30),&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>operationdesc&nbsp;&nbsp;&nbsp;&nbsp; varchar2(100),&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span class="keyword">primary</span><span> </span><span class="keyword">key</span><span>(operationid)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li class="alt"><span>)&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span class="comment">--res_operation 表的序列号&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span></li> 
 <li class="alt"><span class="keyword">create</span><span>&nbsp;&nbsp;</span><span class="keyword">sequence</span><span>&nbsp;&nbsp;&nbsp; res_operation_seq;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span class="comment">--res_role 表的序列&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span></li> 
 <li class="alt"><span class="keyword">create</span><span>&nbsp;&nbsp;</span><span class="keyword">sequence</span><span>&nbsp;&nbsp;&nbsp; res_role_seq;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span class="comment">--建立soperationid与sroleid两个序列分别用来产生Operation表与Role表的ID列&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span></li> 
 <li class="alt"><span class="keyword">create</span><span> </span><span class="keyword">sequence</span><span> soperationid increment </span><span class="keyword">by</span><span> 1 start </span><span class="keyword">with</span><span> 1 nomaxvalue minvalue 1;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li> 
 <li><span class="keyword">create</span><span> </span><span class="keyword">sequence</span><span> sroleid increment </span><span class="keyword">by</span><span> 1 start </span><span class="keyword">with</span><span> 1 nomaxvalue minvalue 1;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span> <p>--表设计的原理<br /> --根据交叉法来匹配权限<br /> --1:根据用户表中的用户id关联到res_userrole的userid，然后再关联到res_role，查出用户对应的所有权限，存放到list中<br /> --2:根据资源和操作查询出用户可以操作的所有许可res_permission，存放到list中<br /> --3:通过同时遍历两个list，查询出是否存在交叉，如果存在就是有权限，否则为无权限</p> <p> </p> </li>
</ul></div></body></html>