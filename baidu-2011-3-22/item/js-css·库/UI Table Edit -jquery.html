<html><head><title><div class="tit">
  UI Table Edit -jquery
</div></title></head><body><div id='tit'>UI Table Edit -jquery</div><div id='cate'>js-css&middot;库</div><div id='date'>2008年11月01日 星期六 11:18 P.M.</div><div id='page'>87</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/64697f3126d9b41eeac4af5a.html'>http://hi.baidu.com/hxzon/blog/item/64697f3126d9b41eeac4af5a.html</a><div id='cnt'><div> 
 <p> </p> 
 <h2>UI Table Edit -jquery</h2> 
 <p> </p> 
 <div class="node">
  <span class="submitted">December 15, 2007 - 10:37pm — <a title="View user profile." href="http://plugins.jquery.com/user/1680"><font color="#0f67a1">gregW</font></a></span> 
  <div class="content"> 
   <div class="rating-item"> 
    <div class="rating"> 
     <div class="rating-intro">
      <span class="rating-intro-text">Average rating</span>
     </div> 
     <div class="rating-stars"> 
      <div class="star avg on"> 
      </div> 
      <div class="star avg on"> 
      </div> 
      <div class="star avg on"> 
      </div> 
      <div class="star avg on"> 
      </div> 
      <div class="star avg"> 
      </div> 
     </div> 
     <div class="num-votes">
      (
      <span>2</span> votes)
     </div> 
    </div> 
    <div class="rating"> 
     <div class="rating-intro"> 
     </div> 
    </div> 
   </div> 
   <p>make an html table editable by the user<br /> user clicks on a cell, edits the value,<br /> then presses enter or clicks on any cell to save the new value</p> 
   <p>var t = $('table')<br /> $.uiTableEdit( t ) // returns t</p> 
   <p>documentation at <a style="background-image: none" class="external" title="http://gregweber.info/projects/uitableedit" href="http://gregweber.info/projects/uitableedit"><font color="#176092">http://gregweber.info/projects/uitableedit</font></a></p> 
   <h3>Releases</h3> 
   <table class="releases FCK__ShowTableBorders"> 
    <thead> 
     <tr> 
      <th class="release-title">Official releases</th> 
      <th class="release-date">Date</th> 
      <th class="release-size">Size</th> 
      <th class="release-links">Links</th> 
      <th class="release-status" colspan="2">Status</th> 
     </tr> 
    </thead> 
    <tbody> 
     <tr class="release ok odd"> 
      <td class="release-title"><a href="http://plugins.jquery.com/node/2393"><font color="#0f67a1">0.4</font></a></td> 
      <td class="release-date">2008-Apr-25</td> 
      <td class="release-size">3.52 KB</td> 
      <td class="release-links"> 
       <ul class="links"> 
        <li class="first project_release_download"><a class="project_release_download" href="http://plugins.jquery.com/files/jquery.uitableedit.js_3.txt"><font color="#0f67a1">Download</font></a></li> 
        <li class="last project_release_notes"><a class="project_release_notes" href="http://plugins.jquery.com/node/2393"><font color="#0f67a1">Release notes</font></a></li> 
       </ul> </td> 
      <td class="release-reason">Recommended for <em>1.0.x</em></td> 
      <td class="release-icon"><img style="display: none; oldpaddingtop: ; oldbordertopwidth: ; oldpaddingbottom: ; oldborderbottomwidth: ; oldpaddingright: ; oldborderrightwidth: ; oldpaddingleft: ; oldborderleftwidth: " title="This is currently the recommended release for 1.0.x." alt="This is currently the recommended release for 1.0.x." width="17" height="17" oldblock="inline" src="image/UI Table Edit -jquer.watchdog-ok.png" /><p class="origImg">http://plugins.jquery.com/misc/watchdog-ok.png</p></td> 
     </tr> 
     <tr class="release ok even"> 
      <td class="release-title"><a href="http://plugins.jquery.com/node/3135"><font color="#0f67a1">0.5</font></a></td> 
      <td class="release-date">2008-Jul-06</td> 
      <td class="release-size">3.43 KB</td> 
      <td class="release-links"> 
       <ul class="links"> 
        <li class="first project_release_download"><a class="project_release_download" href="http://plugins.jquery.com/files/jquery.uitableedit.js_4.txt"><font color="#0f67a1">Download</font></a></li> 
        <li class="last project_release_notes"><a class="project_release_notes" href="http://plugins.jquery.com/node/3135"><font color="#0f67a1">Release notes</font></a></li> 
       </ul> </td> 
      <td class="release-reason">Recommended for <em>1.2.x</em></td> 
      <td class="release-icon"><img style="display: none; oldpaddingtop: ; oldbordertopwidth: ; oldpaddingbottom: ; oldborderbottomwidth: ; oldpaddingright: ; oldborderrightwidth: ; oldpaddingleft: ; oldborderleftwidth: " title="This is currently the recommended release for 1.2.x." alt="This is currently the recommended release for 1.2.x." width="17" height="17" oldblock="inline" src="image/UI Table Edit -jquer.watchdog-ok.png" /><p class="origImg">http://plugins.jquery.com/misc/watchdog-ok.png</p></td> 
     </tr> 
    </tbody> 
   </table> 
   <div class="item-list"> 
    <ul> 
     <li><a href="http://plugins.jquery.com/node/1044/release"><font color="#0f67a1">View all releases</font></a></li> 
    </ul> 
   </div> 
   <div class="item-list"> 
    <h3>Support</h3> 
    <ul> 
     <li><a href="http://plugins.jquery.com/project/issues/uiTableEdit?categories=support&amp;states=all"><font color="#0f67a1">View all support requests</font></a></li> 
     <li><a href="http://plugins.jquery.com/project/issues/uiTableEdit?categories=support"><font color="#0f67a1">View pending support requests</font></a></li> 
     <li><a href="http://plugins.jquery.com/project/issues/uiTableEdit?categories=bug"><font color="#0f67a1">View pending bug reports</font></a></li> 
     <li><a href="http://plugins.jquery.com/project/issues/uiTableEdit?categories=feature"><font color="#0f67a1">View pending feature requests</font></a></li> 
     <li><a href="http://plugins.jquery.com/user/login?destination=node/add/project-issue/uiTableEdit"><font color="#0f67a1">Login</font></a> or <a href="http://plugins.jquery.com/user/register?destination=node/add/project-issue/uiTableEdit"><font color="#0f67a1">register</font></a> to create an issue</li> 
    </ul> 
   </div> 
   <div class="item-list"> 
    <h3>Development</h3> 
    <ul> 
     <li><a href="http://plugins.jquery.com/project/issues/uiTableEdit?states=8,13,14"><font color="#0f67a1">View pending patches</font></a></li> 
     <li><a href="http://plugins.jquery.com/project/issues/uiTableEdit?categories=task"><font color="#0f67a1">View available tasks</font></a></li> 
     <li><a href="http://plugins.jquery.com/project/issues/uiTableEdit"><font color="#0f67a1">View all pending issues</font></a></li> 
    </ul> 
   </div> 
  </div> 
 </div> 
 <p>-----------------------------------------------------------------</p> 
 <div class="entry"> 
  <h1>uiTableEdit</h1> 
  <h4>- jquery plugin for making tables user editable</h4> 
  <p> </p> 
  <h2><a href="http://plugins.jquery.com/project/uiTableEdit">download</a></h2> 
  <p> </p> 
  <h2>author and license</h2> 
  <p>copyright Greg Weber dual licensed under GPL and MIT</p> 
  <h2>overview</h2> 
  <p>user clicks on a cell, edits the value, then presses enter or clicks on any cell to save the new value</p> 
  <h2>usage</h2> 
  <pre class="dawn"><span class="Storage">var</span> t <span class="Keyword">=</span> <span class="Support">$</span>('<span class="Entity">table</span>')
              <span class="Keyword">$</span>.uiTableEdit( t ) <span class="Comment"><span class="Comment">//</span> returns t</span></pre> 
  <h2>options :</h2> 
  <ul> 
   <li>off : turns off table editing</li> 
   <li>find : defaults to tbody &gt; tr &gt; td</li> 
   <li>mousedown : callback on mouseDown event <br /> called in context of the table cell <br /> if mousedown returns false, cell will not become editable</li> 
   <li>dataVerify : callback after cell has been changed <br /> called in context of the cell, <br /> if dataVerify returns false, cell will stay in editable state <br /> if dataVerify returns a value, that value will replace the cell's value <br /> arguments are cell's value, original text, event</li> 
   <li>editDone : invoked on completion <br /> arguments are cell's new value, original text</li> 
  </ul> 
 </div> 
 <p><a href="http://gregweber.info/projects/uitableedit.html">http://gregweber.info/projects/uitableedit.html</a><br /> ------------------------------------------------------------------------<br /> uiTableEdit.js</p> 
 <pre>/*
 * Copyright (c) 2008 Greg Weber greg at gregweber.info
 * Dual licensed under the MIT and GPL licenses
 *
 * jquery plugin
 * make an html table editable by the user
 *   user clicks on a cell, edits the value,
 *   then presses enter or clicks on any cell to save the new value
 *   pressing escape returns the cell text to its orignal text
 *
 * documentation at http://gregweber.info/projects/uitableedit
 * 
 * var t = $('table')
 * $.uiTableEdit( t ) // returns t
 *
 * options : off, mouseDown, find, dataEntered, dataVerify, editDone
 *   off : turns off table editing
 *   find : defaults to tbody &gt; tr &gt; td
 *   mousedown : called in context of the table cell (as a normal event would be)
 *     if mouseDown returns false, cell will not become editable
 *   dataVerify : called in context of the cell,
 *     if dataVerify returns false, cell will stay in editable state
 *     if dataVerify returns text, that text will replace the cell's text
 *     arguments are the cell's text, original text, event, jquery object for the cell
 *   editDone : invoked on completion
 *     arguments: td cell's new text, original text, event, and jquery element for the td cell
*/
jQuery.uiTableEdit = function(jq, options){
  function unbind(){
    return jq.find( options.find ).unbind('mousedown.uiTableEdit')
  }
  options = options || {}
  options.find = options.find || 'tbody &gt; tr &gt; td'
  if( options.off ){
    unbind().find('form').each( function(){ var f = $(this);
      f.parents(&quot;td:first&quot;).text( f.find(':text').attr('value') );
      f.remove();
    });
    return jq;
  }

  function bind_mouse_down( mouseDn ){
    unbind().bind('mousedown.uiTableEdit', mouseDn )
  }
  function td_edit(){
    var td = jQuery(this);

    function restore(e){
      var val = td.find(':text').attr('value')
      if( options.dataVerify ){
        var value = options.dataVerify.call(this, val, orig_text, e, td);
        if( value === false ){ return false; }
        if( value !== null &amp;&amp; value !== undefined ) val = value;
      }
      td.html( &quot;&quot; );
      td.text( val );
      if( options.editDone ) options.editDone(val,orig_text,e,td)
      bind_mouse_down( td_edit_wrapper );
    }

    function checkEscape(e){
      if (e.keyCode === 27) {
        td.html( &quot;&quot; );
        td.text( orig_text );
        bind_mouse_down( td_edit_wrapper );
      }
    }

    var orig_text = td.text();
    var w = td.width();
    var h = td.height();
    td.css({width: w + &quot;px&quot;, height: h + &quot;px&quot;, padding: &quot;0&quot;, margin: &quot;0&quot;});
    td.html( '&lt;form name=&quot;td-editor&quot; action=&quot;javascript:void(0);&quot;&gt;' +
      '&lt;input type=&quot;text&quot; name=&quot;td_edit&quot; value=&quot;' +
    td.text() + '&quot;' + ' style=&quot;margin:0px;padding:0px;border:0px;width: ' +
      w  + 'px;&quot;&gt;' + '&lt;/input&gt;&lt;/form&gt;' )
      .find('form').submit( restore ).mousedown( restore ).blur( restore ).keypress( checkEscape );

    function focus_text(){ td.find('input:text').get(0).focus() }

    // focus bug (seen in FireFox) fixed by small delay
    setTimeout(focus_text, 50);

    /* TODO: investigate removing bind_mouse_down
     I also got rid of bind_mouse_down(restore),
     because now that you can refocus on fields that have been blurred,
     you can have multiple edits going simultaneously
    */
    bind_mouse_down( restore );
  }

  var td_edit_wrapper = !options.mouseDown ? td_edit : function(){
    if( options.mouseDown.apply(this,arguments) == false ) return false;
    td_edit.apply(this,arguments);
  };
  bind_mouse_down( td_edit_wrapper );
  return jq;
}</pre> 
</div></div></body></html>