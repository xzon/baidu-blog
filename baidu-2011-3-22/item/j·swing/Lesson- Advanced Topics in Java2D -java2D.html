<html><head><title><div class="tit">
  Lesson: Advanced Topics in Java2D -java2D
</div></title></head><body><div id='tit'>Lesson: Advanced Topics in Java2D -java2D</div><div id='cate'>j&middot;swing</div><div id='date'>2010年06月07日 星期一 04:11 P.M.</div><div id='page'>13</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/3874b28f4c6e98e3f01f3696.html'>http://hi.baidu.com/hxzon/blog/item/3874b28f4c6e98e3f01f3696.html</a><div id='cnt'><p>Lesson: Advanced Topics in Java2D -java2D</p> 
<p><a href="http://java.sun.com/docs/books/tutorial/2d/advanced/index.html">http://java.sun.com/docs/books/tutorial/2d/advanced/index.html</a></p>This lesson shows you how to use 
<code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> to display graphics with fancy outline and fill styles, transform graphics when they are rendered, constrain rendering to a particular area, and generally control the way graphics look when they are rendered. You'll also learn how to create complex 
<code><span style="FONT-FAMILY: NSimsun">Shape</span></code> objects by combining simple ones and how to detect when the user clicks on a displayed graphics primitive. These topics are discussed in the following sections: 
<h3><a href="http://java.sun.com/docs/books/tutorial/2d/advanced/transforming.html">Transforming Shapes, Text, and Images </a></h3> 
<blockquote>
 This section shows you how to modify the default transformation so that objects are translated, rotated, scaled, or sheared when they are rendered. 
</blockquote> 
<h3><a href="http://java.sun.com/docs/books/tutorial/2d/advanced/clipping.html">Clipping the Drawing Region </a></h3> 
<blockquote>
 You can use any shape as a 
 <em>clipping path</em>--the area within which rendering takes place. 
</blockquote> 
<h3><a href="http://java.sun.com/docs/books/tutorial/2d/advanced/compositing.html">Compositing Graphics </a></h3> 
<blockquote>
 This section illustrates the various compositing styles supported by 
 <code><span style="FONT-FAMILY: NSimsun">AlphaComposite</span></code> and shows you how to set the compositing style in the 
 <code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> rendering context. 
</blockquote> 
<h3><a href="http://java.sun.com/docs/books/tutorial/2d/advanced/quality.html">Controlling Rendering Quality </a></h3> 
<blockquote>
 This section describes the rendering hints that 
 <code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> supports and shows you how to specify your preference in the trade-off between rendering quality and speed. 
</blockquote> 
<h3><a href="http://java.sun.com/docs/books/tutorial/2d/advanced/complexshapes.html">Constructing Complex Shapes from Geometry Primitives </a></h3> 
<blockquote>
 This section shows you how to perform boolean operations on 
 <code><span style="FONT-FAMILY: NSimsun">Shape</span></code> objects using the 
 <code><span style="FONT-FAMILY: NSimsun">Area</span></code> class. 
</blockquote> 
<h3><a href="http://java.sun.com/docs/books/tutorial/2d/advanced/user.html">Supporting User Interaction </a></h3> 
<blockquote>
 This section shows you how to perform hit detection on graphics primitives. 
</blockquote> 
<div>
 Transforming Shapes, Text, and Images
</div> 
<blockquote>
 You can modify the transform attribute in the 
 <code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> context to move, rotate, scale, and shear graphics primitives when they are rendered. The transform attribute is defined by an instance of the 
 <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/geom/AffineTransform.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">AffineTransform</span></code></a> class. An affine transform is a transformation such as translate, rotate, scale, or shear in which parallel lines remain parallel even after being transformed. 
 <p>The <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/Graphics2D.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code></a> class provides several methods for changing the transform attribute. You can construct a new <code><span style="FONT-FAMILY: NSimsun">AffineTransform</span></code> and change the <code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> transform attribute by calling <code><span style="FONT-FAMILY: NSimsun">transform</span></code>.</p> 
 <p><code><span style="FONT-FAMILY: NSimsun">AffineTransform</span></code> defines the following factory methods to make it easier to construct new transforms:</p> 
 <ul> 
  <li><code><span style="FONT-FAMILY: NSimsun">getRotateInstance</span></code></li> 
  <li><code><span style="FONT-FAMILY: NSimsun">getScaleInstance</span></code></li> 
  <li><code><span style="FONT-FAMILY: NSimsun">getShearInstance</span></code></li> 
  <li><code><span style="FONT-FAMILY: NSimsun">getTranslateInstance</span></code></li>
 </ul> 
 <p>Alternatively you can use one of the <code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> transformation methods to modify the current transform. When you call one of these convenience methods, the resulting transform is concatenated with the current transform and is applied during rendering:</p> 
 <ul> 
  <li><code><span style="FONT-FAMILY: NSimsun">rotate</span></code>--to specify an angle of rotation in radians</li> 
  <li><code><span style="FONT-FAMILY: NSimsun">scale</span></code>--to specify a scaling factor in the <em class="Emphasis">x</em> and <em class="Emphasis">y</em> directions</li> 
  <li><code><span style="FONT-FAMILY: NSimsun">shear</span></code>--to specify a shearing factor in the <em class="Emphasis">x</em> and <em class="Emphasis">y</em> directions</li> 
  <li><code><span style="FONT-FAMILY: NSimsun">translate</span></code>--to specify a translation offset in the <em class="Emphasis">x</em> and <em class="Emphasis">y</em> directions</li>
 </ul> 
 <p>You can also construct an <code><span style="FONT-FAMILY: NSimsun">AffineTransform</span></code> object directly and concatenate it with the current transform by calling the <code><span style="FONT-FAMILY: NSimsun">transform</span></code>method.</p> 
 <p>The <code><span style="FONT-FAMILY: NSimsun">drawImage</span></code> method is also overloaded to allow you to specify an <code><span style="FONT-FAMILY: NSimsun">AffineTransform</span></code> that is applied to the image as it is rendered. Specifying a transform when you call <code><span style="FONT-FAMILY: NSimsun">drawImage</span></code> does not affect the <code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> transform attribute.</p>
</blockquote> 
<h3>Example: Transform</h3>The following program is the same as 
<code><span style="FONT-FAMILY: NSimsun">StrokeandFill</span></code>, but also allows the user to choose a transformation to apply to the selected object when it is rendered. 
<p><a class="SourceLink" href="http://java.sun.com/docs/books/tutorial/2d/advanced/examples/Transform.java" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Transform.java</span></code></a> contains the complete code for this applet.</p> 
<p>When a transform is chosen from the Transform menu, the transform is concatenated onto the <code><span style="FONT-FAMILY: NSimsun">AffineTransform</span></code> <code><span style="FONT-FAMILY: NSimsun">at</span></code>:</p> 
<blockquote>
 <pre>public void setTrans(int transIndex) {<br />    // Sets the AffineTransform.<br />    switch ( transIndex ) {<br />    case 0 : at.setToIdentity();<br />             at.translate(w/2, h/2); break;<br />    case 1 : at.rotate(Math.toRadians(45)); break;<br />    case 2 : at.scale(0.5, 0.5); break;<br />    case 3 : at.shear(0.5, 0.0); break;<br />    }<br />}</pre>
</blockquote>Before displaying the shape corresponding to the menu choices, the application first retrieves the current transform from the 
<code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> object: 
<blockquote>
 <pre>AffineTransform saveXform = g2.getTransform();</pre>
</blockquote>This transform will be restored to the 
<code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> after rendering. 
<p>After retrieving the current transform, another <code><span style="FONT-FAMILY: NSimsun">AffineTransform</span></code>, <code><span style="FONT-FAMILY: NSimsun">toCenterAt</span></code>, is created that causes shapes to be rendered in the center of the panel. The <code><span style="FONT-FAMILY: NSimsun">at</span></code> <code><span style="FONT-FAMILY: NSimsun">AffineTransform</span></code> is concatenated onto <code><span style="FONT-FAMILY: NSimsun">toCenterAt</span></code>:</p> 
<blockquote>
 <pre>AffineTransform toCenterAt = new AffineTransform();<br />toCenterAt.concatenate(at);<br />toCenterAt.translate(-(r.width/2), -(r.height/2));</pre>
</blockquote>The 
<code><span style="FONT-FAMILY: NSimsun">toCenterAt</span></code> transform is concatenated onto the 
<code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> transform with the 
<code><span style="FONT-FAMILY: NSimsun">transform</span></code> method: 
<blockquote>
 <pre>g2.transform(toCenterAt);</pre>
</blockquote>After rendering is completed, the original transform is restored using the 
<code><span style="FONT-FAMILY: NSimsun">setTransform</span></code> method: 
<blockquote>
 <pre>g2.setTransform(saveXform);</pre>
</blockquote> 
<hr /> 
<strong>Note:</strong> Never use the 
<code><span style="FONT-FAMILY: NSimsun">setTransform</span></code> method to concatenate a coordinate transform onto an existing transform. The 
<code><span style="FONT-FAMILY: NSimsun">setTransform</span></code> method overwrites the 
<code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> object's current transform, which might be needed for other reasons, such as positioning Swing and lightweight components in a window. Use these steps to perform transformations: 
<ol> 
 <li>Use the <code><span style="FONT-FAMILY: NSimsun">getTransform</span></code> method to get the current transform.</li> 
 <li>Use <code><span style="FONT-FAMILY: NSimsun">transform</span></code>, <code><span style="FONT-FAMILY: NSimsun">translate</span></code>, <code><span style="FONT-FAMILY: NSimsun">scale</span></code>, <code><span style="FONT-FAMILY: NSimsun">shear</span></code>, or <code><span style="FONT-FAMILY: NSimsun">rotate</span></code> to concatenate a transform.</li> 
 <li>Perform the rendering.</li> 
 <li>Restore the original transform using the <code><span style="FONT-FAMILY: NSimsun">setTransform</span></code> method.</li>
</ol> 
<div>
 Clipping the Drawing Region
</div> 
<blockquote>
 Any 
 <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/Shape.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Shape</span></code></a> object can be used as a clipping path that restricts the portion of the drawing area that will be rendered. The clipping path is part of the 
 <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/Graphics2D.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code></a> context; to set the clip attribute, you call 
 <code><span style="FONT-FAMILY: NSimsun">Graphics2D.setClip</span></code> and pass in the 
 <code><span style="FONT-FAMILY: NSimsun">Shape</span></code> that defines the clipping path you want to use. You can shrink the clipping path by calling the 
 <code><span style="FONT-FAMILY: NSimsun">clip</span></code> method and passing in another 
 <code><span style="FONT-FAMILY: NSimsun">Shape</span></code>; the clip is set to the intersection of the current clip and the specified 
 <code><span style="FONT-FAMILY: NSimsun">Shape</span></code>. 
</blockquote> 
<h3>Example: ClipImage</h3>This example animates a clipping path to reveal different portions of an image. 
<p><a class="SourceLink" href="http://java.sun.com/docs/books/tutorial/2d/advanced/examples/ClipImage.java" target="_blank"><code><span style="FONT-FAMILY: NSimsun">ClipImage.java</span></code></a> contains the complete code for this applet. The applet requires the <a href="http://java.sun.com/docs/books/tutorial/2d/advanced/examples/images/clouds.jpg"><code><span style="FONT-FAMILY: NSimsun">clouds.jpg</span></code></a> image file.</p> 
<p>The clipping path is defined by the intersection of an ellipse and a rectangle whose dimensions are set randomly. The ellipse is passed to the <code><span style="FONT-FAMILY: NSimsun">setClip</span></code> method, and then <code><span style="FONT-FAMILY: NSimsun">clip</span></code> is called to set the clipping path to the intersection of the ellipse and the rectangle.</p> 
<blockquote>
 <pre>private Ellipse2D ellipse = new Ellipse2D.Float();<br />private Rectangle2D rect = new Rectangle2D.Float();<br />...<br />ellipse.setFrame(x, y, ew, eh);<br />g2.setClip(ellipse);<br />rect.setRect(x+5, y+5, ew-10, eh-10);<br />g2.clip(rect);</pre>
</blockquote> 
<p></p> 
<p></p> 
<h3>Example: Starry</h3>A clipping area can also be created from a text string. The following example creates a 
<code><span style="FONT-FAMILY: NSimsun">TextLayout</span></code> with the string 
<em>The Starry Night</em>. Then, it gets the outline of the 
<code><span style="FONT-FAMILY: NSimsun">TextLayout</span></code>. The 
<a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/font/TextLayout.html#getOutline%28java.awt.geom.AffineTransform%29" target="_blank"><code><span style="FONT-FAMILY: NSimsun">TextLayout.getOutline</span></code></a> method returns a 
<code><span style="FONT-FAMILY: NSimsun">Shape</span></code> object and a 
<code><span style="FONT-FAMILY: NSimsun">Rectangle</span></code> is created from the bounds of this 
<code><span style="FONT-FAMILY: NSimsun">Shape</span></code> object. The bounds contain all the pixels the layout can draw. The color in the graphics context is set to blue and the outline shape is drawn, as illustrated by the following image and code snippet. 
<center>
 <img align="bottom" src="image/Lesson- Advanced Top.62d0f7032aaeddd008fa933a.jpg" width="425" height="64" />
 <p class="origImg">http://hiphotos.baidu.com/hxzon/pic/item/62d0f7032aaeddd008fa933a.jpg</p>
</center> 
<blockquote>
 <pre>FontRenderContext frc = g2.getFontRenderContext();<br />Font f = new Font(&quot;Helvetica&quot;, 1, w/10);<br />String s = new String(&quot;The Starry Night&quot;);<br />TextLayout textTl = new TextLayout(s, f, frc);<br />AffineTransform transform = new AffineTransform();<br />Shape outline = textTl.getOutline(null);<br />Rectangle r = outline.getBounds();<br />transform = g2.getTransform();<br />transform.translate(w/2-(r.width/2), h/2+(r.height/2));<br />g2.transform(transform);<br />g2.setColor(Color.blue);<br />g2.draw(outline);</pre>
</blockquote> 
<p>Next, a clipping area is set on the graphics context using the <code><span style="FONT-FAMILY: NSimsun">Shape</span></code> object created from <code><span style="FONT-FAMILY: NSimsun">getOutline</span></code>. The <code><span style="FONT-FAMILY: NSimsun">starry.gif</span></code> image, which is Van Gogh's famous painting, <em>The Starry Night</em>, is drawn into this clipping area starting at the lower left corner of the <code><span style="FONT-FAMILY: NSimsun">Rectangle</span></code> object.</p> 
<p></p> 
<blockquote>
 <pre>g2.setClip(outline);<br />g2.drawImage(img, r.x, r.y, r.width, r.height, this);</pre>
</blockquote> 
<p><a class="SourceLink" href="http://java.sun.com/docs/books/tutorial/2d/advanced/examples/Starry.java" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Starry.java</span></code></a> contains the complete code for this program. This applet requires the <a href="http://java.sun.com/docs/books/tutorial/2d/advanced/examples/images/Starry.gif"><code><span style="FONT-FAMILY: NSimsun">Starry.gif</span></code></a> image file.</p> 
<div>
 Compositing Graphics
</div> 
<blockquote>
 The 
 <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/AlphaComposite.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">AlphaComposite</span></code></a> class encapsulates various compositing styles, which determine how overlapping objects are rendered. An 
 <code><span style="FONT-FAMILY: NSimsun">AlphaComposite</span></code> can also have an alpha value that specifies the degree of transparency: alpha = 1.0 is totally opaque, alpha = 0.0 totally transparent (clear). 
 <code><span style="FONT-FAMILY: NSimsun">AlphaComposite</span></code> supports most of the standard Porter-Duff compositing rules shown in the following table. 
 <p> </p>
 <table border="1"> 
  <tbody> 
   <tr> 
    <td>Source-over (<code><span style="FONT-FAMILY: NSimsun">SRC_OVER</span></code>)<br /><img src="image/Lesson- Advanced Top.918fa0ecb5db2c012697913a.jpg" width="173" height="72" /><p class="origImg">http://hiphotos.baidu.com/hxzon/pic/item/918fa0ecb5db2c012697913a.jpg</p></td> 
    <td>If pixels in the object being rendered (the source) have the same location as previously rendered pixels (the destination), the source pixels are rendered over the destination pixels.</td>
   </tr> 
   <tr> 
    <td>Source-in (<code><span style="FONT-FAMILY: NSimsun">SRC_IN</span></code>)<br /><img src="image/Lesson- Advanced Top.08fa513d99b624d23d6d973a.jpg" width="65" height="76" /><p class="origImg">http://hiphotos.baidu.com/hxzon/pic/item/08fa513d99b624d23d6d973a.jpg</p></td> 
    <td>If pixels in the source and the destination overlap, only the source pixels in the overlapping area are rendered.</td>
   </tr> 
   <tr> 
    <td>Source-out (<code><span style="FONT-FAMILY: NSimsun">SRC_OUT</span></code>)<br /><img src="image/Lesson- Advanced Top.269759eefc4c28c7b2fb953a.jpg" width="84" height="93" /><p class="origImg">http://hiphotos.baidu.com/hxzon/pic/item/269759eefc4c28c7b2fb953a.jpg</p></td> 
    <td>If pixels in the source and the destination overlap, only the source pixels outside of the overlapping area are rendered. The pixels in the overlapping area are cleared.</td>
   </tr> 
   <tr> 
    <td>Destination-over (<code><span style="FONT-FAMILY: NSimsun">DST_OVER</span></code>)<br /><img src="image/Lesson- Advanced Top.3d6d55fb71da3e2a6d22eb3a.jpg" width="92" height="91" /><p class="origImg">http://hiphotos.baidu.com/hxzon/pic/item/3d6d55fb71da3e2a6d22eb3a.jpg</p></td> 
    <td>If pixels in the source and the destination overlap, only the source pixels outside of the overlapping area are rendered. The pixels in the overlapping area are not changed.</td>
   </tr> 
   <tr> 
    <td>Destination-in (<code><span style="FONT-FAMILY: NSimsun">DST_IN</span></code>)<br /><img src="image/Lesson- Advanced Top.6d224f4ae7853b1f09f7ef3a.jpg" width="80" height="74" /><p class="origImg">http://hiphotos.baidu.com/hxzon/pic/item/6d224f4ae7853b1f09f7ef3a.jpg</p></td> 
    <td>If pixels in the source and the destination overlap, the alpha from the source is applied to the destination pixels in the overlapping area. If the alpha = 1.0, the pixels in the overlapping area are unchanged; if the alpha is 0.0, pixels in the overlapping area are cleared.</td>
   </tr> 
   <tr> 
    <td>Destination-out (<code><span style="FONT-FAMILY: NSimsun">DST_OUT</span></code>)<br /><img src="image/Lesson- Advanced Top.20a44623c0d6ed6e9822ed3a.jpg" width="87" height="74" /><p class="origImg">http://hiphotos.baidu.com/hxzon/pic/item/20a44623c0d6ed6e9822ed3a.jpg</p></td> 
    <td>If pixels in the source and the destination overlap, the alpha from the source is applied to the destination pixels in the overlapping area. If the alpha = 1.0, the pixels in the overlapping area are cleared; if the alpha is 0.0, the pixels in the overlapping area are unchanged.</td>
   </tr> 
   <tr> 
    <td>Clear (<code><span style="FONT-FAMILY: NSimsun">CLEAR</span></code>)<br /><img src="image/Lesson- Advanced Top.09f7905253030f320cf3e33a.jpg" width="90" height="85" /><p class="origImg">http://hiphotos.baidu.com/hxzon/pic/item/09f7905253030f320cf3e33a.jpg</p></td> 
    <td>If the pixels in the source and the destination overlap, the pixels in the overlapping area are cleared.</td>
   </tr>
  </tbody>
 </table> 
 <p>To change the compositing style used by the <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/Graphics2D.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code></a> class, create an <code><span style="FONT-FAMILY: NSimsun">AlphaComposite</span></code> object and pass it into the <code><span style="FONT-FAMILY: NSimsun">setComposite</span></code> method.</p>
</blockquote> 
<h3>Example: Composite</h3>This program illustrates the effects of various compositing style and alpha combinations. 
<p><a class="SourceLink" href="http://java.sun.com/docs/books/tutorial/2d/advanced/examples/Composite.java" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Composite.java</span></code></a>. contains the full code for this applet.</p> 
<p>A new <code><span style="FONT-FAMILY: NSimsun">AlphaComposite</span></code> object <em class="Emphasis">ac</em> is constructed by calling <code><span style="FONT-FAMILY: NSimsun">AlphaComposite.getInstance</span></code> and specifying the desired compositing rule.</p> 
<blockquote>
 <pre>AlphaComposite ac =<br />               AlphaComposite.getInstance(AlphaComposite.SRC);</pre>
</blockquote> 
<p>When a different compositing rule or alpha value is selected, <code><span style="FONT-FAMILY: NSimsun">AlphaComposite.getInstance</span></code> is called again, and the new <code><span style="FONT-FAMILY: NSimsun">AlphaComposite</span></code> is assigned to <em class="Emphasis">ac</em>. The selected alpha is applied in addition to the per-pixel alpha value and is passed as a second parameter to <code><span style="FONT-FAMILY: NSimsun">AlphaComposite</span></code>.<code><span style="FONT-FAMILY: NSimsun">getInstance</span></code>.</p> 
<blockquote>
 <pre>ac = AlphaComposite.getInstance(getRule(rule), alpha);</pre>
</blockquote> 
<p>The composite attribute is modified by passing the <code><span style="FONT-FAMILY: NSimsun">AlphaComposite</span></code> object to <code><span style="FONT-FAMILY: NSimsun">Graphics 2D</span></code> <code><span style="FONT-FAMILY: NSimsun">setComposite</span></code>. The objects are rendered into a <code><span style="FONT-FAMILY: NSimsun">BufferedImage</span></code> and are later copied to the screen, so the composite attribute is set on the <code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> context for the <code><span style="FONT-FAMILY: NSimsun">BufferedImage</span></code>:</p> 
<blockquote>
 <pre>BufferedImage buffImg = new BufferedImage(w, h,<br />                            BufferedImage.TYPE_INT_ARGB);<br />Graphics2D gbi = buffImg.createGraphics();<br />...<br />gbi.setComposite(ac);</pre>
</blockquote> 
<div>
 Controlling Rendering Quality
</div> 
<blockquote> 
 <p>Use the <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/Graphics2D.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code></a> class rendering hints attribute to specify whether you want objects to be rendered as quickly as possible or whether you prefer that the rendering quality be as high as possible.</p> 
 <p>To set or change the rendering hints attribute in the <code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> context, construct a <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/RenderingHints.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">RenderingHints</span></code></a> object and pass it into <code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> by using the <code><span style="FONT-FAMILY: NSimsun">setRenderingHints</span></code> method. If you just want to set one hint, you can call <code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code> <code><span style="FONT-FAMILY: NSimsun">setRenderingHint</span></code> and specify the key-value pair for the hint you want to set. (The key-value pairs are defined in the <code><span style="FONT-FAMILY: NSimsun">RenderingHints</span></code> class.)</p> 
 <p>For example, to set a preference for antialiasing to be used if possible, you could use <code><span style="FONT-FAMILY: NSimsun">setRenderingHint</span></code>:</p> 
 <blockquote>
  <pre>public void paint (graphics g){<br />    Graphics2D g2 = (Graphics2D)g;<br /> RenderingHints rh = new RenderingHints(<br />  RenderingHints.KEY_TEXT_ANTIALIASING,<br />  RenderingHints.VALUE_TEXT_ANTIALIAS_ON);<br /> g2.setRenderingHints(rh);<br />   ...<br />   }</pre>
 </blockquote> 
 <blockquote> 
  <hr /> 
  <strong>Note:</strong> Not all platforms support modification of the rendering mode, so specifying rendering hints does not guarantee that they will be used. 
  <hr /> 
 </blockquote> 
 <p><code><span style="FONT-FAMILY: NSimsun">RenderingHints</span></code> supports the following types of hints: </p>
 <table class="FCK__ShowTableBorders" border="0" cellspacing="8"> 
  <tbody> 
   <tr> 
    <td valign="top"><strong>Hint</strong></td> 
    <td valign="top"><strong>Key</strong></td> 
    <td valign="top"><strong>Values</strong></td>
   </tr> 
   <tr> 
    <td valign="top"><strong>Antialiasing</strong></td> 
    <td valign="top"><code><span style="FONT-FAMILY: NSimsun">KEY_ANTIALIASING</span></code></td> 
    <td valign="top"><span style="FONT-FAMILY: NSimsun"><code>VALUE_ANTIALIAS_ON</code><br /><code>VALUE_ANTIALIAS_OFF</code></span> <br /><code><span style="FONT-FAMILY: NSimsun">VALUE_ANTIALIAS_DEFAULT</span></code></td>
   </tr> 
   <tr> 
    <td valign="top"><strong>Alpha Interpolation</strong></td> 
    <td valign="top"><code><span style="FONT-FAMILY: NSimsun">KEY_ALPHA_INTERPOLATION</span></code></td> 
    <td valign="top"><span style="FONT-FAMILY: NSimsun"><code>VALUE_ALPHA_INTERPOLATION_QUALITY</code><br /><code>VALUE_ALPHA_INTERPOLATION_SPEED</code></span> <br /><code><span style="FONT-FAMILY: NSimsun">VALUE_ALPHA_INTERPOLATION_DEFAULT</span></code></td>
   </tr> 
   <tr> 
    <td valign="top"><strong>Color Rendering</strong></td> 
    <td valign="top"><code><span style="FONT-FAMILY: NSimsun">KEY_COLOR_RENDERING</span></code></td> 
    <td valign="top"><span style="FONT-FAMILY: NSimsun"><code>VALUE_COLOR_RENDER_QUALITY</code><br /><code>VALUE_COLOR_RENDER_SPEED</code></span> <br /><code><span style="FONT-FAMILY: NSimsun">VALUE_COLOR_RENDER_DEFAULT</span></code></td>
   </tr> 
   <tr> 
    <td valign="top"><strong>Dithering</strong></td> 
    <td valign="top"><code><span style="FONT-FAMILY: NSimsun">KEY_DITHERING</span></code></td> 
    <td valign="top"><span style="FONT-FAMILY: NSimsun"><code>VALUE_DITHER_DISABLE</code><br /><code>VALUE_DITHER_ENABLE</code></span> <br /><code><span style="FONT-FAMILY: NSimsun">VALUE_DITHER_DEFAULT</span></code></td>
   </tr> 
   <tr> 
    <td valign="top"><strong>Fractional Text Metrics</strong></td> 
    <td valign="top"><code><span style="FONT-FAMILY: NSimsun">KEY_FRACTIONALMETRICS</span></code></td> 
    <td valign="top"><span style="FONT-FAMILY: NSimsun"><code>VALUE_FRACTIONALMETRICS_ON</code><br /><code>VALUE_FRACTIONALMETRICS_OFF</code></span> <br /><code><span style="FONT-FAMILY: NSimsun">VALUE_FRACTIONALMETRICS_DEFAULT</span></code></td>
   </tr> 
   <tr> 
    <td valign="top"><strong>Image Interpolation</strong></td> 
    <td valign="top"><code><span style="FONT-FAMILY: NSimsun">KEY_INTERPOLATION</span></code></td> 
    <td valign="top"><span style="FONT-FAMILY: NSimsun"><code>VALUE_INTERPOLATION_BICUBIC</code><br /><code>VALUE_INTERPOLATION_BILINEAR</code></span> <br /><code><span style="FONT-FAMILY: NSimsun">VALUE_INTERPOLATION_NEAREST_NEIGHBOR</span></code></td>
   </tr> 
   <tr> 
    <td valign="top"><strong>Rendering</strong></td> 
    <td valign="top"><code><span style="FONT-FAMILY: NSimsun">KEY_RENDERING</span></code></td> 
    <td valign="top"><span style="FONT-FAMILY: NSimsun"><code>VALUE_RENDER_QUALITY</code><br /><code>VALUE_RENDER_SPEED</code></span> <br /><code><span style="FONT-FAMILY: NSimsun">VALUE_RENDER_DEFAULT</span></code></td>
   </tr> 
   <tr> 
    <td valign="top"><strong>Stroke Normalization Control</strong></td> 
    <td valign="top"><code><span style="FONT-FAMILY: NSimsun">KEY_STROKE_CONTROL</span></code></td> 
    <td valign="top"><span style="FONT-FAMILY: NSimsun"><code>VALUE_STROKE_NORMALIZE</code><br /><code>VALUE_STROKE_DEFAULT</code></span> <br /><code><span style="FONT-FAMILY: NSimsun">VALUE_STROKE_PURE</span></code></td>
   </tr> 
   <tr> 
    <td valign="top"><strong>Text Antialiasing</strong></td> 
    <td valign="top"><code><span style="FONT-FAMILY: NSimsun">KEY_TEXT_ANTIALIASING</span></code></td> 
    <td valign="top"><span style="FONT-FAMILY: NSimsun"><code>VALUE_TEXT_ANTIALIAS_ON</code><br /><code>VALUE_TEXT_ANTIALIAS_OFF</code></span> <br /><span style="FONT-FAMILY: NSimsun"><code>VALUE_TEXT_ANTIALIAS_DEFAULT</code><br /><code>VALUE_TEXT_ANTIALIAS_GASP</code><br /><code>VALUE_TEXT_ANTIALIAS_LCD_HRGB</code><br /><code>VALUE_TEXT_ANTIALIAS_LCD_HBGR</code><br /><code>VALUE_TEXT_ANTIALIAS_LCD_VRGB</code><br /><code>VALUE_TEXT_ANTIALIAS_LCD_VBGR</code><br /></span></td>
   </tr> 
   <tr> 
    <td valign="top"><strong>LCD Text Contrast</strong></td> 
    <td valign="top"><code><span style="FONT-FAMILY: NSimsun">KEY_TEXT_LCD_CONTRAST</span></code></td> 
    <td valign="top">Values should be a positive integer in the range 100 to 250. A lower value (eg 100) corresponds to higher contrast text when displaying dark text on a light background. A higher value (eg 200) corresponds to lower contrast text when displaying dark text on a light background. A typical useful value is in the narrow range 140-180. If no value is specified, a system or implementation default value will be applied.</td>
   </tr>
  </tbody>
 </table> 
 <p>When a hint is set to default, the platform rendering default is used.</p>
</blockquote> 
<div>
 Constructing Complex Shapes from Geometry Primitives
</div> 
<blockquote>
 Constructive area geometry (CAG) is the process of creating new geometric shapes by performing boolean operations on existing ones. In the Java 2D™ API the 
 <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/geom/Area.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Area</span></code></a> class implements the 
 <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/Shape.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Shape</span></code></a> interface and supports the following boolean operations. 
 <p> </p>
 <table class="FCK__ShowTableBorders"> 
  <tbody> 
   <tr> 
    <td><img src="image/Lesson- Advanced Top.9822720ec1d2aaf67bcbe13a.jpg" width="131" height="86" /><p class="origImg">http://hiphotos.baidu.com/hxzon/pic/item/9822720ec1d2aaf67bcbe13a.jpg</p></td> 
    <td>Union</td> 
    <td><img src="image/Lesson- Advanced Top.0cf3d7cab4ea777af21fe73a.jpg" width="131" height="86" /><p class="origImg">http://hiphotos.baidu.com/hxzon/pic/item/0cf3d7cab4ea777af21fe73a.jpg</p></td> 
    <td>Subtraction</td>
   </tr> 
   <tr> 
    <td><img src="image/Lesson- Advanced Top.7bcb0a46233ec3356b63e53a.jpg" width="135" height="89" /><p class="origImg">http://hiphotos.baidu.com/hxzon/pic/item/7bcb0a46233ec3356b63e53a.jpg</p></td> 
    <td>Intersection</td> 
    <td><img src="image/Lesson- Advanced Top.f21fbe09b8428b186b60fb3a.jpg" width="134" height="88" /><p class="origImg">http://hiphotos.baidu.com/hxzon/pic/item/f21fbe09b8428b186b60fb3a.jpg</p></td> 
    <td>Exclusive-or (<code><span style="FONT-FAMILY: NSimsun">XOR</span></code>)</td>
   </tr>
  </tbody>
 </table>
</blockquote> 
<h3>Example: Areas</h3>In this example 
<code><span style="FONT-FAMILY: NSimsun">Area</span></code> objects construct a pear shape from several ellipses. 
<p><a class="SourceLink" href="http://java.sun.com/docs/books/tutorial/2d/advanced/examples/Pear.java" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Pear.java</span></code></a> contains the complete code for this applet.</p> 
<p>The leaves are each created by performing an intersection on two overlapping circles.</p> 
<blockquote>
 <pre>leaf = new Ellipse2D.Double();<br />...<br />leaf1 = new Area(leaf);<br />leaf2 = new Area(leaf);<br />...<br />leaf.setFrame(ew-16, eh-29, 15.0, 15.0);<br />leaf1 = new Area(leaf);<br />leaf.setFrame(ew-14, eh-47, 30.0, 30.0);<br />leaf2 = new Area(leaf);<br />leaf1.intersect(leaf2);<br />g2.fill(leaf1);<br />...<br />leaf.setFrame(ew+1, eh-29, 15.0, 15.0);<br />leaf1 = new Area(leaf);<br />leaf2.intersect(leaf1);<br />g2.fill(leaf2);</pre>
</blockquote> 
<p>Overlapping circles are also used to construct the stem through a subtraction operation.</p> 
<blockquote>
 <pre>stem = new Ellipse2D.Double();<br />...<br />stem.setFrame(ew, eh-42, 40.0, 40.0);<br />st1 = new Area(stem);<br />stem.setFrame(ew+3, eh-47, 50.0, 50.0);<br />st2 = new Area(stem);<br />st1.subtract(st2);<br />g2.fill(st1);</pre>
</blockquote> 
<p>The body of the pear is constructed by performing a union operation on a circle and an oval.</p> 
<blockquote>
 <pre>circle = new Ellipse2D.Double();<br />oval = new Ellipse2D.Double();<br />circ = new Area(circle);<br />ov = new Area(oval);<br />...<br />circle.setFrame(ew-25, eh, 50.0, 50.0);<br />oval.setFrame(ew-19, eh-20, 40.0, 70.0);<br />circ = new Area(circle);<br />ov = new Area(oval);<br />circ.add(ov);<br />g2.fill(circ);</pre>
</blockquote> 
<div>
 Supporting User Interaction
</div> 
<blockquote>
 To enable the user to interact with the graphics you display, you need to be able to determine when the user clicks on one of them. The 
 <code><span style="FONT-FAMILY: NSimsun">hit</span></code> method of the 
 <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/Graphics2D.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Graphics2D</span></code></a> class provides a way to easily determine whether a mouse click occurred over a particular 
 <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/Shape.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">Shape</span></code></a> object. Alternatively you can get the location of the mouse click and call 
 <code><span style="FONT-FAMILY: NSimsun">contains</span></code> on the 
 <code><span style="FONT-FAMILY: NSimsun">Shape</span></code> to determine whether the click was within the bounds of the 
 <code><span style="FONT-FAMILY: NSimsun">Shape</span></code>. 
 <p>If you are using primitive text, you can perform simple hit testing by getting the outline <code><span style="FONT-FAMILY: NSimsun">Shape</span></code> that corresponds to the text and then calling <code><span style="FONT-FAMILY: NSimsun">hit</span></code> or <code><span style="FONT-FAMILY: NSimsun">contains</span></code> with that <code><span style="FONT-FAMILY: NSimsun">Shape</span></code>. Supporting text editing requires much more sophisticated hit testing. If you want to allow the user to edit text, you should generally use one of the Swing editable text components. If you are working with primitive text and are using the <a class="APILink" href="http://java.sun.com/javase/7/docs/api/java/awt/font/TextLayout.html" target="_blank"><code><span style="FONT-FAMILY: NSimsun">TextLayout</span></code></a> class to manage the shaping and positioning of the text, you can also use <code><span style="FONT-FAMILY: NSimsun">TextLayout</span></code> to perform hit testing for text editing. For more information see the chapter Text and Fonts in the <a class="OutsideLink" href="http://java.sun.com/javase/7/docs/technotes/guides/2d/spec/j2d-bookTOC.html" target="_blank">Java 2D™ Programmer's Guide</a> or see the HitTestSample example below, which uses a <code><span style="FONT-FAMILY: NSimsun">TextLayout</span></code> to perform simple hit-testing.</p> 
 <p></p>
</blockquote> 
<h3>Example: ShapeMover</h3>This applet allows the user to drag a 
<code><span style="FONT-FAMILY: NSimsun">Shape</span></code> around within the applet window. The 
<code><span style="FONT-FAMILY: NSimsun">Shape</span></code> is redrawn at every mouse location to provide feedback as the user drags it. 
<p><a class="SourceLink" href="http://java.sun.com/docs/books/tutorial/2d/advanced/examples/ShapeMover.java" target="_blank"><code><span style="FONT-FAMILY: NSimsun">ShapeMover.java</span></code></a> contains the complete code for this applet.</p> 
<p>The <code><span style="FONT-FAMILY: NSimsun">contains</span></code> method is called to determine whether the cursor is within the bounds of the rectangle when the mouse is pressed. If it is, the location of the rectangle is updated.</p> 
<blockquote>
 <pre>public void mousePressed(MouseEvent e){<br />    last_x = rect.x - e.getX();<br />    last_y = rect.y - e.getY();<br />    if(rect.contains(e.getX(), e.getY())) updateLocation(e);<br />...<br /><br />public void updateLocation(MouseEvent e){<br />    rect.setLocation(last_x + e.getX(), last_y + e.getY());<br />    ...<br />    repaint();</pre>
</blockquote> 
<p>You might notice that redrawing the <code><span style="FONT-FAMILY: NSimsun">Shape</span></code> at every mouse location is slow, because the filled rectangle is rerendered every time it is moved. Using double buffering can eliminate this problem. If you use Swing, the drawing will be double buffered automatically; you don't have to change the rendering code at all. The code for a Swing version of this program is <a class="SourceLink" href="http://java.sun.com/docs/books/tutorial/2d/advanced/examples/SwingShapeMover.java" target="_blank"><code><span style="FONT-FAMILY: NSimsun">SwingShapeMover.java</span></code></a>.</p> 
<h3>Example: HitTestSample</h3>This application illustrates hit testing by drawing the default caret wherever the user clicks on the 
<code><span style="FONT-FAMILY: NSimsun">TextLayout</span></code>, as shown in the following figure. 
<p><a class="SourceLink" href="http://java.sun.com/docs/books/tutorial/2d/advanced/examples/HitTestSample.java" target="_blank"><code><span style="FONT-FAMILY: NSimsun">HitTestSample.java</span></code></a> contains the complete code for this applet.</p> 
<p>The <code><span style="FONT-FAMILY: NSimsun">mouseClicked</span></code> method uses <code><span style="FONT-FAMILY: NSimsun">TextLayout.hitTestChar</span></code> to return a <code><span style="FONT-FAMILY: NSimsun">java.awt.font.TextHitInfo</span></code> object that contains the mouse click location (the insertion index) in the <code><span style="FONT-FAMILY: NSimsun">TextLayout</span></code> object.</p> 
<p>Information returned by the <code><span style="FONT-FAMILY: NSimsun">TextLayout</span></code> <code><span style="FONT-FAMILY: NSimsun">getAscent</span></code>, <code><span style="FONT-FAMILY: NSimsun">getDescent</span></code>, and <code><span style="FONT-FAMILY: NSimsun">getAdvance</span></code> methods is used to compute the location of the origin for the <code><span style="FONT-FAMILY: NSimsun">TextLayout</span></code> object so it is horizontally and vertically centered.</p> 
<p></p> 
<blockquote>
 <pre>...<br /><br />private Point2D computeLayoutOrigin() {<br />  Dimension size = getPreferredSize();<br />  Point2D.Float origin = new Point2D.Float();<br />     <br />  origin.x = (float) (size.width - textLayout.getAdvance()) / 2;   <br />  origin.y = <br />    (float) (size.height - textLayout.getDescent()<br />             + textLayout.getAscent())/2;<br />  return origin;<br />}<br /><br />...<br /><br />public void paintComponent(Graphics g) {<br />  super.paintComponent(g);<br />  setBackground(Color.white);<br />  Graphics2D graphics2D = (Graphics2D) g;                <br />  Point2D origin = computeLayoutOrigin();<br />  graphics2D.translate(origin.getX(), origin.getY());<br />                <br />  // Draw textLayout.<br />  textLayout.draw(graphics2D, 0, 0);<br />     <br />  // Retrieve caret Shapes for insertionIndex.<br />  Shape[] carets = textLayout.getCaretShapes(insertionIndex);<br />       <br />  // Draw the carets.  carets[0] is the strong caret and <br />  // carets[1] is the weak caret.   <br />  graphics2D.setColor(STRONG_CARET_COLOR);<br />  graphics2D.draw(carets[0]);                <br />  if (carets[1] != null) {<br />    graphics2D.setColor(WEAK_CARET_COLOR);<br />    graphics2D.draw(carets[1]);<br />  }       <br />}<br /><br />...<br /><br />private class HitTestMouseListener extends MouseAdapter {<br />                <br />    /**<br />     * Compute the character position of the mouse click.<br />     */     <br />    public void mouseClicked(MouseEvent e) {<br />                <br />      Point2D origin = computeLayoutOrigin();<br />                <br />      // Compute the mouse click location relative to  <br />      // textLayout's origin.<br />      float clickX = (float) (e.getX() - origin.getX());<br />      float clickY = (float) (e.getY() - origin.getY());<br />         <br />      // Get the character position of the mouse click.<br />      TextHitInfo currentHit = textLayout.hitTestChar(clickX, clickY);<br />      insertionIndex = currentHit.getInsertionIndex();<br />            <br />      // Repaint the Component so the new caret(s) will be displayed.<br />      hitPane.repaint();<br />    }</pre>
</blockquote> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p></div></body></html>