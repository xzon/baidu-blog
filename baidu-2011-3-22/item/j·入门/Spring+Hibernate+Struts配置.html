<html><head><title><div class="tit">
  Spring+Hibernate+Struts配置
</div></title></head><body><div id='tit'>Spring+Hibernate+Struts配置</div><div id='cate'>j&middot;入门</div><div id='date'>2008年07月31日 星期四 00:14 A.M.</div><div id='page'>114</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/46ba07e9b5d50839b90e2de1.html'>http://hi.baidu.com/hxzon/blog/item/46ba07e9b5d50839b90e2de1.html</a><div id='cnt'><p>Spring+Hibernate+Struts配置</p> 
<p>spring学习笔记--摘自互联网<br /> 一、Spring中两个十分重要的概念——IOC/DI &amp; AOP<br /> 1.IOC/DI(Inverse of control/Dependence Injection)<br /> IOC:控制反转，看起来比较牛B，说起来十分简单。就是不使用传统的将类的依赖关系用硬编码来维护的方式，而是让容器来管理类之间的依赖，依赖关系在全在一个配置文件上。这样，就将造成耦合的根源——复杂的依赖关系，进行了统一的，集约式管理。</p> 
<p>DI：依赖注入，其实就是控制反转。只是比IOC的表达稍微好点，更能望文生意些。依赖注入，简单地说，就是在运行期间，由容器将组件之间的依赖关系注入到组件中。</p> 
<p>IOC/DI的作用：有了这样的设计，我们只需要专心编写一个个高内聚的零件，而不用关心这些零件如何组合起来工作。这个问题是由依赖关系的配置文件需要关注的。这样将组件和依赖分离，提高了组件的可重用性。</p> 
<p>三种IOC/DI方式：<br /> 1.接口注入：<br /> 将实现类的对象赋给接口的引用。实现类的对象是通过配置文件描述，由容器负责创建的。<br /> 注意：目前部门使用的BS，就是这种方式。<br /> 2.值注入：<br /> 通过setxxx方法，将依赖关系注入到某个具体的对象中。Spring使用最多的依赖注入方式就是值注入。<br /> 3.构造子注入：<br /> 容器调用实现类的购造器，将依赖作为构造器的参数注入，一次性构建一个稳定的对象。</p> 
<p>后两种依赖注入方式的比较：<br /> 1.值注入：自然，直接，简洁，但不稳定(如果在set的时候发生并发访问，可能会出现很严重的状况)<br /> 2.构造子注入：复杂，但很稳定(一次性创建，在创建阶段就将依赖注入了，创建完成后，就已经是一个完成的，稳定的对象)，而且可以很好地控制依赖注入的顺序关系。</p> 
<p><br /> 2.AOP(Aspect Oriented Programming)<br /> AOP：翻译为面向方法编程，网上说比较确切的说法是面向切面编程。我个人认为，说成是面向动作编程好象更加贴切。因为AOP是将某类动作高度内聚的编程方法。</p> 
<p>AOP的特点：1.切分动作 2.源代码无关性</p> 
<p>AOP在Spring中的应用：事务管理机制</p> 
<p>Spring事务管理机制的基本原理：<br /> 1.用一个动态Proxy类加载所有的配有事物管理的Bean<br /> 2.根据配置的事务触发点做if判断，然后在方法的前后加上事务处理的代码</p> 
<p>Spring中的两种AOP方式：<br /> 1.Proxy：面向接口<br /> 2.CGLIB：面向Class</p> 
<p>对于AOP在Spring中的应用还不是十分清楚，需要加强。</p> 
<p>二、struts+spring+hibernate 整合<br /> 1.在Eclipse中创建项目<br /> 2.加入struts<br /> 3.加入spring<br /> 4.加入hibernate<br /> 5.整合struts&amp;spring<br /> <strong>1)通过plug-in将struts与spring对接</strong><br /> <strong>2)通过action的type属性将Action的控制权转给spring</strong><br /> <strong>3)spring中配置action的实现类</strong><br /> 6.整和spring+hibernate<br /> <strong>1)只需要配置spring中的sessionFactory就可以了。十分方便</strong>。<br /> <strong>2)为数据库访问类配置spring的事务管理，使得持久层的操作可以在spring的控制范围之内。</strong></p> 
<p>附：登录模块示例</p> 
<p>配置文件部分</p> 
<p><br /> Struts配置：struts-config.xml<br /> &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br /> &lt;!DOCTYPE struts-config PUBLIC &quot;-//Apache Software Foundation//DTD Struts Configuration 1.1//EN&quot; &quot;<a href="http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd">http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd</a>&quot;&gt;</p> 
<p>&lt;struts-config&gt;<br /> &lt;data-sources /&gt;<br /> &lt;form-beans&gt;<br /> &lt;form-bean name=&quot;loginForm&quot; type=&quot;com.neusoft.apps.login.rp.LoginForm&quot;/&gt;<br /> &lt;/form-beans&gt;<br /> &lt;global-exceptions /&gt;<br /> &lt;global-forwards /&gt;<br /> &lt;action-mappings&gt;<br /> &lt;action path=&quot;/loginAction&quot; <br /> <font color="#ff0000"><strong>type=&quot;org.springframework.web.struts.DelegatingActionProxy&quot;</strong> </font><br /> &nbsp;&nbsp;&nbsp; name=&quot;loginForm&quot; <br /> &nbsp;&nbsp;&nbsp; scope=&quot;request&quot; <br /> &nbsp;&nbsp;&nbsp; parameter=&quot;method&quot;&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;forward name=&quot;ok&quot; path=&quot;/index.jsp&quot;&gt;&lt;/forward&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;forward name=&quot;failed&quot; path=&quot;/login.jsp&quot;&gt;&lt;/forward&gt;<br /> &lt;/action&gt;<br /> &lt;/action-mappings&gt;<br /> &lt;message-resources parameter=&quot;com.neusoft.apps.ApplicationResources&quot; /&gt;<br /> <font color="#ff0000"><strong>&lt;plug-in className=&quot;org.springframework.web.struts.ContextLoaderPlugIn&quot;&gt;<br /> &lt;set-property property=&quot;contextConfigLocation&quot; value=&quot;/WEB-INF/classes/applicationContext.xml&quot;/&gt;<br /> &lt;/plug-in&gt;</strong></font> <br /> &lt;/struts-config&gt;</p> 
<p> </p> 
<p>Spring配置：applicationContext.xml<br /> &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br /> &lt;!DOCTYPE beans PUBLIC &quot;-//SPRING//DTD BEAN//EN&quot; &quot;<a href="http://www.springframework.org/dtd/spring-beans.dtd">http://www.springframework.org/dtd/spring-beans.dtd</a>&quot;&gt;</p> 
<p>&lt;beans&gt;<br /> &lt;bean id=&quot;sessionFactory&quot;<br /> &nbsp;&nbsp;&nbsp; class=&quot;org.springframework.orm.hibernate3.LocalSessionFactoryBean&quot;&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;property name=&quot;configLocation&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;/WEB-INF/classes/hibernate.cfg.xml&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &lt;/bean&gt;<br /> <br /> &lt;bean id=&quot;transactionManager&quot; <br /> &nbsp;&nbsp;&nbsp; class=&quot;org.springframework.orm.hibernate3.HibernateTransactionManager&quot;&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;property name=&quot;sessionFactory&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;ref local=&quot;sessionFactory&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &lt;/bean&gt;<br /> <br /> &lt;bean id=&quot;loginDAO&quot; <br /> &nbsp;&nbsp;&nbsp; class=&quot;com.neusoft.apps.login.bp.LoginBSImp&quot;&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;property name=&quot;sessionFactory&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;ref local=&quot;sessionFactory&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;property name=&quot;hql&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;from LOGIN login where login.aae011=? and login.aae012=?&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &lt;/bean&gt;<br /> <br /> <strong>&lt;<font color="#003366">bean id=&quot;loginDAOProxy&quot; </font></strong><br /> &nbsp;&nbsp;&nbsp; class=&quot;org.springframework.transaction.interceptor.TransactionProxyFactoryBean&quot;&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;property name=&quot;transactionManager&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;ref bean=&quot;transactionManager&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;<br /> &nbsp;&nbsp;&nbsp; &lt;property name=&quot;target&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;ref local=&quot;loginDAO&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;<br /> &nbsp;&nbsp;&nbsp; &lt;property name=&quot;transactionAttributes&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;props&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;insert*&quot;&gt;PROPAGATION_REQUIRED&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;get*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;is*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;/props&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &lt;/bean&gt;<br /> <br /> <font color="#ff0000"><strong>&lt;bean name=&quot;/loginAction&quot; <br /> &nbsp;&nbsp;&nbsp; class=&quot;com.neusoft.apps.login.rp.LoginAction&quot; <br /> &nbsp;&nbsp;&nbsp; singleton=&quot;false&quot;&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;property name=&quot;dao&quot;&gt;<br /> &nbsp;&nbsp;<font color="#003300"> &lt;ref bean=&quot;loginDAOProxy&quot;/&gt;</font><br /> &nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &lt;/bean&gt;</strong></font><br /> <br /> &lt;/beans&gt;</p> 
<p>Hibernate配置：hibernate.cfg.xml:略，没什么好看的，就是配了个数据源</p> 
<p><br /> 代码部分：</p> 
<p>Action:</p> 
<p>package com.neusoft.apps.login.rp;</p> 
<p>import javax.servlet.http.HttpServletRequest;<br /> import javax.servlet.http.HttpServletResponse;</p> 
<p>import org.apache.struts.action.ActionForm;<br /> import org.apache.struts.action.ActionForward;<br /> import org.apache.struts.action.ActionMapping;<br /> import org.apache.struts.actions.DispatchAction;</p> 
<p>import com.neusoft.apps.login.LoginBS;</p> 
<p>public class LoginAction extends DispatchAction{<br /> <br /> private LoginBS dao;<br /> <br /> public ActionForward login(ActionMapping actionMapping, <br /> &nbsp;&nbsp;&nbsp;&nbsp; ActionForm actionForm, <br /> &nbsp;&nbsp;&nbsp;&nbsp; HttpServletRequest request, <br /> &nbsp;&nbsp;&nbsp;&nbsp; HttpServletResponse response) throws Exception {<br /> &nbsp;&nbsp;&nbsp; // TODO Auto-generated method stub<br /> &nbsp;&nbsp;&nbsp; LoginForm form = (LoginForm) actionForm;<br /> &nbsp;&nbsp;&nbsp; if(dao.isValidUser(form.getAae011(),form.getAae012()))<br /> &nbsp;&nbsp;&nbsp;&nbsp; return actionMapping.findForward(&quot;ok&quot;);<br /> &nbsp;&nbsp;&nbsp; else<br /> &nbsp;&nbsp;&nbsp;&nbsp; return actionMapping.findForward(&quot;failed&quot;);<br /> }</p> 
<p>public LoginBS getDao() {<br /> &nbsp;&nbsp;&nbsp; return dao;<br /> }</p> 
<p>public void setDao(LoginBS dao) {<br /> &nbsp;&nbsp;&nbsp; this.dao = dao;<br /> }<br /> }</p> 
<p> </p> 
<p>DAOImp:</p> 
<p>package com.neusoft.apps.login.bp;</p> 
<p>import java.util.List;</p> 
<p>import org.hibernate.SessionFactory;<br /> import org.springframework.orm.hibernate3.support.HibernateDaoSupport;</p> 
<p>import com.neusoft.apps.login.LoginBS;</p> 
<p>public class LoginBSImp extends HibernateDaoSupport implements LoginBS{<br /> private SessionFactory sessionFactory;<br /> <br /> private String hql;<br /> <br /> public boolean isValidUser(String username, String password) {<br /> &nbsp;&nbsp;&nbsp; // TODO Auto-generated method stub<br /> &nbsp;&nbsp;&nbsp; List userList = this.getHibernateTemplate().find(hql, new Object[]{username,password});<br /> &nbsp;&nbsp;&nbsp; if(userList.size() &gt; 0)<br /> &nbsp;&nbsp;&nbsp;&nbsp; return true;<br /> &nbsp;&nbsp;&nbsp; else<br /> &nbsp;&nbsp;&nbsp;&nbsp; return false;<br /> }</p> 
<p>public String getHql() {<br /> &nbsp;&nbsp;&nbsp; return hql;<br /> }</p> 
<p>public void setHql(String hql) {<br /> &nbsp;&nbsp;&nbsp; this.hql = hql;<br /> }<br /> <br /> <br /> }</p> 
<p> </p> 
<p> </p> 
<p>参见另一个配置：<br /> struts配置文件<br /> &lt;action input=&quot;/jsp/login.jsp&quot; name=&quot;loginForm&quot; path=&quot;/login&quot; scope=&quot;request&quot; type=&quot;org.springframework.web.struts.DelegatingActionProxy&quot; validate=&quot;true&quot; /&gt;<br /> &lt;plug-in className=&quot;org.springframework.web.struts.ContextLoaderPlugIn&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;set-property property=&quot;contextConfigLocation&quot; value=&quot;/WEB-INF/applicationContext.xml,/WEB-INF/action-servlet.xml&quot; /&gt;<br /> &lt;/plug-in&gt;<br /> <br /> 对应的/login在action-servlet.xml文件中<br /> &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br /> &lt;!DOCTYPE beans PUBLIC &quot;-//SPRING//DTD BEAN//EN&quot; &quot;http://www.springframework.org/dtd/spring-beans.dtd&quot;&gt;<br /> &lt;beans&gt;<br /> &lt;bean name=&quot;/login&quot; class=&quot;com.laoer.bbscs.web.action.Login&quot; singleton=&quot;false&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;userService&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ref bean=&quot;userService&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &lt;/bean&gt;<br /> &lt;/beans&gt;</p> 
<p>然后对应的userService在applicationContext.xml文件中:</p> 
<p>&lt;!DOCTYPE beans PUBLIC &quot;-//SPRING//DTD BEAN//EN&quot; &quot;http://www.springframework.org/dtd/spring-beans.dtd&quot;&gt;<br /> &lt;beans&gt;</p> 
<p>&lt;<font color="#0000ff"><strong>bean id=&quot;userService&quot; parent=&quot;txProxyTemplate&quot;&gt;</strong></font><br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;target&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ref bean=&quot;userTarget&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &lt;/bean&gt;</p> 
<p>&lt;<strong><font color="#0000ff">bean id=&quot;txProxyTemplate&quot;</font></strong> abstract=&quot;true&quot; class=&quot;org.springframework.transaction.interceptor.TransactionProxyFactoryBean&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;transactionManager&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ref bean=&quot;<font color="#cc99ff">myTransactionManager</font>&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;transactionAttributes&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;props&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;create*&quot;&gt;PROPAGATION_REQUIRED&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;save*&quot;&gt;PROPAGATION_REQUIRED&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;remove*&quot;&gt;PROPAGATION_REQUIRED&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;update*&quot;&gt;PROPAGATION_REQUIRED&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;del*&quot;&gt;PROPAGATION_REQUIRED&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/props&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &lt;/bean&gt;</p> 
<p>&lt;bean id=&quot;<font color="#cc99ff">myTransactionManager</font>&quot; class=&quot;org.springframework.orm.hibernate3.HibernateTransactionManager&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;sessionFactory&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ref local=&quot;<strong><font color="#ff9900">sessionFactory</font></strong>&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &lt;/bean&gt;</p> 
<p>&lt;<strong><font color="#ff9900">bean id=&quot;sessionFactory&quot;</font></strong> class=&quot;org.springframework.orm.hibernate3.LocalSessionFactoryBean&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;dataSource&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ref local=&quot;<font color="#ff99cc"><strong>dataSource</strong></font>&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;mappingResources&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;list&gt;</p> 
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;接下来就是.hbm.xml的路径&lt;/value&gt;</p> 
<p>&lt;/list&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;hibernateProperties&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;props&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;hibernate.dialect&quot;&gt;${hibernate.dialect}&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;hibernate.show_sql&quot;&gt;${hibernate.show_sql}&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;hibernate.jdbc.fetch_size&quot;&gt;${hibernate.jdbc.fetch_size}&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;hibernate.jdbc.batch_size&quot;&gt;${hibernate.jdbc.batch_size}&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!--&lt;prop key=&quot;hibernate.proxool.pool_alias&quot;&gt;bbscs7db&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;hibernate.proxool.xml&quot;&gt;proxool.xml&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;prop key=&quot;hibernate.connection.release_mode&quot;&gt;${hibernate.connection.release_mode}&lt;/prop&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/props&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &lt;/bean&gt;</p> 
<p>&lt;<font color="#ff99cc"><strong>bean id=&quot;dataSource&quot;</strong></font> class=&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot; destroy-method=&quot;close&quot; dependency-check=&quot;none&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;driverClass&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;${datasource.driverClassName}&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;jdbcUrl&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;${datasource.url}&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;user&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;${datasource.username}&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;password&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;${datasource.password}&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;acquireIncrement&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;${c3p0.acquireIncrement}&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;initialPoolSize&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;${c3p0.initialPoolSize}&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;minPoolSize&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;${c3p0.minPoolSize}&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;maxPoolSize&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;${c3p0.maxPoolSize}&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;maxIdleTime&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;${c3p0.maxIdleTime}&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;idleConnectionTestPeriod&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;${c3p0.idleConnectionTestPeriod}&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;maxStatements&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;${c3p0.maxStatements}&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;numHelperThreads&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;${c3p0.numHelperThreads}&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &lt;/bean&gt;</p> 
<p><strong>&lt;bean id=&quot;placeholderConfig&quot; class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;property name=&quot;location&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;value&gt;classpath:init.properties&lt;/value&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;/property&gt;<br /> &lt;/bean&gt;</strong></p> 
<p>&lt;/beans&gt;</p> 
<p>接下来需要classpath下定义名为<strong>init.properties</strong>的文件,如:</p> 
<p>#next attributes need your config</p> 
<p>datasource.type=mysql<br /> datasource.driverClassName=org.gjt.mm.mysql.Driver<br /> datasource.url=jdbc:mysql://localhost:3306/databasename?useUnicode=true&amp;characterEncoding=UTF-8<br /> datasource.username=databaseusername<br /> datasource.password=userpassword<br /> <br /> datasource.maxActive=10<br /> datasource.maxIdle=2<br /> datasource.maxWait=120000<br /> datasource.whenExhaustedAction=1<br /> datasource.validationQuery=select 1 from dual<br /> datasource.testOnBorrow=true<br /> datasource.testOnReturn=false<br /> <br /> c3p0.acquireIncrement=3<br /> c3p0.initialPoolSize=3<br /> c3p0.idleConnectionTestPeriod=900<br /> c3p0.minPoolSize=2<br /> c3p0.maxPoolSize=50<br /> c3p0.maxStatements=100<br /> c3p0.numHelperThreads=10<br /> c3p0.maxIdleTime=600<br /> <br /> hibernate.dialect=org.hibernate.dialect.MySQLInnoDBDialect<br /> #hibernate.dialect=org.hibernate.dialect.MySQLMyISAMDialect<br /> #hibernate.dialect=org.hibernate.dialect.MySQLDialect<br /> hibernate.jdbc.batch_size=25<br /> hibernate.jdbc.fetch_size=50<br /> hibernate.show_sql=false<br /> hibernate.connection.release_mode=after_transaction<br /> Trackback: http://tb.blog.csdn.net/TrackBack.aspx?PostId=1729471</p> 
<p><a href="http://hi.baidu.com/mico1983/blog/item/42915f0e67170fc87acbe1ff.html">http://hi.baidu.com/mico1983/blog/item/42915f0e67170fc87acbe1ff.html</a></p></div></body></html>