<html><head><title><div class="tit">
  dom4j学习总结（一）
</div></title></head><body><div id='tit'>dom4j学习总结（一）</div><div id='cate'>j&middot;入门</div><div id='date'>2008年04月20日 星期日 00:50 A.M.</div><div id='page'>141</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/5497fedc0ec1a7a4cc116615.html'>http://hi.baidu.com/hxzon/blog/item/5497fedc0ec1a7a4cc116615.html</a><div id='cnt'><div class="con_all"> 
 <p> </p> 
 <h4 align="center">dom4j学习总结（一）</h4> 
 <p><strong>（一）创建Document的基本操作</strong></p> 
 <p><font color="#333399">/**<br /> * xml基本操作<br /> */</font><br /> public void BaseOperation(){<br /> <font color="#99cc00">//创建一个document<br /> </font>&nbsp;&nbsp; Document document=DocumentHelper.createDocument();<br /> &nbsp;&nbsp;<font color="#99cc00">//创建根结点<br /> </font>&nbsp;&nbsp; Element root=document.addElement(&quot;root&quot;);<br /> <font color="#99cc00">//为根结点添加一个book节点<br /> </font>&nbsp;&nbsp; Element book1=root.addElement(&quot;book&quot;);<br /> &nbsp;&nbsp;<font color="#99cc00">//为book1添加属性type<br /> </font>&nbsp;&nbsp; book1.addAttribute(&quot;type&quot;,&quot;science&quot;);<br /> &nbsp;&nbsp;<font color="#99cc00">//为book1添加name子节点<br /> </font>&nbsp;&nbsp; Element name1=book1.addElement(&quot;Name&quot;);<br /> <font color="#99cc00">//并设置其name为&quot;Java&quot;<br /> </font>&nbsp;&nbsp; name1.setText(&quot;Java&quot;);<br /> &nbsp;&nbsp;<font color="#99cc00">//为book1创建一个price节点,并设其价格为100<br /> </font>&nbsp;&nbsp; book1.addElement(&quot;price&quot;).setText(&quot;100&quot;);<br /> &nbsp;&nbsp;<br /> &nbsp;&nbsp;<font color="#99cc00">//为根结点添加第二个book节点，并设置该book节点的type属性<br /> </font>&nbsp;&nbsp; Element book2=root.addElement(&quot;book&quot;).addAttribute(&quot;type&quot;,&quot;science&quot;);<br /> <font color="#99cc00">//为book1添加name子节点<br /> </font>&nbsp;&nbsp; Element name2=book2.addElement(&quot;Name&quot;);<br /> &nbsp;&nbsp;<font color="#99cc00">//并设置其name为&quot;Oracle&quot;<br /> </font>&nbsp;&nbsp; name2.setText(&quot;Oracle&quot;);<br /> <font color="#99cc00">//为book1创建一个price节点,并设其价格为200<br /> </font>&nbsp;&nbsp; book2.addElement(&quot;price&quot;).setText(&quot;200&quot;);<br /> &nbsp;&nbsp;<br /> <font color="#99cc00">//输出xml<br /> </font>&nbsp;&nbsp; System.out.println(document.asXML());<br /> }</p> 
 <p>调用BaseOperation，输出结果为：</p> 
 <p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br /> &lt;root&gt;<br /> &lt;book type=&quot;science&quot;&gt;<br /> &nbsp;&nbsp; &lt;Name&gt;Java&lt;/Name&gt;<br /> &nbsp;&nbsp; &lt;price&gt;100&lt;/price&gt;<br /> &lt;/book&gt;<br /> &lt;book type=&quot;science&quot;&gt;<br /> &nbsp;&nbsp; &lt;Name&gt;Oracle&lt;/Name&gt;<br /> &nbsp;&nbsp; &lt;price&gt;200&lt;/price&gt;<br /> &lt;/book&gt;<br /> &lt;/root&gt;</p> 
 <p><strong>（二）根据一个符合Document格式的字符串来生成一个Document</strong></p> 
 <p><font color="#333399">/**将字符串转化为Document<br /> * @param str 输入的字符串<br /> * @return 生成的document<br /> * @throws DocumentException<br /> */</font><br /> public Document parserStrtoDocument(String str) throws DocumentException{<br /> &nbsp;&nbsp; Document document=DocumentHelper.parseText(str);<br /> &nbsp;&nbsp; return document;<br /> }</p> 
 <p>调用示例：</p> 
 <p>String str=&quot;&lt;root&gt;&lt;book type='science'&gt;&lt;Name&gt;Java&lt;/Name&gt;&lt;price&gt;100&lt;/price&gt;&lt;/book&gt;&lt;/root&gt;&quot;;</p> 
 <p>&nbsp;&nbsp; Document document = parserStrtoDocument(str);<br /> &nbsp;&nbsp; System.out.println(document.asXML());</p> 
 <p>输出结果为：</p> 
 <p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br /> &lt;root&gt;<br /> &lt;book type=&quot;science&quot;&gt;<br /> &nbsp;&nbsp; &lt;Name&gt;Java&lt;/Name&gt;<br /> &nbsp;&nbsp; &lt;price&gt;100&lt;/price&gt;<br /> &lt;/book&gt;<br /> &lt;/root&gt;</p> 
 <p><strong>（三）取得xml节点属性的基本方法</strong></p> 
 <p><font color="#333399">/**<br /> * 取得xml的节点和属性的值<br /> * @throws DocumentException <br /> */</font><br /> public void getBaseInfofromDocument() throws DocumentException{<br /> &nbsp;&nbsp; String str=&quot;&lt;root&gt;&lt;book type='science'&gt;&lt;Name&gt;Java&lt;/Name&gt;&lt;price&gt;100&lt;/price&gt;&lt;/book&gt;&lt;/root&gt;&quot;;<br /> <font color="#99cc00">//生成一个Document<br /> </font>&nbsp;&nbsp; Document document = DocumentHelper.parseText(str);<br /> &nbsp;&nbsp;<font color="#99cc00">//取得根结点<br /> </font>&nbsp;&nbsp; Element root=document.getRootElement();<br /> <font color="#99cc00">//取得book节点<br /> </font>&nbsp;&nbsp; Element book=root.element(&quot;book&quot;);<br /> &nbsp;&nbsp;<font color="#99cc00">//取得book节点的type属性的值<br /> </font>&nbsp;&nbsp; String type=book.attributeValue(&quot;type&quot;);<br /> &nbsp;&nbsp;<font color="#99cc00">//取得Name节点<br /> </font>&nbsp;&nbsp; Element name=book.element(&quot;Name&quot;);<br /> <font color="#99cc00">//取得书名<br /> </font>&nbsp;&nbsp; String bookname=name.getText();<br /> &nbsp;&nbsp;<font color="#99cc00">//取得书的价钱<br /> </font>&nbsp;&nbsp; int price=Integer.parseInt(book.element(&quot;price&quot;).getText());<br /> &nbsp;&nbsp;<br /> <font color="#808000"></font><font color="#99cc00">//输出书目信息</font><br /> &nbsp;&nbsp; System.out.println(&quot;书名：&quot;+bookname);<br /> &nbsp;&nbsp; System.out.println(&quot;所属类别：&quot;+type);<br /> &nbsp;&nbsp; System.out.println(&quot;价格：&quot;+price);<br /> }</p> 
 <p>调用getBaseInfofromDocument，输出结果为：</p> 
 <p>书名：Java<br /> 所属类别：science<br /> 价格：100</p> 
 <p><strong>（四）利用迭代，xpath取得节点及其属性值</strong></p> 
 <p><font color="#333399">/**利用迭代，xpath取得xml的节点及其属性值<br /> * @throws DocumentException<br /> */</font><br /> public void getComplexInfofromDocument() throws DocumentException{</p> 
 <p><br /> &nbsp;&nbsp; String str=&quot;&lt;root&gt;&lt;book type='science'&gt;&lt;Name&gt;Java&lt;/Name&gt;&lt;price&gt;100&lt;/price&gt;&lt;/book&gt;&quot;<br /> &nbsp;&nbsp;&nbsp; +&quot;&lt;book type='science'&gt;&lt;Name&gt;Oracle&lt;/Name&gt;&lt;price&gt;120&lt;/price&gt;&lt;/book&gt;&quot;<br /> &nbsp;&nbsp;&nbsp; +&quot;&lt;book type='society'&gt;&lt;Name&gt;Society security&lt;/Name&gt;&lt;price&gt;130&lt;/price&gt;&lt;/book&gt;&quot;<br /> &nbsp;&nbsp;&nbsp; +&quot;&lt;author&gt;&lt;name&gt;chb&lt;/name&gt;&lt;/author&gt;&lt;/root&gt;&quot;;<br /> <font color="#99cc00">//生成一个Document<br /> </font>&nbsp;&nbsp; Document document = DocumentHelper.parseText(str);<br /> &nbsp;&nbsp;<br /> <font color="#99cc00">//提取类型为&quot;society&quot;的书<br /> </font><font color="#ff0000">&nbsp;&nbsp; //此处需要添加支持xpath的jar包，详细见备注<br /> </font>&nbsp;&nbsp; Element society_book=(Element)document.selectSingleNode(&quot;/root/book[@type='society']&quot;);<br /> &nbsp;&nbsp; System.out.println(society_book.asXML());<br /> &nbsp;&nbsp;<br /> &nbsp;&nbsp;<font color="#99cc00">//提取价格节点的列表<br /> </font>&nbsp;&nbsp; System.out.println(&quot;-----------价格列表-------------&quot;);<br /> &nbsp;&nbsp; List price=document.selectNodes(&quot;//price&quot;);<br /> &nbsp;&nbsp; for(int i=0;i&lt;price.size();i++){<br /> &nbsp;&nbsp;&nbsp; Element elem_price=(Element)price.get(i);<br /> &nbsp;&nbsp;&nbsp; System.out.println(elem_price.getText());<br /> &nbsp;&nbsp; }<br /> &nbsp;&nbsp;<br /> <font color="#99cc00">&nbsp;&nbsp; //循环根结点下的所有节点，若当前节点为book，则输出这本书的详细信息<br /> </font>&nbsp;&nbsp; System.out.println(&quot;-------------书目详情------------&quot;);<br /> &nbsp;&nbsp; System.out.println(&quot;书名\t\t类别\t\t价格&quot;);<br /> &nbsp;&nbsp; Element root=document.getRootElement();<br /> &nbsp;&nbsp; Iterator iterator=root.elementIterator();<br /> &nbsp;&nbsp; while(iterator.hasNext()){<br /> &nbsp;&nbsp;&nbsp; Element element=(Element)iterator.next();<br /> &nbsp;&nbsp;&nbsp; if(element.getName().equals(&quot;book&quot;)){<br /> &nbsp;&nbsp;&nbsp;&nbsp; System.out.print(element.element(&quot;Name&quot;).getText()+&quot;\t&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp; System.out.print(element.attributeValue(&quot;type&quot;)+&quot;\t\t&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp; System.out.print(element.element(&quot;price&quot;).getText()+&quot;\n&quot;);<br /> &nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp; }</p> 
 <p>&nbsp;&nbsp;<font color="#99cc00">//查找作者姓名<br /> </font>&nbsp;&nbsp; Element author=(Element)document.selectSingleNode(&quot;//author&quot;);<br /> &nbsp;&nbsp; System.out.println(&quot;---------&quot;+author.element(&quot;name&quot;).getText()+&quot;----------&quot;);<br /> &nbsp;&nbsp;<font color="#99cc00">//提取作者的所有书目名称<br /> </font>&nbsp;&nbsp; Iterator iterator_book=root.elementIterator(&quot;book&quot;);&nbsp;&nbsp;<br /> &nbsp;&nbsp; while(iterator_book.hasNext()){<br /> &nbsp;&nbsp;&nbsp; Element book=(Element)iterator_book.next();<br /> &nbsp;&nbsp;&nbsp; System.out.print(book.element(&quot;Name&quot;).getText()+&quot;\t&quot;);<br /> &nbsp;&nbsp; }<br /> &nbsp;&nbsp;<br /> <font color="#99cc00">//属性迭代<br /> </font>&nbsp;&nbsp; System.out.println(&quot;\n-------属性迭代--------&quot;);<br /> &nbsp;&nbsp; String str1=&quot;&lt;book type='science' name='Java' price='100'/&gt;&quot;;<br /> &nbsp;&nbsp; Document document1=DocumentHelper.parseText(str1);<br /> <font color="#99cc00">//开始迭代<br /> </font>&nbsp;&nbsp; Iterator iterator_attribute=document1.getRootElement().attributeIterator();<br /> &nbsp;&nbsp; while(iterator_attribute.hasNext()){<br /> <font color="#99cc00">&nbsp;&nbsp; //提取当前属性<br /> </font>&nbsp;&nbsp;&nbsp; Attribute attribute=(Attribute)iterator_attribute.next();<br /> &nbsp;&nbsp;&nbsp; System.out.println(attribute.getName()+&quot;:&quot;+attribute.getValue());<br /> &nbsp;&nbsp; }<br /> }</p> 
 <p>调用getComplexInfofromDocument，输出结果为：</p> 
 <p>&lt;book type=&quot;society&quot;&gt;&lt;Name&gt;Society security&lt;/Name&gt;&lt;price&gt;130&lt;/price&gt;&lt;/book&gt;<br /> -----------价格列表-------------<br /> 100<br /> 120<br /> 130<br /> -------------书目详情------------<br /> 书名&nbsp;&nbsp; 类别&nbsp;&nbsp; 价格<br /> Java science&nbsp;&nbsp; 100<br /> Oracle science&nbsp;&nbsp; 120<br /> Society security society&nbsp;&nbsp; 130<br /> ---------chb----------<br /> Java Oracle Society security <br /> -------属性迭代--------<br /> type:science<br /> name:Java<br /> price:100</p> 
 <p><font color="#ff0000"><strong>备注：调用该方法之前，应该先向工程中添加支持xpath的jar包，否则，会出现以下错误：</strong></font></p> 
 <p><font color="#ff0000">java.lang.NoClassDefFoundError: org/jaxen/JaxenException<br /> </font>at org.dom4j.DocumentFactory.createXPath(DocumentFactory.java:230)<br /> at org.dom4j.tree.AbstractNode.createXPath(AbstractNode.java:207)<br /> at org.dom4j.tree.AbstractNode.selectSingleNode(AbstractNode.java:183)<br /> at xml_chb.dom4j_chb.getComplexInfofromDocument(dom4j_chb.java:82)<br /> at xml_chb.dom4j_chb.main(dom4j_chb.java:92)<br /> Exception in thread &quot;main&quot;</p> 
 <p>只需要引入jaxen包就行了，我使用的是hibernate包中的jaxen-1.1-beta-7.jar包。</p> 
 <p><a href="http://dev.csdn.net/author/hbcui1984/b45318a9d8eb43bb82edf864fb22ad07.html">http://dev.csdn.net/author/hbcui1984/b45318a9d8eb43bb82edf864fb22ad07.html</a></p> 
</div></div></body></html>