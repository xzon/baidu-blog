<html><head><title><div class="tit">
  AJAX读取rss的代码 -ajaxcode
</div></title></head><body><div id='tit'>AJAX读取rss的代码 -ajaxcode</div><div id='cate'>代码备份</div><div id='date'>2008年04月13日 星期日 03:19 P.M.</div><div id='page'>143</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/07156a81560c17ddbc3e1ed2.html'>http://hi.baidu.com/hxzon/blog/item/07156a81560c17ddbc3e1ed2.html</a><div id='cnt'><p>AJAX读取rss的代码 -ajaxcode</p> 
<p>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;<br /> &nbsp;&nbsp; &quot;<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd</a>&quot;&gt;<br /> &lt;html xmlns=&quot;<a href="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</a>&quot;&gt;<br /> &lt;head&gt;<br /> &lt;title&gt;this is test&lt;/title&gt;</p> 
<p>&lt;script type=&quot;text/javascript&quot;&gt;<br /> var xmlHttp;</p> 
<p>function createXMLHttpRequest() {<br /> &nbsp;&nbsp;&nbsp;&nbsp; if (window.ActiveXObject) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xmlHttp = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp; } <br /> &nbsp;&nbsp;&nbsp;&nbsp; else if (window.XMLHttpRequest) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xmlHttp = new XMLHttpRequest();<br /> &nbsp;&nbsp;&nbsp;&nbsp; }<br /> }</p> 
<p>function readRSS(url) {<br /> &nbsp;&nbsp;&nbsp;&nbsp; createXMLHttpRequest();<br /> &nbsp;&nbsp;&nbsp;&nbsp; xmlHttp.onreadystatechange = handleStateChange;<br /> &nbsp;&nbsp;&nbsp;&nbsp; xmlHttp.open(&quot;GET&quot;, url, true);<br /> &nbsp;&nbsp;&nbsp;&nbsp; xmlHttp.send(null);<br /> &nbsp;&nbsp;<br /> &nbsp;&nbsp;<br /> }<br /> &nbsp;&nbsp;&nbsp;&nbsp;<br /> function handleStateChange() {<br /> &nbsp;&nbsp;&nbsp;&nbsp; if(xmlHttp.readyState == 4) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(xmlHttp.status == 200) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ResultSet();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp; }<br /> }</p> 
<p>function ResultSet() {<br /> &nbsp;&nbsp;&nbsp;&nbsp; var results = xmlHttp.responseXML;<br /> &nbsp;&nbsp;&nbsp;&nbsp; var title = null;<br /> &nbsp;&nbsp;&nbsp;&nbsp; var item = null;<br /> &nbsp;&nbsp;&nbsp;&nbsp; var link=null;<br /> &nbsp;&nbsp;&nbsp;&nbsp; //得到channel<br /> &nbsp;&nbsp;&nbsp;&nbsp; var ccc=results.getElementsByTagName(&quot;channel&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var headtitle=ccc[0].getElementsByTagName(&quot;title&quot;)[0].firstChild.nodeValue;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var headlink=ccc[0].getElementsByTagName(&quot;link&quot;)[0].firstChild.nodeValue;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var cell = document.createElement(&quot;div&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cell.innerHTML=&quot;&lt;h1&gt;&lt;a href=&quot;+headlink+&quot; target=_blank&gt;&quot;+headtitle+&quot;&lt;/a&gt;&lt;/h1&gt;&lt;br&gt;&quot;;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; document.getElementById(&quot;result&quot;).appendChild(cell);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //得到items<br /> &nbsp;&nbsp;&nbsp;&nbsp; var items = results.getElementsByTagName(&quot;item&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp; for(var i = 0; i &lt; items.length; i++) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; item = items[i];<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; link=item.getElementsByTagName(&quot;link&quot;)[0].firstChild.nodeValue;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; title = item.getElementsByTagName(&quot;title&quot;)[0].firstChild.nodeValue;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var cell = document.createElement(&quot;div&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cell.innerHTML=&quot;&lt;a href=&quot;+link+&quot; target=_blank&gt;&quot;+title+&quot;&lt;/a&gt;&lt;br&gt;&quot;;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; document.getElementById(&quot;result&quot;).appendChild(cell);<br /> &nbsp;&nbsp;&nbsp;&nbsp; }</p> 
<p>}<br /> function readrss1()<br /> {<br /> &nbsp;&nbsp;&nbsp;&nbsp; var url=document.getElementById(&quot;txturl&quot;).value;<br /> &nbsp;&nbsp;&nbsp;&nbsp; if(url==&quot;&quot;)<br /> &nbsp;&nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(&quot;请输入RSS地址&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp; else<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; readRSS(url);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp; }</p> 
<p>&lt;/script&gt;<br /> &lt;/head&gt;</p> 
<p>&lt;body&quot;&gt;<br /> &nbsp;&nbsp; &lt;h1&gt;ajax读rss示例&lt;/h1&gt;<br /> &nbsp;&nbsp; &lt;form &gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /> &nbsp;&nbsp; &lt;a href=&quot;javascript:readRSS('http://www.blogjava.net/rss.aspx')&quot;&gt;blogjava原创区 &lt;/a&gt;&amp;nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /> &nbsp;&nbsp;&nbsp; &lt;a href=&quot;javascript:readRSS('http://beginner.blogjava.net/rss.aspx')&quot;&gt;blogjava新手区 &lt;/a&gt; &amp;nbsp <br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;a href=&quot;javascript:readRSS('http://life.blogjava.net/rss.aspx')&quot;&gt;blogjava非技术区 &lt;/a&gt; &amp;nbsp <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;a href=&quot;javascript:readRSS('http://general.blogjava.net/rss.aspx')&quot;&gt;综合区 &lt;/a&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;br&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 输入一个RSS地址:&lt;input type=&quot;text&quot; value=&quot;<a href="http://www.blogjava.net/wujun/rss.aspx">http://www.blogjava.net/wujun/rss.aspx</a>&quot; size=50 id=&quot;txturl&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;input type=&quot;button&quot; value=&quot;查 看&quot; onclick=&quot;readrss1()&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /> &nbsp;&nbsp; &lt;/form&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;div id=&quot;result&quot;&gt;&lt;/div&gt;<br /> &lt;/body&gt;<br /> &lt;/html&gt;</p></div></body></html>