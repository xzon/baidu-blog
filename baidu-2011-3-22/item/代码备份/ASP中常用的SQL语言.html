<html><head><title><div class="tit">
  ASP中常用的SQL语言
</div></title></head><body><div id='tit'>ASP中常用的SQL语言</div><div id='cate'>代码备份</div><div id='date'>2007年11月23日 星期五 09:35 P.M.</div><div id='page'>204</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/d07fab6e8f84efd981cb4a8a.html'>http://hi.baidu.com/hxzon/blog/item/d07fab6e8f84efd981cb4a8a.html</a><div id='cnt'><div class="tit">
 ASP中常用的SQL语言
</div> 
<div class="date">
 2007-04-27 15:32
</div> 
<table style="table-layout: fixed"> 
 <tbody> 
  <tr> 
   <td> 
    <div class="cnt">
     <span> 
      <div class="hei13" style="padding-right: 3px; padding-left: 3px; padding-bottom: 3px; padding-top: 3px">
       <font size="3">SQL语句的添加、删除、修改虽然有如下很多种方法，但在使用过程中还是不够用，不知是<br /> 否有高手把更多灵活的使用方法贡献出来？<br /> <br /> 添加、删除、修改使用db.Execute(Sql)命令执行操作<br /> ╔----------------╗<br /> ☆ 数据记录筛选 ☆<br /> ╚----------------╝<br /> 注意：单双引号的用法可能有误(没有测式)<br /> <br /> Sql = &quot;Select Distinct 字段名 From 数据表&quot;<br /> Distinct函数，查询数据库存表内不重复的记录<br /> <br /> Sql = &quot;Select Count(*) From 数据表 where 字段名1&gt;#18:0:0# and 字段名1&lt; #19:00# &quot;<br /> count函数,查询数库表内有多少条记录，“字段名1”是指同一字段<br /> 例：<br /> set rs=conn.execute(&quot;select count(id) as idnum from news&quot;)<br /> response.write rs(&quot;idnum&quot;)<br /> <br /> sql=&quot;select * from 数据表 where 字段名 between 值1 and 值2&quot; <br /> Sql=&quot;select * from 数据表 where 字段名 between #2003-8-10# and #2003-8-12#&quot;<br /> 在日期类数值为2003-8-10 19:55:08 的字段里查找2003-8-10至2003-8-12的所有记录，而<br /> 不管是几点几分。<br /> <br /> select * from tb_name where datetime between #2003-8-10# and #2003-8-12#<br /> 字段里面的数据格式为：2003-8-10 19:55:08，通过sql查出2003-8-10至2003-8-12的所有<br /> 纪录，而不管是几点几分。<br /> <br /> <br /> Sql=&quot;select * from 数据表 where 字段名=字段值 order by 字段名 [desc]&quot; <br /> <br /> Sql=&quot;select * from 数据表 where 字段名 like '%字段值%' order by 字段名 [desc]&quot; <br /> 模糊查询<br /> <br /> Sql=&quot;select top 10 * from 数据表 where 字段名 order by 字段名 [desc]&quot; <br /> 查找数据库中前10记录<br /> <br /> Sql=&quot;select top n * form 数据表 order by newid()&quot;<br /> 随机取出数据库中的若干条记录的方法<br /> top n，n就是要取出的记录数<br /> <br /> Sql=&quot;select * from 数据表 where 字段名 in ('值1','值2','值3')&quot;<br /> <br /> ╔----------------╗<br /> ☆ 添加数据记录 ☆<br /> ╚----------------╝<br /> sql=&quot;insert into 数据表 (字段1,字段2,字段3 …) valuess (值1,值2,值3 …)&quot; <br /> <br /> sql=&quot;insert into 数据表 valuess (值1,值2,值3 …)&quot; <br /> 不指定具体字段名表示将按照数据表中字段的顺序，依次添加<br /> <br /> sql=&quot;insert into 目标数据表 select * from 源数据表&quot; <br /> 把源数据表的记录添加到目标数据表<br /> <br /> ╔----------------╗<br /> ☆ 更新数据记录 ☆<br /> ╚----------------╝<br /> Sql=&quot;update 数据表 set 字段名=字段值 where 条件表达式&quot; <br /> <br /> Sql=&quot;update 数据表 set 字段1=值1,字段2=值2 …… 字段n=值n where 条件表达式&quot; <br /> <br /> Sql=&quot;update 数据表 set 字段1=值1,字段2=值2 …… 字段n=值n &quot; <br /> 没有条件则更新整个数据表中的指定字段值<br /> <br /> ╔----------------╗<br /> ☆ 删除数据记录 ☆<br /> ╚----------------╝<br /> Sql=&quot;delete from 数据表 where 条件表达式&quot; <br /> <br /> Sql=&quot;delete from 数据表&quot; <br /> 没有条件将删除数据表中所有记录)<br /> <br /> ╔--------------------╗<br /> ☆ 数据记录统计函数 ☆<br /> ╚--------------------╝<br /> AVG(字段名) 得出一个表格栏平均值 <br /> COUNT(*|字段名) 对数据行数的统计或对某一栏有值的数据行数统计 <br /> MAX(字段名) 取得一个表格栏最大的值 <br /> MIN(字段名) 取得一个表格栏最小的值 <br /> SUM(字段名) 把数据栏的值相加 <br /> <br /> 引用以上函数的方法： <br /> sql=&quot;select sum(字段名) as 别名 from 数据表 where 条件表达式&quot; <br /> set rs=conn.excute(sql) <br /> 用 rs(&quot;别名&quot;) 获取统的计值，其它函数运用同上。 <br /> <br /> ╔----------------------╗<br /> ☆ 数据表的建立和删除 ☆<br /> ╚----------------------╝<br /> Create TABLE 数据表名称(字段1 类型1(长度),字段2 类型2(长度) …… ) <br /> 例：Create TABLE tab01(name varchar(50),datetime default now()) <br /> Drop TABLE 数据表名称 (永久性删除一个数据表) <br /> <br /> ╔--------------------╗<br /> ☆ 记录集对象的方法 ☆<br /> ╚--------------------╝<br /> rs.movenext 将记录指针从当前的位置向下移一行 <br /> rs.moveprevious 将记录指针从当前的位置向上移一行 <br /> rs.movefirst 将记录指针移到数据表第一行 <br /> rs.movelast 将记录指针移到数据表最后一行 <br /> rs.absoluteposition=N 将记录指针移到数据表第N行 <br /> rs.absolutepage=N 将记录指针移到第N页的第一行 <br /> rs.pagesize=N 设置每页为N条记录 <br /> rs.pagecount 根据 pagesize 的设置返回总页数 <br /> rs.recordcount 返回记录总数 <br /> rs.bof 返回记录指针是否超出数据表首端，true表示是，false为否 <br /> rs.eof 返回记录指针是否超出数据表末端，true表示是，false为否 <br /> rs.delete 删除当前记录，但记录指针不会向下移动 <br /> rs.addnew 添加记录到数据表末端 <br /> rs.update 更新数据表记录 </font>
      </div> </span>
    </div> </td> 
  </tr> 
 </tbody> 
</table></div></body></html>