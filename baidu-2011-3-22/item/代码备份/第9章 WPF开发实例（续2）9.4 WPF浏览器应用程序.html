<html><head><title><div class="tit">
  第9章 WPF开发实例（续2）9.4 WPF浏览器应用程序
</div></title></head><body><div id='tit'>第9章 WPF开发实例（续2）9.4 WPF浏览器应用程序</div><div id='cate'>代码备份</div><div id='date'>2009年04月25日 星期六 08:32 P.M.</div><div id='page'>53</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/1f802e34321684335ab5f524.html'>http://hi.baidu.com/hxzon/blog/item/1f802e34321684335ab5f524.html</a><div id='cnt'><div> 
 <div> 
  <div>
   <strong>第9章 WPF开发实例（续2）9.4 WPF浏览器应用程序</strong>
  </div> 
  <div>
   <strong>9.4 WPF浏览器应用程序</strong>
  </div> 
  <div>
   WPF应用程序既可以作为独立应用程序运行在客户端，也可以依附在Internet浏览器（IE6、IE7等）上执行，后一种程序称为WPF浏览器应用程序，本节将介绍WPF浏览器应用程序的开发流程。
  </div> 
  <div>
   <strong>9.4.1 创建WPF浏览器应用程序</strong>
  </div> 
  <div>
   在Visual Studio 2008中，要创建一个WPF浏览器应用程序非常简单，只需根据创建向导执行即可，大致过程如下：
  </div> 
  <div>
   （1）进入Visual Studio 2008开发环境，通过选择&quot;文件&quot;→&quot;新建&quot;→&quot;项目&quot;命令，打开&quot;新建项目&quot;对话框。
  </div> 
  <div>
   （2）在&quot;新建项目&quot;对话框中选择&quot;WPF浏览器应用程序&quot;模板，该模板位于&quot;其他语言&quot;→&quot;C#&quot;→&quot;Windows&quot;分类下。
  </div> 
  <div>
   （3）选择.NET Framework 3.5，输入项目名称&quot;WPFBroseApp&quot;，选择项目存放位置，并选中&quot;创建解决方案的目录&quot;复选框。
  </div> 
  <div>
   （4）单击&quot;确定&quot;按钮，完成创建向导的设置，Visual Studio 2008会根据模板自动生成WPF浏览器应用程序的基本框架以及默认的页面（Page）。
  </div> 
  <div>
   通过Visual Studio 2008自动生成的WPF浏览器应用程序的代码结构如图9-9所示，其中，包括以下几个主要部分。
  </div> 
  <div>
   Properties：包含应用程序版本信息（AssemblyInfo.cs定义）、资源文件（Resources. resx定义）、配置信息（Settings.settings定义）。
  </div> 
  <div>
   引用：包含WPF应用程序必需的引用，PresentationCore、PresentationFramework是主要增加的。
  </div> 
  <div>
   App.xaml：应用程序的XAML代码，主导应用程序的启动和退出等，App.xaml.cs是App.xaml的后台代码。
  </div> 
  <div>
   Page1.xaml：默认启动页面的XAML代码，Page1.xaml.cs是Page1.xaml的后台代码，该页面是可以修改的。
  </div> 
  <div> 
   <table cellspacing="0" bordercolordark="#ffffff" align="center" bgcolor="#ddddd0" bordercolorlight="#999999" border="1"> 
    <tbody> 
     <tr> 
      <td bgcolor="#ffffff"><a target="_blank" href="http://new.51cto.com/files/uploadimg/20080929/175422321.jpg"><img height="391" width="235" border="0" src="image/第9章 WPF开发实例（续2）9.4 W.175422321.jpg" /><p class="origImg">http://new.51cto.com/files/uploadimg/20080929/175422321.jpg</p></a></td> 
     </tr> 
     <tr> 
      <td align="center" bgcolor="#dddddd">图9-9 WPF浏览器应用程序<br /> 的代码结构</td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div>
   和WPF独立应用程序一样，WPF浏览器应用程序也是通过App.xaml启动的，只是它的StartupUri属性是Page1.xaml。 WPF浏览器应用程序界面很像网页，所有页面都是从System.Windows.Controls.Page类直接集成得到的，可以前进或后退。
  </div> 
  <div>
   WPF页面的设计和WPF窗体类设计一样，可以通过Visual Studio 2008的可视化设计器进行设计，同样可以在页面上创建控件、设置控件的外观等。示例代码9-12是一个简单页面的XAML代码，其中Page的标题（Title）为Page1，对应后台代码中的C#类型为WPFBroseApp.Page1。该页面包含两个Label控件、一个TextBox控件、一个Button控件。
  </div> 
  <div>
   示例代码9-12：
  </div> 
  <div> 
   <table cellspacing="0" bordercolordark="#ffffff" cellpadding="2" width="400" align="center" bordercolorlight="#000000" border="1"> 
    <tbody> 
     <tr> 
      <td bgcolor="#e6e6e6"> <pre>&lt;Page x:Class=&quot;WPFBroseApp.Page1&quot;<br />xmlns=&quot;<a href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a>&quot;<br />xmlns:x=&quot;<a href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</a>&quot;<br />Title=&quot;Page1&quot; Height=&quot;166&quot; Width=&quot;311&quot;&gt;<br />&lt;Grid Background=&quot;Aquamarine&quot; Height=&quot;154&quot; Width=&quot;305&quot;&gt;<br />&lt;Grid.RowDefinitions&gt;<br />&lt;RowDefinition Height=&quot;0*&quot; /&gt;<br />&lt;RowDefinition Height=&quot;185*&quot; /&gt;<br />&lt;/Grid.RowDefinitions&gt;<br />&lt;Label Margin=&quot;23,26,0,0&quot; Name=&quot;label1&quot; Height=&quot;32&quot; VerticalAlignment=&quot;Top&quot; <br />FontSize=&quot;20&quot; Grid.Row=&quot;1&quot; HorizontalAlignment=&quot;Left&quot; <br />Width=&quot;260&quot;&gt;第一个WPF浏览器应用程序!!!&lt;/Label&gt;<br />&lt;TextBox Margin=&quot;111,69,0,0&quot; Name=&quot;tbName&quot; Grid.Row=&quot;1&quot; <br />HorizontalAlignment=&quot;Left&quot; Width=&quot;148&quot; Height=&quot;22&quot; <br />VerticalAlignment=&quot;Top&quot;&gt;王先生&lt;/TextBox&gt;<br />&lt;Label Margin=&quot;32,69,0,0&quot; Name=&quot;label2&quot; Grid.Row=&quot;1&quot; <br />HorizontalAlignment=&quot;Left&quot; Width=&quot;71&quot; Height=&quot;27&quot; <br />VerticalAlignment=&quot;Top&quot;&gt;输入姓名：&lt;/Label&gt;<br />&lt;Button Grid.Row=&quot;1&quot; Margin=&quot;112,100,0,0&quot; Name=&quot;btnEnter&quot; <br />FontSize=&quot;18&quot; FontWeight =&quot;Bold&quot; Click=&quot;btnEnter_Click&quot; Height=&quot;28&quot; <br />VerticalAlignment=&quot;Top&quot; HorizontalAlignment=&quot;Left&quot; <br />Width=&quot;122&quot;&gt;进入==&amp;gt;&amp;gt;&lt;/Button&gt;<br />&lt;/Grid&gt;<br />&lt;/Page&gt;</pre> </td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div>
   通过选择&quot;调试&quot;→&quot;启动调试&quot;命令生成并执行WPFBroseApp应用程序，得到的界面如图9-10所示，该应用程序是承载在IE中运行的。生成的可执行程序以.xbap作为扩展名，默认在项目的Bin目录下。
  </div> 
  <div> 
   <table cellspacing="0" bordercolordark="#ffffff" align="center" bgcolor="#ddddd0" bordercolorlight="#999999" border="1"> 
    <tbody> 
     <tr> 
      <td bgcolor="#ffffff"><a target="_blank" href="http://new.51cto.com/files/uploadimg/20080929/175528367.jpg"><img height="221" width="322" border="0" src="image/第9章 WPF开发实例（续2）9.4 W.175528367.jpg" /><p class="origImg">http://new.51cto.com/files/uploadimg/20080929/175528367.jpg</p></a></td> 
     </tr> 
     <tr> 
      <td align="center" bgcolor="#dddddd">图9-10 WPFBroseApp界面效果（1）</td> 
     </tr> 
    </tbody> 
   </table> 图9-10顶端的前进和后退导航栏类似于Windows窗体的标题栏，由WPF自动生成和管理，并不属于开发人员开发区域。下面部分分别是两个Label和一个TextBox控件的效果图。
  </div> 
  <div>
   <strong>9.4.2 页面导航</strong>
  </div> 
  <div>
   WPF浏览器应用程序页面（Page）的设计、开发等与WPF窗体一样，只是在页面导航上有所区别，在WPF窗体中，新窗体的显示是通过 System.Windows.Window类的Show()或ShowDialog()方法来实现的。而在WPF页面中，新页面的显示大致需要以下3个步骤。
  </div> 
  <div>
   （1）创建页面对象：通过new关键字创建新的要显示的页面对象。
  </div> 
  <div>
   （2）对页面进行参数设置等必要的初始化操作，如果不需要初始化，则直接进入第（3）步。
  </div> 
  <div>
   （3）通过Page.NavigationService属性获取当前页面的导航对象，然后通过Navigation Service.Navigate()方法导航到新的页面。
  </div> 
  <div>
   示例代码9-13是示例代码9-12的后台C#代码，函数btnEnter_Click()以最简单的例子演示了导航到新页面的3个步骤，它首先创建一个新页面Page2的对象pg，然后设置Page2的显示必需参数UserName，最后通过Page.NavigationService属性的 Navigate()方法导航到新的页面pg。
  </div> 
  <div>
   示例代码9-13：
  </div> 
  <div> 
   <table cellspacing="0" bordercolordark="#ffffff" cellpadding="2" width="400" align="center" bordercolorlight="#000000" border="1"> 
    <tbody> 
     <tr> 
      <td bgcolor="#e6e6e6"> <pre>namespace WPFBroseApp<br />{<br />/// &lt;summary&gt;<br />/// Page1.xaml 的交互逻辑<br />/// &lt;/summary&gt;<br />public partial class Page1 : Page<br />{<br />public Page1( )<br />{<br />InitializeComponent( );<br />}</pre> <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   private void btnEnter_Click(object sender, RoutedEventArgs e)<br />{<br />//创建新的页面对象pg<br />Page2 pg = new Page2( );<br />//初始化页面对象的参数<br />pg.UserName = this.tbName.Text;<br />//导航到新的页面对象pg<br />this.NavigationService.Navigate(pg);<br />}<br />}<br />}</pre> </td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div>
   其中，Page2是一个新的增加到项目WPFBroseApp中的页面，选中项目WPFBroseApp，通过选择右键菜单中的&quot;添加&quot;→&quot;页&quot;命令完成添加动作。示例代码9-14是Page2的&nbsp;&nbsp; XAML代码和后台C#代码的具体实现，Page2在加载时通过Page_Loaded()方法显示欢迎&nbsp;&nbsp;&nbsp; 信息。
  </div> 
  <div>
   示例代码9-14：
  </div> 
  <div> 
   <table cellspacing="0" bordercolordark="#ffffff" cellpadding="2" width="400" align="center" bordercolorlight="#000000" border="1"> 
    <tbody> 
     <tr> 
      <td bgcolor="#e6e6e6"> <pre>&lt;Page x:Class=&quot;WPFBroseApp.Page2&quot;<br />xmlns=&quot;<a href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a>&quot;<br />xmlns:x=&quot;<a href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</a>&quot;<br />Title=&quot;Page2&quot; Loaded=&quot;Page_Loaded&quot; Height=&quot;52&quot; Width=&quot;248&quot;&gt;<br />&lt;Grid&gt;<br />&lt;Label Name=&quot;lbHint&quot; FontSize=&quot;20&quot; FontWeight=&quot;Bold&quot; Foreground=&quot;Blue&quot; <br />HorizontalAlignment=&quot;Left&quot; Width=&quot;272&quot; Height=&quot;67&quot; <br />VerticalAlignment=&quot;Top&quot;&gt;Label&lt;/Label&gt;<br />&lt;/Grid&gt;<br />&lt;/Page&gt;<br />-----------------------------------------------------------<br />------------------------------------------------------------------------<br />namespace WPFBroseApp<br />{<br />/// &lt;summary&gt;<br />/// Page2.xaml 的交互逻辑<br />/// &lt;/summary&gt;<br />public partial class Page2 : Page<br />{<br />public Page2( )<br />{<br />InitializeComponent( );<br />}</pre> <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   private string _UserName;<br />//用户名属性<br />public string UserName<br />{<br />get<br />{<br />return this._UserName;<br />}<br />set<br />{<br />this._UserName = value;<br />}<br />}</pre> <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   //加载时显示欢迎信息<br />private void Page_Loaded(object sender, RoutedEventArgs e)<br />{<br />this.lbHint.Content = &quot;欢迎----&quot; + this._UserName;<br />}<br />}<br />}</pre> </td> 
     </tr> 
    </tbody> 
   </table> 
   <br /> 在启动WPFBroseApp之后，通过单击&quot;进入==&gt;&gt;&quot;按钮导航到Page2，得到如图9-11所示的效果图，注意最上面的导航栏&quot;返回&quot;变成可用，通过该命令可以回退到Page1页面。 
   <table cellspacing="0" bordercolordark="#ffffff" align="center" bgcolor="#ddddd0" bordercolorlight="#999999" border="1"> 
    <tbody> 
     <tr> 
      <td bgcolor="#ffffff"><a target="_blank" href="http://new.51cto.com/files/uploadimg/20080929/175815839.jpg"><img height="97" width="205" border="0" src="image/第9章 WPF开发实例（续2）9.4 W.175815839.jpg" /><p class="origImg">http://new.51cto.com/files/uploadimg/20080929/175815839.jpg</p></a></td> 
     </tr> 
     <tr> 
      <td align="center" bgcolor="#dddddd">图9-11 WPFBroseApp<br /> 界面效果（2）</td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div> 
  </div> 
 </div> 
</div></div></body></html>