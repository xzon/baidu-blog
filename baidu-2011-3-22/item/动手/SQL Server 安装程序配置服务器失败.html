<html><head><title><div class="tit">
  SQL Server 安装程序配置服务器失败
</div></title></head><body><div id='tit'>SQL Server 安装程序配置服务器失败</div><div id='cate'>动手</div><div id='date'>2007年11月23日 星期五 09:29 P.M.</div><div id='page'>204</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/6a2181d6b644202c07088b8e.html'>http://hi.baidu.com/hxzon/blog/item/6a2181d6b644202c07088b8e.html</a><div id='cnt'><span style="line-height: 15pt"><strong>SQL Server 安装程序配置服务器失败</strong><br /> <br /> 
 <table style="line-height: 1.5" cellspacing="0" cellpadding="0" width="100%" border="0"> 
  <tbody> 
   <tr> 
    <td><span style="font-size: 9pt; "><span>安装程序配置服务器失败。参考服务器错误日志和C:\Windows\sqlstp.log了解更多信息。打开日志一看：<br /> 10:01:23 C:\WINDOWS\TEMP\SqlSetup\Bin\scm.exe -Silent 1 -Action 4 -Service SQLSERVERAGENT<br /> 10:01:26 Process Exit Code: (1060) 指定的服务并未以已安装的服务存在。<br /> 10:01:26 C:\WINDOWS\TEMP\SqlSetup\Bin\scm.exe -Silent 1 -Action 4 -Service MSSQLSERVER<br /> 10:01:27 Process Exit Code: (0) <br /> 10:01:27 StatsGenerate returned: 2<br /> <br /> baidu了下，发现以下办法可以解决：<br /> 第一步：在HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\ Control\Session Manager中找到PendingFilerenameOperations项目，并删除它。这样就可以清除安装暂挂项目，不用重启。<br /> <br /> 第二步：重装，安装的时候选择“高级选项”，并点选“重建注册表项”，然后继续，目录继续指定上次安装的目录，覆盖即可。 <br /> <br /> <br /> 不过装完了，打开企业管理器却报错了：<br /> <br /> 安装好SQL Server 2000后，打开企业管理器提示“管理单元初始化失败”<br /> 管理单元初始化失败 CLSID:{00100100-1816-11D0-8EF5-00AA0062C58F}<br /> <br /> 解决办法如下：<br /> <br /> 通过批处理将SQL相关文件全部注册一遍来解决这个问题。<br /> <br /> 把以下内容粘贴到记事本作成*bat文件执行。<br /> 
       <table class="TBAnc" cellspacing="1" cellpadding="5" width="100%" bgcolor="#cccccc"> 
        <tbody> 
         <tr> 
          <td class="TBBGAnc" bgcolor="#f7f7f7">LeadBBS CODE</td> 
         </tr> 
         <tr> 
          <td class="TBBGAnc" bgcolor="#f7f7f7">@echo on<br /> regsvr32 autoplt.dll /s<br /> regsvr32 autowiz.dll /s<br /> regsvr32 axscphst.dll /s<br /> regsvr32 cdwtasks.dll /s<br /> regsvr32 cdwtskui.dll /s<br /> regsvr32 colctrl.dll /s<br /> regsvr32 comnevnt.dll /s<br /> regsvr32 ctasksui.dll /s<br /> regsvr32 custtask.dll /s<br /> regsvr32 dtsffile.dll /s<br /> regsvr32 dtspkg.dll /s<br /> regsvr32 dtspump.dll /s<br /> regsvr32 dtsui.dll /s<br /> regsvr32 dtswiz.dll /s<br /> regsvr32 hhsetup.dll /s<br /> regsvr32 objmgr.dll /s<br /> regsvr32 pfclnt80.dll /s<br /> regsvr32 pfutil80.dll /s<br /> regsvr32 psdcscm.dll /s<br /> regsvr32 sdiclnt.dll /s<br /> regsvr32 semcomn.dll /s<br /> regsvr32 Semcros.dll /s<br /> regsvr32 Semdll.dll /s<br /> regsvr32 semdts.dll /s<br /> regsvr32 SEMEXEC.dll /s<br /> regsvr32 semmap.dll /s<br /> regsvr32 semnt.dll /s<br /> regsvr32 Semobj.dll /s<br /> regsvr32 semrepl.dll /s<br /> regsvr32 semsfc.dll /s<br /> regsvr32 Semsys.dll /s<br /> regsvr32 semwebwz.dll /s<br /> regsvr32 Semwiz.dll /s<br /> regsvr32 sqdedev.dll /s<br /> regsvr32 SQLDMO.dll /s<br /> regsvr32 sqlftwiz.dll /s<br /> regsvr32 sqlgui.dll /s<br /> regsvr32 sqllex.dll /s<br /> regsvr32 sqlmmc.dll /s<br /> regsvr32 sqlns.dll /s<br /> regsvr32 sqlqry.dll /s<br /> regsvr32 sqlresld.dll /s<br /> regsvr32 sqlsui.dll /s<br /> regsvr32 sqlsvc.dll /s<br /> regsvr32 sqlvdir.dll /s<br /> regsvr32 stardds.dll /s<br /> regsvr32 svrnetcn.dll /s<br /> regsvr32 w95scm.dll /s</td> 
         </tr> 
        </tbody> 
       </table> </span></span></td> 
   </tr> 
  </tbody> 
 </table> </span></div></body></html>