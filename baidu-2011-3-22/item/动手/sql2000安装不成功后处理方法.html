<html><head><title><div class="tit">
  sql2000安装不成功后处理方法
</div></title></head><body><div id='tit'>sql2000安装不成功后处理方法</div><div id='cate'>动手</div><div id='date'>2007年11月23日 星期五 12:39 P.M.</div><div id='page'>204</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/68667ad97ad8bdea38012f13.html'>http://hi.baidu.com/hxzon/blog/item/68667ad97ad8bdea38012f13.html</a><div id='cnt'><div class="tit">
 sql2000安装不成功后处理方法
</div> 
<div class="date">
 2007-03-25 02:53
</div> 
<table style="table-layout: fixed"> 
 <tbody> 
  <tr> 
   <td> 
    <div class="cnt">
     1、先停止服务，退出，再到控制面板正常卸载；
     <br /> 
     <br /> 2、删除安装路径下的所有目录文件夹，包括注册表，如果担心删除不到位，可以用查找命令，将所有*SQL*的逐一查出，然后再一一确认删除；（如果安装SQL时，不是按默认路径安装，除了删除安装路径下的所有目录文件夹外，主系统盘里的程序组里的相应文件夹也要删除）
     <br /> 
     <br /> 3、删除的时候还应考虑到C:\Program Files\Common Files\Microsoft Shared\web server extensions\40\bin\FPMMC.MSC;
     <br /> 
     <br /> 4、管理工具中，将SQLSERVERAGENT服务停止服务；此服务程序存放在D:\Program Files\Microsoft SQL Server\MSSQL\Binn\sqlagent.exe -i MSSQLSERVER
     <br /> 
     <br /> 5、将C:\WINDOWS目录下的sql.mif、sqlsp.log、sqlstp.log、sqlsrv32.rll、 sqlwid.dll、sqlwoa.dll、dbmsqlgc.dll、SQLSRV32.dll、sqlclnt.rsp、 sqlunirl.dll、SQLSERVR.EXE-18F260D8.pf、SQLMANGR.EXE-0150BA62.pf等清除；（偶机器 SQL是打过SP4的）
     <br /> 
     <br /> 6、删除时还应将C:\Program Files\Common Files\Microsoft Shared\SQL Debugging\sqldbreg2.exe,sqldbreg.exe
     <br /> ,sqldbg.dll也清除掉；
     <br /> 
     <br /> 7、如果安装不成功，记得要将C:\WINDOWS\Temp\SQLSETUP\BIN\SCM.EXE一并清除；
     <br /> 
     <br /> 8、卸载干净后，如果怕再次安装出错，那就建议按默认路径安装；
     <br /> 
     <br /> 9、SQL在安装过程中如果出错，系统会锁定文件，当然，卸载程序也会，但可以通过修改注册表，就不用重新启动，再尝试安装了。（建议装完SQL后还是重新启动一下机器，就避免修改注册表了）
     <br /> 避免重启，注册表修改：（1）运行REGEDIT；（2）注册表中选择HKEY_LOCAL_MACHINE\SYSTEM\ CurrentControlSet\Control\Session Manager，将光标定位于此；（3）选择文件-&gt;导出，再次保存（安全起见）；（4）在右边窗中右击PendingFile Rename Operations，选择删除，最后确认；
     <br /> 
     <br /> 10、如果安装不成功，还可以通过C:\WINDOWS\sqlstp.log查看安装不成功的原因，这个是最利于解决问题的了；
     <br /> 
     <br /> 11、同时需要将C:\Documents and Settings\XXX\Local Settings\Temp\所有关于*SQL*.*全部清除；例如将sqlsp.out，SQLSERVR.DBD， sqlmangr.exe.mdmp，sqlmangr.exe.hdmp清除即可。
    </div> </td> 
  </tr> 
 </tbody> 
</table></div></body></html>