<html><head><title><div class="tit">
  sql2000安装失败的解决方法
</div></title></head><body><div id='tit'>sql2000安装失败的解决方法</div><div id='cate'>动手</div><div id='date'>2007年11月23日 星期五 12:58 P.M.</div><div id='page'>204</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/49a85cafcadcf7f8faed50e5.html'>http://hi.baidu.com/hxzon/blog/item/49a85cafcadcf7f8faed50e5.html</a><div id='cnt'><div>
 sql2000安装失败的解决方法
 <br /> 2007-03-25 02:55
 <br /> 安装sql的时候，如果出现以前有挂起的文件。或者安装后期出配置服务器失败。那么可以通过如下方法解决。
 <br /> 1.找到下面的注册表项目删除之（注意。一定要先对注册表进行一个备份）
 <br /> HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Setup\ExceptionComponents
 <br /> HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft SQL Server 2000
 <br /> HLM\SYSTEM\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations
 <br /> //可以用下面命令在cmd或者建立bat文件进行删除
 <br /> delsqlinfo.bat
 <br /> reg delete HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Setup\ExceptionComponents
 <br /> reg delete HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Microsoft SQL Server 2000
 <br /> reg delete HLM\SYSTEM\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations
 <br /> 2.删除c：\program files\microsoft sql server 2000 整个目录
 <br /> 3.重新启动电脑。
 <br /> 4.在次安装就可以成功拉。 该方法已经经过n次实践拉。
 <br /> 二、 
 <br /> 1。将Program files下的SQL安装目录删除（此处如果有重要的数据，请先备份）
</div> 
<div> 
</div> 
<div>
 C:\Program Files\Microsoft SQL Server\80\Tools。 
 <br /> C:\Program Files\Microsoft SQL Server\MSSQL。
</div> 
<div> 
</div> 
<div>
 2。注册表中的相关信息删除：
</div> 
<div> 
</div> 
<div>
 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer。 
 <br /> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\MSDTC。
</div> 
<div> 
</div> 
<div>
 3。HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager中找到PendingFileRenameOperations项目，并删除它。这样就可以清除安装暂挂项目
</div> 
<div> 
</div> 
<div>
 4。HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\setup
 <br /> 删除ExceptionComponents
</div> 
<div> 
</div> 
<div>
 &nbsp;&nbsp;&nbsp; 这个项目下的内容可能很多，只有在上面几个办法不行的情况下，使用此方法（注意不要全部删除）
</div> 
<div> 
</div> 
<div>
 删除内容前先看下内容说明
</div> 
<div> 
</div> 
<div>
 5。Windows&nbsp;&nbsp;&nbsp; 目录中的&nbsp;&nbsp;&nbsp; Sqlstp.log&nbsp;&nbsp;&nbsp; 文件，该文件列出了安装程序所执行的操作的详细信息，并包含安装期间遇到的所有错误。通过检查该文件，可以详细了解安装在什么地方失败、为什么失败。&nbsp;&nbsp;
</div> 
<div> 
</div> 
<div>
 <br /> 6。SQL安装的时的错误信息保存在一个叫Errorlog的日志文件中，默认情况下该文件位于&nbsp;&nbsp;&nbsp; Program&nbsp;&nbsp;&nbsp; Files\Microsoft&nbsp;&nbsp;&nbsp; SQL&nbsp;&nbsp;&nbsp; Server\Mssql\Log&nbsp;&nbsp;&nbsp; 目录中。该错误日志包含安装程序试图启动&nbsp;&nbsp;&nbsp; SQL&nbsp;&nbsp;&nbsp; Server&nbsp;&nbsp;&nbsp; 时&nbsp;&nbsp;&nbsp; SQL&nbsp;&nbsp;&nbsp; Server&nbsp;&nbsp;&nbsp; 所遇到的错误，这些信息可以帮助您深入检查错误原因。
</div> 
<div> 
</div> 
<div>
 <br /> 7。需要检查的另一个组件是&nbsp;&nbsp;&nbsp; Microsoft&nbsp;&nbsp;&nbsp; 数据访问组件&nbsp;&nbsp;&nbsp; (MDAC)&nbsp;&nbsp;&nbsp; 安装程序，它作为&nbsp;&nbsp;&nbsp; SQL&nbsp;&nbsp;&nbsp; Server&nbsp;&nbsp;&nbsp; 2000&nbsp;&nbsp;&nbsp; 安装程序的一部分启动。SQL Server 2000 安装程序会安装 MDAC 2.6。 MDAC 安装程序会创建名为 Dasetup.log&nbsp;&nbsp;&nbsp; 的单独的日志文件；您可以查看此日志文件并确保&nbsp;&nbsp;&nbsp; MDAC&nbsp;&nbsp;&nbsp; 安装程序没有出现问题。
 <br /> 
</div></div></body></html>