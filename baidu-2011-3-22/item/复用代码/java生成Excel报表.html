<html><head><title><div class="tit">
  java生成Excel报表
</div></title></head><body><div id='tit'>java生成Excel报表</div><div id='cate'>复用代码</div><div id='date'>2007年12月21日 星期五 03:55 P.M.</div><div id='page'>187</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/ecd5982f49d82b3c1e30891b.html'>http://hi.baidu.com/hxzon/blog/item/ecd5982f49d82b3c1e30891b.html</a><div id='cnt'><div class="tit">
 java生成Excel报表
</div> 
<div class="date"> 
</div> 
<table style="table-layout: fixed"> 
 <tbody> 
  <tr> 
   <td> 
    <div class="cnt"> 
     <div style="border-right: rgb(204,204,204) 1px solid; padding-right: 5px; border-top: rgb(204,204,204) 1px solid; padding-left: 4px; font-size: 13px; padding-bottom: 4px; border-left: rgb(204,204,204) 1px solid; width: 98%; padding-top: 4px; border-bottom: rgb(204,204,204) 1px solid; background-color: rgb(238,238,238)">
      <span style="color: rgb(0,0,255)">package</span> 
      <span style="color: rgb(0,0,0)">org.eagle.jexcel;<br /> <br /> </span>
      <span style="color: rgb(0,0,255)">import</span> 
      <span style="color: rgb(0,0,0)">jxl.</span> 
      <span style="color: rgb(0,0,0)">*</span> 
      <span style="color: rgb(0,0,0)">;<br /> </span>
      <span style="color: rgb(0,0,255)">import</span> 
      <span style="color: rgb(0,0,0)">jxl.format.UnderlineStyle;<br /> </span>
      <span style="color: rgb(0,0,255)">import</span> 
      <span style="color: rgb(0,0,0)">jxl.write.</span> 
      <span style="color: rgb(0,0,0)">*</span> 
      <span style="color: rgb(0,0,0)">;<br /> </span>
      <span style="color: rgb(0,0,255)">import</span> 
      <span style="color: rgb(0,0,0)">jxl.write.Number;<br /> </span>
      <span style="color: rgb(0,0,255)">import</span> 
      <span style="color: rgb(0,0,0)">jxl.write.Boolean;<br /> </span>
      <span style="color: rgb(0,0,255)">import</span> 
      <span style="color: rgb(0,0,0)">java.io.</span> 
      <span style="color: rgb(0,0,0)">*</span> 
      <span style="color: rgb(0,0,0)">;<br /> <br /> </span>
      <span style="color: rgb(0,128,0)">/**</span> 
      <span style="color: rgb(0,128,0)"><br /> * <br /> * &lt;p&gt;<br /> * Title:<br /> * &lt;/p&gt;<br /> * <br /> * &lt;p&gt;<br /> * Description:<br /> * &lt;/p&gt;<br /> * <br /> * &lt;p&gt;<br /> * Copyright: Copyright (c) 2006<br /> * &lt;/p&gt;<br /> * <br /> * &lt;p&gt;<br /> * Company:<br /> * &lt;/p&gt;<br /> * <br /> * </span>
      <span style="color: rgb(128,128,128)">@author</span> 
      <span style="color: rgb(0,128,0)">eagle<br /> * </span>
      <span style="color: rgb(128,128,128)">@version</span> 
      <span style="color: rgb(0,128,0)">1.0<br /> </span>
      <span style="color: rgb(0,128,0)">*/</span> 
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,255)">public</span> 
      <span style="color: rgb(0,0,255)">class</span> 
      <span style="color: rgb(0,0,0)">JexcelHandle {<br /> &nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,0,255)">public</span> 
      <span style="color: rgb(0,0,0)">JexcelHandle() {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> <br /> &nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,0,255)">public</span> 
      <span style="color: rgb(0,0,255)">static</span> 
      <span style="color: rgb(0,0,255)">void</span> 
      <span style="color: rgb(0,0,0)">writeExcel(OutputStream os) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,0,255)">try</span> 
      <span style="color: rgb(0,0,0)">{<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableWorkbook wwb </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">Workbook.createWorkbook(os);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">创建excel工作表 镇定名称和位置</span> 
      <span style="color: rgb(0,128,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableSheet ws </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">wwb.createSheet(</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">card sheet </span>
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">1.添加Label对象</span> 
      <span style="color: rgb(0,128,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Label label </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,255)">new</span> 
      <span style="color: rgb(0,0,0)">Label(</span> 
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">编号</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(label);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Label label2 </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,255)">new</span> 
      <span style="color: rgb(0,0,0)">Label(</span> 
      <span style="color: rgb(0,0,0)">1</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">冲值卡号</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(label2);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Label label3 </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,255)">new</span> 
      <span style="color: rgb(0,0,0)">Label(</span> 
      <span style="color: rgb(0,0,0)">2</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">冲值卡密码</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(label3);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Label label4 </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,255)">new</span> 
      <span style="color: rgb(0,0,0)">Label(</span> 
      <span style="color: rgb(0,0,0)">3</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">最晚冲值时间</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(label4);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Label label5 </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,255)">new</span> 
      <span style="color: rgb(0,0,0)">Label(</span> 
      <span style="color: rgb(0,0,0)">4</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">冲值的面值（TC）（1RMB=100TC）</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(label5);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Label label6 </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,255)">new</span> 
      <span style="color: rgb(0,0,0)">Label(</span> 
      <span style="color: rgb(0,0,0)">5</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">是否作废</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(label6);<br /> <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Number labelN </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,255)">new</span> 
      <span style="color: rgb(0,0,0)">Number(</span> 
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">1</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">3.1415926</span> 
      <span style="color: rgb(0,0,0)">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(labelN);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">通过 记录集的方式可以得到数据库中的相关的记录<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">WritableFont wf = new WritableFont(WritableFont.TIMES, 18,<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">WritableFont.BOLD, true);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">WritableCellFormat wcf = new WritableCellFormat(wf);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">Label labelcf = new Label(1, 0, &quot;this is a label test&quot;, wcf);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">ws.addCell(labelcf);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">2.添加Number对象<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">Number labelN = new Number(0,1,3.1415926);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">ws.addCell(labelN);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)"><br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">添加带有formatting的Number对象<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">NumberFormat nf = new NumberFormat(&quot;#.##&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">WritableCellFormat wcfN = new WritableCellFormat(nf);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">Number labelNF = new jxl.write.Number(1,1,3.1415926,wcfN);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">ws.addCell(labelNF);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)"><br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">3.添加Boolean对象<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">Boolean labelB = new jxl.write.Boolean(0,2,false);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">ws.addCell(labelB);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)"><br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">4.添加DateTime对象<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">jxl.write.DateTime labelDT = new jxl.write.DateTime(0,3,new<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">java.util.Date());<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">ws.addCell(labelDT);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)"><br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">添加带有formatting的DateFormat对象<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">DateFormat df = new DateFormat(&quot;dd MM yyyy hh:mm:ss&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">WritableCellFormat wcfDF = new WritableCellFormat(df);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">DateTime labelDTF = new DateTime(1,3,new java.util.Date(),wcfDF);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">ws.addCell(labelDTF);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)"><br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">添加图片对象,jxl只支持png格式图片<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">File image = new File(&quot;f:\\x.png&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">WritableImage wimage = new<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">WritableImage(0,1,2,2,image);</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">0,1分别代表x,y.2,2代表宽和高占的单元格数<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">ws.addImage(wimage);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">写入工作表</span> 
      <span style="color: rgb(0,128,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wwb.write();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wwb.close();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span>
      <span style="color: rgb(0,0,255)">catch</span> 
      <span style="color: rgb(0,0,0)">(Exception e) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(</span> 
      <span style="color: rgb(0,0,0)">&quot;&quot;</span> 
      <span style="color: rgb(0,0,0)">+</span> 
      <span style="color: rgb(0,0,0)">e);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> <br /> <br /> <br /> &nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,0,255)">public</span> 
      <span style="color: rgb(0,0,255)">static</span> 
      <span style="color: rgb(0,0,255)">void</span> 
      <span style="color: rgb(0,0,0)">modifyExcel(File file1, File file2) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,0,255)">try</span> 
      <span style="color: rgb(0,0,0)">{<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">先copy 在操作第二个文件修改，</span> 
      <span style="color: rgb(0,128,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Workbook rwb </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">Workbook.getWorkbook(file1);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableWorkbook wwb </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">Workbook.createWorkbook(file2, rwb);</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">copy</span> 
      <span style="color: rgb(0,128,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableSheet ws </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">wwb.getSheet(</span> 
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableCell wc </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">ws.getWritableCell(</span> 
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">);<br /> <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">判断单元格的类型,做出相应的转换</span> 
      <span style="color: rgb(0,128,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Label label </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">(Label) wc;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; label.setString(</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">1</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">);<br /> <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wwb.write();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wwb.close();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rwb.close();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span>
      <span style="color: rgb(0,0,255)">catch</span> 
      <span style="color: rgb(0,0,0)">(Exception e) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> <br /> &nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">/**</span> 
      <span style="color: rgb(0,128,0)"><br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * 读取Excel<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * </span>
      <span style="color: rgb(128,128,128)">@param</span> 
      <span style="color: rgb(0,128,0)">filePath<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">*/</span> 
      <span style="color: rgb(0,0,0)"><br /> &nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,0,255)">public</span> 
      <span style="color: rgb(0,0,255)">static</span> 
      <span style="color: rgb(0,0,255)">void</span> 
      <span style="color: rgb(0,0,0)">readExcel(String filePath) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,0,255)">try</span> 
      <span style="color: rgb(0,0,0)">{<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InputStream is </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,255)">new</span> 
      <span style="color: rgb(0,0,0)">FileInputStream(filePath);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Workbook rwb </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">Workbook.getWorkbook(is);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">Sheet st = rwb.getSheet(&quot;0&quot;)这里有两种方法获取sheet表,1为名字，而为下标，从0开始</span> 
      <span style="color: rgb(0,128,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sheet st </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">rwb.getSheet(</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">original</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Cell c00 </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">st.getCell(</span> 
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">, </span>
      <span style="color: rgb(0,0,0)">0</span> 
      <span style="color: rgb(0,0,0)">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">通用的获取cell值的方式,返回字符串</span> 
      <span style="color: rgb(0,128,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String strc00 </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">c00.getContents();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">获得cell具体类型值的方式</span> 
      <span style="color: rgb(0,128,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,0,255)">if</span> 
      <span style="color: rgb(0,0,0)">(c00.getType() </span>
      <span style="color: rgb(0,0,0)">==</span> 
      <span style="color: rgb(0,0,0)">CellType.LABEL) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LabelCell labelc00 </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">(LabelCell) c00;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strc00 </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,0)">labelc00.getString();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">输出</span> 
      <span style="color: rgb(0,128,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(strc00);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,128,0)">//</span> 
      <span style="color: rgb(0,128,0)">关闭</span> 
      <span style="color: rgb(0,128,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rwb.close();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span>
      <span style="color: rgb(0,0,255)">catch</span> 
      <span style="color: rgb(0,0,0)">(Exception e) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> <br /> &nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,0,255)">public</span> 
      <span style="color: rgb(0,0,255)">static</span> 
      <span style="color: rgb(0,0,255)">void</span> 
      <span style="color: rgb(0,0,0)">main(String args[]) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,0,255)">try</span> 
      <span style="color: rgb(0,0,0)">{<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File fileWrite </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,255)">new</span> 
      <span style="color: rgb(0,0,0)">File(</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">f:/cardWrite.xls</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fileWrite.createNewFile();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OutputStream os </span>
      <span style="color: rgb(0,0,0)">=</span> 
      <span style="color: rgb(0,0,255)">new</span> 
      <span style="color: rgb(0,0,0)">FileOutputStream(fileWrite);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JexcelHandle.writeExcel(os);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JexcelHandle.modifyExcel(</span> 
      <span style="color: rgb(0,0,255)">new</span> 
      <span style="color: rgb(0,0,0)">File(</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">f:/cardWrite.xls</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">), </span>
      <span style="color: rgb(0,0,255)">new</span> 
      <span style="color: rgb(0,0,0)">File(<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">f:/cardWrite2.xls</span> 
      <span style="color: rgb(0,0,0)">&quot;</span> 
      <span style="color: rgb(0,0,0)">));<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span>
      <span style="color: rgb(0,0,255)">catch</span> 
      <span style="color: rgb(0,0,0)">(Exception e) {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(e);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> <br /> }<br /> </span>
     </div> 在网上看了写源码在结合自己的。不要忘了下载jxl包哟。http://www.andykhan.com/jexcelapi/ 
     <div style="border-right: rgb(204,204,204) 1px solid; padding-right: 5px; border-top: rgb(204,204,204) 1px solid; padding-left: 4px; font-size: 13px; padding-bottom: 4px; border-left: rgb(204,204,204) 1px solid; width: 98%; padding-top: 4px; border-bottom: rgb(204,204,204) 1px solid; background-color: rgb(238,238,238)">
      <span style="color: rgb(0,0,0)">&lt;%</span>
      <span style="color: rgb(0,0,0)">@ page contentType</span>
      <span style="color: rgb(0,0,0)">=</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">text/html; charset=utf-8</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)"> language</span>
      <span style="color: rgb(0,0,0)">=</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">java</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)"> </span>
      <span style="color: rgb(0,0,255)">import</span>
      <span style="color: rgb(0,0,0)">=</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">java.sql.*</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)"> errorPage</span>
      <span style="color: rgb(0,0,0)">=</span>
      <span style="color: rgb(0,0,0)">&quot;&quot;</span>
      <span style="color: rgb(0,0,0)"> </span>
      <span style="color: rgb(0,0,0)">%&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&lt;%</span>
      <span style="color: rgb(0,0,0)">@ page </span>
      <span style="color: rgb(0,0,255)">import</span>
      <span style="color: rgb(0,0,0)">=</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">org.eagle.gz.*</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">%&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&lt;%</span>
      <span style="color: rgb(0,0,0)">@ page </span>
      <span style="color: rgb(0,0,255)">import</span>
      <span style="color: rgb(0,0,0)">=</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">java.io.*</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">%&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&lt;</span>
      <span style="color: rgb(0,0,0)">html</span>
      <span style="color: rgb(0,0,0)">&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&lt;</span>
      <span style="color: rgb(0,0,0)">head</span>
      <span style="color: rgb(0,0,0)">&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&lt;</span>
      <span style="color: rgb(0,0,0)">meta http</span>
      <span style="color: rgb(0,0,0)">-</span>
      <span style="color: rgb(0,0,0)">equiv</span>
      <span style="color: rgb(0,0,0)">=</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">Content-Type</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)"> content</span>
      <span style="color: rgb(0,0,0)">=</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">text/html; charset=utf-8</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&lt;</span>
      <span style="color: rgb(0,0,0)">title</span>
      <span style="color: rgb(0,0,0)">&gt;</span>
      <span style="color: rgb(0,0,0)">无标题文档</span>
      <span style="color: rgb(0,0,0)">&lt;/</span>
      <span style="color: rgb(0,0,0)">title</span>
      <span style="color: rgb(0,0,0)">&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&lt;</span>
      <span style="color: rgb(0,0,0)">style type</span>
      <span style="color: rgb(0,0,0)">=</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">text/css</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&lt;!--</span>
      <span style="color: rgb(0,0,0)"><br /> body,td,th {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; font</span>
      <span style="color: rgb(0,0,0)">-</span>
      <span style="color: rgb(0,0,0)">size: 12px;<br /> }<br /> body {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; margin</span>
      <span style="color: rgb(0,0,0)">-</span>
      <span style="color: rgb(0,0,0)">left: 0px;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; margin</span>
      <span style="color: rgb(0,0,0)">-</span>
      <span style="color: rgb(0,0,0)">top: 0px;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; margin</span>
      <span style="color: rgb(0,0,0)">-</span>
      <span style="color: rgb(0,0,0)">right: 0px;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; margin</span>
      <span style="color: rgb(0,0,0)">-</span>
      <span style="color: rgb(0,0,0)">bottom: 0px;<br /> }<br /> </span>
      <span style="color: rgb(0,0,0)">--&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&lt;/</span>
      <span style="color: rgb(0,0,0)">style</span>
      <span style="color: rgb(0,0,0)">&gt;&lt;/</span>
      <span style="color: rgb(0,0,0)">head</span>
      <span style="color: rgb(0,0,0)">&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> <br /> </span>
      <span style="color: rgb(0,0,0)">&lt;</span>
      <span style="color: rgb(0,0,0)">body</span>
      <span style="color: rgb(0,0,0)">&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> <br /> </span>
      <span style="color: rgb(0,0,0)">&lt;%</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,255)">try</span>
      <span style="color: rgb(0,0,0)">{<br /> response.reset();</span>
      <span style="color: rgb(0,128,0)">//</span>
      <span style="color: rgb(0,128,0)">清除Buffer</span>
      <span style="color: rgb(0,128,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">response.setContentType(</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">application/vnd.ms-excel</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">);<br /> File fileWrite </span>
      <span style="color: rgb(0,0,0)">=</span>
      <span style="color: rgb(0,0,0)"> </span>
      <span style="color: rgb(0,0,255)">new</span>
      <span style="color: rgb(0,0,0)"> File(</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">f:/testWrite.xls</span>
      <span style="color: rgb(0,0,0)">&quot;</span>
      <span style="color: rgb(0,0,0)">);<br /> fileWrite.createNewFile();<br /> </span>
      <span style="color: rgb(0,0,255)">new</span>
      <span style="color: rgb(0,0,0)"> FileOutputStream(fileWrite);<br /> JexcelHandle.writeExcel(</span>
      <span style="color: rgb(0,0,255)">new</span>
      <span style="color: rgb(0,0,0)"> FileOutputStream(fileWrite));<br /> }</span>
      <span style="color: rgb(0,0,255)">catch</span>
      <span style="color: rgb(0,0,0)">(Exception e){<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(e);<br /> }<br /> </span>
      <span style="color: rgb(0,0,0)">%&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&lt;/</span>
      <span style="color: rgb(0,0,0)">body</span>
      <span style="color: rgb(0,0,0)">&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
      <span style="color: rgb(0,0,0)">&lt;/</span>
      <span style="color: rgb(0,0,0)">html</span>
      <span style="color: rgb(0,0,0)">&gt;</span>
      <span style="color: rgb(0,0,0)"><br /> </span>
     </div> 
    </div> </td> 
  </tr> 
 </tbody> 
</table> 
<br /></div></body></html>