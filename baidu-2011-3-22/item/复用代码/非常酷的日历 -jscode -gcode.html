<html><head><title><div class="tit">
  非常酷的日历 -jscode -gcode
</div></title></head><body><div id='tit'>非常酷的日历 -jscode -gcode</div><div id='cate'>复用代码</div><div id='date'>2008年10月31日 星期五 00:10 A.M.</div><div id='page'>87</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/7f258a545f35f2183b2935e9.html'>http://hi.baidu.com/hxzon/blog/item/7f258a545f35f2183b2935e9.html</a><div id='cnt'><p> </p> 
<p>非常酷的日历 -jscode -gcode</p> 
<p>放到body之间。</p> 
<p>&lt;Script LANGUAGE=&quot;JavaScript&quot;&gt;<br /> var months = new Array(&quot;一&quot;, &quot;二&quot;, &quot;三&quot;,&quot;四&quot;, &quot;五&quot;, &quot;六&quot;, &quot;七&quot;, &quot;八&quot;, &quot;九&quot;,&quot;十&quot;, &quot;十一&quot;, &quot;十二&quot;);<br /> var daysInMonth = new Array(31, 28, 31, 30, 31, 30, 31, 31,30, 31, 30, 31);<br /> var days = new Array(&quot;日&quot;,&quot;一&quot;, &quot;二&quot;, &quot;三&quot;,&quot;四&quot;, &quot;五&quot;, &quot;六&quot;);<br /> var classTemp;<br /> var today=new getToday();<br /> var year=today.year;<br /> var month=today.month;<br /> var newCal;</p> 
<p>function getDays(month, year) {<br /> if (1 == month) return ((0 == year % 4) &amp;&amp; (0 != (year % 100))) ||(0 == year % 400) ? 29 : 28;<br /> else return daysInMonth[month];<br /> }</p> 
<p>function getToday() {<br /> this.now = new Date();<br /> this.year = this.now.getFullYear();<br /> this.month = this.now.getMonth();<br /> this.day = this.now.getDate();<br /> }</p> 
<p>function Calendar() {<br /> newCal = new Date(year,month,1);<br /> today = new getToday();&nbsp;&nbsp; <br /> var day = -1;<br /> var startDay = newCal.getDay();<br /> var endDay=getDays(newCal.getMonth(), newCal.getFullYear());<br /> var daily = 0;<br /> if ((today.year == newCal.getFullYear()) &amp;&amp;(today.month == newCal.getMonth()))<br /> {<br /> &nbsp;&nbsp; day = today.day;<br /> }<br /> var caltable = document.all.caltable.tBodies.calendar;<br /> var intDaysInMonth =getDays(newCal.getMonth(), newCal.getFullYear());</p> 
<p>for (var intWeek = 0; intWeek &lt; caltable.rows.length;intWeek++)<br /> &nbsp;&nbsp; for (var intDay = 0;intDay &lt; caltable.rows[intWeek].cells.length;intDay++)<br /> &nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp; var cell = caltable.rows[intWeek].cells[intDay];<br /> &nbsp;&nbsp;&nbsp; var montemp=(newCal.getMonth()+1)&lt;10?(&quot;0&quot;+(newCal.getMonth()+1)):(newCal.getMonth()+1);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; if ((intDay == startDay) &amp;&amp; (0 == daily)){ daily = 1;}<br /> &nbsp;&nbsp;&nbsp; var daytemp=daily&lt;10?(&quot;0&quot;+daily):(daily);<br /> &nbsp;&nbsp;&nbsp; var d=&quot;&lt;&quot;+newCal.getFullYear()+&quot;-&quot;+montemp+&quot;-&quot;+daytemp+&quot;&gt;&quot;;<br /> &nbsp;&nbsp;&nbsp; if(day==daily) cell.className=&quot;DayNow&quot;;<br /> &nbsp;&nbsp;&nbsp; else if(intDay==6) cell.className = &quot;DaySat&quot;;<br /> &nbsp;&nbsp;&nbsp; else if (intDay==0) cell.className =&quot;DaySun&quot;;<br /> &nbsp;&nbsp;&nbsp; else cell.className=&quot;Day&quot;;<br /> &nbsp;&nbsp;&nbsp; if ((daily &gt; 0) &amp;&amp; (daily &lt;= intDaysInMonth))<br /> &nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp; cell.innerText = daily;<br /> &nbsp;&nbsp;&nbsp;&nbsp; daily++;<br /> &nbsp;&nbsp;&nbsp; } else<br /> &nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp; cell.className=&quot;CalendarTD&quot;;<br /> &nbsp;&nbsp;&nbsp;&nbsp; cell.innerText = &quot;&quot;;<br /> &nbsp;&nbsp;&nbsp; }<br /> }<br /> document.all.year.value=year;<br /> document.all.month.value=month+1;<br /> }</p> 
<p>function subMonth()<br /> {<br /> if ((month-1)&lt;0)<br /> {<br /> &nbsp;&nbsp; month=11;<br /> &nbsp;&nbsp; year=year-1;<br /> } else<br /> {<br /> &nbsp;&nbsp; month=month-1;<br /> }<br /> Calendar();<br /> }</p> 
<p>function addMonth()<br /> {<br /> if((month+1)&gt;11)<br /> {<br /> &nbsp;&nbsp; month=0;<br /> &nbsp;&nbsp; year=year+1;<br /> } else<br /> {<br /> &nbsp;&nbsp; month=month+1;<br /> }<br /> Calendar();<br /> }</p> 
<p>function setDate() <br /> {<br /> if (document.all.month.value&lt;1||document.all.month.value&gt;12)<br /> {<br /> &nbsp;&nbsp; alert(&quot;月的有效范围在1-12之间!&quot;);<br /> &nbsp;&nbsp; return;<br /> }<br /> year=Math.ceil(document.all.year.value);<br /> month=Math.ceil(document.all.month.value-1);<br /> Calendar();<br /> }<br /> &lt;/Script&gt;</p> 
<p>&lt;Script&gt;<br /> function buttonOver()<br /> {<br /> var obj = window.event.srcElement;<br /> obj.runtimeStyle.cssText = &quot;background-color:#FFFFFF&quot;;<br /> // obj.className=&quot;Hover&quot;;<br /> }</p> 
<p>function buttonOut()<br /> {<br /> var obj = window.event.srcElement;<br /> window.setTimeout(function(){obj.runtimeStyle.cssText = &quot;&quot;;},300);<br /> }<br /> &lt;/Script&gt;</p> 
<p>&lt;Style&gt;<br /> Input {font-family: verdana;font-size: 9pt;text-decoration: none;background-color: #FFFFFF;height: 20px;border: 1px solid #666666;color:#000000;}</p> 
<p>.Calendar {font-family: verdana;text-decoration: none;width: 170;background-color: #C0D0E8;font-size: 9pt;border:0px dotted #1C6FA5;}<br /> .CalendarTD {font-family: verdana;font-size: 7pt;color: #000000;background-color:#f6f6f6;height: 20px;width:11%;text-align: center;}</p> 
<p>.Title {font-family: verdana;font-size: 11pt;font-weight: normal;height: 24px;text-align: center;color: #333333;text-decoration: none;background-color: #A4B9D7;border-top-width: 1px;border-right-width: 1px;border-bottom-width: 1px;border-left-width: 1px;border-bottom-style:1px;border-top-color: #999999;border-right-color: #999999;border-bottom-color: #999999;border-left-color: #999999;}</p> 
<p>.Day {font-family: verdana;font-size: 7pt;color:#243F65;background-color: #E5E9F2;height: 20px;width:11%;text-align: center;}<br /> .DaySat {font-family: verdana;font-size: 7pt;color:#FF0000;text-decoration: none;background-color:#E5E9F2;text-align: center;height: 18px;width: 12%;}<br /> .DaySun {font-family: verdana;font-size: 7pt;color: #FF0000;text-decoration: none;background-color:#E5E9F2;text-align: center;height: 18px;width: 12%;}<br /> .DayNow {font-family: verdana;font-size: 7pt;font-weight: bold;color: #000000;background-color: #FFFFFF;height: 20px;text-align: center;}</p> 
<p>.DayTitle {font-family: verdana;font-size: 9pt;color: #000000;background-color: #C0D0E8;height: 20px;width:11%;text-align: center;}<br /> .DaySatTitle {font-family: verdana;font-size: 9pt;color:#FF0000;text-decoration: none;background-color:#C0D0E8;text-align: center;height: 20px;width: 12%;}<br /> .DaySunTitle {font-family: verdana;font-size: 9pt;color: #FF0000;text-decoration: none;background-color: #C0D0E8;text-align: center;height: 20px;width: 12%;}</p> 
<p>.DayButton {font-family: Webdings;font-size: 9pt;font-weight: bold;color: #243F65;cursor:hand;text-decoration: none;}</p> 
<p>&lt;/Style&gt;</p> 
<p><br /> &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;1&quot; class=&quot;Calendar&quot; id=&quot;caltable&quot;&gt;<br /> &lt;thead&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;tr align=&quot;center&quot; valign=&quot;middle&quot;&gt; <br /> &lt;td colspan=&quot;7&quot; class=&quot;Title&quot;&gt;<br /> &nbsp;&nbsp; &lt;a href=&quot;javaScript:subMonth();&quot; title=&quot;上一月&quot; Class=&quot;DayButton&quot;&gt;3&lt;/a&gt; &lt;input name=&quot;year&quot; type=&quot;text&quot; size=&quot;4&quot; maxlength=&quot;4&quot; onkeydown=&quot;if (event.keyCode==13){setDate()}&quot; onkeyup=&quot;this.value=this.value.replace(/[^0-9]/g,'')&quot; onpaste=&quot;this.value=this.value.replace(/[^0-9]/g,'')&quot;&gt; 年 &lt;input name=&quot;month&quot; type=&quot;text&quot; size=&quot;1&quot; maxlength=&quot;2&quot; onkeydown=&quot;if (event.keyCode==13){setDate()}&quot; onkeyup=&quot;this.value=this.value.replace(/[^0-9]/g,'')&quot; onpaste=&quot;this.value=this.value.replace(/[^0-9]/g,'')&quot;&gt; 月 &lt;a href=&quot;JavaScript:addMonth();&quot; title=&quot;下一月&quot; Class=&quot;DayButton&quot;&gt;4&lt;/a&gt;<br /> &lt;/td&gt;<br /> &lt;/tr&gt;<br /> &lt;tr align=&quot;center&quot; valign=&quot;middle&quot;&gt; <br /> &lt;Script LANGUAGE=&quot;JavaScript&quot;&gt; <br /> &nbsp;&nbsp; document.write(&quot;&lt;TD class=DaySunTitle id=diary &gt;&quot; + days[0] + &quot;&lt;/TD&gt;&quot;); <br /> &nbsp;&nbsp; for (var intLoop = 1; intLoop &lt; days.length-1;intLoop++) <br /> &nbsp;&nbsp;&nbsp; document.write(&quot;&lt;TD class=DayTitle id=diary&gt;&quot; + days[intLoop] + &quot;&lt;/TD&gt;&quot;); <br /> &nbsp;&nbsp;&nbsp; document.write(&quot;&lt;TD class=DaySatTitle id=diary&gt;&quot; + days[intLoop] + &quot;&lt;/TD&gt;&quot;); <br /> &lt;/Script&gt;<br /> &lt;/TR&gt; <br /> &lt;/thead&gt;<br /> &lt;TBODY border=1 cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; ID=&quot;calendar&quot; ALIGN=CENTER ONCLICK=&quot;getDiary()&quot;&gt;<br /> &lt;Script LANGUAGE=&quot;JavaScript&quot;&gt;<br /> for (var intWeeks = 0; intWeeks &lt; 6; intWeeks++)<br /> {<br /> &nbsp;&nbsp; document.write(&quot;&lt;TR style='cursor:hand'&gt;&quot;);<br /> &nbsp;&nbsp; for (var intDays = 0; intDays &lt; days.length;intDays++) document.write(&quot;&lt;TD class=CalendarTD onMouseover='buttonOver();' onMouseOut='buttonOut();'&gt;&lt;/TD&gt;&quot;);<br /> &nbsp;&nbsp; document.write(&quot;&lt;/TR&gt;&quot;);<br /> } <br /> &lt;/Script&gt;<br /> &lt;/TBODY&gt;<br /> &lt;/TABLE&gt;<br /> &lt;Script LANGUAGE=&quot;JavaScript&quot;&gt;<br /> Calendar();<br /> &lt;/Script&gt;</p></div></body></html>