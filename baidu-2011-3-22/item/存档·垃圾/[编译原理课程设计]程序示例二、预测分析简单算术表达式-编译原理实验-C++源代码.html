<html><head><title><div class="tit">
  [编译原理课程设计]程序示例二、预测分析简单算术表达式-编译原理实验-C++源代码
</div></title></head><body><div id='tit'>[编译原理课程设计]程序示例二、预测分析简单算术表达式-编译原理实验-C++源代码</div><div id='cate'>存档&middot;垃圾</div><div id='date'>2008年03月12日 星期三 04:05 P.M.</div><div id='page'>163</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/5ca0364e0a8d54ced0c86a25.html'>http://hi.baidu.com/hxzon/blog/item/5ca0364e0a8d54ced0c86a25.html</a><div id='cnt'><p>[编译原理课程设计]程序示例二、预测分析简单算术表达式-编译原理实验-C++源代码</p> 
<p>/*学生做的程序，功能简单，比较好懂。<span style="font-size: 10.5pt">通过键盘输入算数表达式，然后进行语法分析，分析过程在屏幕显示。</span><span style="font-size: 10.5pt">可以输入多个算术表达式，以字符</span><span style="font-size: 10.5pt">’#’</span><span style="font-size: 10.5pt">作为程序的结束标志。</span>*/</p> 
<p>#include &quot;stdio.h&quot;</p> 
<p>int flag=1;<br /> int ZT=1;<br /> int k=0,j=0,l=0;</p> 
<p>char Stack[10]={'\0'};<br /> char S[80]={'\0'};<br /> char T[100]={'\0'};</p> 
<p>char top,coda,tp;</p> 
<p>char bring[12][10]={&quot;error\n&quot;,&quot;E-&gt; TA\n&quot;,&quot;A-&gt; +TA\n&quot;,<br /> &quot;A-&gt; -TA\n&quot;,&quot;T-&gt; PB\n&quot;,&quot;B-&gt; *PB\n&quot;,&quot;B-&gt; /PB\n&quot;,&quot;P-&gt; c\n&quot;,<br /> &quot;P-&gt; i\n&quot;,&quot;A-&gt;empty\n&quot;,&quot;B-&gt;empty\n&quot;,&quot;\n&quot;};</p> 
<p>void Push()<br /> {<br /> &nbsp;&nbsp; Stack[k]=tp;top=tp; k++;<br /> }<br /> void Pop()<br /> {<br /> &nbsp;&nbsp; k--; Stack[k]='\0';top=Stack[k-1];<br /> }<br /> void Next()<br /> {<br /> coda=S[j];j++;<br /> }<br /> void g()<br /> {<br /> int i=0;<br /> while(S[i]!='\0'&amp;&amp;S[i]!=' ')<br /> &nbsp;&nbsp; i++;<br /> S[i]='#';<br /> }<br /> void copy(int n)<br /> {<br /> &nbsp;&nbsp; int i;<br /> &nbsp;&nbsp; for(i=0;i&lt;10;i++,l++)<br /> &nbsp;&nbsp;&nbsp; T[l]=bring[n][i];<br /> &nbsp;&nbsp; if(n==0) ZT=0;<br /> }<br /> void emptyST()<br /> {int i;<br /> for(i=0;i&lt;100;i++)<br /> &nbsp;&nbsp; {S[i]='\0';T[i]='\0';}<br /> }<br /> void display(int n)<br /> {<br /> int i;<br /> for(l=0;l&lt;k;l++) T[l]=Stack[l];<br /> while(l&lt;10) {T[l]=' ';l++;}<br /> for(i=0;i&lt;j-1;i++,l++) T[l]=' ';<br /> for(;S[i]!='\0';i++,l++)&nbsp;&nbsp; T[l]=S[i];<br /> while(l&lt;30) {T[l]=' ';l++;}<br /> copy(n);printf(&quot;%s&quot;,T);<br /> }<br /> void match(char a,char b)<br /> {<br /> &nbsp;&nbsp; if(a==b)<br /> &nbsp;&nbsp;&nbsp;&nbsp; if(a=='#'){flag=0;return;}<br /> &nbsp;&nbsp;&nbsp;&nbsp; else<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {Pop();Next();display(11);flag=1;return;}<br /> &nbsp;&nbsp; else<br /> &nbsp;&nbsp; switch(a)<br /> &nbsp;&nbsp; {case 'E':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; switch(b)<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {case 'c':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'i':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp; Pop();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tp='A';Push();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tp='T';Push();&nbsp;&nbsp;&nbsp; /* E-&gt; TA */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; display(1);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case '#':{Pop();display(11);break;}<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default:{Next();display(0);}&nbsp;&nbsp;&nbsp;&nbsp; /* error */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp; break;<br /> &nbsp;&nbsp;&nbsp; case 'A':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; switch(b)<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {case'+':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp; tp='T';Push();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tp='+';Push();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* A-&gt; +TA */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; display(2);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case '-':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp; tp='T';Push();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tp='-';Push();&nbsp;&nbsp;&nbsp; /* A-&gt; -TA */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; display(3);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case '#':{Pop();display(9);break;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /*&nbsp;&nbsp; A-&gt;empty */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default:{Next();display(0);}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /*&nbsp;&nbsp; error&nbsp;&nbsp; */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp; break;<br /> &nbsp;&nbsp;&nbsp; case 'T':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; switch(b)<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {case 'c':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'i':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp; Pop();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tp='B';Push();<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tp='P';Push();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* T-&gt; PB */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; display(4);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case '+':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case '-':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case '#': {Pop();display(0);break;} /*&nbsp;&nbsp; error&nbsp;&nbsp; */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default:{Next();display(0);}&nbsp;&nbsp; /*&nbsp;&nbsp; error&nbsp;&nbsp; */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp; break;<br /> &nbsp;&nbsp;&nbsp; case 'B':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; switch(b)<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {case '*':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp; tp='P';Push();<br /> &nbsp;&nbsp;&nbsp; tp='*';Push();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* B-&gt; *PB */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; display(5);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case '/':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp; tp='P';Push();<br /> &nbsp;&nbsp; tp='/';Push();&nbsp;&nbsp;&nbsp; /* B-&gt; /PB */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; display(6);break;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case '+':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case '-':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case '#':{Pop();display(10);break;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* B-&gt;empty */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default:{Next();display(0);}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /*&nbsp;&nbsp; error&nbsp;&nbsp; */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp; break;<br /> &nbsp;&nbsp;&nbsp; case 'P':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; switch(b)<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {case 'c':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp; Pop();<br /> &nbsp;&nbsp; tp='c';Push();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* P-&gt; c */<br /> &nbsp;&nbsp; display(7);break;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case 'i':<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp; Pop();<br /> &nbsp;&nbsp;&nbsp; tp='i';Push();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* P-&gt; i */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; display(8);break;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default:{Pop();display(0);}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* error&nbsp;&nbsp; */<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp; flag=1;return;<br /> }</p> 
<p>main()<br /> {<br /> &nbsp;&nbsp; char i='1';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int w=0;<br /> &nbsp;&nbsp; char buf[10][12]={&quot;E-&gt;TA&quot;,&quot;A-&gt;+TA&quot;,&quot;A-&gt;-TA&quot;,&quot;A-&gt;e&quot;,&quot;T-&gt;PB&quot;,&quot;B-&gt;*PB&quot;,&quot;B-&gt;/PB&quot;,&quot;B-&gt;e&quot;,&quot;P-&gt;c&quot;,&quot;P-&gt;i&quot;};<br /> &nbsp;&nbsp; printf(&quot;This Program Analysis Excepssions in the following grammer:\n&quot;);<br /> &nbsp;&nbsp; for (;w&lt;10;w++){<br /> &nbsp;&nbsp;&nbsp; printf(&quot;%s&nbsp;&nbsp;&nbsp;&nbsp; &quot;,buf[w]);<br /> &nbsp;&nbsp;&nbsp; if ((w+1)%4==0) printf(&quot;\n&quot;);<br /> &nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp; printf(&quot;E:expression, c:const, i:identifier.\n&quot;);<br /> &nbsp;&nbsp; printf(&quot;input an expression:\n&quot;);<br /> &nbsp;&nbsp; scanf(&quot;%s&quot;,S);<br /> &nbsp;&nbsp; while(S[0]!='#') {<br /> &nbsp;&nbsp; k=0;j=0;flag=1;<br /> &nbsp;&nbsp; tp='#';Push();<br /> &nbsp;&nbsp; tp='E';Push();<br /> &nbsp;&nbsp; g();<br /> &nbsp;&nbsp; Next();<br /> &nbsp;&nbsp; display(11);<br /> &nbsp;&nbsp; while(flag)<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; match(top,coda);<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp; if(ZT)<br /> &nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp; printf(&quot;Correct Excepssion!\n&quot;);<br /> &nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp; else<br /> &nbsp;&nbsp;&nbsp; {<br /> &nbsp;&nbsp;&nbsp;&nbsp; printf(&quot;Wrong Excepssion!\n&quot;);<br /> &nbsp;&nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp; emptyST(); i++;ZT=1;<br /> &nbsp;&nbsp; printf(&quot;input an expression:\n&quot;);<br /> &nbsp;&nbsp; scanf(&quot;%s&quot;,S);<br /> &nbsp;&nbsp; if(S[0]=='#')&nbsp;&nbsp;&nbsp;&nbsp; exit(0);<br /> &nbsp;&nbsp; }<br /> <br /> }</p></div></body></html>