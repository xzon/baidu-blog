<html><head><title><div class="tit">
  ASP学习笔记
</div></title></head><body><div id='tit'>ASP学习笔记</div><div id='cate'>异域</div><div id='date'>2008年03月27日 星期四 11:06 P.M.</div><div id='page'>153</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/9a972097d145d96954fb963f.html'>http://hi.baidu.com/hxzon/blog/item/9a972097d145d96954fb963f.html</a><div id='cnt'><p>ASP学习笔记</p> 
<p>1.允许使用VBscript或Javascript简易Script语言，并可在文件中结合Html； <br /> 2.无需编译，由WEBserver执行产生； <br /> 3.与任何ActiveX Script兼容； <br /> 4.ASP原始代码不会传到客户端，客户端显示的是执行结果。</p> 
<p>&lt;Form&gt;表单语法： <br /> &lt;Form name=&quot;StrName&quot; id=&quot;StrId&quot; action=&quot;&quot; method=&quot;post/get&quot;&gt;content&lt;/Form&gt;;</p> 
<p>&lt;Input&gt;类型： <br /> &lt;input type=text name=&quot;StrName&quot; value=&quot;StrValue&quot; size=&quot;num&quot; maxlength=&quot;num&quot; [disable]&gt;; <br /> &lt;input type=password name=&quot;StrName&quot; value=&quot;StrValue&quot;&gt;; <br /> &lt;input type=radio name=&quot;StrName&quot; value=&quot;StrValue&quot; [checked]&gt;; <br /> &lt;input type=checkbox name=&quot;StrName&quot; value=&quot;StrValue&quot; [checked]&gt;; <br /> &lt;INPUT type=file NAME=&quot;StrName&quot; SIZE=&quot;20&quot;&gt; <br /> &lt;input type=hidden name=&quot;StrName&quot; value=&quot;StrValue&quot;&gt; <br /> &lt;input type=&quot;submit&quot; name=&quot;StrName&quot; value=&quot;StrValue&quot;&gt; <br /> &lt;input type=&quot;reset&quot; name=&quot;StrName&quot; value=&quot;StrValue&quot;&gt; <br /> &lt;input type=&quot;button&quot; name=&quot;StrName&quot; value=&quot;StrValue&quot;&gt;</p> 
<p>&lt;select name=&quot;StrName&quot; [multiple]&gt;&lt;option value=&quot;StrValue&quot; selected&gt;text[&lt;option&gt;n]&lt;/select&gt;</p> 
<p>&lt;textarea name=&quot;StrName&quot; rows=&quot;num&quot; cols=&quot;num&quot;&gt;text&lt;/textarea&gt;</p> 
<p>&lt;frameset&gt;语法： <br /> &lt;frameset rows/cols=&quot;num,num/*..&quot;&gt;&lt;frame name=&quot;StrName&quot; src=&quot;StrSrc&quot;&gt;[&lt;frame&gt;n [&lt;frameset&gt;..&lt;/frameset&gt;]]&lt;/frameset&gt; <br /> &lt;noframe&gt;&lt;body&gt;warning!&lt;/body&gt;&lt;/noframe&gt; 无框架提示; <br /> 控制框架内容：&lt;a href=&quot;StrSrc&quot; target=&quot;StrFrameName&quot;&gt; 就可以了。 <br /> 用JavaScript: Document.frame.StrFrameName.Location=&quot;StrSrc&quot;;</p> 
<p><br /> *VBscript常用函数：</p> 
<p>1.数值型函数： <br /> abs(num): 返回绝对值 <br /> sgn(num): num&gt;0 1; num=0 0; num&lt;0 -1;判断数值正负 <br /> hex(num): 返回十六进制值 直接表示：&amp;Hxx 最大8位 <br /> oct(num): 返回八进制值 直接表示：&amp;Oxx 最大8位 <br /> sqr(num): 返回平方根 num&gt;0 <br /> int(num): 取整 int(99.8)=99; int(-99.2)=100 <br /> fix(num): 取整 fix(99.8)=99; fix(-99.2)=99 <br /> round(num,n): 四舍五入取小数位 round(3.14159,3)=3.142 中点数值四舍五入为近偶取整 round(3.25,1)=3.2 <br /> log(num): 取以e为底的对数 num&gt;0 <br /> exp(n): 取e的n次幂 通常用 num^n <br /> sin(num): 三角函数，以弧度为值计算 (角度*Pai)/180=弧度 con(num); tan(num); atn(num)</p> 
<p>2.字符串函数： <br /> len(str)：计算字符串长度 中文字符长度也计为一！ <br /> mid(str,起始字符,[读取长度])：截取字符串中间子字符串 <br /> left(str,nlen)：从左边起截取nlen长度子字符串 <br /> right(str,nlen)：从右边起截取nlen长度子字符串 <br /> Lcase(str)：字符串转成小写 <br /> Ucase(str)：字符串转成大写 <br /> trim(str)：去除字符串两端空格 <br /> Ltrim(str)：去除字符串左侧空格 <br /> Rtrim(str)：去除字符串右侧空格 <br /> replace(str,查找字符串,替代字符串,[起始字符,替代次数,比较方法])：替换字符串 <br /> 注：默认值：起始字符 1；替代次数 不限；比较方法 区分大小写（0） <br /> InStr([起始字符,]str,查找字符串[,比较方法])：检测是否包含子字符串 可选参数需同时选 返回起始位置 <br /> InStrRev(str,查找字符串[,起始字符][,比较方法])：反向检测是否包含子字符串 返回起始位置 <br /> space(n)：构造n个空格的字符串 <br /> string(n,str)：构造由n个str第一个字符组成的字符串 <br /> StrReverse(str)：反转字符串 <br /> split(str,分割字符串[,次数][,比较方法])：以分割字符串为分割标志将字符串转为字符数组 可选参数需同时选</p> 
<p>3.数据类型转换函数： <br /> Cint(str)：转换正数 True -1；False 0；日期 距离1899/12/31天数；时间 上午段 0；下午段 1； <br /> Cstr(str)：日期 输出格式 yyyy/mm/dd；时间 输出格式 Am/Pm hh:mm:ss <br /> Clng(str)：与Cin()类似 <br /> Cbool(num)：num不为零 True；反之 False <br /> Cdate(str)：转换日期格式 0：#Am 12:00:00#；正数 距离1899/12/31天数的日期；浮点数 日期＋小数时间 <br /> Cbyte(num)：num&lt;255 转换为字节 <br /> Csng(str)：转换为单精度数值 <br /> Cdbl(str)：转换为双精度数值 <br /> Ccur(str)：转换为现金格式</p> 
<p>4.时间函数： <br /> date：取系统当前日期 <br /> time：取系统当前时间 <br /> now：取系统当前时间及日期值 Datetime类型 <br /> timer：取当前时间距离零点秒值，计时器，可计算时间差 <br /> DateAdd(间隔单位,间隔值,日期)：推算相邻日期 <br /> DateDiff(间隔单位,日期一,日期二)：计算时间差 日期二-日期一 <br /> Datepart(间隔单位,日期)：计算日期的间隔单位值 <br /> Dateserial(date)：输出日期值（按序列计算） <br /> Timeserial(time)：输出时间值（按序列计算） <br /> DateValue(datetime)：取出字符串中日期值 <br /> Timevalue(datetime)：取出字符串中时间值 <br /> weekday(date)：计算星期几 <br /> MonthName(date)：输出月分名 <br /> year(datetime)：截取年份 <br /> month(datetime)：截取月份 <br /> day(datetime)：截取日 <br /> hour(datetime)：截取小时 <br /> minute(datetime)：截取分钟 <br /> second(datetime)：截取秒</p> 
<p>5.其它函数： <br /> Array(unit,..)：动态生成数组 <br /> Asc(str)：输出字符串第一个字符的ASCII码 <br /> Chr(asc)：转换ASCII为字符 Enter：Chr(13)&amp;Chr(10) <br /> Filter(数组名称,关键字符串,[,包含][,比较方法])： <br /> 将字符串数组中含有关键字符串的元素存成新的数组（默认） [包含]为false则取不包含的元素 <br /> Join(ArrayName)：将数组中元素连成字符串 <br /> Ubound(ArrayName[,维数])：取得数组相应维数的上界 <br /> Lbound(ArrayName[,维数])：取得数组相应维数的下界 一般为0 <br /> Randmize n：启动随机数种子 <br /> Rnd(n)：取得随机数，n&gt;0或为空，取序列下一随机值，n&lt;0，随机值相同，n=0，生产与上一随机值相同的数 <br /> 取介于A和B之间的随机正数C，公式：C=Int((B-A+1)*Rnd+A) 条件（B&gt;A）</p> 
<p>子程序和自定义函数 <br /> Sub StrSubName Function StrFunName(arg[1],..) <br /> 子程序体 函数体 <br /> Exit Sub 中途跳出 Exit Function 中途跳出 <br /> End Sub StrFunName＝Value 返回值 <br /> End Function <br /> [call] StrSubName 引用子程序 Var=StrFunName(arg[1],..) 引用函数 <br /> 子程序和自定义函数可以递归调用；</p> 
<p><br /> *ASP六大对象常用语句示范：</p> 
<p>Response：<br /> Response.write StrVar/&quot;String&quot;：向网页写出参数值或字符串 等同于在Html标记中嵌入&lt;%=StrVar/&quot;String&quot;%&gt; <br /> Response.End：停止页面编译，并将已经编译内容输出到浏览器<br /> Response.Buffer=True|False：页面编译时是否使用缓存的设置，一般在页面头部设置<br /> Response.Flush：强制输出页面已编译部分内容<br /> Response.Clear：将缓冲区内的数据清除<br /> Response.Redirect&nbsp;&nbsp;&nbsp;&nbsp; URL：停止页面编译或输出，转载指定所需页面<br /> Response.IsClientConnected：返回True|False，检测用户是否还处于连接状态<br /> Response.Charset(CharsetName)：设置页面编码类型，即&lt;meta&nbsp;&nbsp;&nbsp;&nbsp; http-equiv=&quot;Content-Type&quot;&nbsp;&nbsp;&nbsp;&nbsp; content=&quot;text/html;&nbsp;&nbsp;&nbsp;&nbsp; charset=gb2312&quot;&gt;<br /> Response.ContentType&nbsp;&nbsp;&nbsp;&nbsp; [=&nbsp;&nbsp;&nbsp;&nbsp; ContentType&nbsp;&nbsp;&nbsp;&nbsp; ]：设置页面文件类型，同上<br /> Response.Expires&nbsp;&nbsp;&nbsp;&nbsp; [=&nbsp;&nbsp;&nbsp;&nbsp; number]：设置页面失效时间，单位分钟<br /> Response.ExpiresAbsolute&nbsp;&nbsp;&nbsp;&nbsp; [=&nbsp;&nbsp;&nbsp;&nbsp; [date]&nbsp;&nbsp;&nbsp;&nbsp; [time]]：设置页面失效的绝对时间<br /> Response.Status&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp;&nbsp;&nbsp; StatusDescription：设置页面状态描述</p> 
<p>Request：<br /> Request(&quot;PassStrName&quot;)：读取网页传递值，包括表单及以？PassStrName＝value&amp;PassStrName_n＝value_n形式<br /> Request[.collection|property|method](variable)<br /> Request.querystring(&quot;PassStrName&quot;)：读取Get方法传递的表单值和？PassStrName＝value<br /> Request.QueryString(Varible)[(Index).Count]&nbsp;&nbsp;<br /> Request.form(&quot;PassStrName&quot;)：读取Post方法传递的纯表单域的值<br /> Request.Form(Parameter)[(Index).Count]<br /> Request.ServerVaribles(Server&nbsp;&nbsp;&nbsp;&nbsp; Environment&nbsp;&nbsp;&nbsp;&nbsp; Variable)：读取客户端系统环境变量，详见参考<br /> Request.BinaryRead(Count)：读取指定字节数的传送值<br /> Request.TotalBytes：查询体的长度，以字节为单位，只读</p> 
<p>注：同名表单如：CheckBox如有多项值，传递形式如右，StrName=value1,value2,...需要用Split函数分割各项值</p> 
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Multiple的Select表单与CheckBox类似，TextArea的值可包含换行字符，用Replace转为&lt;br&gt;，以满足格式需要</p> 
<p>Session：（用户全局变量）<br /> Session(&quot;SesName&quot;)＝value：存储Session变量值，也可读取该值&nbsp;&nbsp;<br /> Session(&quot;SesName&quot;)＝Empty：判断Session值是否存在的两种方法&nbsp;&nbsp;<br /> IsEmpty(Session(&quot;SesName&quot;))=True|False：判断Session值是否存在的两种方法<br /> Session.TimeOut=num：设置Session变量的存在时效，单位分钟<br /> Session.Abandon：清除所有Session变量值<br /> Session.SessionID：Session变量的ID序列号，只读</p> 
<p>Application：（应用程序全局变量）<br /> Application(&quot;AppName&quot;)＝value：存储Application变量值，也可读取该值&nbsp;&nbsp;<br /> Application(&quot;AppName&quot;)＝Empty：判断Application值是否存在的两种方法&nbsp;&nbsp;<br /> IsEmpty(Application(&quot;AppName&quot;))=True|False：判断Application值是否存在的两种方法&nbsp;&nbsp;<br /> Application.Lock：Application变量值锁定，防止同时更改变量值<br /> Application.UnLock：Application变量值解锁，允许更改变量值</p> 
<p>注：Session与Application变量都可以用来存储数组和系统对象，引用方法是变量名相当于数组名而已，但不能直接改变其值，需要借助临时数组修改值后，再赋给Session与Application变量</p> 
<p>Global.asa文件的结构：<br /> &lt;%&nbsp;&nbsp;&nbsp;&nbsp; @language=&quot;VBscript&quot;%&gt;<br /> &lt;%&nbsp;&nbsp;&nbsp;&nbsp; Sub&nbsp;&nbsp;&nbsp;&nbsp; Application_OnStart&nbsp;&nbsp;&nbsp;&nbsp; ...End&nbsp;&nbsp;&nbsp;&nbsp; Sub<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sub&nbsp;&nbsp;&nbsp;&nbsp; Application_OnEnd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...&nbsp;&nbsp;&nbsp;&nbsp; End&nbsp;&nbsp;&nbsp;&nbsp; Sub<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sub&nbsp;&nbsp;&nbsp;&nbsp; Session_OnStart&nbsp;&nbsp;&nbsp;&nbsp; ...End&nbsp;&nbsp;&nbsp;&nbsp; Sub<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sub&nbsp;&nbsp;&nbsp;&nbsp; Session_OnEnd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...&nbsp;&nbsp;&nbsp;&nbsp; End&nbsp;&nbsp;&nbsp;&nbsp; Sub%&gt;</p> 
<p>Server:<br /> Server.MapPath(&quot;FileUrl&quot;)：映射文件名的服务器站点绝对地址，Path=Server.MapPath(./)可以得到虚拟目录根路径<br /> Server.HtmlEncode(&quot;string&quot;)：转换为可以直接显示带Html格式的字符串，如：&lt;,&gt;等<br /> Server.URLEncode(&nbsp;&nbsp;&nbsp;&nbsp; &quot;string&quot;)：转换为浏览器地址编码<br /> set&nbsp;&nbsp;&nbsp;&nbsp; Var＝Server.CreatObject(&quot;ObjName&quot;)：创建对象变量<br /> Server.ScriptTimeout&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp;&nbsp;&nbsp;&nbsp; NumSeconds：ASP程序页面执行时限，以秒为单位</p> 
<p>Cookies:&nbsp;&nbsp;&nbsp;&nbsp; 存储在用户本机的临时变量，每个Cookie的最大字节4KB，最多可以有300个Cookie&nbsp;&nbsp;&nbsp;&nbsp; 1.2MB<br /> Response.cookies(&quot;StrCookieName&quot;)＝value：存储Cookie变量值，也可读取该值&nbsp;&nbsp;<br /> Response.cookies(&quot;StrCookieName&quot;).Expires=Date：变量有效期，以天为单位，小于当前时间立即失效<br /> Response.Cookies(Cookie[(key).Attribute])：创建cookie<br /> Request.Cookies(Cookie[(key).Attribute])：读取cookie<br /> Request.cookies(&quot;StrCookieName&quot;)＝&quot;&quot;：判断是否为空(并非未赋值所以是&quot;&quot;,若cookie根本不存在则Empty)</p> 
<p>ObjectContext:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 控制ASP的事务处理<br /> ObjectContext.OnTransactionAbort：由放弃的事务处理事件激发，在脚本完成处理后发生<br /> ObjectContext.OnTransactionCommit：由成功的事务处理事件激发，在脚本完成处理后发生<br /> ObjectContext.SetAbort：显式的放弃一次事务处理<br /> ObjectContext.SetComplete：覆盖前面任何调用ObjectContext.SetAbort方法的调用</p> 
<p>表单的Onsubmit事件：在同一页面写入 Function FormName_onsubmit()..FormName_onsubmit＝True/False..end Function， <br /> 页面会在提交前先执行语句，并根据返回值判断是否完成提交任务。</p> 
<p>*数据库连接字符串举例：</p> 
<p>Access2000： <br /> conn.Open &quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot; &amp; Server.MapPath(&quot;dbase\liuyan.mdb&quot;) <br /> conn.Open &quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot; &amp; Server.MapPath(&quot;dbase\liuyan.mdb&quot;)&amp;&quot;;Password=admin&quot; <br /> Recordset.Open &quot;数据表名&quot;, conn, 2, 2</p> 
<p>SqlServer2000： <br /> conn.Open &quot;Provider=SQLOLEDB.1;User ID=sa;Password=admin;Initial Catalog=pubs;Data Source=server\garlmrm&quot; <br /> conn.Open &quot;provider=SQLOLEDB;data source=hyserver;uid=sa;pwd=;database=pubs&quot; <br /> Recordset.Open StrSQL, conn, 2, 2</p> 
<p>Dbase：(?) <br /> conn Open &quot;Driver={Microsoft dBase Driver};SourceType=DB;SourceDB=&quot; &amp; Server.MapPath( &quot;目录名&quot; ) <br /> Recordset.Open StrSQL, conn, 2, 2</p> 
<p>FoxBase： <br /> conn Open &quot;Driver={Microsoft Visual FoxPro Driver};SourceType=DBF;SourceDB=&quot; &amp; Server.MapPath( &quot;目录名&quot; ) <br /> Recordset.Open DBF文件名或Select语句, conn, 2, 2 <br /> conn Open &quot;Driver={Microsoft Visual FoxPro Driver};SourceType=DBC;SourceDB=&quot; &amp; Server.MapPath( &quot;DBC数据库文件名&quot; ) <br /> Recordset.Open DBF文件名或Select语句, conn, 2, 2</p> 
<p>Excel： <br /> conn Open &quot;Driver={Microsoft Excel Driver (*.xls)};DBQ=&quot; &amp; Server.MapPath( &quot;XLS文件名&quot; ) <br /> Recordset.Open &quot;Select * From [&quot;&amp;sheet&amp;&quot;$]&quot;,conn,2,2</p> 
<p>注：使用DBF、DBC、Excel数据库，下面几点要注意：Excel数据库只能读取、增加记录、修改记录，但不能删除记录； <br /> DBF、DBC可以读取记录、增加记录、删除记录、修改记录，但是在增加记录时，任何一个字段值都不能为空，由此 <br /> 可看出局限性很大，所以尽可能地用MDB或SQL数据库。</p> 
<p><a href="http://hi.baidu.com/yujo/blog/category/asp.net%26%2347%3Basp">http://hi.baidu.com/yujo/blog/category/asp.net%26%2347%3Basp</a></p></div></body></html>