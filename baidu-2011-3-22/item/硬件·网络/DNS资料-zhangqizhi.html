<html><head><title><div class="tit">
  DNS资料-zhangqizhi
</div></title></head><body><div id='tit'>DNS资料-zhangqizhi</div><div id='cate'>硬件&middot;网络</div><div id='date'>2007年12月18日 星期二 01:21 A.M.</div><div id='page'>190</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/5bf89e220fd9f7f0d6cae2e2.html'>http://hi.baidu.com/hxzon/blog/item/5bf89e220fd9f7f0d6cae2e2.html</a><div id='cnt'><div> 
 <p><font size="3">DNS资料-zhangqizhi </font></p> 
 <p><font size="3">域名的管理机构全称互联网名称与数字地址分配机构（The Internet Corporation for Assigned Names and Numbers，ICANN）是一个非营利性的国际组织，负责互联网协议(IP)地址的空间分配、协议标识符的指派、通用顶级域名(gTLD)以及国家和地区顶级域名(ccTLD)系统的管理、以及根服务器系统的管理。 </font></p> 
</div> 
<div> 
</div> 
<div>
 <font size="3">目前全球共有13台域名根服务器。1个为主根服务器，放置在美国。其余12个均为辅根服务器，其中9个放置在美国、欧洲2个(位于英国和瑞典)、亚洲1个(位于日本),由互联网名字与编号分配机构ICANN统一管理。任何域名解析都要经过这13台根服务器获得顶级索引，并不是说您访问.com会经过这些服务器，访问.cn就不经过这些服务器。 </font>
</div> 
<div> 
</div> 
<div>
 <font size="3">而每一个顶级域，不管是gTLD(通用顶级域)，还是ccTLD(国别顶级域)，它们都有自己的域名服务器(即该顶级域的NS记录)，比如： </font>
</div> 
<div> 
</div> 
<div>
 <font size="3">&nbsp;&nbsp;&nbsp; .com &amp; .net 的域名服务器是：[a-m].gtld-servers.net 共13个&nbsp;&nbsp;&nbsp;&nbsp; .org 的域名服务器是：tld1.ultradns.net 等6个&nbsp;&nbsp;&nbsp;&nbsp; .biz 的域名服务器是：[a-h].gtld.biz 共8个&nbsp;&nbsp;&nbsp;&nbsp; .info 的域名服务器是：tld1.ultradns.net 等6个&nbsp;&nbsp;&nbsp;&nbsp; .cn 的域名服务器是：ns.cnc.ac.cn 等6个&nbsp;&nbsp;&nbsp;&nbsp; .jp 的域名服务器是：[a-f].dns.jp 共6个等等。 </font>
</div> 
<div> 
</div> 
<div>
 <font size="3">&nbsp;&nbsp;&nbsp; .COM .NET服务器全球也有13个，其中，美国有8个、英国、瑞典、荷兰、日本和香港各有1个。由美国Verisign公司管理。 </font>
</div> 
<div> 
</div> 
<div>
 <font size="3">近年来国内网民数增长很快,CN域名注册量也上升了很多,中国已于2003年和2004年引进了域名根服务器的F镜像服务器和J镜像服务器及顶级域名.COM .NET的镜像服务器。国内从此有了域名根服务器的镜像服务器(目前这两台域名根服务器的镜像服务器: F镜像服务器在中国电信,J镜像服务器和.COM .NET镜像服务器在中国网通)。据说镜像服务器的管理是由技术持有方来进行日常的维护和管理。有了域名根服务器的镜像服务器后,国内解析.CN域名和.COM域名就不用到国外的域名根服务器获得顶级索引了,这将从根本上提高国内网络访问速度。</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">2005年7月1日，美国政府宣布，美国商务部将无限期保留对13台域名根服务器的监控权。</font>
</div> 
<div> 
</div> 
<div>
 <font size="3"> 一位互联网资深专家解释说，美国控制了域名解析的根服务器，也就控制了相应的所有域名，如果美国不想让人访问某些域名，就可以屏蔽掉这些域名，使它们的IP地址无法解析出来，那么这些域名所指向的网站就相当于从互联网的世界中消失了。比如，2004年4月，由于“.ly”域名瘫痪，导致利比亚从互联网上消失了3天。</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">另外，凭借在域名管理上的特权，美国还可以对其他国家的网络使用情况进行监控，例如美国可以对某个国家的某类网站进行流量访问统计，从中大致分析出该国热门网站分布情况和网民的访问喜好等。</font>
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 <font size="3">每个服务器的域名为： x.root-servers.net</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">A&nbsp;&nbsp; INTERNI.NET（美国，弗吉尼亚州） 198.41.0.4 B&nbsp;&nbsp; 美国信息科学研究所（美国，加利弗尼亚） 128.9.0.107 C&nbsp;&nbsp; PSINet公司（美国，弗吉尼亚州） 192.33.4.12 D&nbsp;&nbsp; 马里兰大学（美国马里兰州） 128.8.10.90 E&nbsp;&nbsp; 美国航空航天管理局（美国加利弗尼亚州） 192.203.230.10 F&nbsp;&nbsp; 因特网软件联盟（美国加利弗尼亚州）&nbsp;&nbsp; 192.5.5.241 G 美国国防部网络信息中心（美国弗吉尼亚州） 192.112.36.4 H 美国陆军研究所（美国马里兰州） 128.63.2.53 I Autonomica公司（瑞典斯德哥尔摩） 192.36.148.17 J VerSign公司（美国弗吉尼亚州） 192.58.128.30 K RIPE NCC(英国伦敦) 192.0.14.129 L IANA（美国弗吉尼亚州） 198.32.64.12 M WIDE Project(日本东京） 202.12.27.33</font>
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">对windows DNS配置感兴趣的同学可以找一本MCSE的书看看，专门看DNS那一节，中间如果对SOA和NS不太明白，再看下述论坛上找到的讨论贴。</font>
</div> 
<div> 
</div> 
<div> 
</div> 
<div> 
</div> 
<div>
 <font size="3">请问dns中的SOA记录的作用是什么？是不是一般在辅助的dns服务器里才用到？用来指定谁是主服务器？？？ NS的作用又是什么？？？ </font>
</div> 
<div> 
</div> 
<div>
 <font size="3">網中人 回复于：2004-01-31 17:37:38 soa 是指 zone 的權威設定，若忽略其中的 5 組數字，soa 指定了權威主機的 FQDN 及 admin email 。 而那 5 組數字的前四組，則用與 master/slave 的同步機制中參考。 最後的 min ttl 則是當 recorad 沒設 ttl、且 db 也沒設 $TTL 時參考。 ns 是往下授權，也可授權給自己...</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">banner99999 回复于：2004-01-31 17:42:01 有个老师给我们讲课的时候说“soa是描述辅助服务器的。 ns是描述主服务器的。” 你说的ns授权还不是太明白。</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">網中人 回复于：2004-01-31 21:51:09 若你再見到你的老師，不妨請他告訴理論依據好讓你深入研究... 然而，教育的要旨，不在於接受而在於懷疑。 ns 授權很簡單... 假設你註冊的 domain 叫 abc.com ，而你有 ns1 與 ns2 兩台 server 。 那，你必需從 .com 的權威伺服器授權給你，其設定或類似如此： </font>
</div> 
<div> 
</div> 
<div>
 <font size="3">$ORIGIN com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">abc IN NS ns1.abc.com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">abc IN NS ns2.abc.com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">ns1.abc IN A 1.2.3.4</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">ns1.abc IN A 1.2.3.5</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">然後，你的 ns1 或 ns2 都可是權威伺服器了(各自的 SOA 設為自己即可)。 在 abc.com 的 db 中，最少還應類似如下的設定： </font>
</div> 
<div> 
</div> 
<div>
 <font size="3">$ORIGIN abc.com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">@ IN NS ns1.abc.com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">@ IN NS ns2.abc.com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">ns1 IN A 1.2.3.4</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">ns2 IN A 1.2.3.5</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">不過，既然 SOA 是自己的話，那事實上，我可以改變 ns 或增加 ns 授權： </font>
</div> 
<div> 
</div> 
<div>
 <font size="3">$ORIGIN abc.com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">@ IN NS ns1.abc.com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">@ IN NS ns2.abc.com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">@ IN NS ns3.abc.com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">ns1 IN A 1.2.3.4</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">ns2 IN A 1.2.3.5</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">ns3 IN A 1.2.3.6</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">假如你有 sub-zone 要授權，事實上也是利用 ns 啦： </font>
</div> 
<div> 
</div> 
<div>
 <font size="3">$ORIGIN abc.com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">sub1 IN NS ns1.sub1.abc.com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">sub1 IN NS ns2.sub1.abc.com.</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">ns1.sub1 IN A 4.3.2.1</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">ns2.sub1 IN A 4.3.2.2</font>
</div> 
<div> 
</div> 
<div>
 <font size="3">然而，不同版本的 resolver ，對最終的 ns 判定是不一樣的： bind9 是以 abc.com 的權威主機的 ns 為依據，若找不到，那就沒結果。 而之前的版本，則可退而求次，以 com. 裡關於 abc.com 的 ns 為答案。</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">banner99999 回复于：2004-02-01 11:23:34 谢谢这位大哥，收益非浅！</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">馨婷 回复于：2004-02-01 18:33:04 網中人大哥：你说： ns 授權很簡單...&nbsp;&nbsp; 假設你註冊的 domain 叫 abc.com ，而你有 ns1 與 ns2 兩台 server 。&nbsp;&nbsp; 那，你必需從 .com 的權威伺服器授權給你，其設定或類似如此：&nbsp;&nbsp; 代码:&nbsp;&nbsp; $ORIGIN com.&nbsp;&nbsp; abc IN NS ns1.abc.com.&nbsp;&nbsp; abc IN NS ns2.abc.com.&nbsp;&nbsp; ns1.abc IN A 1.2.3.4&nbsp;&nbsp; ns1.abc IN A 1.2.3.5&nbsp;&nbsp; 这让我想到，我们单位有一个下级单位要搭建一台域名服务器由于他们自己部门的域名解析，我当时在我的zone文件里，就给他们做了条A</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">馨婷 回复于：2004-02-01 18:34:30 记录，也没做NS记录，也没见他们反映说不行嘛，那么NS记录是不是必须的呢</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">網中人 回复于：2004-02-01 21:37:15 因為你不是授權，而是幫他們設好了 A 記錄。 這跟授權出去讓他們設是不一樣的，雖然，查詢結果一樣... 若你管 abc.com 的話， 你可以設一個這樣的 A 沒問題： hsot1.sub3.sub2.sub1.abc.com. IN A 1.2.3.4 也可先將 sub1.abc.com 授權出去， 再將 sub2.sub1.abc.com 授權出去， 再將 sub3.sub2.sub1.abc.com 授權出去，然後再設 host1 的 A ...</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">馨婷 回复于：2004-02-02 18:23:11 那我想在问一句，这不同点具体在哪儿呢？ 他们内部的CLIENT可以用他们自己的域名服务器解析啊？ 难道他们用nslookup看他们自己内部的机器，显示的是 Non-authoritative answer:吗？ 请指教</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">網中人 回复于：2004-02-03 16:14:09 不同點在--- 權威伺服器。 從查詢&quot;結果&quot;來看，沒差。 Non-authoritative answer 是指 cache 中的 answer ，別想得太複雜~~~</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">馨婷 回复于：2004-02-04 23:16:26 我知道了，我那种是属于划定了子域，但没有授权，是吧 也就是说，若我不给那个子域的DNS授权的话，那么即使它可以解析别人，那别人解析它本地主机表里的主机是解析不到的，这样说对不对啊？</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">banner99999 回复于：2004-02-05 11:34:39 为什么有的时候我直接打域名就能解析出来。&nbsp;&nbsp; 后来又做了一个dns，直接打域名就解析不出来了？？ 这是什么问题？？？</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">網中人 回复于：2004-02-05 12:26:40 1) 你的 resolver 用甚麼版本？(請留意我前面提到的版本差異) 2) 你用甚麼 program 來查？能將結果貼上來嗎？</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">banner99999 回复于：2004-02-05 12:34:57 不好意思，我用win2000做的时候出现的这种情况。 直接用的ping</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">網中人 回复于：2004-02-05 12:51:12 w2k 應可用 nslookup ， 能否設 set debug 之後，再查查看？(順便將結果貼上來...)</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">banner99999 回复于：2004-02-05 12:55:53 好的。我试试</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">banner99999 回复于：2004-02-09 18:03:24 试过了，用nslookup可以直接将域名解析出来。 用ping 就不行</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">好好先生 回复于：2004-02-09 19:50:20 引用：原帖由 &quot;banner99999&quot; 发表： 有个老师给我们讲课的时候说“soa是描述辅助服务器的。 ns是描述主服务器的。” 你说的ns授权还不是太明白。 如果你没有记错的话，你们的老师应该承担误人子第的责任了。 :em02:</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">網中人 回复于：2004-02-10 07:12:57 若 ping IP 都不行，那就不是 dns 而是 network/firewall 的問題...</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">yfhe 回复于：2004-02-10 09:57:41 现在很多的路由器和防火墙对ICMP都有过滤的，所以很多情况下ping都不行，如果是在同一个网段下的话，ping应该是没问题的 :)</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">qwerqwer34 回复于：2005-02-18 00:37:57 SOA纪录我不是很清楚，但是NS纪录的话我用最一个简单的例子说明： 假如你拥有xxx.com的域名，而负责解析这个域名的DNS服务器为ns1.zzz.com和ns2.zzz.com，那么如果你增加了一个值为news.xxx.com的NS纪录到dns.ooo.com，那么你的news.xxx.com下的一切子域名都可以由dns.ooo.com负责解析(当然ns1.zzz.com和ns2.zzz.com也可以解析)，而其他的只能由ns1.zzz.com和ns2.zzz.com解析，不能由dns.ooo.com来负责解析！ 不知道我说清楚没有！</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">archangle 回复于：2005-02-18 15:23:24 引用： 不過，既然 SOA 是自己的話，那事實上，我可以改變 ns 或增加 ns 授權：&nbsp;&nbsp; 代码:&nbsp;&nbsp; $ORIGIN abc.com.&nbsp;&nbsp; @ IN NS ns1.abc.com.&nbsp;&nbsp; @ IN NS ns2.abc.com.&nbsp;&nbsp; @ IN NS ns3.abc.com.&nbsp;&nbsp; ns1 IN A 1.2.3.4&nbsp;&nbsp; ns2 IN A 1.2.3.5&nbsp;&nbsp; ns3 IN A 1.2.3.6&nbsp;&nbsp; 那么增加的ns3在什么情况下会收到查询呢？</font>
</div> 
<div> 
</div> 
<div>
 <br /> 
 <font size="3">archangle 回复于：2005-02-18 16:05:21 是不是要在24小时后才会生效呢？<br /> </font>
</div></div></body></html>