<html><head><title><div class="tit">
  Tomcat和Websphere类加载机制
</div></title></head><body><div id='tit'>Tomcat和Websphere类加载机制</div><div id='cate'>细节</div><div id='date'>2008年03月23日 星期日 01:02 P.M.</div><div id='page'>156</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/004570099fa976ab2fddd42b.html'>http://hi.baidu.com/hxzon/blog/item/004570099fa976ab2fddd42b.html</a><div id='cnt'><div class="comTitle"> 
 <p><strong><font color="#000000">Tomcat和Websphere类加载机制</font></strong></p> 
 <p><strong><font color="#000000"> 
    <table class="FCK__ShowTableBorders" style="table-layout: fixed; word-break: break-all; word-wrap: break-word" width="100%"> 
     <tbody> 
      <tr> 
       <td> <h1><span><span style="mso-list: Ignore">1<span style="font: 7pt Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span>基本信息</span></h1> <p class="MsoNormal" style="line-height: 150%; text-align: left; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto" align="left"><strong><span style="font-size: 10pt; color: #993300; line-height: 150%; mso-ascii-: 0pt">摘要：</span></strong><span style="font-size: 10pt; mso-ascii-: 0pt">分别介绍</span><span style="font-size: 10pt; mso-hansi-: 0pt">Tomcat</span><span style="font-size: 10pt; mso-ascii-: 0pt">和</span><span style="font-size: 10pt; mso-hansi-: 0pt">Webshpher</span><span style="font-size: 10pt; mso-ascii-: 0pt">类加载机制。</span></p> <p class="MsoNormal" style="text-align: left; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto" align="left"><strong><span style="font-size: 10pt; color: #993300; mso-ascii-: 0pt">作者：</span></strong><span style="font-size: 10pt; mso-ascii-: 0pt">戴小丹</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span><span style="font-size: 10pt; mso-ascii-: 0pt">林晓咏</span></p> <h1><span><span style="mso-list: Ignore">2<span style="font: 7pt Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span>Tomcat</span><span>类加载机制</span></h1> <p class="MsoNormal" style="text-indent: 20pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-char-indent-count: 2.0"><span style="font-size: 10pt; mso-hansi-: 0pt">Tomcat Server</span><span style="font-size: 10pt; mso-ascii-: 0pt">在启动的时候将构造一个</span><span style="font-size: 10pt; mso-hansi-: 0pt">ClassLoader</span><span style="font-size: 10pt; mso-ascii-: 0pt">树，以保证模块的类库是私有的</span><span style="font-size: 10pt; mso-hansi-: 0pt"><br /> </span><span style="font-size: 10pt; mso-ascii-: 0pt">&nbsp;&nbsp;&nbsp;</span><span style="font-size: 10pt; mso-hansi-: 0pt"> Tomcat Server</span><span style="font-size: 10pt; mso-ascii-: 0pt">的</span><span style="font-size: 10pt; mso-hansi-: 0pt">ClassLoader</span><span style="font-size: 10pt; mso-ascii-: 0pt">结构图如下：</span></p> <p class="MsoNormal" style="text-indent: 20pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-char-indent-count: 2.0"><span style="font-size: 9pt; mso-font-kerning: 0pt"><img height="302" width="417" src="image/Tomcat和Websphere类加载机.1(186).jpg" /><p class="origImg">http://gocom.primeton.com/uploads/FCKUserFiles/Image/1(186).jpg</p></span></p> <p class="MsoNormal" style="text-indent: 24pt; text-align: left; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto" align="left"> </p> <p class="MsoNormal" style="mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">- Bootstrap - </span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">载入</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">JVM</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">自带的类和</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">/jre/lib/ext/*.jar<br /> - System - </span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">载入</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">/*.class<br /> - Common - </span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">载入</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">/common/...</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">，它们对</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">TOMCAT</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">和所有的</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">WEB APP</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">都可见</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt"><br /> - Catalina - </span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">载入</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">/server/...</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">，它们仅对</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">TOMCAT</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">可见，对所有的</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">WEB APP</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">都不可见</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt"><br /> - Shared - </span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">载入</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">/shared/...</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">，它们仅对所有</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">WEB APP</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">可见，对</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">TOMCAT</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">不可见（也不必见）</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt"><br /> - WebApp - </span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">载入</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">ContextBase?/WEB-INF/...</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">，它们仅对该</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">WEB APP</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">可见</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt"> </span></p> <p class="MsoNormal" style="text-indent: 21pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-char-indent-count: 2.0"><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">每个运行中的线程都有一个成员</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">contextClassLoader</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">，用来在运行时动态地载入其它类，系统默认的</span><span style="mso-font-kerning: 0pt; mso-bidi-: 10.5pt"> contextClassLoader</span><span style="mso-font-kerning: 0pt; mso-bidi-: 10.5pt">是<span>systemClassLoader</span>，所以一般而言<span>java</span>程序在执行时可以使用<span>JVM</span>自</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">带的类、</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">$ JAVA_HOME/jre/lib/ext/</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">中的类和</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">/</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">中的类，可以使用</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">Thread.currentThread(). setContextClassLoader(...);</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">更改当前线程的</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">contextClassLoader</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">，来改变其载入类的行为</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">ClassLoader</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">被组织成树形，一般的工作原理是：</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt"><br /> 1) </span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">线程需要用到某个类，于是</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">contextClassLoader</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">被请求来载入该类</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt"><br /> 2) contextClassLoader</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">请求它的父</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">ClassLoader</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">来完成该载入请求</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt"><br /> 3) </span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">如果父</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">ClassLoader</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">无法载入类，则</span><span style="mso-hansi-: 0pt; mso-bidi-font-size: 10.5pt">contextClassLoader</span><span style="mso-ascii-: 0pt; mso-bidi-font-size: 10.5pt">试图自己来载入</span></p> <h1><span><span style="mso-list: Ignore">3<span style="font: 7pt Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span>Websphere</span><span>类加载机制</span></h1> <p class="MsoNormal" style="text-indent: 21pt; text-align: left; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto" align="left"><span style="color: black; mso-bidi-: 10.5pt">Java</span><span style="color: black; mso-bidi-: 10.5pt">应用程序运行时，在<span>class</span>执行和被访问之前，它必须通过类加载器加载使之有效，类加载器是<span>JVM</span>代码的一部分，负责在<span>JVM</span>虚拟机中查找和加载所有的<span>Java </span>类和本地的<span>lib</span>库。类加载器的不同配置影响到应用程序部署到应用程序服务器上运行时的行为。<span>JVM</span>和<span>WebSphere</span>应用程序服务器提供了多种不同的类加载器配置， 形成一个具有父子关系的分层结构。</span></p> <p class="MsoNormal" style="text-indent: 21pt; text-align: left; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto" align="left"><span style="color: black; mso-bidi-: 10.5pt">WebSphere</span><span style="color: black; mso-bidi-: 10.5pt">中类加载器的层次结构图<span>1</span>所示：</span></p> <p class="MsoNormal" style="text-indent: 21pt; text-align: left; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto" align="left"><span style="font-size: 9pt; mso-font-kerning: 0pt"><img height="354" width="551" src="image/Tomcat和Websphere类加载机.1(187).jpg" /><p class="origImg">http://gocom.primeton.com/uploads/FCKUserFiles/Image/1(187).jpg</p></span></p> <p class="MsoNormal" style="text-indent: 21pt; text-align: left; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto" align="left"><span style="font-size: 10pt; color: black">如上图所示，<span>WebSphere</span>中类加载器被组织成一个自上而下的层次结构，最上层是系统的运行环境<span>JVM</span>，最下层是具体的应用程序，上下层之间形成父子关系。</span></p> 
        <ul type="disc"> 
         <li class="MsoNormal" style="color: black; line-height: 14.25pt; text-align: left; mso-list: l3 level1 lfo2; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><span style="font-size: 10pt; mso-font-kerning: 0pt">JVM Class loader</span><span style="font-size: 10pt; mso-ascii-: 0pt">：位于整个层次结构的最上层，它是整个类加载器层次结构的根，因此它没有父类加载器。这个类加载器负责加载</span><span style="font-size: 10pt; mso-font-kerning: 0pt">JVM</span><span style="font-size: 10pt; mso-ascii-: 0pt">类，</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> JVM </span><span style="font-size: 10pt; mso-ascii-: 0pt">扩展类，以及定义在</span><span style="font-size: 10pt; mso-font-kerning: 0pt">classpath </span><span style="font-size: 10pt; mso-ascii-: 0pt">环境变量上的所有的</span><span style="font-size: 10pt; mso-font-kerning: 0pt">Java</span><span style="font-size: 10pt; mso-ascii-: 0pt">类。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span></li> 
         <li class="MsoNormal" style="color: black; line-height: 14.25pt; text-align: left; mso-list: l3 level1 lfo2; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><span style="font-size: 10pt; mso-font-kerning: 0pt">WebSphere Extensions Class loader</span><span style="font-size: 10pt; mso-ascii-: 0pt">：</span><span style="font-size: 10pt; mso-font-kerning: 0pt">WebSphere </span><span style="font-size: 10pt; mso-ascii-: 0pt">扩展类加载器</span><span style="font-size: 10pt; mso-font-kerning: 0pt">, </span><span style="font-size: 10pt; mso-ascii-: 0pt">它将加载</span><span style="font-size: 10pt; mso-font-kerning: 0pt">WebSphere</span><span style="font-size: 10pt; mso-ascii-: 0pt">的一些</span><span style="font-size: 10pt; mso-font-kerning: 0pt">runtime </span><span style="font-size: 10pt; mso-ascii-: 0pt">类，资源适配器类等。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span></li> 
         <li class="MsoNormal" style="color: black; line-height: 14.25pt; text-align: left; mso-list: l3 level1 lfo2; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><span style="font-size: 10pt; mso-font-kerning: 0pt">WebSphere lib/app Class loader</span><span style="font-size: 10pt; mso-ascii-: 0pt">：</span><span style="font-size: 10pt; mso-font-kerning: 0pt">WebSphere</span><span style="font-size: 10pt; mso-ascii-: 0pt">服务器类加载器，它将加载</span><span style="font-size: 10pt; mso-font-kerning: 0pt">WebSphere</span><span style="font-size: 10pt; mso-ascii-: 0pt">安装目录下</span><span style="font-size: 10pt; mso-font-kerning: 0pt">$(WAS_HOME)/lib/app</span><span style="font-size: 10pt; mso-ascii-: 0pt">路径上的类。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span><span style="font-size: 10pt; mso-ascii-: 0pt">在</span><span style="font-size: 10pt; mso-font-kerning: 0pt">WAS v4</span><span style="font-size: 10pt; mso-ascii-: 0pt">版本中，</span><span style="font-size: 10pt; mso-font-kerning: 0pt">WAS</span><span style="font-size: 10pt; mso-ascii-: 0pt">使用这个路径在所有的应用程序之间共享</span><span style="font-size: 10pt; mso-font-kerning: 0pt">jar</span><span style="font-size: 10pt; mso-ascii-: 0pt">包。从</span><span style="font-size: 10pt; mso-font-kerning: 0pt">WAS v5</span><span style="font-size: 10pt; mso-ascii-: 0pt">开始，</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span><span style="font-size: 10pt; mso-ascii-: 0pt">共享库功能提供了一种更好的方式，因此，这个类加载器主要用于一些原有的系统的兼容。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span></li> 
         <li class="MsoNormal" style="color: black; line-height: 14.25pt; text-align: left; mso-list: l3 level1 lfo2; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><span style="font-size: 10pt; mso-font-kerning: 0pt">WebSphere &quot;server&quot; Class loader</span><span style="font-size: 10pt; mso-ascii-: 0pt">：</span><span style="font-size: 10pt; mso-font-kerning: 0pt">WebSphere</span><span style="font-size: 10pt; mso-ascii-: 0pt">应用服务器类加载器。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span><span style="font-size: 10pt; mso-ascii-: 0pt">它定义在这个服务器上的所有的应用程序之间共享的类。</span><span style="font-size: 10pt; mso-font-kerning: 0pt">WAS v5</span><span style="font-size: 10pt; mso-ascii-: 0pt">中有了共享库的概念之后，可以为应用服务器定义多个与共享库相关联的类加载器，他们按照定义的先后顺序形成父子关系。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span></li> 
         <li class="MsoNormal" style="color: black; line-height: 14.25pt; text-align: left; mso-list: l3 level1 lfo2; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><span style="font-size: 10pt; mso-font-kerning: 0pt">Application Module Class Loader</span><span style="font-size: 10pt; mso-ascii-: 0pt">：应用程序类加载器，位于层次结构的最后一层，用于加载</span><span style="font-size: 10pt; mso-font-kerning: 0pt">J2EE</span><span style="font-size: 10pt; mso-ascii-: 0pt">应用程序。根据应用程序的类加载策略的不同，还可以为</span><span style="font-size: 10pt; mso-font-kerning: 0pt">Web</span><span style="font-size: 10pt; mso-ascii-: 0pt">模块定义自己的类加载器。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span></li> 
        </ul> <p class="MsoNormal" style="line-height: 14.25pt; text-align: left; mso-pagination: widow-orphan" align="left"><span style="font-size: 10pt; color: black; mso-font-kerning: 0pt">关于<span>WebSphere</span>的类加载器的层次结构，以下的几点说明可能更有助于进一步的理解类的查找和加载过程：</span></p> 
        <ul type="disc"> 
         <li class="MsoNormal" style="color: black; line-height: 14.25pt; text-align: left; mso-list: l7 level1 lfo3; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><span style="font-size: 10pt; mso-ascii-: 0pt">每个类加载器负责在自身定义的类路径上进行查找和加载类。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span></li> 
         <li class="MsoNormal" style="color: black; line-height: 14.25pt; text-align: left; mso-list: l7 level1 lfo3; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><span style="font-size: 10pt; mso-ascii-: 0pt">一个子类加载器能够委托它的父类加载器查找和加载类，一个加载类的请求会从子类加载器发送到父类加载器，但是从来不会从父类加载器发送到子类加载器。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span></li> 
         <li class="MsoNormal" style="color: black; line-height: 14.25pt; text-align: left; mso-list: l7 level1 lfo3; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><span style="font-size: 10pt; mso-ascii-: 0pt">一旦一个类被成功加载，</span><span style="font-size: 10pt; mso-font-kerning: 0pt">JVM </span><span style="font-size: 10pt; mso-ascii-: 0pt">会缓存这个类直至其生命周期结束，并把它和相应的类加载器关联在一起，这意味着不同的类加载器可以加载相同名字的类。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span></li> 
         <li class="MsoNormal" style="color: black; line-height: 14.25pt; text-align: left; mso-list: l7 level1 lfo3; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><span style="font-size: 10pt; mso-ascii-: 0pt">如果一个加载的类依赖于另一个或一些类，那么这些被依赖的类必须存在于这个类的类加载器查找路径上，或者父类加载器查找路径上。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span></li> 
        </ul> <p class="MsoNormal" style="text-align: left; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto" align="left"><span style="font-size: 10pt; color: black; mso-ascii-: 0pt">如果一个类加载器以及它所有的父类加载器都无法找到所需的类，系统就会抛出</span><span style="font-size: 10pt; color: black; mso-font-kerning: 0pt">ClassNotFoundExecption</span><span style="font-size: 10pt; color: black; mso-ascii-: 0pt">异常或者</span><span style="font-size: 10pt; color: black; mso-font-kerning: 0pt">NoClassDefFoundError</span><span style="font-size: 10pt; color: black; mso-ascii-: 0pt">的错误。</span></p> <p class="MsoNormal" style="line-height: 14.25pt; text-align: left; mso-pagination: widow-orphan" align="left"><span style="color: black; mso-font-kerning: 0pt; mso-bidi-font-size: 10.5pt"><strong><font face="Arial"> 类加载器的委托模式</font></strong></span></p> <p class="MsoNormal" style="line-height: 14.25pt; text-align: left; mso-pagination: widow-orphan" align="left"><span style="font-size: 10pt; color: black; mso-font-kerning: 0pt">类加载器有一个重要的属性：委托模式（<span>Delegation Mode</span>，有时也称为加载方式：<span>Classloader mode</span>）。委托模式决定了类加载器在查找一个类的时候，是先查找类加载器自身指定的类路径还是先查找父类加载器上的类路径。</span></p> <p class="MsoNormal" style="line-height: 14.25pt; text-align: left; mso-pagination: widow-orphan" align="left"><span style="font-size: 10pt; color: black; mso-font-kerning: 0pt">类加载器的委托模式有两个取值：</span></p> 
        <ul type="disc"> 
         <li class="MsoNormal" style="color: black; line-height: 14.25pt; text-align: left; mso-list: l2 level1 lfo4; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><span style="font-size: 10pt; mso-font-kerning: 0pt">Parent_First</span><span style="font-size: 10pt; mso-ascii-: 0pt">：在加载类的时候，在从类加载器自身的类路径上查找加载类之前，首先尝试在父类加载器的类路径上查找和加载类。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span></li> 
         <li class="MsoNormal" style="color: black; line-height: 14.25pt; text-align: left; mso-list: l2 level1 lfo4; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto"><span style="font-size: 10pt; mso-font-kerning: 0pt">Parent_Last</span><span style="font-size: 10pt; mso-ascii-: 0pt">：在加载类的时候，首先尝试从自己的类路径上查找加载类，在找不到的情况下，再尝试父类加载器类路径。</span><span style="font-size: 10pt; mso-font-kerning: 0pt"> </span></li> 
        </ul> <p class="MsoNormal" style="line-height: 14.25pt; text-align: left; mso-pagination: widow-orphan" align="left"><span style="font-size: 10pt; color: black; mso-font-kerning: 0pt">有了委托模式的概念，我们可以更加灵活的配置在类加载器的层次结构中类的加载和查找方式。表<span>1</span>中给出了在<span>WebSphere</span>的类加载器层次结构中各个类加载器的委托模式的定义，并给出了不同的类加载器内类的生命周期。</span></p> <p class="MsoNormal" style="line-height: 14.25pt; text-align: left; mso-pagination: widow-orphan" align="left"><span style="font-size: 10pt; color: black; mso-font-kerning: 0pt"><img height="297" width="561" src="image/Tomcat和Websphere类加载机.1(189).jpg" /><p class="origImg">http://gocom.primeton.com/uploads/FCKUserFiles/Image/1(189).jpg</p></span></p> <p class="MsoNormal" style="line-height: 14.25pt; text-align: left; mso-pagination: widow-orphan" align="left"><span style="font-size: 10pt; color: black; mso-font-kerning: 0pt">注意：在上表中，<span>&quot;JVM Class loader&quot; </span>因为在类加载器的最顶层，它没有父类加载器，因此其委托模式为<span>N/A</span>，<span>&quot;WebSphere Extensions Class loader&quot;</span>和<span>&quot;WebSphere lib/app Class loader&quot;</span>的委托模式固定为表中的取值，不可配置，其它的类加载器的委托模式都是可以配置的。</span></p> </td> 
      </tr> 
      <tr> 
       <td> 
        <div class="comText">
         <small><font size="1">2007/12/5 9:43</font></small>
        </div> </td> 
      </tr> 
     </tbody> 
    </table> </font></strong></p> 
</div></div></body></html>