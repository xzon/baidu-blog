<html><head><title><div class="tit">
  struts2 自定义拦截器 -hxzon
</div></title></head><body><div id='tit'>struts2 自定义拦截器 -hxzon</div><div id='cate'>默认分类</div><div id='date'>2009年03月17日 星期二 12:43 P.M.</div><div id='page'>61</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/6c2ccf17b3444e01c83d6d49.html'>http://hi.baidu.com/hxzon/blog/item/6c2ccf17b3444e01c83d6d49.html</a><div id='cnt'><p>struts2 自定义拦截器 -hxzon</p> 
<p>无实用价值。许多需要的值没有取得。</p> 
<p>配置：<br /> &lt;interceptors&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;!-- 定义权限控制拦截器 --&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;interceptor name=&quot;logger&quot; class=&quot;logger&quot; /&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;!-- 定义一个包含权限控制的拦截器栈 --&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;interceptor-stack name=&quot;mydefault&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;interceptor-ref name=&quot;defaultStack&quot; /&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp; &lt;interceptor-ref name=&quot;logger&quot; /&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;/interceptor-stack&gt;<br /> &nbsp;&nbsp; &lt;/interceptors&gt;<br /> &nbsp;&nbsp; &lt;!-- 定义默认拦截器 --&gt;<br /> &nbsp;&nbsp; &lt;default-interceptor-ref name=&quot;mydefault&quot; /&gt;<br /> <br /> 拦截器代码：<br /> package com.hxzon.wswj.web.interceptor;</p> 
<p>import com.hxzon.wswj.model.Author;<br /> import com.hxzon.wswj.model.Logger;<br /> import com.hxzon.wswj.service.LoggerService;<br /> import com.opensymphony.xwork2.ActionContext;<br /> import com.opensymphony.xwork2.ActionInvocation;<br /> import com.opensymphony.xwork2.interceptor.MethodFilterInterceptor;</p> 
<p>public class LoggerInterceptor extends MethodFilterInterceptor {<br /> private LoggerService loggerSer;<br /> private Logger logger;<br /> <br /> public void setLoggerService(LoggerService loggerSer){<br /> &nbsp;&nbsp; this.loggerSer=loggerSer;<br /> }</p> 
<p>@Override<br /> protected String doIntercept(ActionInvocation arg0) throws Exception {<br /> //&nbsp;&nbsp; System.out.println(&quot;��ʼ---------------------&quot;+arg0);<br /> //&nbsp;&nbsp; System.out.println(arg0.getResultCode());<br /> //&nbsp;&nbsp; System.out.println(arg0.invokeActionOnly());<br /> //&nbsp;&nbsp; System.out.println(arg0.invoke());<br /> &nbsp;&nbsp;<br /> &nbsp;&nbsp; arg0.invoke();<br /> &nbsp;&nbsp; return null;<br /> }<br /> // @Override<br /> // public String intercept(ActionInvocation arg0) throws Exception {<br /> //&nbsp;&nbsp; System.out.println(&quot;��ʼ---------------------&quot;+arg0);<br /> //&nbsp;&nbsp; System.out.println(arg0.getResultCode());<br /> //&nbsp;&nbsp; System.out.println(arg0.getClass());<br /> //&nbsp;&nbsp; System.out.println(arg0.getResult());<br /> //&nbsp;&nbsp; System.out.println(arg0.isExecuted());<br /> //&nbsp;&nbsp;<br /> //&nbsp;&nbsp; arg0.invoke();<br /> //&nbsp;&nbsp; System.out.println(arg0.isExecuted());<br /> //&nbsp;&nbsp; //<br /> ////&nbsp;&nbsp; logger=new Logger();<br /> ////&nbsp;&nbsp; logger.setAuthorName(user().getName());<br /> ////&nbsp;&nbsp; logger.setLogTime(new Date());<br /> ////&nbsp;&nbsp; logger.setOperation(arg0.getAction().toString());<br /> ////&nbsp;&nbsp; logger.setTargetType(&quot;post&quot;);<br /> ////&nbsp;&nbsp; logger.setTarget(&quot;&quot;);<br /> ////&nbsp;&nbsp; loggerSer.saveLogger(logger);<br /> //&nbsp;&nbsp; return null;<br /> // }<br /> private Author user(){<br /> &nbsp;&nbsp; ActionContext act = ActionContext.getContext();<br /> &nbsp;&nbsp; return (Author) act.getSession().get(&quot;user&quot;);<br /> }</p> 
<p> </p> 
<p>}</p></div></body></html>