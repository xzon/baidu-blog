<html><head><title><div class="tit">
  struts2知识总结
</div></title></head><body><div id='tit'>struts2知识总结</div><div id='cate'>默认分类</div><div id='date'>2008年10月16日 星期四 04:38 P.M.</div><div id='page'>91</div><a id='url' href='http://hi.baidu.com/hxzon/blog/item/8a9e910a3c49c61995ca6bdc.html'>http://hi.baidu.com/hxzon/blog/item/8a9e910a3c49c61995ca6bdc.html</a><div id='cnt'><p>struts2知识总结</p> 
<p><font size="2">要找工作啦，把学过的东西总结一下&middot;&middot;&middot;&middot;，希望十月是我的幸运月&middot;&middot;&middot;</font></p> 
<p><br /> <font size="2"></font><font color="#ff0000">1.</font>全局的逻辑控制器为一个过滤器，负责过滤所有的请求。该过滤器引用的API类为<br /> &nbsp;&nbsp;&nbsp;&nbsp; org.apache.struts2.<font color="#000000">disapatcher</font>.FilterDispatcher<br /> &nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp; <font color="#ff0000">2.</font>MVC:页面请求(jsp)——&gt;逻辑控制器(Filter)——&gt;业务控制器(Action)——&gt;业务逻辑组件——&gt;业务处理/DAO<br /> &nbsp;&nbsp; <br /> &nbsp;&nbsp; <font color="#ff0000">3.</font>struts2的配置文件放在classpath下。<br /> &nbsp;&nbsp; <br /> <font color="#ff0000">4.</font><font color="#ff0000">struts2的类型转换</font>：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">a.</font>继承DefaultTypeConverter，<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 覆盖父类的public Object convertValue(Map context, Object value, Class toType)方法<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">b.</font>继承StrutsTypeConverter,<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 覆盖父类的public Object convertFromString(Map context, String[] values, Class toClass)<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 该方法负责转换从页面传递过来的数据。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 覆盖父类的public String convertToString(Map context, Object o) <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 该方法负责将Action中处理好的数据转换成相应格式的字符串。<br /> &nbsp;&nbsp; <br /> &nbsp;&nbsp; 5.<font color="#ff0000">struts2的数据验证</font>：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">a.</font>使用编码方式进行验证。业务控制器Action继承ActionSupport类，重写public void validate()方法。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在该方法中进行数据验证。若Action中处理业务的方法为test，则可以编写public void validateTest()<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 方法，来对test方法的数据进行验证。（系统在进行validateTest方法后，会接着执行validate方法，然后<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 才执行相应的业务代码。）<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 若严重出错，则可以调用addFieldError或者调用addActionError方法，增加相应的错误提示信息。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000"> b.</font>使用配置xml文件进行验证。验证文件的名字为：&times;&times;&times;Action-validation.xml。验证的方式包含字段验证和非字段验证。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 其中字段验证表示对某个字段进行某些类型的验证。非字段验证表示用某个类型的验证来验证，某个字段。两种方式<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 底层实现一样，只是表现方式不同，字段验证方式比较直观。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 验证的类型有一下几种：required,requiredstring,int,date,double,expression,fieldexpression<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; email,url,visitor,conversion,stringLength,regex(正则表达式)。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 对验证类型可以指定shourt-circuit参数为true，来执行短路验证。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 如果Action中执行业务的方法为test，则可以通过编写&times;&times;&times;Action-test-validation.xml方法来对test方法的数据进行<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 验证。且执行完test方法的私有验证文件后，还会执行默认的验证文件&times;&times;&times;Action-test-validation.xml的验证。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000"> c.</font>struts2进行客户端的验证。首先需要使用struts2的标签库，且标签库的theme属性不能为simple，然后设置标签的<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; validate属性为true。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 注意：struts2的客户端验证依赖于服务器的验证配置文件。<br /> &nbsp;&nbsp; <br /> &nbsp;&nbsp; 6.<font color="#ff0000">struts2的拦截器。</font>struts2的拦截器是struts2的核心，其底层实现使用了Java的反射机制与动态代理。在struts2的配置文件中<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 为一个Action引入了一个拦截器，则配置的默认拦截器不会被调用，需要手工配置到该Action中。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 实现struts2拦截器的方法：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">a.</font>实现Interceptor接口，并实现init，destrory以及intercept方法。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">b.</font>继承AbstractInterceptor类，覆盖intercept方法。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">c.</font>继承MethodFilterInterceptor类，覆盖intercept方法。该类可以对特定的方法进行拦截。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 拦截器栈可以包含拦截器和拦截器栈。<br /> &nbsp;&nbsp; <br /> &nbsp;&nbsp; 7.<font color="#ff0000">文件的上传和下载</font>：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000"> a.</font>使用apache组织开发的commons-fileupload和commons-io包，并且按需要配置fileUpload拦截器和相应的上传参数，<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 比如上传文件的类型，上传文件的大小。多文件的上传可以使用js代码来在页面修改上传文件的列表，在Action中<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 则用三个列表分别来保存文件对象(file)，文件名(fileName)，以及文件类型(fileContentType)。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">b.</font>文件下载使用流进行读取：return ServletActionContext.getServletContext.getResourceAsStream(&quot;文件名&quot;)<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 并将Action的结果返回类设定为stream，即流。按需要配置相应的参数。<br /> &nbsp;&nbsp; <br /> &nbsp;&nbsp;<font color="#ff0000"> 8.struts2的国际化。</font>struts2国际化的底层实现用到了Java基础类库中的Locale(地区)和ResourceBundle(消息资源)两个类。<br /> &nbsp;&nbsp;&nbsp;&nbsp; struts2的国际化主要用在一下几个地方：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000"> a.jsp页面</font>:使用struts2的标签时，指定标签的key属性(对应消息资源文件中的key)。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 使用&lt;s:text name=&quot;key&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;s:param&gt;&lt;/s:param&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/s:text&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 标签取得消息资源信息。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 还可以用&lt;s:i18n name=&quot;basename&quot;&gt;&lt;/s:i18n&gt;标签来指定特定的消息资源文件。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000"> b.Action中</font>：调用getText(key)或者getText(key,args)方法取得消息资源文件中的消息资源。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">c.xml验证文件中</font>：指定message元素的key属性(对应消息资源文件中的key)。（怎么传参数？）<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">d.类型转换过程中</font>：通过查看xwork包的源代码可以找到：ge.properties文件中可以找到如下的键值对：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xwork.default.invalid.fieldvalue=Invalid field value for field &quot;{0}&quot;.<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在消息资源文件中重新指定该键值对即可。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 另外在struts.properties中设定键值对<font color="#ff0000">struts.i18n.encoding=GBK</font>，可以解决中文乱码问题。<br /> &nbsp;&nbsp; <br /> &nbsp;&nbsp; <font color="#ff0000">9.struts2的异常处理</font>。在Action中，我们的业务逻辑处理方法都对抛出异常进行了声明。具体的异常对应具体的处理结果。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在action配置中：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font size="2"></font><font color="#3366ff">&lt;action name=&quot;upload&quot; class=&quot;uploadAction&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;result name=&quot;exception&quot;&gt;&lt;/result&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;exception-mapping result=&quot;exception&quot; exception=&quot;具体的异常类型&quot;&gt;&lt;/exception-mapping&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/action&gt;</font><br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 还可以配置全局的异常处理：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font size="2"></font><font color="#3366ff">&lt;global-exception-mappings&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;exception-mapping result=&quot;&quot; exception=&quot;&quot;&gt;&lt;/exception-mapping&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/global-exception-mappings&gt;</font><br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp; <font size="2"></font><font color="#ff0000">struts2的其他东西：<br /> </font>&nbsp;&nbsp;&nbsp; <font color="#ff0000">1.</font>对于struts.xml中的package：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">a.</font>设置<font color="#ff0000">&lt;package abstract=&quot;true&quot;&gt;</font><font color="#000000">，</font>则表明该包中没有action的配置，只定义一个基础公共的组件。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000"> b.</font><font color="#ff0000">package的namespace可以将不同的请求路径分隔开</font>，在多人合作项目中用到比较多。当接收到一个请求，<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 若在当前的namespace中没有相应的请求地址，则会到默认的namespace中去寻找匹配的地址。<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; <font color="#ff0000">2.模型驱动机制(ModelDriven)</font>，将一个Action中的各个参数封装成为一个JavaBean（类似struts1.x中的<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActionForm）。需要实现ModelDriven&lt;T&gt;接口，并实现getModel方法。当一个Action实现ModenDriven接口后，<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 该Action会被ModenDrivenInterceptor拦截，进行相应的参数设置。<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;<font color="#ff0000"> 3.防止表单的重复提交</font>：在jsp的表单中设置&lt;s:token name=&quot;***&quot;&gt;&lt;/s:token&gt;标签。并且在相应的Action<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 中设置token拦截器和名为invalid.token的返回结果。相应出错信息的key为struts.message.invalid.token。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 配置该key，来实现国际化。<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; 4<font color="#ff0000">.struts2中Action与Servlet容器的耦合</font>。主要有三种方式：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">a.</font>实现ServletRequestAware或ServletResponseAware接口。并提供对request或者response熟悉的设置方法。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">b.</font>使用ActionContext（但不能获得response对象）。改方法方便单元测试。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">c.</font>使用ServletActionContext。ServletActionContext是ActionContext的子类。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 首选使用ActionContext,其次ServletActionContext。<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; 5.整合多个struts配置文件，在struts2的配置文件中使用<font color="#ff0000">include元素包含其他的配置文件</font>。用于多模块开发。<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; 6.可以在web.xml中对struts2的核心过滤器FilterDispatcher设置初始化参数（不推荐使用）。<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; 7<font color="#ff0000">.动态方法调用</font>(DynamicMethodInvocation).<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000"> a.</font>action配置中指定：&lt;action name=&quot;&times;&times;&times;&quot; method=&quot;&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000"> b.</font>在客户端即页面指定：&lt;s:form action=&quot;method!actionName&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000"> c.</font>使用通配符：&lt;action name=&quot;*Login&quot; class=&quot;com.action.LoginAction&quot; method=&quot;{1}&quot;&gt;，<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 若Action的url为helloLogin，则调用LoginAction的hello来处理业务。此种方法简化了配置，但是<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 使得程序不明了，不提倡使用该方法。<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; <font color="#ff0000">8.struts2的结果类型</font>。在struts2-core包中，有几种struts2已经配置好的结果类型。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 其中默认的类型为dispatcher，此外还有：redirectAction,chain,freemaker,httpheader,redirect,<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; redirectAction,stream,velocity,xslt,plainText。<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp;<font color="#ff0000"> 9.struts2与spring的整合</font>。导入struts2-spring-plugin包，在web.xml中设置spring的监听器,<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; spring监听器对应的API类为：org.springframework.web.context.ContextLoaderListener。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struts2-spring-plugin包为我们将struts2的对象工厂设置为spring的IoC容器，其代码为：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font size="2"></font><font color="#3366ff">&lt;struts&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;bean type=&quot;com.opensymphony.xwork2.ObjectFactory&quot; name=&quot;spring&quot; class=&quot;org.apache.struts2.spring.StrutsSpringObjectFactory&quot; /&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!-- Make the Spring object factory the automatic default --&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;constant name=&quot;struts.objectFactory&quot; value=&quot;spring&quot; /&gt;<br /> &nbsp;&nbsp;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;package name=&quot;spring-default&quot;&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;interceptors&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;interceptor name=&quot;autowiring&quot; class=&quot;com.opensymphony.xwork2.spring.interceptor.ActionAutowiringInterceptor&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;interceptor name=&quot;sessionAutowiring&quot; class=&quot;org.apache.struts2.spring.interceptor.SessionContextAutowiringInterceptor&quot;/&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/interceptors&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/package&gt;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp; &lt;/struts&gt;<br /> </font>&nbsp;&nbsp; 很明显，将struts.objectFactory定位为org.apache.struts2.spring.StrutsSpringObjectFactory<br /> &nbsp;&nbsp; 其余的工作就交给spring的IoC容器去做了。<br /> &nbsp;&nbsp; 另外：当我们需要增加spring的配置文件时，需要在web.xml中设定<font color="#ff0000">contextConfigLocation</font>参数。代码如下：<br /> &nbsp;&nbsp;&nbsp; <font size="2"></font><font color="#3366ff">&lt;context-param&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;param-value&gt;其他的spring配置文件名，用逗号隔开&lt;/param-value&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;/context-param&gt;<br /> </font>&nbsp;&nbsp;&nbsp;</p> 
<p><br /> <font size="2">&nbsp;&nbsp; </font><font size="2"></font><font color="#ff0000">需要注意的一些地方<br /> </font>&nbsp;&nbsp;&nbsp; 1.存储fieldError的是一个LinkedHashMap&lt;String,ArrayList&gt;;而actionError则存储在一个ArrayList中。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ActionSupport中的getFieldError方法返回的是一个新的集合。该集合是原fieldError集合的一个副本。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在struts2的源代码中返回的是：new LinkedHashMap(internalGetFieldError)，即一个新的集合对象。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 所以执行代码:this.getFieldErrors.put(&quot;username&quot;,&quot;ErrorMsg&quot;);不会影响原fieldError集合的数据。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; 2.若一个Action注册了PreResultListner，则会在该Action返回的时候调用相应结果验证的逻辑代码。<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; 3.struts2-core包中的default.properties和struts-default.xml文件保存了一些struts2默认的配置。<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 可以在自己的struts配置文件中对相应的配置进行覆盖或重新设值。比如修改请求的后缀名：在struts.properties<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 中加入：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struts.action.extension = do<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 则将struts2请求的后缀名修改成了struts1中的do后缀名的形式。<br /> &nbsp;&nbsp;&nbsp; <br /> &nbsp;&nbsp;&nbsp; 4.在配置文件中配置struts.multipart.saveDir来设定上传文件时的临时文件的存储位置。需要定期清理该路径下的文件。<br /> &nbsp;&nbsp;&nbsp;</p></div></body></html>