<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>OGNL学习笔记-属性（Referring to Properties）</title></head><body><h1>OGNL学习笔记-属性（Referring to Properties）</h1><div><div>
<p>OGNL学习笔记-属性（Referring to Properties）</p>
<div align="center"><font size="3"><strong><span>属性（</span></strong><strong><span>Referring to Properties</span></strong><strong><span>）</span></strong><strong><span>
<p> </p>
</span></strong></font><strong><span>一、</span></strong><strong><span>OGNL</span></strong><strong><span>处理不同对象的属性是不一样的。</span></strong><strong><span> </span></strong></div>
<p> </p>
<p> </p>
<p> </p>
<div><span><span>1．<span>&nbsp;&nbsp;  </span></span></span><span dir="ltr"><span>Map</span></span><span>的属性就是</span><span>key
<p> </p>
</span></div>
<p> </p>
<div><span><span>2．<span>&nbsp;&nbsp;  </span></span></span><span dir="ltr"><span>Lists</span></span><span>和</span><span>Array</span><span>的属性就是下标</span><span>index
<p> </p>
</span></div>
<p> </p>
<div><span><span>3．<span>&nbsp;&nbsp;  </span></span></span><span dir="ltr"><span>String</span></span><span>的属性也是下标</span><span>
<p> </p>
</span></div>
<p> </p>
<div><span><span>4．<span>&nbsp;&nbsp;  </span></span></span><span dir="ltr"><span>普通对象只能处理</span></span><span>string</span><span>属性，这个属性具有</span><span>set/get</span><span>或</span><span>is/set</span><span>方法。</span><span>
<p> </p>
</span></div>
<p> </p>
<div><span>属性名可以是任何类型，而不仅仅是&ldquo;字符串类型的名字&rdquo;（注意区别属性名和属性值的类型，这里是说这个属性的名字可以是非字符串的，例如这个属性的名字可以是一个数字），对于非字符串类型的属性名，我们访问属性值的时候要用下标的形式。例如对一个数组</span><span>array</span><span>：</span><span>
<p> </p>
</span></div>
<p> </p>
<div><span>它的长度是</span><span>array</span><span>的一个属性，这个属性名字叫做</span><span>length</span><span>，这个名字是一个字符串，因此可以用下面的方式访问：</span><span>
<p> </p>
</span></div>
<p> </p>
<div><strong><span>array.length
<p> </p>
</span></strong></div>
<p> </p>
<div><span>现在要访问第</span><span>0</span><span>个元素，那么这个属性名是</span><span>0</span><span>，它是数字，应该按下下标方式访问</span><span>
<p> </p>
</span></div>
<p> </p>
<div><strong><span>array[0]
<p> </p>
</span></strong></div>
<p> </p>
<div><span>为什么要将下标也作为属性呢？暂时做为一个未解决的问题！</span><span>
<p> </p>
</span></div>
<p> </p>
<div><span>OGNL</span><span>内部是将</span><span>
<p> </p>
</span></div>
<p> </p>
<div><strong><span>array.length
<p> </p>
</span></strong></div>
<p> </p>
<div><span>做为</span><span>
<p> </p>
</span></div>
<p> </p>
<div><strong><span>array[&ldquo;length&rdquo;]
<p> </p>
</span></strong></div>
<p> </p>
<div><span>形式的，同时也等价于</span><span>
<p> </p>
</span></div>
<p> </p>
<div><span><span>&nbsp;&nbsp;&nbsp;  </span><strong><span>array[&ldquo;len&rdquo;+&rdquo;gth&rdquo;]
<p> </p>
</span></strong></span></div>
<p> </p>
<div><span>
<p> </p>
</span></div>
<p> </p>
<div> </div>
<div><strong><span>二、</span></strong><strong><span>OGNL</span></strong><strong><span>与</span></strong><strong><span>java</span></strong><strong><span>代码中属性的下标访问</span></strong><span>
<p> </p>
</span></div>
<p> </p>
<div><span>在</span><span>java</span><span>代码中，按</span><span>index</span><span>访问属性的模型如下：</span><span>
<p> </p>
</span></div>
<p> </p>
<div><span><span>&nbsp;&nbsp;&nbsp;  </span><strong><span>public PropertyType[] getPropertyName()
<p> </p>
</span></strong></span></div>
<p> </p>
<div><strong><span>public void setPropertyName(PropertyType[] anArray)
<p> </p>
</span></strong></div>
<p> </p>
<div><strong><span>public PropertyType getPropertyName(int index)
<p> </p>
</span></strong></div>
<p> </p>
<div><strong><span>public void setPropertyName(int index, PropertyType value)
<p> </p>
</span></strong></div>
<p> </p>
<div><span>在</span><span>OGNL</span><span>中可以通过</span><span>index</span><span>来无缝地访问，用下面的方式：</span><span>
<p> </p>
</span></div>
<p> </p>
<div><strong><span>someProperty[2]
<p> </p>
</span></strong></div>
<p> </p>
<div><span>这样将自动调用</span><span>getSomeProperty(2)</span><span>或者是</span><span>setSomeProperty(2,value)
<p> </p>
</span></div>
<p> </p>
<div><span>OGNL</span><span>对</span><span>index</span><span>方式访问属性做了扩展，它不仅仅可以用整数下标，也可以使用任意的对象做</span><span>index</span><span>。</span><span>OGNL</span><span>将匹配</span><span>java</span><span>对象中下列形式的方法：</span><span>
<p> </p>
</span></div>
<p> </p>
<div><strong><span>public PropertyType getPropertyName(IndexType index)
<p> </p>
</span></strong></div>
<p> </p>
<div><strong><span>public void setPropertyName(IndexType index, PropertyType value)
<p> </p>
</span></strong></div>
<p> </p>
<div><tt><em><span><font face="新宋体">PropertyType</font></span></em></tt><span>和</span><font face="新宋体"><tt><em><span>IndexType</span></em></tt><tt><span>必须在相应的</span></tt><tt><span>set</span></tt><tt><span>和</span></tt><tt><span>get</span></tt><tt><span>方法中匹配。在</span></tt><tt><span>webwork</span></tt><tt><span>中的</span></tt><tt><span>Session</span></tt><tt><span>对象就有</span></tt></font><tt><span><font face="新宋体">: </font>
<p> </p>
</span></tt></div>
<p> </p>
<div><tt><span><span><font face="新宋体">&nbsp;&nbsp;&nbsp;  </font></span><strong><span><font face="新宋体">public Object getAttribute(String name) </font>
<p> </p>
</span></strong></span></tt></div>
<p> </p>
<div><tt><strong><span><font face="新宋体">public void setAttribute(String name, Object value) </font>
<p> </p>
</span></strong></tt></div>
<p> </p>
<div><font face="新宋体"><tt><span>来设置任意类型的属性值。使用</span></tt><tt><span>OGNL</span></tt><tt><span>表达式来访问就是：</span></tt></font><tt><span><font face="新宋体"> </font>
<p> </p>
</span></tt></div>
<p> </p>
<div><tt><span><span><font face="新宋体">&nbsp;&nbsp;&nbsp;  </font></span><strong><span><font face="新宋体">session.attribute[&ldquo;foo&rdquo;] </font>
<p> </p>
</span></strong></span></tt></div>
<p> </p>
<div><tt><strong><span>
<p> </p>
</span></strong></tt></div>
<p> </p>
<div> </div>
<div><strong><span>三、</span></strong><strong><span>Collections</span></strong><strong><span>伪属性（</span></strong><strong><span>Pseudo-Properties</span></strong><strong><span>）</span></strong><strong><span>
<p> </p>
</span></strong></div>
<p> </p>
<div><span>Collections</span><span>中有很多特殊的属性可以通过</span><span>OGNL</span><span>来访问，</span><span>Collections</span><span>并不遵循</span><span>javabeans</span><span>的命名规则，像</span><span>size()</span><span>、</span><span>length()</span><span>等等。罗列如下</span><span>
<p> </p>
</span>
<table border="1" cellspacing="0" cellpadding="0">
    <thead>
        <tr>
            <td valign="top">
            <div align="center"><strong><span>Collection
            <p> </p>
            </span></strong></div>
            </td>
            <td valign="top">
            <div align="center"><strong><span>Special Properties
            <p> </p>
            </span></strong></div>
            </td>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td valign="top">
            <div><tt><span><font face="新宋体">Collection</font></span></tt><span> (inherited by <tt><span><font face="新宋体">Map</font></span></tt>, <tt><span><font face="新宋体">List</font></span></tt> &amp; <tt><span><font face="新宋体">Set</font></span></tt>)<span>
            <p> </p>
            </span></span></div>
            </td>
            <td valign="top">
            <div><tt><strong><span><font face="新宋体">size</font></span></strong></tt><span>
            <p> </p>
            </span>
            <div><span>The size of the collection
            <p> </p>
            </span>
            <div><tt><strong><span><font face="新宋体">isEmpty</font></span></strong></tt></div>
            <div><span><font size="3">Evaluates to </font></span><tt><span><font face="新宋体">true</font></span></tt><font size="3"><span> if the collection is empty</span><span>
            <p> </p>
            </span></font></div>
            </div>
            </div>
            </td>
        </tr>
        <tr>
            <td valign="top">
            <div><span>List<span>
            <p> </p>
            </span></span></div>
            </td>
            <td valign="top">
            <div><tt><strong><span><font face="新宋体">iterator</font></span></strong></tt><span>
            <p> </p>
            </span>
            <div><span>Evalutes to an <tt><span><font face="新宋体">Iterator</font></span></tt> over the <tt><span><font face="新宋体">List</font></span></tt>.
            <p> </p>
            </span></div>
            </div>
            </td>
        </tr>
        <tr>
            <td valign="top">
            <div><tt><span><font face="新宋体">Map</font></span></tt><span>
            <p> </p>
            </span></div>
            </td>
            <td valign="top">
            <div><tt><strong><span><font face="新宋体">keys</font></span></strong></tt><span>
            <p> </p>
            </span>
            <div><span>Evalutes to a <tt><span><font face="新宋体">Set</font></span></tt> of all keys in the <tt><span><font face="新宋体">Map</font></span></tt>.
            <p> </p>
            </span>
            <div><tt><strong><span><font face="新宋体">values</font></span></strong></tt><span>
            <p> </p>
            </span>
            <div><span>Evaluates to a <tt><span><font face="新宋体">Collection</font></span></tt> of all values in the <tt><span><font face="新宋体">Map</font></span></tt>.
            <p> </p>
            </span>
            <div><span>Note</span><span>：</span><span>
            <p> </p>
            </span>
            <div><span><font size="3">These properties, plus </font></span><tt><span><font face="新宋体">size</font></span></tt><span><font size="3"> and </font></span><tt><span><font face="新宋体">isEmpty</font></span></tt><span><font size="3">, are different than the indexed form of access for </font></span><tt><span><font face="新宋体">Map</font></span></tt><span><font size="3">s (i.e. </font></span><tt><span><font face="新宋体">someMap[&quot;size&quot;]</font></span></tt><span><font size="3"> gets the </font></span><tt><span><font face="新宋体">&quot;size&quot;</font></span></tt><span><font size="3"> key from the map, whereas </font></span><tt><span><font face="新宋体">someMap.size</font></span></tt><span><font size="3"> gets the size of the </font></span><tt><span><font face="新宋体">Map</font></span></tt><font size="3"><span>.</span><span>
            <p> </p>
            </span></font></div>
            </div>
            </div>
            </div>
            </div>
            </div>
            </td>
        </tr>
        <tr>
            <td valign="top">
            <div><tt><span><font face="新宋体">Set</font></span></tt><span>
            <p> </p>
            </span></div>
            </td>
            <td valign="top">
            <div><tt><strong><span><font face="新宋体">iterator</font></span></strong></tt><span>
            <p> </p>
            </span>
            <div><span>Evalutes to an <tt><span><font face="新宋体">Iterator</font></span></tt> over the <tt><span><font face="新宋体">Set</font></span></tt>.
            <p> </p>
            </span></div>
            </div>
            </td>
        </tr>
        <tr>
            <td valign="top">
            <div><tt><span><font face="新宋体">Iterator</font></span></tt><span>
            <p> </p>
            </span></div>
            </td>
            <td valign="top">
            <div><tt><strong><span><font face="新宋体">next</font></span></strong></tt><span>
            <p> </p>
            </span>
            <div><span>Evalutes to the next object from the <tt><span><font face="新宋体">Iterator</font></span></tt>.
            <p> </p>
            </span>
            <div><tt><strong><span><font face="新宋体">hasNext</font></span></strong></tt><span>
            <p> </p>
            </span>
            <div><span>Evaluates to <tt><span><font face="新宋体">true</font></span></tt> if there is a next object available from the <tt><span><font face="新宋体">Iterator</font></span></tt>.
            <p> </p>
            </span></div>
            </div>
            </div>
            </div>
            </td>
        </tr>
        <tr>
            <td valign="top">
            <div><tt><span><font face="新宋体">Enumeration</font></span></tt><span>
            <p> </p>
            </span></div>
            </td>
            <td valign="top">
            <div><tt><strong><span><font face="新宋体">next</font></span></strong></tt><span>
            <p> </p>
            </span>
            <div><span>Evalutes to the next object from the <tt><span><font face="新宋体">Enumeration</font></span></tt>.
            <p> </p>
            </span>
            <div><tt><strong><span><font face="新宋体">hasNext</font></span></strong></tt><span>
            <p> </p>
            </span>
            <div><span>Evaluates to <tt><span><font face="新宋体">true</font></span></tt> if there is a next object available from the <tt><span><font face="新宋体">Enumeration</font></span></tt>.
            <p> </p>
            </span>
            <div><tt><strong><span><font face="新宋体">nextElement</font></span></strong></tt><span>
            <p> </p>
            </span>
            <div><span>Synonym for <tt><span><a href="http://www.ognl.org/2.6.7/Documentation/html/"><span><font face="新宋体">next</font></span></a></span></tt>.
            <p> </p>
            </span>
            <div><tt><strong><span><font face="新宋体">hasMoreElements</font></span></strong></tt><span>
            <p> </p>
            </span>
            <div><span>Synonym for <tt><span><a href="http://www.ognl.org/2.6.7/Documentation/html/"><span><font face="新宋体">hasNext</font></span></a></span></tt>.
            <p> </p>
            </span></div>
            </div>
            </div>
            </div>
            </div>
            </div>
            </div>
            </div>
            </td>
        </tr>
    </tbody>
</table>
</div>
<p> </p>
<div><span>
<p><a href="http://blog.csdn.net/upccpu/archive/2005/10/09/498407.aspx">http://blog.csdn.net/upccpu/archive/2005/10/09/498407.aspx</a></p>
</span></div>
</div></div></body></html>