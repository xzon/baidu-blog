<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>velocity语法</title></head><body><h1>velocity语法</h1><div><p>velocity语法</p>
<p>一、基本语法</p>
<p>&nbsp;&nbsp;&nbsp;  1、&quot;#&quot;用来标识Velocity的脚本语句，包括#set、#if 、#else、#end、#foreach、#end、#iinclude、#parse、#macro等；<br>
&nbsp;&nbsp;&nbsp;  如:<br>
&nbsp;&nbsp;&nbsp;  #if($info.imgs)<br>
&nbsp;&nbsp;&nbsp;  &lt;img src=&quot;$info.imgs&quot; border=0&gt;<br>
&nbsp;&nbsp;&nbsp;  #else<br>
&nbsp;&nbsp;&nbsp;  &lt;img src=&quot;noPhoto.jpg&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;  #end</p>
<p>&nbsp;&nbsp;&nbsp;  2、&quot;$&quot;用来标识一个对象(或理解为变量)；如<br>
&nbsp;&nbsp;&nbsp;  如：$i、$msg、$TagUtil.options(...)等。</p>
<p>&nbsp;&nbsp;&nbsp;  3、&quot;{}&quot;用来明确标识Velocity变量；<br>
&nbsp;&nbsp;&nbsp;  比如在页面中，页面中有一个$someonename，此时，Velocity将把someonename作为变量名，若我们程序是想在someone这个变量的后面紧接着显示name字符，则上面的标签应该改成${someone}name。</p>
<p>&nbsp;&nbsp;&nbsp;  4、&quot;!&quot;用来强制把不存在的变量显示为空白。<br>
&nbsp;&nbsp;&nbsp;  如当页面中包含$msg，如果msg对象有值，将显示msg的值，如果不存在msg对象同，则在页面中将显示$msg字符。这是我们不希望的，为了把不存在的变量或变量值为null的对象显示为空白，则只需要在变量名前加一个&ldquo;!&rdquo;号即可。<br>
&nbsp;&nbsp;&nbsp;  如：$!msg</p>
<p> </p>
<p><br>
&nbsp;&nbsp;&nbsp;  二，关于#set的使用</p>
<p>&nbsp;&nbsp;&nbsp;  在万不得已的时候，不要在页面视图自己声明Velocity脚本变量，也就是尽量少使用#set。有时候我们需要在页面中显示序号，而程序对象中又没有包含这个序号属性同，可以自己定义。如在一个循环体系中，如下所示：<br>
&nbsp;&nbsp;&nbsp;  #set ($i=0)<br>
&nbsp;&nbsp;&nbsp;  #foreach($info in $list)<br>
&nbsp;&nbsp;&nbsp;  序号:$i<br>
&nbsp;&nbsp;&nbsp;  #set($i=$i+1)<br>
&nbsp;&nbsp;&nbsp;  #end</p>
<p> </p>
<p>&nbsp;&nbsp;&nbsp;  三，Velocity脚本语法摘要</p>
<p>&nbsp;&nbsp;&nbsp;  1、声明:#set ($var=XXX)<br>
&nbsp;&nbsp;&nbsp;  左边可以是以下的内容<br>
&nbsp;&nbsp;&nbsp;  Variable reference<br>
&nbsp;&nbsp;&nbsp;  String literal<br>
&nbsp;&nbsp;&nbsp;  Property reference<br>
&nbsp;&nbsp;&nbsp;  Method reference<br>
&nbsp;&nbsp;&nbsp;  Number literal #set ($i=1)<br>
&nbsp;&nbsp;&nbsp;  ArrayList #set ($arr=[&quot;yt1&quot;,&quot;t2&quot;])<br>
&nbsp;&nbsp;&nbsp;  算术运算符</p>
<p>&nbsp;&nbsp;&nbsp;  2、注释:<br>
&nbsp;&nbsp;&nbsp;  单行## XXX<br>
&nbsp;&nbsp;&nbsp;  多行#* xxx<br>
&nbsp;&nbsp;&nbsp;  xxxx<br>
&nbsp;&nbsp;&nbsp;  xxxxxxxxxxxx*#</p>
<p>&nbsp;&nbsp;&nbsp;  References 引用的类型<br>
&nbsp;&nbsp;&nbsp;  3、变量 Variables<br>
&nbsp;&nbsp;&nbsp;  以 &quot;$&quot; 开头，第一个字符必须为字母。character followed by a VTL Identifier. (a .. z or A .. Z).<br>
&nbsp;&nbsp;&nbsp;  变量可以包含的字符有以下内容：<br>
&nbsp;&nbsp;&nbsp;  alphabetic (a .. z, A .. Z)<br>
&nbsp;&nbsp;&nbsp;  numeric (0 .. 9)<br>
&nbsp;&nbsp;&nbsp;  hyphen (&quot;-&quot;)<br>
&nbsp;&nbsp;&nbsp;  underscore (&quot;_&quot;)</p>
<p>&nbsp;&nbsp;&nbsp;  4、Properties<br>
&nbsp;&nbsp;&nbsp;  $Identifier.Identifier<br>
&nbsp;&nbsp;&nbsp;  $user.name<br>
&nbsp;&nbsp;&nbsp;  hashtable user中的的name值.类似：user.get(&quot;name&quot;)</p>
<p>&nbsp;&nbsp;&nbsp;  5、Methods<br>
&nbsp;&nbsp;&nbsp;  object user.getName() = $user.getName()</p>
<p>&nbsp;&nbsp;&nbsp;  6、Formal Reference Notation<br>
&nbsp;&nbsp;&nbsp;  用{}把变量名跟字符串分开</p>
<p>&nbsp;&nbsp;&nbsp;  如<br>
&nbsp;&nbsp;&nbsp;  #set ($user=&quot;csy&quot;}<br>
&nbsp;&nbsp;&nbsp;  ${user}name<br>
&nbsp;&nbsp;&nbsp;  返回csyname</p>
<p>&nbsp;&nbsp;&nbsp;  $username<br>
&nbsp;&nbsp;&nbsp;  $!username<br>
&nbsp;&nbsp;&nbsp;  $与$!的区别<br>
&nbsp;&nbsp;&nbsp;  当找不到username的时候，$username返回字符串&quot;$username&quot;，而$!username返回空字符串&quot;&quot;</p>
<p>&nbsp;&nbsp;&nbsp;  7、双引号 与 引号<br>
&nbsp;&nbsp;&nbsp;  #set ($var=&quot;helo&quot;)<br>
&nbsp;&nbsp;&nbsp;  test&quot;$var&quot; 返回testhello<br>
&nbsp;&nbsp;&nbsp;  test'$var' 返回test'$var'<br>
&nbsp;&nbsp;&nbsp;  可以通过设置 stringliterals.interpolate=false改变默认处理方式</p>
<p>&nbsp;&nbsp;&nbsp;  8、条件语句<br>
&nbsp;&nbsp;&nbsp;  #if( $foo )<br>
&nbsp;&nbsp;&nbsp;  &lt;strong&gt;Velocity!&lt;/strong&gt;<br>
&nbsp;&nbsp;&nbsp;  #end<br>
&nbsp;&nbsp;&nbsp;  #if($foo)<br>
&nbsp;&nbsp;&nbsp;  #elseif()<br>
&nbsp;&nbsp;&nbsp;  #else<br>
&nbsp;&nbsp;&nbsp;  #end<br>
&nbsp;&nbsp;&nbsp;  当$foo为null或为Boolean对象的false值执行.</p>
<p>&nbsp;&nbsp;&nbsp;  9、逻辑运算符:== &amp;&amp; || !</p>
<p>&nbsp;&nbsp;&nbsp;  10、循环语句#foreach($var in $arrays ) // 集合包含下面三种Vector, a Hashtable or an Array<br>
&nbsp;&nbsp;&nbsp;  #end<br>
&nbsp;&nbsp;&nbsp;  #foreach( $product in $allProducts )<br>
&nbsp;&nbsp;&nbsp;  &lt;li&gt;$product&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;  #end</p>
<p>&nbsp;&nbsp;&nbsp;  #foreach( $key in $allProducts.keySet() )<br>
&nbsp;&nbsp;&nbsp;  &lt;li&gt;Key: $key -&gt; Value: $allProducts.get($key)&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;  #end</p>
<p>&nbsp;&nbsp;&nbsp;  #foreach( $customer in $customerList )<br>
&nbsp;&nbsp;&nbsp;  &lt;tr&gt;&lt;td&gt;$velocityCount&lt;/td&gt;&lt;td&gt;$customer.Name&lt;/td&gt;&lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp;  #end</p>
<p>&nbsp;&nbsp;&nbsp;  11、velocityCount变量在配置文件中定义<br>
&nbsp;&nbsp;&nbsp;  # Default name of the loop counter<br>
&nbsp;&nbsp;&nbsp;  # variable reference.<br>
&nbsp;&nbsp;&nbsp;  directive.foreach.counter.name = velocityCount<br>
&nbsp;&nbsp;&nbsp;  # Default starting value of the loop<br>
&nbsp;&nbsp;&nbsp;  # counter variable reference.<br>
&nbsp;&nbsp;&nbsp;  directive.foreach.counter.initial.value = 1</p>
<p>&nbsp;&nbsp;&nbsp;  12、包含文件<br>
&nbsp;&nbsp;&nbsp;  #include( &quot;one.gif&quot;,&quot;two.txt&quot;,&quot;three.htm&quot; )</p>
<p>&nbsp;&nbsp;&nbsp;  13、Parse导入脚本<br>
&nbsp;&nbsp;&nbsp;  #parse(&quot;me.vm&quot; )</p>
<p>&nbsp;&nbsp;&nbsp;  14、#stop 停止执行并返回</p>
<p>&nbsp;&nbsp;&nbsp;  15、定义宏Velocimacros ,相当于函数 支持包含功能<br>
&nbsp;&nbsp;&nbsp;  #macro( d )<br>
&nbsp;&nbsp;&nbsp;  &lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp;  #end<br>
&nbsp;&nbsp;&nbsp;  调用<br>
&nbsp;&nbsp;&nbsp;  #d()</p>
<p>&nbsp;&nbsp;&nbsp;  16、带参数的宏<br>
&nbsp;&nbsp;&nbsp;  #macro( tablerows $color $somelist )<br>
&nbsp;&nbsp;&nbsp;  #foreach( $something in $somelist )<br>
&nbsp;&nbsp;&nbsp;  &lt;tr&gt;&lt;td bgcolor=$color&gt;$something&lt;/td&gt;&lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp;  #end<br>
&nbsp;&nbsp;&nbsp;  #end</p>
<p>&nbsp;&nbsp;&nbsp;  17、Range Operator<br>
&nbsp;&nbsp;&nbsp;  #foreach( $foo in [1..5] )</p>
<p>&nbsp;&nbsp;&nbsp;  这次吃亏的主要是红色部分，很多地方没有加感叹号，<br>
&nbsp;&nbsp;&nbsp;  导致画面直接显示了变量名${xxx.yyy}<br>
<br>
<a href="http://velocity.apache.org/">http://velocity.apache.org/</a>&nbsp;&nbsp;<br>
使用 Velocity 实现客户端和服务器端模板 灵活的模板引擎为 JSP 技术提供一种没有遗产负担的选择<br>
<a href="http://www-128.ibm.com/developerworks/cn/java/j-velocity/">http://www-128.ibm.com/developerworks/cn/java/j-velocity/</a></p></div></body></html>