<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>MD5Digest.java JSP站点MD5加密 -javacode</title></head><body><h1>MD5Digest.java JSP站点MD5加密 -javacode</h1><div><p>MD5Digest.java  JSP站点MD5加密 -javacode</p>
<p><font color="#ff0000">MD5Digest.java</font></p>
<p>/**<br>
* 类名：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  MD5Digest&lt;br&gt;<br>
* 说明：&nbsp;&nbsp;  用来进行密码加密的md5公用参数&lt;br&gt;<br>
* 编写日期： 2001/03/05&lt;br&gt;<br>
* 修改者：&nbsp;&nbsp;&nbsp;  &lt;br&gt;<br>
* 修改信息： &lt;br&gt;<br>
* @author&nbsp;&nbsp;&nbsp;&nbsp;  edgarlo <a href="mailto:edgarlo@china.com">edgarlo@china.com</a><br>
* @version&nbsp;&nbsp;&nbsp;  1.0&lt;br&gt;<br>
*/<br>
<br>
import java.security.MessageDigest;<br>
import java.security.NoSuchAlgorithmException;</p>
<p>public class MD5Digest<br>
{</p>
<p>&nbsp;&nbsp;&nbsp;  private MessageDigest __md5 = null;<br>
&nbsp;&nbsp;&nbsp;  private StringBuffer __digestBuffer = null;</p>
<p>&nbsp;&nbsp;&nbsp;  public MD5Digest()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  throws NoSuchAlgorithmException<br>
&nbsp;&nbsp;&nbsp;  {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  __md5 = MessageDigest.getInstance(&quot;MD5&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  __digestBuffer = new StringBuffer();<br>
&nbsp;&nbsp;&nbsp;  }</p>
<p>&nbsp;&nbsp;&nbsp;  public String md5crypt(String s)<br>
&nbsp;&nbsp;&nbsp;  {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  __digestBuffer.setLength(0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  byte abyte0[] = __md5.digest(s.getBytes());<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  for(int i = 0; i &lt; abyte0.length; i++)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  __digestBuffer.append(toHex(abyte0[i]));</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  return __digestBuffer.toString();<br>
&nbsp;&nbsp;&nbsp;  }<br>
&nbsp;&nbsp;&nbsp;  public String toHex(byte one){<br>
&nbsp;&nbsp;  String HEX=&quot;0123456789ABCDEF&quot;;<br>
&nbsp;&nbsp;  char[] result=new char[2];<br>
&nbsp;&nbsp;  result[0]=HEX.charAt((one &amp; 0xf0) &gt;&gt; 4);<br>
&nbsp;&nbsp;  result[1]=HEX.charAt(one &amp; 0x0f);<br>
&nbsp;&nbsp;  String mm=new String(result);<br>
&nbsp;&nbsp;  return mm;<br>
}<br>
}</p>
<p>使用的时间可以这样</p>
<p><font color="#ff0000">&lt;jsp:useBean id=&quot;md5&quot; scope=&quot;application&quot; class=&quot;beans.MD5&quot;/&gt;<br>
&lt;jsp:useBean id=&quot;MD5Digest&quot; scope=&quot;application&quot; class=&quot;beans.MD5Digest&quot;/&gt;</font></p>
<p>。。。。</p>
<p>try{<br>
ResultSet rs=connDB.executeQuery(&quot;select * from admin where admin='&quot;+admin+&quot;'&quot;);<br>
if(rs.next()){<br>
&nbsp;&nbsp;  String PWD1=request.getParameter(&quot;PWD&quot;);<br>
<font color="#ff0000">String PWD = md5.getMD5ofStr(PWD1); //MD5加密<br>
</font>&nbsp;&nbsp;  if(PWD.equals(rs.getString(&quot;password&quot;))){<br>
&nbsp;&nbsp;&nbsp;  session.setAttribute(&quot;admin&quot;,admin);<br>
&nbsp;&nbsp;&nbsp;  response.sendRedirect(&quot;admin_index.jsp&quot;);<br>
&nbsp;&nbsp;  }else{<br>
&nbsp;&nbsp;&nbsp;  out.println(&quot;&lt;script language='javascript'&gt;alert('您输入的管理员或密码错误!');window.location.href='admin_login.jsp';&lt;/script&gt;&quot;);<br>
&nbsp;&nbsp;  }<br>
}else{<br>
&nbsp;&nbsp;&nbsp;  out.println(&quot;&lt;script language='javascript'&gt;alert('您输入的管理员或密码错误!');window.location.href='admin_login.jsp';&lt;/script&gt;&quot;);<br>
}<br>
}catch(Exception e){<br>
out.println(&quot;&lt;script language='javascript'&gt;alert('您的操作有误!');window.location.href='admin_login.jsp';&lt;/script&gt;&quot;);<br>
}<br>
}</p></div></body></html>