<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Chapter 4 JNI Functions</title></head><body><h1>Chapter 4 JNI Functions</h1><div><p> </p>
<p>Chapter 4 JNI Functions</p>
<p>hxzon：C++版本中env的函数签名都没有env参数，并且直接env-&gt;而不是(*env).</p>
<p><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/jniTOC.html">http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/jniTOC.html</a></p>
<h2 class="pChapNum">Chapter 4</h2>
<h2 class="pNewHTMLPage">JNI Functions</h2>
<a name="wp15899"></a>
<p class="pBody">This chapter serves as the reference section for the JNI functions. It provides a complete listing of all the JNI functions. It also presents the exact layout of the JNI function table.</p>
<a name="wp5821"></a>
<p class="pBody">Note the use of the term &ldquo;must&rdquo; to describe restrictions on JNI programmers. For example, when you see that a certain JNI function <em class="cEmphasis">must</em> receive a non-NULL object, it is your responsibility to ensure that NULL is not passed to that JNI function. As a result, a JNI implementation does not need to perform NULL pointer checks in that JNI function.</p>
<a name="wp5310"></a>
<p class="pBody">A portion of this chapter is adapted from Netscape&rsquo;s JRI documentation.</p>
<a name="wp3476"></a>
<p class="pBody">The reference material groups functions by their usage. The reference section is organized by the following functional areas:</p>
<ul class="pBullet1"><a name="wp3739"></a>
    <div class="pBullet1">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp23717">Version Information</a></li>
    </div>
    <a name="wp3744"></a>
    <div class="pBullet1Plus">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp15982">Class Operations</a></li>
    </div>
    <a name="wp3749"></a>
    <div class="pBullet1Plus">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp5234">Exceptions</a></li>
    </div>
    <a name="wp3754"></a>
    <div class="pBullet1Plus">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#global_local">Global and Local References</a></li>
    </div>
    <a name="wp3759"></a>
    <div class="pBullet1Plus">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#weak">Weak Global References</a></li>
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp16334">Object Operations</a></li>
    </div>
    <a name="wp3764"></a>
    <div class="pBullet1Plus">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp16536">Accessing Fields of Objects</a></li>
    </div>
    <a name="wp3769"></a>
    <div class="pBullet1Plus">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp16656">Calling Instance Methods</a></li>
    </div>
    <a name="wp3774"></a>
    <div class="pBullet1Plus">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp5901">Accessing Static Fields</a></li>
    </div>
    <a name="wp3779"></a>
    <div class="pBullet1Plus">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp20949">Calling Static Methods</a></li>
    </div>
    <a name="wp3784"></a>
    <div class="pBullet1Plus">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#string_operations">String Operations</a></li>
    </div>
    <a name="wp3789"></a>
    <div class="pBullet1Plus">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp17314">Array Operations</a></li>
    </div>
    <a name="wp3794"></a>
    <div class="pBullet1Plus">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp5833">Registering Native Methods</a></li>
    </div>
    <a name="wp3799"></a>
    <div class="pBullet1Plus">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp5256">Monitor Operations</a></li>
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#nio_support">NIO Support</a></li>
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#reflection_support">Reflection Support</a></li>
    </div>
    <a name="wp3804"></a>
    <div class="pBullet1Last">
    <li><a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp5263">Java VM Interface</a></li>
    </div>
</ul>
<a name="wp23720"></a>
<h2 class="pHeading1">Interface Function Table</h2>
<a name="wp23721"></a>
<p class="pBody">Each function is accessible at a fixed offset through the <em class="cEmphasis">JNIEnv</em> argument. The <em class="cEmphasis">JNIEnv</em> type is a pointer to a structure storing all JNI function pointers. It is defined as follows:</p>
<div class="pPreformatted">
<pre class="pPreformatted">typedef const struct JNINativeInterface *JNIEnv;<a name="wp3813"> </a></pre>
</div>
<a name="wp23802"></a>
<p class="pBody">The VM initializes the function table, as shown by <a href="http://java.sun.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp5267">Code Example 4-1</a>. Note that the first three entries are reserved for future compatibility with COM. In addition, we reserve a number of additional <code class="cCode"><font face="新宋体">NULL</font></code> entries near the beginning of the function table, so that, for example, a future class-related JNI operation can be added after FindClass, rather than at the end of the table.</p>
<a name="wp5267"></a>
<p class="pBody">Note that the function table can be shared among all JNI interface pointers.</p>
<div class="pCodeCaption">
<div class="pCodeCaption"><br>
Code Example 4-1</div>
<div class="pPreformatted">
<pre class="pPreformatted">const struct JNINativeInterface ... = {      NULL,     NULL,     NULL,     NULL,     GetVersion,      DefineClass,     FindClass,      FromReflectedMethod,     FromReflectedField,     ToReflectedMethod,      GetSuperclass,     IsAssignableFrom,      ToReflectedField,      Throw,     ThrowNew,     ExceptionOccurred,     ExceptionDescribe,     ExceptionClear,     FatalError,      PushLocalFrame,     PopLocalFrame,      NewGlobalRef,     DeleteGlobalRef,     DeleteLocalRef,     IsSameObject,     NewLocalRef,     EnsureLocalCapacity,      AllocObject,     NewObject,     NewObjectV,     NewObjectA,      GetObjectClass,     IsInstanceOf,      GetMethodID,      CallObjectMethod,     CallObjectMethodV,     CallObjectMethodA,     CallBooleanMethod,     CallBooleanMethodV,     CallBooleanMethodA,     CallByteMethod,     CallByteMethodV,     CallByteMethodA,     CallCharMethod,     CallCharMethodV,     CallCharMethodA,     CallShortMethod,     CallShortMethodV,     CallShortMethodA,     CallIntMethod,     CallIntMethodV,     CallIntMethodA,     CallLongMethod,     CallLongMethodV,     CallLongMethodA,     CallFloatMethod,     CallFloatMethodV,     CallFloatMethodA,     CallDoubleMethod,     CallDoubleMethodV,     CallDoubleMethodA,     CallVoidMethod,     CallVoidMethodV,     CallVoidMethodA,      CallNonvirtualObjectMethod,     CallNonvirtualObjectMethodV,     CallNonvirtualObjectMethodA,     CallNonvirtualBooleanMethod,     CallNonvirtualBooleanMethodV,     CallNonvirtualBooleanMethodA,     CallNonvirtualByteMethod,     CallNonvirtualByteMethodV,     CallNonvirtualByteMethodA,     CallNonvirtualCharMethod,     CallNonvirtualCharMethodV,     CallNonvirtualCharMethodA,     CallNonvirtualShortMethod,     CallNonvirtualShortMethodV,     CallNonvirtualShortMethodA,     CallNonvirtualIntMethod,     CallNonvirtualIntMethodV,     CallNonvirtualIntMethodA,     CallNonvirtualLongMethod,     CallNonvirtualLongMethodV,     CallNonvirtualLongMethodA,     CallNonvirtualFloatMethod,     CallNonvirtualFloatMethodV,     CallNonvirtualFloatMethodA,     CallNonvirtualDoubleMethod,     CallNonvirtualDoubleMethodV,     CallNonvirtualDoubleMethodA,     CallNonvirtualVoidMethod,     CallNonvirtualVoidMethodV,     CallNonvirtualVoidMethodA,      GetFieldID,      GetObjectField,     GetBooleanField,     GetByteField,     GetCharField,     GetShortField,     GetIntField,     GetLongField,     GetFloatField,     GetDoubleField,     SetObjectField,     SetBooleanField,     SetByteField,     SetCharField,     SetShortField,     SetIntField,     SetLongField,     SetFloatField,     SetDoubleField,      GetStaticMethodID,      CallStaticObjectMethod,     CallStaticObjectMethodV,     CallStaticObjectMethodA,     CallStaticBooleanMethod,     CallStaticBooleanMethodV,     CallStaticBooleanMethodA,     CallStaticByteMethod,     CallStaticByteMethodV,     CallStaticByteMethodA,     CallStaticCharMethod,     CallStaticCharMethodV,     CallStaticCharMethodA,     CallStaticShortMethod,     CallStaticShortMethodV,     CallStaticShortMethodA,     CallStaticIntMethod,     CallStaticIntMethodV,     CallStaticIntMethodA,     CallStaticLongMethod,     CallStaticLongMethodV,     CallStaticLongMethodA,     CallStaticFloatMethod,     CallStaticFloatMethodV,     CallStaticFloatMethodA,     CallStaticDoubleMethod,     CallStaticDoubleMethodV,     CallStaticDoubleMethodA,     CallStaticVoidMethod,     CallStaticVoidMethodV,     CallStaticVoidMethodA,      GetStaticFieldID,      GetStaticObjectField,     GetStaticBooleanField,     GetStaticByteField,     GetStaticCharField,     GetStaticShortField,     GetStaticIntField,     GetStaticLongField,     GetStaticFloatField,     GetStaticDoubleField,      SetStaticObjectField,     SetStaticBooleanField,     SetStaticByteField,     SetStaticCharField,     SetStaticShortField,     SetStaticIntField,     SetStaticLongField,     SetStaticFloatField,     SetStaticDoubleField,      NewString,      GetStringLength,     GetStringChars,     ReleaseStringChars,      NewStringUTF,     GetStringUTFLength,     GetStringUTFChars,     ReleaseStringUTFChars,      GetArrayLength,      NewObjectArray,     GetObjectArrayElement,     SetObjectArrayElement,      NewBooleanArray,     NewByteArray,     NewCharArray,     NewShortArray,     NewIntArray,     NewLongArray,     NewFloatArray,     NewDoubleArray,      GetBooleanArrayElements,     GetByteArrayElements,     GetCharArrayElements,     GetShortArrayElements,     GetIntArrayElements,     GetLongArrayElements,     GetFloatArrayElements,     GetDoubleArrayElements,      ReleaseBooleanArrayElements,     ReleaseByteArrayElements,     ReleaseCharArrayElements,     ReleaseShortArrayElements,     ReleaseIntArrayElements,     ReleaseLongArrayElements,     ReleaseFloatArrayElements,     ReleaseDoubleArrayElements,      GetBooleanArrayRegion,     GetByteArrayRegion,     GetCharArrayRegion,     GetShortArrayRegion,     GetIntArrayRegion,     GetLongArrayRegion,     GetFloatArrayRegion,     GetDoubleArrayRegion,     SetBooleanArrayRegion,     SetByteArrayRegion,     SetCharArrayRegion,     SetShortArrayRegion,     SetIntArrayRegion,     SetLongArrayRegion,     SetFloatArrayRegion,     SetDoubleArrayRegion,      RegisterNatives,     UnregisterNatives,      MonitorEnter,     MonitorExit,      GetJavaVM,      GetStringRegion,     GetStringUTFRegion,      GetPrimitiveArrayCritical,     ReleasePrimitiveArrayCritical,      GetStringCritical,     ReleaseStringCritical,      NewWeakGlobalRef,     DeleteWeakGlobalRef,      ExceptionCheck,      NewDirectByteBuffer,     GetDirectBufferAddress,     GetDirectBufferCapacity,      GetObjectRefType   };</pre>
</div>
</div>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p></div></body></html>