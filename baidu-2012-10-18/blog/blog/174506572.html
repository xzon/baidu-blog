<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>slf4j和log4j示例 -hxzon</title></head><body><h1>slf4j和log4j示例 -hxzon</h1><div><p>slf4j和log4j示例 -hxzon</p>
<p>1，应用程序</p>
<pre>package com.hxzon.logback.example;  import org.slf4j.Logger; import org.slf4j.LoggerFactory;  public class MyApp {      final Logger logger = LoggerFactory.getLogger(MyApp.class);     Integer t;     Integer oldT;      public void setTemperature(Integer temperature) {         oldT = t;         t = temperature;         logger.debug(&quot;Temperature set to {}. Old temperature was {}.&quot;, t, oldT);         if (temperature.intValue() &gt; 50) {             logger.info(&quot;Temperature has risen above 50 degrees.&quot;);         }     }      public static void main(String[] args) {         MyApp app = new MyApp();         app.setTemperature(1);         app.setTemperature(55);     }  }</pre>
<p>2，配置文件logback.xml，类根目录下</p>
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;  &lt;configuration&gt;  &lt;appender name=&quot;stdout&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;   &lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;    &lt;Pattern&gt;%d{yyyy-MM-dd HH:mm:ss} %level [%thread] %C{1}.%M(%L\) | %msg%n&lt;/Pattern&gt;   &lt;/layout&gt;  &lt;/appender&gt;  &lt;appender name=&quot;R&quot;   class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;   &lt;File&gt;analyser.log.html&lt;/File&gt;   &lt;layout class=&quot;ch.qos.logback.classic.html.HTMLLayout&quot;&gt;    &lt;Pattern&gt;%d{yy-MM-dd HH:mm:ss}%level%t%(%C{1}%M(%L\))%msg&lt;/Pattern&gt;   &lt;/layout&gt;   &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.FixedWindowRollingPolicy&quot;&gt;    &lt;maxIndex&gt;3&lt;/maxIndex&gt;    &lt;FileNamePattern&gt;analyser.log.%i.html&lt;/FileNamePattern&gt;   &lt;/rollingPolicy&gt;   &lt;triggeringPolicy    class=&quot;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&quot;&gt;    &lt;MaxFileSize&gt;1000KB&lt;/MaxFileSize&gt;   &lt;/triggeringPolicy&gt;  &lt;/appender&gt;  &lt;logger name=&quot;soy.server.utils&quot; level=&quot;ERROR&quot; /&gt;  &lt;logger name=&quot;org.springframework&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;com.mchange&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;soy.server.utils.Timer&quot; level=&quot;DEBUG&quot; /&gt;  &lt;logger name=&quot;net.mlw.vlh&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;soy&quot; level=&quot;DEBUG&quot; /&gt;  &lt;logger name=&quot;com.ptswitch.analyser.db&quot; level=&quot;DEBUG&quot; /&gt;  &lt;logger name=&quot;org.hibernate.type&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;org.apache.commons&quot; level=&quot;ERROR&quot; /&gt;  &lt;logger name=&quot;net.sf.ehcache&quot; level=&quot;ERROR&quot; /&gt;  &lt;logger name=&quot;com&quot; level=&quot;DEBUG&quot; /&gt;  &lt;logger name=&quot;soy.server.utils.SessionListener&quot; level=&quot;DEBUG&quot; /&gt;  &lt;logger name=&quot;soy.server.locale.jci.fam&quot; level=&quot;ERROR&quot; /&gt;  &lt;logger name=&quot;org.hibernate&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;soy.server.command.DefaultActionCommand&quot; level=&quot;ERROR&quot; /&gt;  &lt;root level=&quot;INFO&quot;&gt;   &lt;appender-ref ref=&quot;stdout&quot; /&gt;   &lt;appender-ref ref=&quot;R&quot; /&gt;  &lt;/root&gt; &lt;/configuration&gt;</pre>
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;configuration&gt;  &lt;property name=&quot;fileName&quot; value=&quot;material&quot; /&gt;  &lt;appender name=&quot;stdout&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;   &lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt; &nbsp;&nbsp;   &lt;Pattern&gt;%d{HH:mm:ss} %level [%thread] %C{1}.%M(%L\) | %msg%n&lt;/Pattern&gt;   &lt;/layout&gt;  &lt;/appender&gt;  &lt;appender name=&quot;R&quot;   class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;   &lt;layout class=&quot;ch.qos.logback.classic.html.HTMLLayout&quot;&gt; &nbsp;&nbsp;   &lt;Pattern&gt;%d{yy-MM-dd HH:mm:ss}%level%t%(%C{1}.%M(%L\))%msg&lt;/Pattern&gt;   &lt;/layout&gt;   &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt; &nbsp;&nbsp;   &lt;MaxHistory&gt;7&lt;/MaxHistory&gt; &nbsp;&nbsp;   &lt;FileNamePattern&gt;${fileName}.log.%d{yyyy-MM-dd}.html&lt;/FileNamePattern&gt;   &lt;/rollingPolicy&gt;  &lt;/appender&gt;  &lt;logger name=&quot;org.springframework&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;org.hibernate.type&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;org.hibernate&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;org.apache.struts2&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;com.opensymphony.xwork2&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;com.opensymphony.xwork2.interceptor.ParametersInterceptor&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;com.mchange&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;net.mlw.vlh&quot; level=&quot;WARN&quot; /&gt;  &lt;logger name=&quot;org.apache.commons&quot; level=&quot;ERROR&quot; /&gt;  &lt;logger name=&quot;net.sf.ehcache&quot; level=&quot;ERROR&quot; /&gt;  &lt;logger name=&quot;com.ptswitch&quot; level=&quot;DEBUG&quot; /&gt;  &lt;root level=&quot;INFO&quot;&gt;   &lt;appender-ref ref=&quot;stdout&quot; /&gt;   &lt;appender-ref ref=&quot;R&quot; /&gt;  &lt;/root&gt; &lt;/configuration&gt;</pre>
<p>3，添加包</p>
<p>\slf4j-1.5.8\slf4j-api-1.5.8.jar<br>
\logback-0.9.17\logback-core-0.9.17.jar<br>
\logback-0.9.17\logback-classic-0.9.17.jar</p>
<p>4，hxzon注意：</p>
<p>4.1，右括号必须使用反斜杠转义，否则右括号总会寻找%（匹配，找不到时使得后面的完全无法解析。%（）里面的内容会单独成一列。</p>
<p>4.2，HtmlLayout不要含有任何其他不必要字符，例如空格，分号等非格式化字符，否则会产生多余的列。</p>
<p>5，新版本加入encoder，格式有所修改。否则会出现下列错误。<br>
<a href="http://logback.qos.ch/codes.html#layoutInsteadOfEncoder" name="layoutInsteadOfEncoder">This appender no longer admits a layout as a sub-component, set an encoder instead.</a></p>
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;configuration&gt;  &lt;property name=&quot;fileName&quot; value=&quot;material&quot; /&gt;<br> &lt;appender name=&quot;stdout&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;<br>  &lt;encoder class=&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;&gt;<br>&nbsp;&nbsp;  &lt;pattern&gt;%d{dd-HH:mm:ss} %level [%thread] %C{1}.%M(%L\) | %msg%n&lt;/pattern&gt;<br>  &lt;/encoder&gt;<br> &lt;/appender&gt;<br> &lt;appender name=&quot;R&quot;<br>  class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;<br>  &lt;encoder class=&quot;ch.qos.logback.core.encoder.LayoutWrappingEncoder&quot;&gt;<br>  &lt;layout class=&quot;ch.qos.logback.classic.html.HTMLLayout&quot;&gt;<br>&nbsp;&nbsp;  &lt;pattern&gt;%d{yy-MM-dd HH:mm:ss}%level%t%(%C{1}.%M(%L\))%msg&lt;/pattern&gt;<br>&nbsp;&nbsp;  &lt;/layout&gt;<br>  &lt;/encoder&gt;<br>  &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;<br>&nbsp;&nbsp;  &lt;MaxHistory&gt;7&lt;/MaxHistory&gt;<br>&nbsp;&nbsp;  &lt;FileNamePattern&gt;${fileName}.log.%d{yyyy-MM-dd}.html&lt;/FileNamePattern&gt;<br>  &lt;/rollingPolicy&gt;<br> &lt;/appender&gt;<br> &lt;logger name=&quot;ch.qos.logback&quot; level=&quot;WARN&quot; /&gt;<br> &lt;logger name=&quot;org.springframework&quot; level=&quot;WARN&quot; /&gt;<br> &lt;logger name=&quot;org.hibernate&quot; level=&quot;WARN&quot; /&gt;<br> &lt;logger name=&quot;org.hibernate.cfg&quot; level=&quot;WARN&quot; /&gt;<br> &lt;!-- <br> &lt;logger name=&quot;org.hibernate.hql&quot; level=&quot;DEBUG&quot; /&gt;<br>  --&gt;<br> &lt;logger name=&quot;org.hibernate.SQL&quot; level=&quot;TRACE&quot; /&gt;<br> &lt;logger name=&quot;org.hibernate.type&quot; level=&quot;WARN&quot; /&gt;<br><br> &lt;logger name=&quot;org.apache.tapestry5&quot; level=&quot;WARN&quot; /&gt;<br> &lt;root level=&quot;INFO&quot;&gt;<br>  &lt;appender-ref ref=&quot;stdout&quot; /&gt;<br>  &lt;appender-ref ref=&quot;R&quot; /&gt;<br> &lt;/root&gt;<br>&lt;/configuration&gt;</pre></div></body></html>