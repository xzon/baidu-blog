<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Thymeleaf 2.0新特性一览</title></head><body><h1>Thymeleaf 2.0新特性一览</h1><div><div><p></p><h1>Thymeleaf 2.0新特性一览</h1><p>作者&nbsp;<strong><a href="http://www.infoq.com/cn/author/Bienvenido-David-III">Bienvenido David III</a>&nbsp;</strong>译者&nbsp;<strong><a href="http://www.infoq.com/cn/author/%E6%9B%B9%E5%A6%82%E8%BF%9B">曹如进</a>&nbsp;</strong>发布于 2012年3月4日</p><p>&nbsp;</p><p><a href="http://www.infoq.com/cn/news/2012/03/thymeleaf-2-0">http://www.infoq.com/cn/news/2012/03/thymeleaf-2-0</a></p><p>&nbsp;</p><p>Thymeleaf是一个面向Java的XML/HTML模板引擎，它的主要目标是提供格式良好的模板创建方式。<a href="http://www.thymeleaf.org/whatsnew20.html" style="color: #0b59b2;">Thymeleaf 2.0</a>包含了许多新特性，其中包括为Thymeleaf扩展开发人员改善了扩展的创建过程。下面让我们快速浏览一下这些新增的特性：</p><h3>性能</h3><p>Thymeleaf内部架构进行了重新设计，模板执行引擎被彻底重写。这意味着巨大的性能提升。<a href="http://www.thymeleaf.org/benchmarking20.html" style="color: #0b59b2;">基准测试</a>显示执行时间从之前的4.19ms降到现在的1.26ms。</p><h3>th:switch/th:case</h3><p>th:switch中指定的表达式在估值后，会与内部th:case属性（attribute）中的表达式结果进行比较。其中“*”被用来指定默认选项。而在以前的版本中，开发人员需要为每一个p元素指定一个th:if。</p><p>&nbsp;&lt;div th:switch=&quot;${user.role}&quot;&gt;<br />&nbsp; &lt;p th:case=&quot;'admin'&quot;&gt;Administrator&lt;/p&gt;<br />&nbsp; &lt;p th:case=&quot;*&quot;&gt;User&lt;/p&gt;<br />&lt;/div&gt;</p><h3>th:remove=&quot;all-but-first&quot;</h3><p>创建一个表格模板，一般意味着你会移除多余的占位符行。新的th:remove=&quot;all-but-first&quot; 可以更轻松地完成这项工作。此前，开发人员必须为表格中所有待删除的行放上th:remove=&quot;all&quot;语句。</p><p>&nbsp;&lt;table th:remove=&quot;all-but-first&quot;&gt;<br />&nbsp; &lt;tr th:each=&quot;user : ${users}&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&lt;td th:text=&quot;${user.name}&quot;&gt;John&lt;/td&gt;<br />&nbsp; &lt;/tr&gt;<br />&nbsp; &lt;tr&gt;<br />&nbsp;&nbsp; &lt;td&gt;Joe&lt;/td&gt;<br />&nbsp; &lt;/tr&gt;<br />&nbsp; &lt;tr&gt;<br />&nbsp;&nbsp; &lt;td&gt;Mike&lt;/td&gt;<br />&nbsp; &lt;/tr&gt;<br />&lt;/table&gt;</p><h3>行号信息</h3><p>在呼声最高的功能中，有一个呼声是希望Thymeleaf在解析模板碰到错误时能够输出行号信息。多亏新的模板引擎，现在这项功能已经有了。</p><h3>DOM选择器</h3><p>Thymeleaf 1.1中可以通过指定XPath表达式来包含模板片段。由于模板引擎重写，Thymeleaf 2.0中使用了一个叫做“DOM选择器”的功能替换了对XPath的支持。使用DOM选择器可以选择DOM中一块特定区域，也可以使用XPath语法的一部分子集。</p><ul><li>/x 表示当前结点直接孩子中名字为x的元素结点；</li><li>//x 表示当前节点任意深度的子孙结点中名字为x的元素结点；</li><li>x[@z='v'] 表示名字为x，且属性z的值为“v”的元素结点 ；</li><li>x[@z1='v1' and @z2='v2'] 表示名字为x，且属性z1和z2值分别为“v1”和“v2”的元素结点；</li><li>x[i] 表示名字为x，且位置在兄弟结点中排在数字i的元素结点；</li><li>x[@z='v'][i] 表示名字为x，属性z的值为“v”，且满足位置在兄弟结点中排在数字i的元素结点；</li></ul><h3>模板片段</h3><p>新的模板引擎允许开发人员处理模板片段而不再是整个XML文档，例如，现在不需要DOCTYPE或文档根元素，且模板可以只是某个XML片段。</p><h3>通用缓存基础架构（Generalized Cache Infrastructure）</h3><p>Thymeleaf 2.0更新了缓存基础架构，并给予开发人员控制缓存的用途以及怎样使用缓存。新的ICacheManager接口定义的扩展点，允许用户指定他们自己的ICache实现。StandardCacheManager被列为ICacheManager的默认实现。</p><h3>新的XHTML DTD</h3><p>新引入的th:switch和th:case属性需要Thymeleaf DTD中作出一些改变。以下是新的DTD：</p><p>&nbsp;&lt;!DOCTYPE html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-3.dtd&quot;&gt;<br />&lt;!DOCTYPE html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-transitional-thymeleaf-3.dtd&quot;&gt;<br />&lt;!DOCTYPE html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-frameset-thymeleaf-3.dtd&quot;&gt;</p><p>&nbsp;&lt;!DOCTYPE html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring3-3.dtd&quot;&gt;<br />&lt;!DOCTYPE html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-transitional-thymeleaf-spring3-3.dtd&quot;&gt;<br />&lt;!DOCTYPE html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-frameset-thymeleaf-spring3-3.dtd&quot;&gt;</p><h3>替换Java DOM API</h3><p>Thymeleaf 2.0从架构中移除了Java DOM API，并替换成它自己的DOM表示。新的DOM为Thymeleaf量身订做，并且比旧标准更加简单。 它还包含了一些优化，可以让Thymeleaf在具有较少资源的情况下也可以较快地处理模板。</p><h3>IProcessor</h3><p>在Thymeleaf 1.1中，处理器被分为两组：属性处理器（attribute processor）和标签处理器（tag processor）。在Thymeleaf 2.0中，新的DOM泛化了模式，属性处理器和标签/元素处理器现在都是新的通用IProcessor接口的子级。这意味着处理器可以应用到任何DOM结点上，如元素、文本节点和注释等等。</p><h3>通用模板模式（Generalized Template Modes）</h3><div>Thymeleaf 2.0泛化了模板模式，它可以让Thymeleaf扩展开发人员创建他们自己的模板模式，而不局限于6个标准的模板模式（XML，VALIDXML，XHTML，VALIDXHTML，HTML5 和LEGACYHTML5）。模板模式现在必须在模板解析器配置中以字符串形式指定，而不是使用已经弃用的TemplateMode枚举。</div><p>想要了解更多信息，请访问Thymeleaf&nbsp;<a href="http://www.thymeleaf.org/" style="color: #0b59b2;">网站</a>&nbsp;和<a href="http://www.thymeleaf.org/doc/changelog/thymeleaf/ChangeLog.txt" style="color: #0b59b2;">更新日志</a>。</p><p><strong>查看英文原文：</strong><a href="http://www.infoq.com/news/2012/02/thymeleaf-2-0" style="color: #0b59b2;">http://www.infoq.com/news/2012/02/thymeleaf-2-0</a></p><p>&nbsp;</p><p></p></div><p><h1></h1></p><p><p><a href="http://www.infoq.com/news/2012/02/thymeleaf-2-0" style="color: #0b59b2;"></a></p></p><p></p></div></body></html>