<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>NETSH命令</title></head><body><h1>NETSH命令</h1><div><div class="cnt">
<h2 class="diaryTitle">NETSH命令</h2>
<strong>关键词</strong>： <a target="_blank" href="http://tag.bokee.com/tag/Netsh">Netsh</a> &nbsp;&nbsp;  <a target="_blank" href="http://tag.bokee.com/tag/%C3%FC%C1%EE">命令</a> &nbsp;&nbsp;  <a target="_blank" href="http://tag.bokee.com/tag/ip">ip</a> &nbsp;&nbsp;  <a target="_blank" href="http://tag.bokee.com/tag/%C5%E4%D6%C3">配置</a> &nbsp;&nbsp;  <a target="_blank" href="http://tag.bokee.com/tag/windows">windows</a> &nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<p> </p>
<p>C:\Documents and Settings&gt;netsh<br>
netsh&gt;interface<br>
netsh interface&gt;ip<br>
netsh interface ip&gt;add address &quot;本地连接&quot; 192.168.10.5 255.255.255.0 192.168.10.1 1<br>
确定。</p>
<p>netsh interface ip&gt;</p>
<p>C:\Documents and Settings&gt;netsh<br>
netsh&gt;interface<br>
netsh interface&gt;ip<br>
netsh interface ip&gt;?</p>
<p>下列指令有效:</p>
<p>命令从 netsh 上下文继承:<br>
..&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 移到上一层上下文级。<br>
abort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 丢弃在脱机模式下所做的更改。<br>
add&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 在项目列表上添加一个配置项目。<br>
alias&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 添加一个别名<br>
bridge&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 更改到 `netsh bridge' 上下文。<br>
bye&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 退出程序。<br>
commit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 提交在脱机模式中所做的更改。<br>
delete&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 在项目列表上删除一个配置项目。<br>
diag&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 更改到 `netsh diag' 上下文。<br>
exit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 退出程序。<br>
interface&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 更改到 `netsh interface' 上下文。<br>
offline&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 将当前模式设置成脱机。<br>
online&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 将当前模式设置成联机。<br>
popd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 从堆栈上打开一个上下文。<br>
pushd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 将当前上下文放推入堆栈。<br>
quit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 退出程序。<br>
ras&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 更改到 `netsh ras' 上下文。<br>
routing&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 更改到 `netsh routing' 上下文。<br>
set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 更新配置设置。<br>
show&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 显示信息<br>
unalias&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 删除一个别名。</p>
<p>命令从 netsh interface 上下文继承:<br>
add&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 向表中添加一个配置项目。<br>
delete&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 从表中删除一个配置项目。<br>
ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 更改到 `netsh interface ip' 上下文。<br>
reset&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 复位信息。<br>
set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 设置配置信息。<br>
show&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 显示信息。</p>
<p>此上下文中的命令:<br>
?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 显示命令列表。<br>
add&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 向表中添加一个配置项目。<br>
delete&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 从表中删除一个配置项目。<br>
dump&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 显示一个配置脚本。<br>
help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 显示命令列表。<br>
reset&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 复位 TCP/IP 及相关的组件到干净的状态。<br>
set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 设置配置信息。<br>
show&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 显示信息。</p>
<p>若需要命令的更多帮助信息，请键入命令，<br>
后面跟 ?。</p>
<p>netsh interface ip&gt;set</p>
<p>下列指令有效:</p>
<p>命令从 netsh 上下文继承:<br>
set file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 复制控制台输出到文件。<br>
set machine&nbsp;&nbsp;&nbsp;  - 设置用来操作的当前计算机。<br>
set mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 设置当前模式为联机或脱机。</p>
<p>此上下文中的命令:<br>
set address&nbsp;&nbsp;&nbsp;  - 设置指定的接口的 IP 地址或默认网关。<br>
set dns&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 设置 DNS 服务器模式和地址。<br>
set wins&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 设置 WINS 服务器模式和地址。<br>
netsh interface ip&gt;set dns &quot;本地连接&quot; static 61.18.34.69<br>
确定。</p>
<p>netsh interface ip&gt;add</p>
<p>下列指令有效:</p>
<p>命令从 netsh 上下文继承:<br>
add helper&nbsp;&nbsp;&nbsp;&nbsp;  - 安装一个助手 DLL。</p>
<p>此上下文中的命令:<br>
add address&nbsp;&nbsp;&nbsp;  - 添加一个 IP 地址到指定的接口。<br>
add dns&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 添加一个静态 DNS 服务器地址。<br>
add wins&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 添加一个静态 WINS 服务器地址。<br>
netsh interface ip&gt;add dns<br>
用法: add dns [name=]<string></string> [addr=]<ip></ip> [[index=]<integer></integer>]</p>
<p>参数:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  标记&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  值<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 添加 DNS 服务器的接口的名称。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  addr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 添加的 DNS 服务器的 IP 地址。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  - 为指定的 DNS 服务器地址指定索引(首选项)。</p>
<p>注释:&nbsp;&nbsp;&nbsp;  把一个新的 DNS 服务器 IP 地址添加到静态配置的列表中。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  默认情况下，这个DNS 服务器被添加在列表的结尾。如果指定一个索引，DNS 服<br>
务器将被置于列表中指定的位置，其他服务器将被移后留出空间。如果 DNS 服务器以前是<br>
通过 DHCP 获取的，这个新的地址将取代旧的列表。</p>
<p>示例:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  add dns &quot;Local Area Connection&quot; 10.0.0.1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  add dns &quot;Local Area Connection&quot; 10.0.0.3 index=2</p>
<p>netsh interface ip&gt;add dns &quot;本地连接&quot; 61.18.39.63<br>
确定。</p>
<p>netsh interface ip&gt;</p>
<p>注：设置第二个DNS的时候就不能用set命令了，否则会盖掉第一个DNS配置，应该使用add dns子命令！</p>
<p>NetSh 命令 <br>
　　list 列出所有可用的 WINS 命令。 <br>
　　dump 将 WINS 服务器配置转储到命令输出。 <br>
　　add name 在服务器上注册名称。详细信息，请输入 add name /? <br>
　　add partner 向服务器添加复制伙伴。详细信息，请输入 add partner /? <br>
　　add pngserver 添加当前服务器的 Persona Non Grata 服务器列表。详细信息，请输入 add pngserver /? <br>
　　check database 检查数据库的一致性。详细信息，请输入 check database /? <br>
　　check name 检查一组 WINS 服务器的名称记录列表。详细信息，请输入 check name /? <br>
　　check version 检查版本号的一致性。详细信息，请输入 check version /? <br>
　　delete name 从服务器数据库中删除已注册的名称。详细信息，请输入 delete name /? <br>
　　delete partner 从复制伙伴列表中删除复制伙伴。详细信息，请输入 delete partner /? <br>
　　delete records 从服务器删除或逻辑删除所有记录或一组记录。详细信息，请输入 delete records /? <br>
　　delete owners 删除所有者列表及其记录。详细信息，请输入 delete owners /? <br>
　　delete pngserver 从列表中删除所有的或选定的 Persona Non Grata 服务器。详细信息，请输入 delete pngserver /? <br>
　　init backup 备份 WINS 数据库。详细信息，请输入 init backup /? <br>
　　init import 从 Lmhosts 文件导入数据。详细信息，请输入 init import /? <br>
　　init pull 启动&ldquo;拉&rdquo;触发器，并发送给另一台 WINS 服务器。详细信息，请输入 init pull /? <br>
　　init pullrange 开始另一台 WINS 服务器的一组记录，并读取该记录。详细信息，请输入 init pullrange /? <br>
　　init push 启动&ldquo;推&rdquo;触发器，并发送给另一台 WINS 服务器。详细信息，请输入 init push /? <br>
　　init replicate 用复制伙伴复制数据库。详细信息，请输入 init replicate /? <br>
　　init restore 从文件还原数据库。详细信息，请输入 init restore /? <br>
　　init scavenge 清除服务器的 WINS 数据库。详细信息，请输入 init scavenge /? <br>
　　init search 搜索服务器的 WINS 数据库。详细信息，请输入 init search /? <br>
　　reset statistics 重置服务器的统计信息。详细信息，请输入 reset statistics /? <br>
　　set autopartnerconfig 设置服务器的自动复制伙伴配置信息。详细信息，请输入 set autopartnerconfig /? <br>
　　set backuppath 设置服务器的备份参数。详细信息，请输入 set backuppath /? <br>
　　set burstparam 设置服务器的突发处理参数。详细信息，请输入 set autopartnerconfig /? <br>
　　set logparam 设置数据库和事件日志记录选项。详细信息，请输入 set logparam /? <br>
　　set migrateflag 设置服务器的迁移标志。详细信息，请输入 set migrateflag /? <br>
　　set namerecord 设置服务器的间隔和超时值。详细信息，请输入 set namerecord /? <br>
　　set periodicdbchecking 设置服务器的定期数据库检查参数。详细信息，请输入 set periodicdbchecking /? <br>
　　set pullpartnerconfig 设置指定的&ldquo;拉&rdquo;伙伴的配置参数。详细信息，请输入 set pullpartnerconfig /? <br>
　　set pushpartnerconfig 设置指定的&ldquo;推&rdquo;伙伴的配置参数。详细信息，请输入 set pushpartnerconfig /? <br>
　　set pullparam 设置服务器的默认&ldquo;拉&rdquo;参数。详细信息，请输入 set pullparam /? <br>
　　set pushparam 设置服务器的默认&ldquo;推&rdquo;参数。详细信息，请输入 set pushparam /? <br>
　　set replicateflag 设置服务器的复制标志。详细信息，请输入 set replicateflag /? <br>
　　set startversion 设置数据库的开始版本 ID。详细信息，请输入 set startversion /? <br>
　　show browser 显示所有活动域主浏览器的 [1Bh] 记录。详细信息，请输入 show browser /? <br>
　　show database 显示指定服务器的数据库和记录。详细信息，请输入 show database /? <br>
　　show info 显示配置信息。详细信息，请输入 show info /? <br>
　　show name 显示服务器中特定记录的详细信息。详细信息，请输入 show name /? <br>
　　show partner 显示服务器的&ldquo;拉&rdquo;或&ldquo;推&rdquo;（或&ldquo;推拉&rdquo;）伙伴。详细信息，请输入 show partner /? <br>
　　show partnerproperties 显示默认伙伴配置。详细信息，请输入 show partnerproperties /? <br>
　　show pullpartnerconfig 显示&ldquo;拉&rdquo;伙伴的配置信息。详细信息，请输入 show pullpartnerconfig /? <br>
　　show pushpartnerconfig 显示&ldquo;推&rdquo;伙伴的配置信息。详细信息，请输入 show pushpartnerconfig /? <br>
　　show reccount 显示指定服务器所拥有的记录数量。详细信息，请输入 show reccount /? <br>
　　show recbyversion 显示指定服务器所拥有的记录。详细信息，请输入 show recbyversion /? <br>
　　show server 显示当前选定的服务器。详细信息，请输入 show server /? <br>
　　show statistics 显示 WINS 服务器的统计信息。详细信息，请输入 show statistics /? <br>
　　show version 显示 WINS 服务器的当前版本计数器值。详细信息，请输入 show version /? <br>
　　show versionmap 显示所有者 ID 到&ldquo;最大版本数&rdquo;的映射。详细信息，请输入 show versionmap /? <br>
　　Interface 命令 <br>
　　interface set/show interface 启用、禁用、连接、断开连接以及显示请求拨号接口的配置。 <br>
　　interface set/show credentials 在请求拨号接口上配置或显示用户名、密码和域名。</p>
</div>
<br></div></body></html>