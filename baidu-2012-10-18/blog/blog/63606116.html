<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>在java中用JDBC连接SQL Server 2000 的注意项</title></head><body><h1>在java中用JDBC连接SQL Server 2000 的注意项</h1><div><table class="buttomBorder FCK__ShowTableBorders" border="0" cellspacing="3" cellpadding="3" width="100%">
    <tbody>
        <tr>
            <td class="contentTitle" align="center">在java中用JDBC连接SQL Server 2000 的注意项 <hr width="70%">
            </td>
        </tr>
        <tr>
            <td align="center">2005-07-21 来源:Java资源网 作者:Java资源网</td>
        </tr>
        <tr>
            <td class="content" valign="top" align="left"><font face="Arial">一.&nbsp;&nbsp;&nbsp;&nbsp;  从网上下并装MS的JDBC sp3的安装程序.<br>
            二.&nbsp;&nbsp;&nbsp;&nbsp;  安装成功后,设置classpath,在classpath添加&nbsp;&nbsp;  install_dir\lib\msbase.jar; install_dir\lib\msutil.jar; install_dir\lib\mssqlserver.jar;<br>
            三.&nbsp;&nbsp;&nbsp;&nbsp;  当第二步安成以后,你可以用以下通用代码测试是否可以连接到数据库;<br>
            import java.sql.*;<br>
            class Test{//本程序在jdk1.4.2下调试通过.<br>
            &nbsp;&nbsp;&nbsp;&nbsp;  public static void main(String args[])<br>
            &nbsp;&nbsp;&nbsp;&nbsp;  {<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  String url = &quot;jdbc:microsoft:sqlserver://localhost:1433;DatabaseName=Northwind&quot;;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  String user =&quot;sa&quot;;//这里替换成你自已的数据库用户名<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  String password = &quot;sa&quot;;//这里替换成你自已的数据库用户密码<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  String sqlStr = &quot;select CustomerID, CompanyName, ContactName from Customers&quot;;<br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  try{&nbsp;&nbsp;&nbsp;&nbsp;  //这里的异常处理语句是必需的.否则不能通过编译!&nbsp;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Class.forName(&quot;com.microsoft.jdbc.sqlserver.SQLServerDriver&quot;);<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println( &quot;类实例化成功!&quot; );<br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Connection con = DriverManager.getConnection( url, user, password );<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println( &quot;创建连接对像成功!&quot; );<br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Statement st = con.createStatement();<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println( &quot;创建Statement成功!&quot; );<br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ResultSet rs = st.executeQuery( sqlStr );<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println( &quot;操作数据表成功!&quot; );<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println( &quot;----------------!&quot; );<br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  while(rs.next())<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  {<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.print(rs.getString(&quot;CustomerID&quot;) + &quot;&nbsp;&nbsp;&nbsp;&nbsp;  &quot;);<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.print(rs.getString(&quot;CompanyName&quot;) + &quot;&nbsp;&nbsp;&nbsp;&nbsp;  &quot;);<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println(rs.getString(&quot;ContactName&quot;));<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  rs.close();<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  st.close();<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  con.close();<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  catch(Exception err){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  err.printStackTrace(System.out);<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
            &nbsp;&nbsp;&nbsp;&nbsp;  }<br>
            }<br>
            <br>
            如果一切都通过并且,在控制台中显示出了数据库中的记录那么说明数据库一定连接成功了!当然,一般来说的话.如果你是第一次连接数据库的话,一定不会这么顺利.所以还要注意以下事项:<br>
            1.&nbsp;&nbsp;&nbsp;&nbsp;  一定要仔细的检查你的classpath,一定不能有一定的错误,比如说,把sqlserver.jar少写一个r,写成sqlsever.jar;等等.这是很多人常犯的一个错误.<br>
            2.&nbsp;&nbsp;&nbsp;&nbsp;  数据库一定要用Windows和数据库混合身分验证方式.</font></td>
        </tr>
    </tbody>
</table></div></body></html>