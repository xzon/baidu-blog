<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>RFC2313 - PKCS #1: RSA Encryption Version 1.5</title></head><body><h1>RFC2313 - PKCS #1: RSA Encryption Version 1.5</h1><div><p><strong><font color="#000000">RFC2313 - PKCS #1: RSA Encryption Version 1.5</font></strong></p>
<strong>
<p align="left"><font color="#000000">Network Working Group B. Kaliski<br>
Request for Comments: 2313 RSA Laboratories East<br>
Category: Informational March 1998<br>
<br>
PKCS #1: RSA Encryption<br>
Version 1.5<br>
<br>
Status of this Memo<br>
<br>
This memo provides information for the Internet community. It does<br>
not specify an Internet standard of any kind. Distribution of this<br>
memo is unlimited.<br>
<br>
Copyright Notice<br>
<br>
Copyright (C) The Internet Society (1998). All Rights Reserved.<br>
<br>
Overview<br>
<br>
This document describes a method for encrypting data using the RSA<br>
public-key cryptosystem.<br>
<br>
1. Scope<br>
<br>
This document describes a method for encrypting data using the RSA<br>
public-key cryptosystem. Its intended use is in the construction of<br>
digital signatures and digital envelopes, as described in PKCS #7:<br>
<br>
o For digital signatures, the content to be signed<br>
is first reduced to a message digest with a<br>
message-digest algorithm (such as MD5), and then<br>
an octet string containing the message digest is<br>
encrypted with the RSA private key of the signer<br>
of the content. The content and the encrypted<br>
message digest are represented together according<br>
to the syntax in PKCS #7 to yield a digital<br>
signature. This application is compatible with<br>
Privacy-Enhanced Mail (PEM) methods.<br>
<br>
o For digital envelopes, the content to be enveloped<br>
is first encrypted under a content-encryption key<br>
with a content-encryption algorithm (such as DES),<br>
and then the content-encryption key is encrypted<br>
with the RSA public keys of the recipients of the<br>
content. The encrypted content and the encrypted<br>
<br>
content-encryption key are represented together<br>
according to the syntax in PKCS #7 to yield a<br>
digital envelope. This application is also<br>
compatible with PEM methods.<br>
<br>
The document also describes a syntax for RSA public keys and private<br>
keys. The public-key syntax would be used in certificates; the<br>
private-key syntax would be used typically in PKCS #8 private-key<br>
information. The public-key syntax is identical to that in both X.509<br>
and Privacy-Enhanced Mail. Thus X.509/PEM RSA keys can be used in<br>
this document.<br>
<br>
The document also defines three signature algorithms for use in<br>
signing X.509/PEM certificates and certificate-revocation lists, PKCS<br>
#6 extended certificates, and other objects employing digital<br>
signatures such as X.401 message tokens.<br>
<br>
Details on message-digest and content-encryption algorithms are<br>
outside the scope of this document, as are details on sources of the<br>
pseudorandom bits required by certain methods in this document.<br>
<br>
2. References<br>
<br>
FIPS PUB 46-1 National Bureau of Standards. FIPS PUB 46-1:<br>
Data Encryption Standard. January 1988.<br>
<br>
PKCS #6 RSA Laboratories. PKCS #6: Extended-Certificate<br>
Syntax. Version 1.5, November 1993.<br>
<br>
PKCS #7 RSA Laboratories. PKCS #7: Cryptographic Message<br>
Syntax. Version 1.5, November 1993.<br>
<br>
PKCS #8 RSA Laboratories. PKCS #8: Private-Key Information<br>
Syntax. Version 1.2, November 1993.<br>
<br>
</font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1319 Kaliski, B., &quot;The MD2 Message-Digest<br>
Algorithm,&quot; </font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1319, April 1992.<br>
<br>
</font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1320 Rivest, R., &quot;The MD4 Message-Digest<br>
Algorithm,&quot; </font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1320, April 1992.<br>
<br>
</font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1321 Rivest, R., &quot;The MD5 Message-Digest<br>
Algorithm,&quot; </font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1321, April 1992.<br>
<br>
</font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1423 Balenson, D., &quot;Privacy Enhancement for<br>
Internet Electronic Mail: Part III: Algorithms,<br>
Modes, and Identifiers,&quot; </font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1423, February 1993.<br>
<br>
X.208 CCITT. Recommendation X.208: Specification of<br>
Abstract Syntax Notation One (ASN.1). 1988.<br>
<br>
X.209 CCITT. Recommendation X.209: Specification of<br>
Basic Encoding Rules for Abstract Syntax Notation<br>
One (ASN.1). 1988.<br>
<br>
X.411 CCITT. Recommendation X.411: Message Handling<br>
Systems: Message Transfer System: Abstract Service<br>
Definition and Procedures.1988.<br>
<br>
X.509 CCITT. Recommendation X.509: The Directory--<br>
Authentication Framework. 1988.<br>
<br>
[dBB92] B. den Boer and A. Bosselaers. An attack on the<br>
last two rounds of MD4. In J. Feigenbaum, editor,<br>
Advances in Cryptology---CRYPTO '91 Proceedings,<br>
volume 576 of Lecture Notes in Computer Science,<br>
pages 194-203. Springer-Verlag, New York, 1992.<br>
<br>
[dBB93] B. den Boer and A. Bosselaers. Collisions for the<br>
compression function of MD5. Presented at<br>
EUROCRYPT '93 (Lofthus, Norway, May 24-27, 1993).<br>
<br>
[DO86] Y. Desmedt and A.M. Odlyzko. A chosen text attack<br>
on the RSA cryptosystem and some discrete<br>
logarithm schemes. In H.C. Williams, editor,<br>
Advances in Cryptology---CRYPTO '85 Proceedings,<br>
volume 218 of Lecture Notes in Computer Science,<br>
pages 516-521. Springer-Verlag, New York, 1986.<br>
<br>
[Has88] Johan Hastad. Solving simultaneous modular<br>
equations. SIAM Journal on Computing,<br>
17(2):336-341, April 1988.<br>
<br>
[IM90] Colin I'Anson and Chris Mitchell. Security defects<br>
in CCITT Recommendation X.509--The directory<br>
authentication framework. Computer Communications<br>
Review, :30-34, April 1990.<br>
<br>
[Mer90] R.C. Merkle. Note on MD4. Unpublished manuscript,<br>
1990.<br>
<br>
[Mil76] G.L. Miller. Riemann's hypothesis and tests for<br>
primality. Journal of Computer and Systems<br>
Sciences, 13(3):300-307, 1976.<br>
<br>
[QC82] J.-J. Quisquater and C. Couvreur. Fast<br>
decipherment algorithm for RSA public-key<br>
cryptosystem. Electronics Letters, 18(21):905-907,<br>
October 1982.<br>
<br>
[RSA78] R.L. Rivest, A. Shamir, and L. Adleman. A method<br>
for obtaining digital signatures and public-key<br>
cryptosystems. Communications of the ACM,<br>
21(2):120-126, February 1978.<br>
<br>
3. Definitions<br>
<br>
For the purposes of this document, the following definitions apply.<br>
<br>
AlgorithmIdentifier: A type that identifies an algorithm (by object<br>
identifier) and associated parameters. This type is defined in X.509.<br>
<br>
ASN.1: Abstract Syntax Notation One, as defined in X.208.<br>
<br>
BER: Basic Encoding Rules, as defined in X.209.<br>
<br>
DES: Data Encryption Standard, as defined in FIPS PUB 46-1.<br>
<br>
MD2: RSA Data Security, Inc.'s MD2 message-digest algorithm, as<br>
defined in </font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1319.<br>
<br>
MD4: RSA Data Security, Inc.'s MD4 message-digest algorithm, as<br>
defined in </font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1320.<br>
<br>
MD5: RSA Data Security, Inc.'s MD5 message-digest algorithm, as<br>
defined in </font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1321.<br>
<br>
modulus: Integer constructed as the product of two primes.<br>
<br>
PEM: Internet Privacy-Enhanced Mail, as defined in </font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1423 and<br>
related documents.<br>
<br>
RSA: The RSA public-key cryptosystem, as defined in [RSA78].<br>
<br>
private key: Modulus and private exponent.<br>
<br>
public key: Modulus and public exponent.<br>
<br>
4. Symbols and abbreviations<br>
<br>
Upper-case symbols (e.g., BT) denote octet strings and bit strings<br>
(in the case of the signature S); lower-case symbols (e.g., c) denote<br>
integers.<br>
<br>
ab hexadecimal octet value c exponent<br>
BT block type d private exponent<br>
D data e public exponent<br>
EB encryption block k length of modulus in<br>
octets<br>
ED encrypted data n modulus<br>
M message p, q prime factors of modulus<br>
MD message digest x integer encryption block<br>
MD' comparative message y integer encrypted data<br>
digest<br>
PS padding string mod n modulo n<br>
S signature X || Y concatenation of X, Y<br>
||X|| length in octets of X<br>
5. General overview<br>
<br>
The next six sections specify key generation, key syntax, the<br>
encryption process, the decryption process, signature algorithms, and<br>
object identifiers.<br>
<br>
Each entity shall generate a pair of keys: a public key and a private<br>
key. The encryption process shall be performed with one of the keys<br>
and the decryption process shall be performed with the other key.<br>
Thus the encryption process can be either a public-key operation or a<br>
private-key operation, and so can the decryption process. Both<br>
processes transform an octet string to another octet string. The<br>
processes are inverses of each other if one process uses an entity's<br>
public key and the other process uses the same entity's private key.<br>
<br>
The encryption and decryption processes can implement either the<br>
classic RSA transformations, or variations with padding.<br>
<br>
6. Key generation<br>
<br>
This section describes RSA key generation.<br>
<br>
Each entity shall select a positive integer e as its public exponent.<br>
<br>
Each entity shall privately and randomly select two distinct odd<br>
primes p and q such that (p-1) and e have no common divisors, and<br>
(q-1) and e have no common divisors.<br>
<br>
The public modulus n shall be the product of the private prime<br>
factors p and q:<br>
<br>
n = pq .<br>
<br>
The private exponent shall be a positive integer d such that de-1 is<br>
divisible by both p-1 and q-1.<br>
<br>
The length of the modulus n in octets is the integer k satisfying<br>
<br>
2^(8(k-1)) &lt;= n &lt; 2^(8k) .<br>
<br>
The length k of the modulus must be at least 12 octets to accommodate<br>
the block formats in this document (see Section 8).<br>
<br>
Notes.<br>
<br>
1. The public exponent may be standardized in<br>
specific applications. The values 3 and F4 (65537) may have<br>
some practical advantages, as noted in X.509 Annex C.<br>
<br>
2. Some additional conditions on the choice of primes<br>
may well be taken into account in order to deter<br>
factorization of the modulus. These security conditions<br>
fall outside the scope of this document. The lower bound on<br>
the length k is to accommodate the block formats, not for<br>
security.<br>
<br>
7. Key syntax<br>
<br>
This section gives the syntax for RSA public and private keys.<br>
<br>
7.1 Public-key syntax<br>
<br>
An RSA public key shall have ASN.1 type RSAPublicKey:<br>
<br>
RSAPublicKey ::= SEQUENCE {<br>
modulus INTEGER, -- n<br>
publicExponent INTEGER -- e }<br>
<br>
(This type is specified in X.509 and is retained here for<br>
compatibility.)<br>
<br>
The fields of type RSAPublicKey have the following meanings:<br>
<br>
o modulus is the modulus n.<br>
<br>
o publicExponent is the public exponent e.<br>
<br>
7.2 Private-key syntax<br>
<br>
An RSA private key shall have ASN.1 type RSAPrivateKey:<br>
<br>
RSAPrivateKey ::= SEQUENCE {<br>
version Version,<br>
modulus INTEGER, -- n<br>
publicExponent INTEGER, -- e<br>
privateExponent INTEGER, -- d<br>
prime1 INTEGER, -- p<br>
prime2 INTEGER, -- q<br>
exponent1 INTEGER, -- d mod (p-1)<br>
exponent2 INTEGER, -- d mod (q-1)<br>
coefficient INTEGER -- (inverse of q) mod p }<br>
<br>
Version ::= INTEGER<br>
<br>
The fields of type RSAPrivateKey have the following meanings:<br>
<br>
o version is the version number, for compatibility<br>
with future revisions of this document. It shall<br>
be 0 for this version of the document.<br>
<br>
o modulus is the modulus n.<br>
<br>
o publicExponent is the public exponent e.<br>
<br>
o privateExponent is the private exponent d.<br>
<br>
o prime1 is the prime factor p of n.<br>
<br>
o prime2 is the prime factor q of n.<br>
<br>
o exponent1 is d mod (p-1).<br>
<br>
o exponent2 is d mod (q-1).<br>
<br>
o coefficient is the Chinese Remainder Theorem<br>
coefficient q-1 mod p.<br>
<br>
Notes.<br>
<br>
1. An RSA private key logically consists of only the<br>
modulus n and the private exponent d. The presence of the<br>
values p, q, d mod (p-1), d mod (p-1), and q-1 mod p is<br>
intended for efficiency, as Quisquater and Couvreur have<br>
shown [QC82]. A private-key syntax that does not include<br>
<br>
all the extra values can be converted readily to the syntax<br>
defined here, provided the public key is known, according<br>
to a result by Miller [Mil76].<br>
<br>
2. The presence of the public exponent e is intended<br>
to make it straightforward to derive a public key from the<br>
private key.<br>
<br>
8. Encryption process<br>
<br>
This section describes the RSA encryption process.<br>
<br>
The encryption process consists of four steps: encryption- block<br>
formatting, octet-string-to-integer conversion, RSA computation, and<br>
integer-to-octet-string conversion. The input to the encryption<br>
process shall be an octet string D, the data; an integer n, the<br>
modulus; and an integer c, the exponent. For a public-key operation,<br>
the integer c shall be an entity's public exponent e; for a private-<br>
key operation, it shall be an entity's private exponent d. The output<br>
from the encryption process shall be an octet string ED, the<br>
encrypted data.<br>
<br>
The length of the data D shall not be more than k-11 octets, which is<br>
positive since the length k of the modulus is at least 12 octets.<br>
This limitation guarantees that the length of the padding string PS<br>
is at least eight octets, which is a security condition.<br>
<br>
Notes.<br>
<br>
1. In typical applications of this document to<br>
encrypt content-encryption keys and message digests, one<br>
would have ||D|| &lt;= 30. Thus the length of the RSA modulus<br>
will need to be at least 328 bits (41 octets), which is<br>
reasonable and consistent with security recommendations.<br>
<br>
2. The encryption process does not provide an<br>
explicit integrity check to facilitate error detection<br>
should the encrypted data be corrupted in transmission.<br>
However, the structure of the encryption block guarantees<br>
that the probability that corruption is undetected is less<br>
than 2-16, which is an upper bound on the probability that<br>
a random encryption block looks like block type 02.<br>
<br>
3. Application of private-key operations as defined<br>
here to data other than an octet string containing a<br>
message digest is not recommended and is subject to further<br>
study.<br>
<br>
4. This document may be extended to handle data of<br>
length more than k-11 octets.<br>
<br>
8.1 Encryption-block formatting<br>
<br>
A block type BT, a padding string PS, and the data D shall be<br>
formatted into an octet string EB, the encryption block.<br>
<br>
EB = 00 || BT || PS || 00 || D . (1)<br>
<br>
The block type BT shall be a single octet indicating the structure of<br>
the encryption block. For this version of the document it shall have<br>
value 00, 01, or 02. For a private- key operation, the block type<br>
shall be 00 or 01. For a public-key operation, it shall be 02.<br>
<br>
The padding string PS shall consist of k-3-||D|| octets. For block<br>
type 00, the octets shall have value 00; for block type 01, they<br>
shall have value FF; and for block type 02, they shall be<br>
pseudorandomly generated and nonzero. This makes the length of the<br>
encryption block EB equal to k.<br>
<br>
Notes.<br>
<br>
1. The leading 00 octet ensures that the encryption<br>
block, converted to an integer, is less than the modulus.<br>
<br>
2. For block type 00, the data D must begin with a<br>
nonzero octet or have known length so that the encryption<br>
block can be parsed unambiguously. For block types 01 and<br>
02, the encryption block can be parsed unambiguously since<br>
the padding string PS contains no octets with value 00 and<br>
the padding string is separated from the data D by an octet<br>
with value 00.<br>
<br>
3. Block type 01 is recommended for private-key<br>
operations. Block type 01 has the property that the<br>
encryption block, converted to an integer, is guaranteed to<br>
be large, which prevents certain attacks of the kind<br>
proposed by Desmedt and Odlyzko [DO86].<br>
<br>
4. Block types 01 and 02 are compatible with PEM RSA<br>
encryption of content-encryption keys and message digests<br>
as described in </font><a target="_blank" href="http://www.cnpaf.net/class/RfcAll/"><font color="#000000">RFC</font></a><font color="#000000">1423.<br>
<br>
5. For block type 02, it is recommended that the<br>
pseudorandom octets be generated independently for each<br>
encryption process, especially if the same data is input to<br>
more than one encryption process. Hastad's results [Has88]<br>
motivate this recommendation.<br>
<br>
6. For block type 02, the padding string is at least<br>
eight octets long, which is a security condition for<br>
public-key operations that prevents an attacker from<br>
recoving data by trying all possible encryption blocks. For<br>
simplicity, the minimum length is the same for block type<br>
01.<br>
<br>
7. This document may be extended in the future to<br>
include other block types.<br>
<br>
8.2 Octet-string-to-integer conversion<br>
<br>
The encryption block EB shall be converted to an integer x, the<br>
integer encryption block. Let EB1, ..., EBk be the octets of EB from<br>
first to last. Then the integer x shall satisfy<br>
<br>
k<br>
x = SUM 2^(8(k-i)) EBi . (2)<br>
i = 1<br>
<br>
In other words, the first octet of EB has the most significance in<br>
the integer and the last octet of EB has the least significance.<br>
<br>
Note. The integer encryption block x satisfies 0 &lt;= x &lt; n since EB1<br>
= 00 and 2^(8(k-1)) &lt;= n.<br>
<br>
8.3 RSA computation<br>
<br>
The integer encryption block x shall be raised to the power c modulo<br>
n to give an integer y, the integer encrypted data.<br>
<br>
y = x^c mod n, 0 &lt;= y &lt; n .<br>
<br>
This is the classic RSA computation.<br>
<br>
8.4 Integer-to-octet-string conversion<br>
<br>
The integer encrypted data y shall be converted to an octet string ED<br>
of length k, the encrypted data. The encrypted data ED shall satisfy<br>
<br>
k<br>
y = SUM 2^(8(k-i)) EDi . (3)<br>
i = 1<br>
<br>
where ED1, ..., EDk are the octets of ED from first to last.<br>
<br>
In other words, the first octet of ED has the most significance in<br>
the integer and the last octet of ED has the least significance.<br>
<br>
9. Decryption process<br>
<br>
This section describes the RSA decryption process.<br>
<br>
The decryption process consists of four steps: octet-string-to-<br>
integer conversion, RSA computation, integer-to-octet-string<br>
conversion, and encryption-block parsing. The input to the decryption<br>
process shall be an octet string ED, the encrypted data; an integer<br>
n, the modulus; and an integer c, the exponent. For a public-key<br>
operation, the integer c shall be an entity's public exponent e; for<br>
a private-key operation, it shall be an entity's private exponent d.<br>
The output from the decryption process shall be an octet string D,<br>
the data.<br>
<br>
It is an error if the length of the encrypted data ED is not k.<br>
<br>
For brevity, the decryption process is described in terms of the<br>
encryption process.<br>
<br>
9.1 Octet-string-to-integer conversion<br>
<br>
The encrypted data ED shall be converted to an integer y, the integer<br>
encrypted data, according to Equation (3).<br>
<br>
It is an error if the integer encrypted data y does not satisfy 0 &lt;=<br>
y &lt; n.<br>
<br>
9.2 RSA computation<br>
<br>
The integer encrypted data y shall be raised to the power c modulo n<br>
to give an integer x, the integer encryption block.<br>
<br>
x = y^c mod n, 0 &lt;= x &lt; n .<br>
<br>
This is the classic RSA computation.<br>
<br>
9.3 Integer-to-octet-string conversion<br>
<br>
The integer encryption block x shall be converted to an octet string<br>
EB of length k, the encryption block, according to Equation (2).<br>
<br>
9.4 Encryption-block parsing<br>
<br>
The encryption block EB shall be parsed into a block type BT, a<br>
padding string PS, and the data D according to Equation (1).<br>
<br>
It is an error if any of the following conditions occurs:<br>
<br>
o The encryption block EB cannot be parsed<br>
unambiguously (see notes to Section 8.1).<br>
<br>
o The padding string PS consists of fewer than eight<br>
octets, or is inconsistent with the block type BT.<br>
<br>
o The decryption process is a public-key operation<br>
and the block type BT is not 00 or 01, or the decryption<br>
process is a private-key operation and the block type is<br>
not 02.<br>
<br>
10. Signature algorithms<br>
<br>
This section defines three signature algorithms based on the RSA<br>
encryption process described in Sections 8 and 9. The intended use of<br>
the signature algorithms is in signing X.509/PEM certificates and<br>
certificate-revocation lists, PKCS #6 extended certificates, and<br>
other objects employing digital signatures such as X.401 message<br>
tokens. The algorithms are not intended for use in constructing<br>
digital signatures in PKCS #7. The first signature algorithm<br>
(informally, &quot;MD2 with RSA&quot;) combines the MD2 message-digest<br>
algorithm with RSA, the second (informally, &quot;MD4 with RSA&quot;) combines<br>
the MD4 message-digest algorithm with RSA, and the third (informally,<br>
&quot;MD5 with RSA&quot;) combines the MD5 message-digest algorithm with RSA.<br>
<br>
This section describes the signature process and the verification<br>
process for the two algorithms. The &quot;selected&quot; message-digest<br>
algorithm shall be either MD2 or MD5, depending on the signature<br>
algorithm. The signature process shall be performed with an entity's<br>
private key and the verification process shall be performed with an<br>
entity's public key. The signature process transforms an octet string<br>
(the message) to a bit string (the signature); the verification<br>
process determines whether a bit string (the signature) is the<br>
signature of an octet string (the message).<br>
<br>
Note. The only difference between the signature algorithms defined<br>
here and one of the the methods by which signatures (encrypted<br>
message digests) are constructed in PKCS #7 is that signatures here<br>
are represented here as bit strings, for consistency with the X.509<br>
SIGNED macro. In PKCS #7 encrypted message digests are octet strings.<br>
<br>
10.1 Signature process<br>
<br>
The signature process consists of four steps: message digesting, data<br>
encoding, RSA encryption, and octet-string-to-bit-string conversion.<br>
The input to the signature process shall be an octet string M, the<br>
message; and a signer's private key. The output from the signature<br>
process shall be a bit string S, the signature.<br>
<br>
10.1.1 Message digesting<br>
<br>
The message M shall be digested with the selected message- digest<br>
algorithm to give an octet string MD, the message digest.<br>
<br>
10.1.2 Data encoding<br>
<br>
The message digest MD and a message-digest algorithm identifier shall<br>
be combined into an ASN.1 value of type DigestInfo, described below,<br>
which shall be BER-encoded to give an octet string D, the data.<br>
<br>
DigestInfo ::= SEQUENCE {<br>
digestAlgorithm DigestAlgorithmIdentifier,<br>
digest Digest }<br>
<br>
DigestAlgorithmIdentifier ::= AlgorithmIdentifier<br>
<br>
Digest ::= OCTET STRING<br>
<br>
The fields of type DigestInfo have the following meanings:<br>
<br>
o digestAlgorithm identifies the message-digest<br>
algorithm (and any associated parameters). For<br>
this application, it should identify the selected<br>
message-digest algorithm, MD2, MD4 or MD5. For<br>
reference, the relevant object identifiers are the<br>
following:<br>
<br>
md2 OBJECT IDENTIFIER ::=<br>
<br>
{ iso(1) member-body(2) US(840) rsadsi(113549)<br>
digestAlgorithm(2) 2 } md4 OBJECT IDENTIFIER ::=<br>
{ iso(1) member-body(2) US(840) rsadsi(113549)<br>
digestAlgorithm(2) 4 } md5 OBJECT IDENTIFIER ::=<br>
{ iso(1) member-body(2) US(840) rsadsi(113549)<br>
digestAlgorithm(2) 5 }<br>
<br>
For these object identifiers, the parameters field of the<br>
digestAlgorithm value should be NULL.<br>
<br>
o digest is the result of the message-digesting<br>
process, i.e., the message digest MD.<br>
<br>
Notes.<br>
<br>
1. A message-digest algorithm identifier is included<br>
in the DigestInfo value to limit the damage resulting from<br>
the compromise of one message-digest algorithm. For<br>
instance, suppose an adversary were able to find messages<br>
with a given MD2 message digest. That adversary might try<br>
to forge a signature on a message by finding an innocuous-<br>
looking message with the same MD2 message digest, and<br>
coercing a signer to sign the innocuous-looking message.<br>
This attack would succeed only if the signer used MD2. If<br>
the DigestInfo value contained only the message digest,<br>
however, an adversary could attack signers that use any<br>
message digest.<br>
<br>
2. Although it may be claimed that the use of a<br>
SEQUENCE type violates the literal statement in the X.509<br>
SIGNED and SIGNATURE macros that a signature is an<br>
ENCRYPTED OCTET STRING (as opposed to ENCRYPTED SEQUENCE),<br>
such a literal interpretation need not be required, as<br>
I'Anson and Mitchell point out [IM90].<br>
<br>
3. No reason is known that MD4 would not be<br>
for very high security digital signature schemes, but<br>
because MD4 was designed to be exceptionally fast, it is<br>
&quot;at the edge&quot; in terms of risking successful cryptanalytic<br>
attack. A message-digest algorithm can be considered<br>
&quot;broken&quot; if someone can find a collision: two messages with<br>
the same digest. While collisions have been found in<br>
variants of MD4 with only two digesting &quot;rounds&quot;<br>
<br>
[Mer90][dBB92], none have been found in MD4 itself, which<br>
has three rounds. After further critical review, it may be<br>
appropriate to consider MD4 for very high security<br>
applications.<br>
<br>
MD5, which has four rounds and is proportionally slower<br>
than MD4, is recommended until the completion of MD4's<br>
review. The reported &quot;pseudocollisions&quot; in MD5's internal<br>
compression function [dBB93] do not appear to have any<br>
practical impact on MD5's security.<br>
<br>
MD2, the slowest of the three, has the most conservative<br>
design. No attacks on MD2 have been published.<br>
<br>
10.1.3 RSA encryption<br>
<br>
The data D shall be encrypted with the signer's RSA private key as<br>
described in Section 7 to give an octet string ED, the encrypted<br>
data. The block type shall be 01. (See Section 8.1.)<br>
<br>
10.1.4 Octet-string-to-bit-string conversion<br>
<br>
The encrypted data ED shall be converted into a bit string S, the<br>
signature. Specifically, the most significant bit of the first octet<br>
of the encrypted data shall become the first bit of the signature,<br>
and so on through the least significant bit of the last octet of the<br>
encrypted data, which shall become the last bit of the signature.<br>
<br>
Note. The length in bits of the signature S is a multiple of eight.<br>
<br>
10.2 Verification process<br>
<br>
The verification process for both signature algorithms consists of<br>
four steps: bit-string-to-octet-string conversion, RSA decryption,<br>
data decoding, and message digesting and comparison. The input to the<br>
verification process shall be an octet string M, the message; a<br>
signer's public key; and a bit string S, the signature. The output<br>
from the verification process shall be an indication of success or<br>
failure.<br>
<br>
10.2.1 Bit-string-to-octet-string conversion<br>
<br>
The signature S shall be converted into an octet string ED, the<br>
encrypted data. Specifically, assuming that the length in bits of the<br>
signature S is a multiple of eight, the first bit of the signature<br>
shall become the most significant bit of the first octet of the<br>
<br>
encrypted data, and so on through the last bit of the signature,<br>
which shall become the least significant bit of the last octet of the<br>
encrypted data.<br>
<br>
It is an error if the length in bits of the signature S is not a<br>
multiple of eight.<br>
<br>
10.2.2 RSA decryption<br>
<br>
The encrypted data ED shall be decrypted with the signer's RSA public<br>
key as described in Section 8 to give an octet string D, the data.<br>
<br>
It is an error if the block type recovered in the decryption process<br>
is not 01. (See Section 9.4.)<br>
<br>
10.2.3 Data decoding<br>
<br>
The data D shall be BER-decoded to give an ASN.1 value of type<br>
DigestInfo, which shall be separated into a message digest MD and a<br>
message-digest algorithm identifier. The message-digest algorithm<br>
identifier shall determine the &quot;selected&quot; message-digest algorithm<br>
for the next step.<br>
<br>
It is an error if the message-digest algorithm identifier does not<br>
identify the MD2, MD4 or MD5 message-digest algorithm.<br>
<br>
10.2.4 Message digesting and comparison<br>
<br>
The message M shall be digested with the selected message-digest<br>
algorithm to give an octet string MD', the comparative message<br>
digest. The verification process shall succeed if the comparative<br>
message digest MD' is the same as the message digest MD, and the<br>
verification process shall fail otherwise.<br>
<br>
11. Object identifiers<br>
<br>
This document defines five object identifiers: pkcs-1, rsaEncryption,<br>
md2WithRSAEncryption, md4WithRSAEncryption, and md5WithRSAEncryption.<br>
<br>
The object identifier pkcs-1 identifies this document.<br>
<br>
pkcs-1 OBJECT IDENTIFIER ::=<br>
<br>
{ iso(1) member-body(2) US(840) rsadsi(113549)<br>
pkcs(1) 1 }<br>
<br>
The object identifier rsaEncryption identifies RSA public and private<br>
keys as defined in Section 7 and the RSA encryption and decryption<br>
processes defined in Sections 8 and 9.<br>
<br>
rsaEncryption OBJECT IDENTIFIER ::= { pkcs-1 1 }<br>
<br>
The rsaEncryption object identifier is intended to be used in the<br>
algorithm field of a value of type AlgorithmIdentifier. The<br>
parameters field of that type, which has the algorithm-specific<br>
syntax ANY DEFINED BY algorithm, would have ASN.1 type NULL for this<br>
algorithm.<br>
<br>
The object identifiers md2WithRSAEncryption, md4WithRSAEncryption,<br>
md5WithRSAEncryption, identify, respectively, the &quot;MD2 with RSA,&quot;<br>
&quot;MD4 with RSA,&quot; and &quot;MD5 with RSA&quot; signature and verification<br>
processes defined in Section 10.<br>
<br>
md2WithRSAEncryption OBJECT IDENTIFIER ::= { pkcs-1 2 }<br>
md4WithRSAEncryption OBJECT IDENTIFIER ::= { pkcs-1 3 }<br>
md5WithRSAEncryption OBJECT IDENTIFIER ::= { pkcs-1 4 }<br>
<br>
These object identifiers are intended to be used in the algorithm<br>
field of a value of type AlgorithmIdentifier. The parameters field of<br>
that type, which has the algorithm-specific syntax ANY DEFINED BY<br>
algorithm, would have ASN.1 type NULL for these algorithms.<br>
<br>
Note. X.509's object identifier rsa also identifies RSA public keys<br>
as defined in Section 7, but does not identify private keys, and<br>
identifies different encryption and decryption processes. It is<br>
expected that some applications will identify public keys by rsa.<br>
Such public keys are compatible with this document; an rsaEncryption<br>
process under an rsa public key is the same as the rsaEncryption<br>
process under an rsaEncryption public key.<br>
<br>
Security Considerations<br>
<br>
Security issues are discussed throughout this memo.<br>
<br>
Revision history<br>
<br>
Versions 1.0-1.3<br>
<br>
Versions 1.0-1.3 were distributed to participants in RSA Data<br>
Security, Inc.'s Public-Key Cryptography Standards meetings in<br>
February and March 1991.<br>
<br>
Version 1.4<br>
<br>
Version 1.4 is part of the June 3, 1991 initial public release of<br>
PKCS. Version 1.4 was published as NIST/OSI Implementors' Workshop<br>
document SEC-SIG-91-18.<br>
<br>
Version 1.5<br>
<br>
Version 1.5 incorporates several editorial changes, including updates<br>
to the references and the addition of a revision history. The<br>
following substantive changes were made:<br>
<br>
o Section 10: &quot;MD4 with RSA&quot; signature and<br>
verification processes are added.<br>
<br>
o Section 11: md4WithRSAEncryption object identifier<br>
is added.<br>
<br>
Supersedes June 3, 1991 version, which was also published as NIST/OSI<br>
Implementors' Workshop document SEC-SIG-91-18.<br>
<br>
Acknowledgements<br>
<br>
This document is based on a contribution of RSA Laboratories, a<br>
division of RSA Data Security, Inc. Any substantial use of the text<br>
from this document must acknowledge RSA Data Security, Inc. RSA Data<br>
Security, Inc. requests that all material mentioning or referencing<br>
this document identify this as &quot;RSA Data Security, Inc. PKCS #1&quot;.<br>
<br>
Author's Address<br>
<br>
Burt Kaliski<br>
RSA Laboratories East<br>
20 Crosby Drive<br>
Bedford, MA 01730<br>
<br>
Phone: (617) 687-7000<br>
EMail: </font><a href="mailto:burt@rsa.com"><font color="#000000">burt@rsa.com</font></a><br>
<br>
<font color="#000000">Full Copyright Statement<br>
<br>
Copyright (C) The Internet Society (1998). All Rights Reserved.<br>
<br>
This document and translations of it may be copied and furnished to<br>
others, and derivative works that comment on or otherwise explain it<br>
or assist in its implementation may be prepared, copied, published<br>
and distributed, in whole or in part, without restriction of any<br>
kind, provided that the above copyright notice and this paragraph are<br>
included on all such copies and derivative works. However, this<br>
document itself may not be modified in any way, such as by removing<br>
the copyright notice or references to the Internet Society or other<br>
Internet organizations, except as needed for the purpose of<br>
developing Internet standards in which case the procedures for<br>
copyrights defined in the Internet Standards process must be<br>
followed, or as required to translate it into languages other than<br>
English.<br>
<br>
The limited permissions granted above are perpetual and will not be<br>
revoked by the Internet Society or its successors or assigns.<br>
<br>
This document and the information contained herein is provided on an<br>
&quot;AS IS&quot; basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING<br>
TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING<br>
BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION<br>
HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF<br>
MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</font></p>
<p align="left"><font color="#000000"><a href="http://hi.baidu.com/hxzon/blog/item/3da9758dc24cec11b31bba8e.html">http://hi.baidu.com/hxzon/blog/item/3da9758dc24cec11b31bba8e.html</a>  中文翻译</font></p>
</strong></div></body></html>