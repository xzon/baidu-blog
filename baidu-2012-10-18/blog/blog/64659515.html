<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Error establishing socket</title></head><body><h1>Error establishing socket</h1><div><div class="date">2007-11-26 21:00</div>
<table style="table-layout: fixed">
    <tbody>
        <tr>
            <td>
            <div class="cnt">
            <p><font size="3">经过一夜的打拼&nbsp;&nbsp;  终于连接成功了 期间走了不少弯路 在这里分享我的一点经验</font></p>
            <p><font size="3">一、准备环境</font></p>
            <p><font size="3">&nbsp;&nbsp;  Windows XP+JDK5.0+Microsoft SQL Server 2000个人版+JCreator(或Eclipse)</font></p>
            <p><font size="3">下载数据库驱动程序SQL Server 2000 Driver for JDBC Service Pack 3.exe<br>
            &nbsp;&nbsp;  安装完毕后 在C:\Program Files\Microsoft SQL Server 2000 Driver for JDBC\lib<br>
            &nbsp;&nbsp;  目录下有三个包msbase.jar mssqlserver.jar msutil.jar<br>
            &nbsp;&nbsp;  1、在命令行下编译运行，配置环境变量 将这三个包的路径加入CLASSPATH中<br>
            &nbsp;&nbsp;  2、在JCreator中 配置 选项 JDK配置文件 编辑 添加存档路径 添加三个包<br>
            &nbsp;&nbsp;  3、在Eclipse此中&nbsp;&nbsp;  选择项目的构建路径&mdash;&mdash;库&mdash;&mdash; 添加外部JAR 将这三个添加进去</font></p>
            <p><font size="3">二、出现的问题及解决办法<br>
            1、是不是出现了Error establishing socket之类的错误 呵呵<br>
            这是因为连接数据库的1433端口没打开 我们必须要下载SP3的补丁<br>
            </font><a href="http://download.microsoft.com/download/d/d/e/dde427eb-0296-4eac-a47c-d11a66b03816/chs_sql2ksp3.exe"><font size="3">http://download.microsoft.com/download/d/d/e/dde427eb-0296-4eac-a47c-d11a66b03816/chs_sql2ksp3.exe</font></a><br>
            <font size="3">SP4行不呢？ 照理说SP4应该包括SP3 我也是这样想 下了个SP4 70多M&nbsp;&nbsp;&nbsp;  装好后<br>
            用NETSTAT -A -N 没发现TCP 1433被监听 UDP 1434没被监听 火啊&nbsp;&nbsp;  在网上找啊找<br>
            发现有位仁兄也遇见此类问题 问题就出在SP4补丁上 一定要打上SP3补丁才管用 <br>
            微软官方有下 有三个文件 一定要下这个chs_sql2ksp3.exe 下别的也不行 因为我首先就下了个chs_sql2kdesksp3.exe 他妈的不知道是什么东西 也不能打开1433 装好chs_sql2ksp3.exe后重启<br>
            NETSTAT -A -N测试若发现1433被监听 TELNET 127.0.0.1 1433 能连接 那么恭喜你 软件环境可以准备好了<br>
            2、当然还有其他的问题比如防火墙设置比如SQL SERVER里的网络配置（TCP/IP默认端口是否是1433）不过一般在一般情况还是不需修改。</font></p>
            <p><font size="3"><br>
            三、实例说明<br>
            下面是一个实例：<br>
            import java.sql.*;<br>
            public class ConSqlserver{ <br>
            &nbsp;&nbsp;&nbsp;&nbsp;  Connection con;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;  Statement st;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;  ResultSet rs;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;  public ConSqlserver(){&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  try{&nbsp;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;  String driver=&quot;com.microsoft.jdbc.sqlserver.SQLServerDriver&quot;;<br>
            &nbsp;&nbsp;  String url=&quot;jdbc:microsoft:sqlserver://localhost:1433;DatabaseName=pubs&quot;;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Class.forName(driver);<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  con=DriverManager.getConnection(url,&quot;SA&quot;,&quot;密码&quot;);<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println(&quot;连接成功!&quot;);<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  con.close();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }catch(Exception e){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  e.printStackTrace();<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
            &nbsp;&nbsp;&nbsp;&nbsp;  }<br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;  public static void main(String args[]){&nbsp;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;  new ConSqlserver();&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;  }<br>
            <br>
            }</font></p>
            <p><font size="3">四、补充<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  写连接代码时需要注意2000和2005的不同：&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;  1、连接SqlServer2000&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Class.forName(&quot;com.microsoft.jdbc.sqlserver.SQLServerDriver&quot;).newInstance();&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  URL&nbsp;&nbsp;&nbsp;  =&nbsp;&nbsp;&nbsp;  &quot;jdbc:microsoft:sqlserver://localhost:1433;DatabaseName=tempdb&quot;;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;  2、连接SqlServer2005&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Class.forName(&quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;).newInstance();&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  URL&nbsp;&nbsp;&nbsp;  =&nbsp;&nbsp;&nbsp;  &quot;jdbc:sqlserver://localhost:1433;DatabaseName=tempdb&quot;;&nbsp;&nbsp;</font></p>
            </div>
            </td>
        </tr>
    </tbody>
</table></div></body></html>