<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>《电脑网络教育与Web教育服务-计算机密码》-04公钥密码体系（PKI：Public Key Infrastructure）：讲义7章</title></head><body><h1>《电脑网络教育与Web教育服务-计算机密码》-04公钥密码体系（PKI：Public Key Infrastructure）：讲义7章</h1><div><div>《电脑网络教育与Web教育服务-计算机密码》<br>
E'education Laboratory And Web'Education Services美国GeneChiu基金资助Supported by USA GeneChiu Foundation</div>
<div> </div>
<div>计算机密码</div>
<div> </div>
<div>公钥密码体系（PKI：Public Key Infrastructure）：讲义7章</div>
<div> </div>
<div> </div>
<div> </div>
<div>内容：公钥密码学（P与NP、（陷门）单向函数、 Diffie-Hellman密钥交换）；RSA；消息摘要、Hash（杂揍、散列）算法；数字签名；公钥密钥管理、认证、证书（CA）与PKI；密码协议；程序设计参考材料</div>
<div> </div>
<div>0.1 信息安全的特性</div>
<div> </div>
<div>1.1 公钥密码学：1.21 P与NP问题；</div>
<div> </div>
<div>1.22 陷门单向函数</div>
<div> </div>
<div>单向陷门函数是满足下列条件的函数f：</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;  (1)给定x，计算y=f(x)是容易的；</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;  (2)给定y, 计算x使y=f(x)是困难的。 (所谓计算x=f-1(Y)困难是指计算上相当复杂，已无实际意义。)</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  (3)存在δ，已知δ 时,对给定的任何y，若相应的x存在，则计算x使y=f(x)是容易的。</div>
<div> </div>
<div>注：1*. 仅满足(1)、(2)两条的称为单向函数；第(3)条称为陷门性，δ 称为陷门信息。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;  2*. 当用陷门函数f作为加密函数时，可将f公开，这相当于公开加密密钥。此时加密密钥便称为公开钥，记为Pk。 f函数的设计者将δ 保密，用作解密密钥，此时δ 称为秘密钥匙，记为Sk。由于加密函数时公开的，任何人都可以将信息x加密成y=f(x)，然后送给函数的设计者（当然可以通过不安全信道传送）；由于设计者拥有Sk，他自然可以解出x=f-1(y)。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;  3*.单向陷门函数的第(2)条性质表明窃听者由截获的密文y=f(x)推测x是不可行的。</div>
<div> </div>
<div>2.11 RSA encryption --- 1978</div>
<div> </div>
<div>RSA公钥密码算法：用&lt;m的大整数M代表明文，C代表密文，E(M)代表加密运算，D(C)代表脱密运算，用x=y(mod z)表示x和y模z同余，则加密和脱密算法简单表示如下：</div>
<div> </div>
<div>C＝E(M)＝M^e (mod m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  M＝D(C)＝C^d (mod m)</div>
<div> </div>
<div>其中加密密钥{e,m}和脱密密钥{d,m}满足下列各项要求：</div>
<div> </div>
<div>1. 素数p和q（保密的）；2. m=p×q （公开的）；3. φ(n)=(p-1)×(q-1)（即n的欧拉函数，保密的）；</div>
<div> </div>
<div>4. 加密密钥e（公开的），满足0&lt;e&lt;φ(n)，且e和φ(n)互素（e的位数较小）；</div>
<div> </div>
<div>5. 脱密密钥d（保密的），满足d×e＝1 (mod φ(n))，即d和e相对于模φ(n)互为逆元素。</div>
<div> </div>
<div>RSA公钥密码算法的安全性是基于大数的因子分解，在计算复杂性理论中已证明是一个NP困难问题，至今仍没有有效算法。虽然公开了加密密钥{e,m}，但要想求得e的逆元素d（脱密密钥），必须对m进行因子分解，只要m足够大，就是非常困难的。</div>
<div> </div>
<div>2.21 大质数的破解；2.3 概率素数</div>
<div> </div>
<div>Solovag-Strasson的概率测试算法。这个算法使用雅可比函数来测试p是否为素数：</div>
<div> </div>
<div>3.10 单向Hash函数：单向Hash函数又称：压缩函数、缩短函数、消息摘要、指纹、密码校验和、信息完整性检验（DIC）、操作检验码（MDC）。 Hash函数把可变输入长度串（叫做预映射，Pre-image）转换成固定长度（经常更短）输出串（叫做hash值）的一种函数。</div>
<div> </div>
<div>3.11 无碰撞(collision-free)性概念；3.12 单向杂凑函数的设计理论；3.13 对单向Hash函数的攻击</div>
<div> </div>
<div>3.14 生日攻击的方法</div>
<div> </div>
<div>4.10 数字签名</div>
<div> </div>
<div>（1）签名是可信的。签名使文件的接收者相信签名者是慎重地在文件上签字的。（2）签名不可伪造。签名证明是签字者而不是其他人慎重地在文件上签字。（3）签名不可重用。签名是文件的一部分，不法之徒不可能将签名移到不同的文件上。（4）签名的文件是不可改变的。在文件签名后，文件不能改变。（5）签名是不可抵赖的。签名和文件是物理的东西。签名者事后不能声称他没有签过名。</div>
<div> </div>
<div>5.11 公钥管理；5.12 PKI-公开密钥基础设施</div>
<div> </div>
<div>5.13 数字证书、认证中心、公钥基础设施PKI 5.14 X.509证书及认证框架</div>
<div> </div>
<div>5.21 分布式网络环境中的安全认证</div>
<div> </div>
<div>6.11 协议；6.12 密码协议；6.13 对密码协议的分析与攻击</div>
<div> </div>
<div>6.14 密码协议的两个例子</div>
<div> </div>
<div>在网络分布式环境下，A、B两人进行扑克搏弈：A将52张牌洗匀送给B取5张，B将剩余47张牌洗匀送给A取5张，A与B用这5块牌进行某种扑克搏弈；请分别用对称密码、公钥密码设计发牌过程（发牌协议），进行安全分析、并用Socket编程实现；</div>
<div> </div>
<div>在网络分布式环境下，A有52个人的档案，A允许B看其中至多5人的档案但B不希望A知道他到底看了哪5人的档案；请分别用对称密码、公钥密码设计实现过程（保密查看协议），进行安全分析、并用Socket编程实现；</div>
<div> </div>
<div>6.21 Diffie-Hellman密钥交换协议；6.31 密钥交换与KDC；6.41 鉴别分类；6.45 鉴别和密钥交换</div>
<div> </div>
<div>6.47 Kerberos：Kerberos密钥分配中心KDC（即Kerberos服务器）由认证服务器AS和许可证颁发服务器TGS构成。 　　</div>
<div> </div>
<div>6.50 零知识证明（随机挑战）</div>
<div> </div>
<div> </div>
<div> </div>
<div> </div>
<div> </div>
<div>计算机密码学&mdash;试题</div>
<div> </div>
<div>简述DES解密过程以及3DES的实现方法。</div>
<div> </div>
<div>何谓陷门单向函数？试述陷门单向函数与公钥密码体制的关系。</div>
<div> </div>
<div>简述使用公钥密码设计KDC的方案。</div>
<div> </div>
<div>何谓数字签名，试述数字签名的意义及种种实现方法</div>
<div> </div>
<div>何谓VPN，简述计算机密码学在VPN中的意义。</div>
<div> </div>
<div>证明生日问题及其对对单向Hash函数攻击的启发。</div>
<div> </div>
<div> </div>
<div> </div>
<div> </div>
<div> </div>
<div> </div>
<div> </div>
<div>（一）公钥密码体系（PKI：Public Key Infrastructure）：</div>
<div> </div>
<div>公钥机制（Public Key Infrastructure， PKI）就是利用公共密钥理论和技术建立的提供安全服务的基础设施。电子商务的迅速发展使信息安全显得尤为重要，一个大型或是中型机构如果要在电子商务的大环境里求得生存，建立基于PKI的体制去认证及控制访问将是它在未来最重要的技术投资。（参考文章：01_ PKI神话还是魔术；02_PKI的理论基础；03_公开密钥基础设施；04_PKI系统的常用信任模型；\PKI参考资料1--3）。</div>
<div> </div>
<div>（二）公钥密码的基础：</div>
<div> </div>
<div>（1）公钥密码的4个条件（见讲义44页）；</div>
<div> </div>
<div>（2）陷门单向函数（One Way Trapdoor Function）与P =? NP（NP难）问题（见讲义45页）</div>
<div> </div>
<div>（3）公钥密码协议：保密通信、数字签名、带签名的保密通信</div>
<div> </div>
<div>（三）RSA（Rivest-Shamir-Adleman）公钥密码（见讲义50页）：</div>
<div> </div>
<div>RSA公钥密码算法：用&lt;m的大整数M代表明文，C代表密文，E(M)代表加密运算，D(C)代表脱密运算，用x=y(mod z)表示x和y模z同余，则加密和脱密算法简单表示如下：</div>
<div> </div>
<div>C＝E(M)＝M^e (mod m)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  M＝D(C)＝C^d (mod m)</div>
<div> </div>
<div>其中加密密钥{e,m}和脱密密钥{d,m}满足下列各项要求：</div>
<div> </div>
<div>1. 素数p和q（保密的）；2. m=p×q （公开的）；</div>
<div> </div>
<div>3. φ(n)=(p-1)×(q-1)（即n的欧拉函数，保密的）；</div>
<div> </div>
<div>4. 加密密钥e（公开的），满足0&lt;e&lt;φ(n)，且e和φ(n)互素（e的位数较小）；</div>
<div> </div>
<div>5. 脱密密钥d（保密的），满足d×e＝1 (mod φ(n))，即d和e相对于模φ(n)互为逆元素。</div>
<div> </div>
<div>RSA公钥密码算法的安全性是基于大数的因子分解，在计算复杂性理论中已证明是一个NP困难问题，至今仍没有有效算法。虽然公开了加密密钥{e,m}，但要想求得e的逆元素d（脱密密钥），必须对m进行因子分解，只要m足够大，就是非常困难的。</div>
<div> </div>
<div>（四）RSA-129的破译：1977年，当公布RSA密码算法时，他们选择了两个大素数的积，一个129位数</div>
<div> </div>
<div>m=1143，81625，75788，88676，69235，77997，61466，12010，21829，67212，42362，56256，18429，35706，93524，57338，97830，59712，35639，58705，05898，90751，47599，29002，68795，43541</div>
<div> </div>
<div>加密一条消息悬赏100美元破译，这就是有名的RSA-129问题；他们初步估计要用4*10^25年才可解决；到1994年4月，共有20多个国家的600多人参加，总共动用1600台计算机，前后8个月，攻破了RSA-129 ：</div>
<div> </div>
<div>3490，52951，08476，50940，14784，96199，03898，13341，77646，38493，38784，39908，20577 和</div>
<div> </div>
<div>32769，13299，32667，09549，96198，81908，34461，41317，76429，67992，94253，97982，88533</div>
<div> </div>
<div> </div>
<div> </div>
<div>（五）混合密码体制：</div>
<div> </div>
<div>传统密码（例如DES）的优点是算法快，缺点是密钥传送与分配问题（例如：网络上n个人互相之间要用DES进行保密通信，每人n-1把密钥，总共0.5*n*(n-1)把密钥）（密钥管理见 ：07_加密算法与密钥管理）！</div>
<div> </div>
<div>将公钥密码的方便与传统密码（例如DES）的快速结合，形成了混合密码体制，使传统密码（例如DES）在网络保密通信中又发挥了作用，想法是：用DES加密文件，公钥加密DES密钥传送出去。</div>
<div> </div>
<div>（六）素数测试：随机地找到（安全的）大素数是RSA公钥系统的关键，下面介绍Miller-Rabin方法：</div>
<div> </div>
<div>在数论中，Wilson定理可以判定p是否为素数：p是素数的充要条件是 (p-1)! = -1 mod p ，但是在计算上不是可行的；Fermat定理是判别p是否为素数的必要条件：若 a^p ≠ mod p 则 p 不是素数，但不充分，例如 2^241 = 2 mod 341 然而 341 =11*31 并非素数，不过，可以用它来测试素数。</div>
<div> </div>
<div>Miller检验：《定义》设n为正整数， n-1 = 2 j *m （其中，j 非负，m为正奇数），若有正整数a使得：</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  a m = 1 mod n&nbsp;&nbsp;  或者 a^(2 h *m) = -1 mod n&nbsp;&nbsp;&nbsp;  （其中，h为非负整数，0≤h≤j-1）</div>
<div> </div>
<div>则称a通过Miller检验；《定理》若p是素数，a是正整数，(p,a)=1，则p关于a一定通过Miller检验。《定理》若n为正奇合数，则最多有(n-1)/4个a（1≤a≤n-1），关于它们n通过Miller检验。</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;  Rabin素数检验法：若n为正整数，随机选取k个小于n的不同整数，若关于这k个数Miller检验全部通过，则n不书素数的概率0.25^k。</div>
<div> </div>
<div>（七）软件实现：PGP（Pretty Good Privacy），目前，在Internet上广为应用的加密系统PGP是一种相当完整的电子邮件安全包，能够实现保密、鉴别、数字签名甚至压缩功能。它采用了RSA、IDEA及MD5等成熟的加密技术（见：07_邮件加密软件PGP）；《研究》：研究PGP的源代码和实际应用</div>
<div> </div>
<div>《作业》用Java大整数类包实现：（1）验证RSA-129，（2）用辗转相除法求（m,n），（3）用RSA-129做一个公钥密码系统，（研究）实现Rabin素数检验法，找100、200、300、400、500位的概率素数</div>
<div> </div>
<div>实现Java数字签名（参考资料：\JAVA做数字签名）；实现Win32数字签名（参考材料：\CryptoAPI）</div>
<div> </div>
<div>《研究》研究IBM的Java公钥密码软件包（参考资料：\Java_IBM公钥密码）AMCE的Java公钥密码软件包</div>
<div> </div>
<div>《研究》Win32的密码接口CryptoAPI（见：\CryptoAPI）；Java1.3的密码类库包，见\Java_security</div>
<div> </div>
<div>例与作业：\RSADemo_Java&nbsp;&nbsp;&nbsp;  （用RSA加解密进行的演示程序）</div>
<div> </div>
<div>例与作业：研究&ldquo;\RSA加密解密算法C源码&rdquo;里的程序，实现它的应用</div>
<div> </div>
<div> </div>
<div> </div>
<div>例：\RSADemo_Java&nbsp;&nbsp;&nbsp;  （用RSA加解密进行的演示程序）</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;  输入一个奇数，程序将自动产生RSA的私、公钥，并进行加密、解密演示；使用了大整数类</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;  作业：</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  将产生私、公钥的过程显示出来</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  对中文：&ldquo;a贵州大学&rdquo;加、解密正常，而&ldquo;贵州大学&rdquo;不正常</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  请修改对中文适用</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  对本程序进行分析说明</div>
<div> </div>
<div>作业：研究&ldquo;\RSA加密解密算法C源码&rdquo;里的程序，实现它的应用</div>
<div> </div>
<div> </div>
<div> </div>
<div> </div>
<div> </div>
<div> </div>
<div> </div>
<div>（四）RSA-129的破译：</div>
<div> </div>
<div>1977年，当公布RSA密码算法时，他们选择了两个大素数的积，一个129位数</div>
<div> </div>
<div>m=1143，81625，75788，88676，69235，77997，61466，12010，21829，67212，42362，56256，18429，35706，93524，57338，97830，59712，35639，58705，05898，90751，47599，29002，68795，43541</div>
<div> </div>
<div>用来加密一条消息，并悬赏100美元破译，这就是有名的RSA-129问题；他们初步估计要用4*10^25年才可分解出这个129位数的两个素数的乘积；公布后20年里无人敢挑战这个问题；</div>
<div> </div>
<div>由于计算机技术的快速发展，特别是Internet的出现，1993年，美国Bellcore公司的一个研究小组决定接受这个挑战，该小组邀请Internet上的志愿参加者，分发因数分解软件（用多线程方式）在他们机器空闲时进行分解的子任务，将结果返回MIT，到1994年4月，共有20多个国家的600多人参加，总共动用了从工作站、大型机到超级计算机的1600台计算机，前后8个月，攻破了RSA-129，两个素数是：</div>
<div> </div>
<div>3490，52951，08476，50940，14784，96199，03898，13341，77646，38493，38784，39908，20577 和</div>
<div> </div>
<div>32769，13299，32667，09549，96198，81908，34461，41317，76429，67992，94253，97982，88533</div>
<div> </div>
<div>&nbsp;&nbsp;&nbsp;  近来，对RSA-512进行了破译（见：06_512位RSA密钥被破译）</div>
<div> </div>
<div> </div></div></body></html>