<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>RegCloseKey 函数</title></head><body><h1>RegCloseKey 函数</h1><div><p>
<table class="TableBlock FCK__ShowTableBorders" cellspacing="0" cellpadding="0">
    <tbody>
        <tr>
            <td style="height: 25px" class="Cell_LM"><span style="color: red; font-size: 15px; font-weight: bold">RegCloseKey 函数</span></td>
        </tr>
        <tr>
            <td class="Cell_LM">
            <table style="width: 100%; border-collapse: collapse" class="FCK__ShowTableBorders" border="0" cellspacing="0" cellpadding="0">
                <tbody>
                    <tr>
                        <td style="width: 20px" class="Cell_LM5P"> </td>
                        <td style="line-height: 130%" class="Cell_LM5P" colspan="2">The RegCloseKey function releases a handle to the specified registry key.</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold" class="Cell_LM5P" colspan="3">定义</td>
                    </tr>
                    <tr>
                        <td style="width: 20px" class="Cell_LM5P"> </td>
                        <td style="line-height: 130%" class="Cell_LM5P" colspan="2">LONG RegCloseKey(HKEY hKey);</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold" class="Cell_LM5P" colspan="3">参数</td>
                    </tr>
                    <tr>
                        <td style="width: 20px" class="Cell_LM5P"> </td>
                        <td class="Cell_LM5P" colspan="2">hKey</td>
                    </tr>
                    <tr>
                        <td style="width: 20px" class="Cell_LM5P"> </td>
                        <td style="width: 20px" class="Cell_LM5P"> </td>
                        <td style="line-height: 130%" class="Cell_LM5P">[in] Handle to the open key to be closed. The handle must have been opened by the RegCreateKeyEx, RegOpenKeyEx, or RegConnectRegistry function.</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold" class="Cell_LM5P" colspan="3">返回值</td>
                    </tr>
                    <tr>
                        <td style="width: 20px" class="Cell_LM5P"> </td>
                        <td style="line-height: 130%" class="Cell_LM5P" colspan="2">If the function succeeds, the return value is ERROR_SUCCESS.<br>
                        <br>
                        If the function fails, the return value is a nonzero error code defined in Winerror.h. You can use the FormatMessage function with the FORMAT_MESSAGE_FROM_SYSTEM flag to get a generic description of the error.</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold" class="Cell_LM5P" colspan="3">说明</td>
                    </tr>
                    <tr>
                        <td style="width: 20px" class="Cell_LM5P"> </td>
                        <td style="line-height: 130%" class="Cell_LM5P" colspan="2">The handle for a specified key should not be used after it has been closed, because it will no longer be valid. Key handles should not be left open any longer than necessary.<br>
                        <br>
                        The RegCloseKey function does not necessarily write information to the registry before returning; it can take as much as several seconds for the cache to be flushed to the hard disk. If an application must explicitly write registry information to the hard disk, it can use the RegFlushKey function. RegFlushKey, however, uses many system resources and should be called only when necessary.</td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold" class="Cell_LM5P" colspan="3">系统要求</td>
                    </tr>
                    <tr>
                        <td style="width: 20px" class="Cell_LM5P"> </td>
                        <td style="line-height: 130%" class="Cell_LM5P" colspan="2">Client: Requires Windows XP, Windows 2000 Professional, Windows NT Workstation, Windows Me, Windows 98, or Windows 95.<br>
                        Server: Requires Windows Server 2003, Windows 2000 Server, or Windows NT Server.<br>
                        Header: Declared in Winreg.h; include Windows.h.<br>
                        Library: Link to Advapi32.lib.<br>
                        DLL: Requires Advapi32.dll.</td>
                    </tr>
                </tbody>
            </table>
            </td>
        </tr>
    </tbody>
</table>
<a href="http://www.hszxcx.cn/WindowsAPI/Default.aspx?dlid=9">http://www.hszxcx.cn/WindowsAPI/Default.aspx?dlid=9</a></p>
<p>long RegCloseKey(HKEY hkey);<br>
long RegConnectRegistry(LPCTSTR lpMachineName,HKEY hkey,PHKEY phkResult);<br>
long RegCreateKeyEx(HKEY hkey,LPCTSTR lpSubKey,DWORD Reserved,LPTST lpClass,DWORD )</p></div></body></html>