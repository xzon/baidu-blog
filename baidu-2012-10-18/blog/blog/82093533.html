<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>void main()从来不存在于C/C++！潭浩强害人不浅</title></head><body><h1>void main()从来不存在于C/C++！潭浩强害人不浅</h1><div><p>void main()从来不存在于C/C++！潭浩强害人不浅</p>
<p><font face="宋体">我一直以为C/C++的main(C#是Main)和C#一样可以void/int<br>
但C/C++中void main()是错误的<br>
<u>C中可以用main()，因为C把这个当成int main()</u> <font face="宋体">//C把int当作默认类型，而()表示接受任何参数。<u>C的标准写法是int main(void)</u>,<font face="宋体">这个void显式地说明函数不接受任何参数</font></font><br>
<u>C++只好是写int main()了</u> //C++中int不是默认类型,()表示不接受任何参数<br>
很多书中都写出了void main()，真是害人不浅(尤其是出现于广大校园中的老潭的书)</font></p>
<p><font face="宋体"><u>c：</u><br>
main()，int main()，main(void)//C89可用<br>
int main(void) //标准<br>
{.........<br>
return 0; //部分编译器自动加上<br>
}</font></p>
<p><font face="宋体"><u>c++：</u><br>
int main() //标准<br>
{.........<br>
return 0; //部分编译器自动加上<br>
}</font></p>
<p><font face="宋体"><strong><br>
关于C语言中return的一些总结</strong><br>
return是C++预定义的语句，它提供了种植函数执行的一种放大。当return语句提供了一个值时，这个值就成为函数的返回值.<br>
<font face="宋体">也有这样的，return;不返回值，直接退出函数<br>
void xx()<br>
{…………<br>
return;<br>
}</font><br>
说到return,有必要提及主函数的定义,下面是从网络上找到的资料,好好消化吧,对了解主函数中返回值的理解有很大的帮助.</font></p>
<p> </p>
<p><font face="宋体"><font color="#ff0000">很多人甚至市面上的一些书籍，都使用了void main( ) ，其实这是错误的。C/C++ 中从来没有定义过void main( ) 。</font>C++ 之父 Bjarne Stroustrup 在他的主页上的 FAQ 中明确地写着 The definition void main( ) { /* ... */ } is not and never has been C++, nor has it even been C. （ void main( ) 从来就不存在于 C++ 或者 C ）。<br>
下面我分别说一下 C 和 C++ 标准中对 main 函数的定义。</font></p>
<p> </p>
<p><font face="宋体"><font face="宋体">★&ldquo;The C programming Language（《C 程序设计语言》）用的就是 main( )。&rdquo;--- 这是因为第一版的C语言只有一种类型，那就是int，没有char，没有long，没有float，…………既然只有一种类型，那么就可以不写，后来的改进版为了兼容以前的代码于是规定：<u>不明确标明返回值的，默认返回值为int，也就是说 main()等同于int main()，而不是等同于void main()。</u>在C99中，标准要求编译器至少给 main() 这种用法来个警告。</font></font></p>
<p><font face="宋体"><br>
★一般来讲在C里可以写&quot;main()&quot;，这是因为<u>C把int当作默认类型</u>，凡是没给类型的都当作int。如果你在C里声明一个变量，比如&ldquo;i&rdquo;，然后没给类型说明符，那么编译器会把它当int类型。</font></p>
<p><font face="宋体"><br>
★C++就不这么干了，尤其是<u>标准的C++，就不把int当作默认类型</u>，所以写main函数的时候，你<u>要写明是int类型</u>。</font></p>
<p><font face="宋体"><br>
★另外一点值得一提的是main后面的这个括号&ldquo;()&rdquo;，他<u>在C++里面表示不接受任何参数，而在C里面则表示接受任何参数</u>。<u>在C里，不接受任何参数，一般指明void。</u>所以，在C里，main函数的声明，可以是&ldquo;int main(void)&rdquo;。<br>
</font></p>
<p> </p>
<p><font face="宋体"><strong>1. C</strong><br>
在 C89 中，main( ) 是可以接受的。Brian W. Kernighan 和 Dennis M. Ritchie 的经典巨著 The C programming Language 2e（《C 程序设计语言第二版》）用的就是 main( )。不过在最新的 C99 标准中，只有以下两种定义方式是正确的：<br>
<font color="#ff0000">int main( void )<br>
int main( int argc, char *argv[] )</font><br>
（参考资料：ISO/IEC 9899:1999 (E) Programming languages &mdash; C 5.1.2.2.1 Program startup）<br>
当然，我们也可以做一点小小的改动。例如：char *argv[] 可以写成 char **argv；argv 和 argc 可以改成别的变量名（如 intval 和 charval），不过一定要符合变量的命名规则。<br>
如果不需要从命令行中获取参数，请用int main(void) ；否则请用int main( int argc, char *argv[] ) 。<br>
main 函数的返回值类型必须是 int ，这样返回值才能传递给程序的激活者（如操作系统）。<br>
如果 main 函数的最后没有写 return 语句的话，C99 规定编译器要自动在生成的目标文件中（如 exe 文件）加入return 0; ，表示程序正常退出。不过，我还是建议你最好在main函数的最后加上return 语句，虽然没有这个必要，但这是一个好的习惯。注意，vc6不会在目标文件中加入 return 0; ，大概是因为 vc6 是 98 年的产品，所以才不支持这个特性。现在明白我为什么建议你最好加上 return 语句了吧！不 过，gcc3.2（Linux 下的 C 编译器）会在生成的目标文件中加入 return 0; 。</font></p>
<p> </p>
<p><font face="宋体"><strong>2. C++</strong><br>
C++98 中定义了如下两种 main 函数的定义方式：<br>
<font color="#ff0000">int main( )<br>
int main( int argc, char *argv[] )<br>
</font>（参考资料：ISO/IEC 14882(1998-9-01)Programming languages &mdash; C++ 3.6 Start and termination）<br>
int main( ) 等同于 C99 中的 int main( void ) ；int main( int argc, char *argv[] ) 的用法也和 C99 中定义的一样。同样， main 函数的返回值类型也必须是int。如果main函数的末尾没写return语句，C++98 规定编译器要自动在生成的目标文件中加入 return 0; 。同样，vc6 也不支持这个特性，但是 g++3.2（Linux 下的 C++ 编译器）支持。</font></p>
<p> </p>
<p><font face="宋体"><strong>3. 关于 void main</strong><br>
<u>在 C 和 C++ 中，不接收任何参数也不返回任何信息的函数原型为&ldquo;void foo(void);&rdquo;。可能正是因为这个，所以很多人都误认为如果不需要程序返回值时可以把main函数定义成void main(void) 。</u><font color="#ff0000">然而这是错误的！main 函数的返回值应该定义为 int 类型，C 和 C++ 标准中都是这样规定的。</font>虽然在一些编译器中，void main 可以通过编译（如 vc6），但并非所有编译器都支持 void main ，因为标准中从来没有定义过 void main 。g++3.2 中如果 main 函数的返回值不是 int 类型，就根本通 不过编译。而 gcc3.2 则会发出警告。所以，如果你想你的程序拥有很好的可移植性，请一定要用 int main 。</font></p>
<p> </p>
<p><font face="宋体"><strong>4. 返回值的作用<br>
</strong>main 函数的返回值用于说明程序的退出状态。如果返回 0，则代表程序正常退出，否则代表程序异常退出。下面我们在 winxp 环境下做一个小实验。首先编译下面的程序：<br>
int main( void )<br>
{<br>
return 0;<br>
}<br>
然后打开附件里的&ldquo;命令提示符&rdquo;，在命令行里运行刚才编译好的可执行文件，然后输入&ldquo;echo %ERRORLEVEL%&rdquo;，回车，就可以看到程序的返回 值为 0 。假设刚才编译好的文件是 a.exe ，如果输入&ldquo;a &amp;&amp; dir&rdquo;，则会列出当前目录下的文件夹和文件。但是如果改成 &ldquo;return -1&rdquo;，或者别的非 0 值，重新编译后输入&ldquo;a &amp;&amp; dir&rdquo;，则 dir 不会执行。因为 &amp;&amp; 的含义是：如果 &amp;&amp; 前面的程序正常退出，则继续执行 &amp;&amp; 后面的程序，否则不执行。也就是说，利用程序的返回值，我们可以控制要不要执行下一个程序。这就是 int main 的好处。如果你有兴趣，也可以把 main 函数的返回值类型改成非 int 类型（如 float），重新编译后执行&ldquo;a &amp;&amp; dir&rdquo;，看看会出现什么情况，想想为什么会出现那样的情况。顺便提一下，如果输入 a || dir 的话，则表示如果 a 异常退出，则执行 dir 。</font></p>
<p> </p>
<p><font face="宋体"><strong>5. 那么 int main(intargc,char*argv[],char*envp[])呢？</strong><br>
这当然也不是标准 C 里面定义的东西！char*envp[] 是某些编译器提供的扩展功能，用于获取系统的环境变量。因为不是标准，所以并非所有编译器都支持，故而移植性差，不推荐使用。<br>
到了这里,你应该了解为什么主函数定义为 int返回类型,而且函数体里面有return 0;这个语句了吧.<br>
下面具体说说我对return的应用的理解。<br>
只要一个函数的返回值是数字型的,那么就可以返回0(即return 0),其实你返回多少都没问题。一般情况下，C++做出来的函数都要求返回一个值，当函数执行正常，且达到了一般情况下的目的，那么就返回0表示正确的调用了该函数，这个0就是返回给主调函数以通知没有出错的；如果函数调用中出错，或者没有按照一般情况执行，那么就返回1，以告知主调函数采取响应策略；如果你在某个函数所在类的定义所在的头文件中定义了一组状态值（一般都是负整数），那么函数就可以返回不同的值以告之主调函数具体发生了什么异常或错误，这种情况一般用于函数功能独立性较差的的情况。所以一般不鼓励把函数返回类型定义为void，至少返回应该是int，而在函数的最后加上return 0.语句：<br>
int func(参数列表)<br>
{<br>
……<br>
……<br>
……<br>
Return 0;<br>
}<br>
在函数中，如果碰到return 语句，那么程序就会返回调用该函数的下一条语句执行，也就是说跳出函数的执行，回到原来的地方继续执行下去。但是如果是在主函数中碰到return语句，那么整个程序就会停止，退出程序的执行。<br>
如果你定义一个函数有返回类型，可以想下面那样调用：<br>
int func()<br>
{<br>
int value;<br>
……<br>
……<br>
……<br>
return value;<br>
}<br>
int main()<br>
{<br>
int intvalue;<br>
intvalue=func();<br>
……<br>
……<br>
return 0;<br>
}</font></p>
<p> </p>
<p><font face="宋体">return语句后面具体是什么内容，这就要具体情况具体分析了：<br>
（1） 在返回类型是char的函数中，return后应该是char类型的值；<br>
（2）在返回类型是int的函数中，如果是要停止函数的调用，最好应该为0；其他的按照你的目的而定，只要是int 类型就行了<br>
（3）在返回类型是结构类型的函数中，return后应该是结构的一个实例对象。<br>
总之，函数定义为什么样的返回类型，该函数中return后就应该是相应类型的值。</font></p></div></body></html>