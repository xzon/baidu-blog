<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Ajax.NET初步了解</title></head><body><h1>Ajax.NET初步了解</h1><div><p><font face="Courier New"><strong><font style="font-size: 16px" color="#ff0000">Ajax.NET初步了解</font></strong><br>
</font><font face="Courier New"><br>
<strong>1.Ajax.NET Pro的下载地址</strong>http://www.ajaxpro.info/</font></p>
<p><font face="Courier New"><strong>2.Ajax.NET简介</strong></font></p>
<p><font face="Courier New">Ajax.NET是一个类库，实现从Javascript到服务器端.NET的存取。</font></p>
<p><font face="Courier New">Ajax.NET的特点：</font></p>
<p><font face="Courier New">能把Javascript中的调用传递到.NET方法，并返回到Javascript回叫。</font></p>
<p><font face="Courier New">能存取来自于JavaScript的会话数据。</font></p>
<p><font face="Courier New">缓存结果</font></p>
<p><font face="Courier New">自由使用，可用的源码。</font></p>
<p><font face="Courier New">用属性标记方法</font></p>
<p><font face="Courier New">完整的类支持以返回客户端JavaScript值</font></p>
<p><font face="Courier New">使用HtmlControls来进行输入和返回值</font></p>
<p><font face="Courier New">可以返回数据表，数据集，数据视图，数组和集合</font></p>
<p><font face="Courier New"><strong>3.Ajax.NET的入门(以下例子在VS 2005下编写)</strong></font></p>
<p><font face="Courier New">1) 新建网站AjaxDemo</font></p>
<p><font face="Courier New">2)&nbsp;&nbsp;  首先，先添加对AjaxPro.2.dll的引用(Framework 1.1 为AjaxPro.dll)</font></p>
<p><font face="Courier New">3)&nbsp;&nbsp;  配置Web.Config文件<br>
&lt;configuration&gt;<br>
&nbsp;&nbsp;  &lt;system.web&gt;<br>
&nbsp;&nbsp;  &lt;!--　Ajax.NET Profession　<br>
&nbsp;&nbsp;&nbsp;&nbsp;  将ajaxpro下文件扩展名为.ashx 的文件的HTTP GET<br>
&nbsp;&nbsp;&nbsp;  和POST 请求映射到AjaxPro.AjaxHandlerFactory<br>
&nbsp;&nbsp;&nbsp;  处理程序<br>
&nbsp;&nbsp;&nbsp;  .Net Framework 1.1配置：<br>
&nbsp;&nbsp;  &lt;httpHandlers&gt;<br>
&nbsp;&nbsp;&nbsp;  &lt;add<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  verb=&quot;POST,GET&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  path=&quot;ajaxpro/*.ashx&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  type=&quot;AjaxPro.AjaxHandlerFactory, AjaxPro&quot;<br>
&nbsp;&nbsp;&nbsp;  /&gt;<br>
&nbsp;&nbsp;  &lt;/httpHandlers&gt;<br>
&nbsp;&nbsp;  --&gt;<br>
&nbsp;&nbsp;  &lt;httpHandlers&gt;<br>
&nbsp;&nbsp;  &lt;!--.Net Framework 2.0 配置--&gt;<br>
&nbsp;&nbsp;  &lt;add<br>
&nbsp;&nbsp;&nbsp;  verb=&quot;POST,GET&quot;<br>
&nbsp;&nbsp;&nbsp;  path=&quot;ajaxpro/*.ashx&quot;<br>
&nbsp;&nbsp;&nbsp;  type=&quot;AjaxPro.AjaxHandlerFactory, AjaxPro.2&quot;<br>
&nbsp;&nbsp;  /&gt;<br>
&nbsp;&nbsp;  &lt;/httpHandlers&gt;<br>
&nbsp;&nbsp;  &lt;/system.web&gt;<br>
&lt;/configuration&gt;</font></p>
<p><font face="Courier New">4)&nbsp;&nbsp;  新建页面FirstAjaxNet.aspx<br>
VS 2005新建页面默认不带命名空间，自己定义一个命名空间，这里我们全部用AjaxDemo作为名称空间，<br>
如果在后端代码添加以下代码设定命名空间,<br>
namespace AjaxDemo<br>
{<br>
//......<br>
}<br>
那么关联的Aspx页面上的<br>
&lt;%@ Page Language=&quot;C#&quot; ……. Inherits=&quot;AjaxDemo.FirstAjaxNet&quot; %&gt;<br>
中的Inherits属性也要进行相应的修改，否则编译将会出错。</font></p>
<p><font face="Courier New">添加一个.NET服务端方法GetAuthorName,为了让服务端方法能够和Javascript脚本编写的客户端方法能够交互，必须用Ajax.NET的属性标记把方法标记为AjaxPro.AjaxMethod属性；另外ASP.NET后端代码中的方法要在客户端脚本中进行调用，必须将方法所属类，通过Ajax.NET的AjaxPro.Utility.RegisterTypeForAjax进行类型注册。</font></p>
<p><font face="Courier New">5)&nbsp;&nbsp;  客户端脚本<br>
&lt;script language=&quot;javascript&quot; type=&quot;text/jscript&quot;&gt;<br>
&nbsp;&nbsp;  function GetAuthor()<br>
&nbsp;&nbsp;&nbsp;  {<br>
&nbsp;&nbsp;&nbsp;&nbsp;  //调用ASP.NET服务端方法，并回调JavaScript客户端脚本函数，<br>
&nbsp;&nbsp;&nbsp;&nbsp;  //必须在后端代码先注册所调用方法所属类的类型<br>
&nbsp;&nbsp;&nbsp;&nbsp;  return AjaxDemo.FirstAjaxNet.GetAuthorName(getAuthor_callback);<br>
&nbsp;&nbsp;&nbsp;  }<br>
<br>
&nbsp;&nbsp;  //JavaScript客户端脚本回调函数<br>
&nbsp;&nbsp;  function getAuthor_callback(res)<br>
&nbsp;&nbsp;&nbsp;  {<br>
&nbsp;&nbsp;&nbsp;&nbsp;  //res.value获得服务端方法返回值<br>
&nbsp;&nbsp;&nbsp;&nbsp;  document.getElementById(&quot;lblAuthor&quot;).innerText = res.value;<br>
&nbsp;&nbsp;&nbsp;&nbsp;  window.status = &quot;hi,&quot; + res.value + &quot; wellcome!&quot;;<br>
&nbsp;&nbsp;&nbsp;  }<br>
<br>
&nbsp;&nbsp;  function Init()<br>
&nbsp;&nbsp;&nbsp;  {<br>
&nbsp;&nbsp;&nbsp;&nbsp;  document.getElementById(&quot;divUserInfo&quot;).style.display=&quot;&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;  GetAuthor();<br>
&nbsp;&nbsp;&nbsp;  }<br>
&lt;/script&gt;</font></p>
<p><font face="Courier New">6)&nbsp;&nbsp;  HTML脚本<br>
&lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;<br>
&nbsp;&nbsp;  &lt;button id=&quot;btnAjaxTest&quot; onclick=&quot;javascript: return Init();&quot;&gt;AjaxTest&lt;/button&gt;&lt;br/&gt;<br>
&nbsp;&nbsp;  &lt;div id=&quot;divUserInfo&quot; style=&quot;display:none;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;  &lt;table&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &lt;td style=&quot;width:20%;&quot;&gt;作者姓名：&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &lt;td&gt;&lt;asp:Label id=&quot;lblAuthor&quot; runat=&quot;server&quot;&gt;&lt;/asp:Label&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;  &lt;/table&gt;<br>
&nbsp;&nbsp;  &lt;/div&gt;<br>
&lt;/form&gt;</font></p>
<p><font face="Courier New"><br>
7)&nbsp;&nbsp;  总结<br>
通过Ajax.NET库，我们可以在ASP.NET中简单、快速的实现Ajax。使用中我们要注意到：要让客户端脚本调用服务端方法，必须将要访问的方法进行AjaxPro.AjaxMethod属性标记,并将方法所属类的类型通过AjaxPro.Utility.RegisterTypeForAjax进行注册。<br>
<a href="http://hi.baidu.com/yujo/blog/category/ajax%26%2347%3Bjs">http://hi.baidu.com/yujo/blog/category/ajax%26%2347%3Bjs</a></font></p></div></body></html>