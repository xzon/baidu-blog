<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>SWT中处理多线程-SWTcode//hxzon有问题，主界面并不能响应鼠标动作</title></head><body><h1>SWT中处理多线程-SWTcode//hxzon有问题，主界面并不能响应鼠标动作</h1><div><div>
<div>
<p class="MsoNormal"><span style="font-size: 12pt"><span>SWT中处理多线程-SWTcode<strong>//hxzon有问题，主界面并不能响应鼠标动作</strong></span></span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 12pt">在<span><a target="_blank" href="http://www.eclipse.org/">Eclipse</a></span>中，<span><a target="_blank" href="http://www.eclipse.org/swt">SWT</a></span>是最重要的基石之一，负责了跨平台的本地界面显示，使<span>Java</span>也能够编写与系统相同的界面元素。在<span>SWT</span>中处理多线程也是其重要技术的表现。</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 12pt">SWT</span><span style="font-size: 12pt">有两个使用方法，分别是<span>asyncExec</span>和<span>syncExec</span>，前者是 异步执行与界面有关的操作，后者反之。为什么要这么做？由于<span>SWT</span>单独有一个线程（主线程）处理界面显示，数据显示等，如果要在其他线程中操作界面元素， 就必须使用上述两个方法执行，即将另外线程的操作交给主线程处理。</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 12pt">而<span>SWT</span>的多线程远没有这么简单。一般情况下，在<span>SWT</span>中运行线程时，其主线程不能阻塞，也能响应用户请求，比如鼠标和菜单等。在这种情况下，需要新建<span>Thread</span>来处理逻辑，在这个<span>Thread</span>中，必须使用上面的两个方法处理界面数据。</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 12pt">以下是一个简单的例子，启动<span>10</span>个线程，在<span>5</span>秒的时间内，刷新列表中各行的字符串，在这个过程中，主界面依然能够响应鼠标请求。代码有点<span>“</span>圆环套圆环<span>”</span>的感觉。</span></p>
<table class="MsoNormalTable FCK__ShowTableBorders" border="0" cellpadding="0">
    <tbody>
        <tr>
            <td style="padding-right: 0.75pt; padding-left: 0.75pt; padding-bottom: 0.75pt; padding-top: 0.75pt" nowrap="nowrap" valign="top">
            <p class="MsoNormal" style="text-align: left" align="left"><strong><span style="font-size: 12pt; color: rgb(127,0,85)">import </span></strong><span style="font-size: 12pt; color: black">org.eclipse.swt.SWT;</span><span style="font-size: 12pt"><br>
            <strong><span style="color: rgb(127,0,85)">import </span></strong><span style="color: black">org.eclipse.swt.custom.BusyIndicator;</span><br>
            <strong><span style="color: rgb(127,0,85)">import </span></strong><span style="color: black">org.eclipse.swt.events.SelectionAdapter;</span><br>
            <strong><span style="color: rgb(127,0,85)">import </span></strong><span style="color: black">org.eclipse.swt.events.SelectionEvent;</span><br>
            <strong><span style="color: rgb(127,0,85)">import </span></strong><span style="color: black">org.eclipse.swt.layout.GridData;</span><br>
            <strong><span style="color: rgb(127,0,85)">import </span></strong><span style="color: black">org.eclipse.swt.layout.GridLayout;</span><br>
            <strong><span style="color: rgb(127,0,85)">import </span></strong><span style="color: black">org.eclipse.swt.widgets.Button;</span><br>
            <strong><span style="color: rgb(127,0,85)">import </span></strong><span style="color: black">org.eclipse.swt.widgets.Display;</span><br>
            <strong><span style="color: rgb(127,0,85)">import </span></strong><span style="color: black">org.eclipse.swt.widgets.List;</span><br>
            <strong><span style="color: rgb(127,0,85)">import </span></strong><span style="color: black">org.eclipse.swt.widgets.Shell;</span><br>
            <br>
            <span style="color: rgb(63,95,191)">/**</span><br>
            <span style="color: rgb(63,95,191)">* </span><span style="color: rgb(127,159,191)">@author </span><span style="color: rgb(63,95,191)">tenyears.cn</span><br>
            <span style="color: rgb(63,95,191)">*/</span><br>
            <strong><span style="color: rgb(127,0,85)">public class </span></strong><span style="color: black">SWTThread {</span><br>
            <span style="color: white">&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">private int </span></strong><span style="color: black">size = </span><span style="color: rgb(153,0,0)">10</span><span style="color: black">; </span><span style="color: rgb(63,127,95)">// 10 threads</span><br>
            <span style="color: white">&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">private long </span></strong><span style="color: black">runTime = </span><span style="color: rgb(153,0,0)">5000</span><span style="color: black">; </span><span style="color: rgb(63,127,95)">// 5 seconds</span><br>
            <span style="color: white">&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">private </span></strong><span style="color: black">List list;</span><br>
            <span style="color: white">&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">private </span></strong><span style="color: black">Shell shell;</span><br>
            <span style="color: white">&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">public void </span></strong><span style="color: black">startThread() {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">for </span></strong><span style="color: black">(</span><strong><span style="color: rgb(127,0,85)">int </span></strong><span style="color: black">index = </span><span style="color: rgb(153,0,0)">0</span><span style="color: black">; index &lt; size; index++) {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">final int </span></strong><span style="color: black">listIndex = index;</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">final </span></strong><span style="color: black">Runnable refresh = </span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">Runnable() {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">public void </span></strong><span style="color: black">run() {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">final </span></strong><span style="color: black">Display disp = shell.getDisplay();</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">final </span></strong><span style="color: black">Runnable runOne = </span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">Runnable() {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">public void </span></strong><span style="color: black">run() {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">final long </span></strong><span style="color: black">start = System.currentTimeMillis();</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">while </span></strong><span style="color: black">((System.currentTimeMillis() - start) &lt; runTime) {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">disp.syncExec(</span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">Runnable() {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">public void </span></strong><span style="color: black">run() {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">if </span></strong><span style="color: black">(list.isDisposed())</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">return</span></strong><span style="color: black">;</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">String string = </span><span style="color: rgb(42,0,255)">"No." </span><span style="color: black">+ listIndex;</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">string += </span><span style="color: rgb(42,0,255)">" " </span><span style="color: black">+ (System.currentTimeMillis() - start);</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">list.setItem(listIndex, string);</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">}</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">});</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">try </span></strong><span style="color: black">{</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">Thread.sleep(</span><span style="color: rgb(153,0,0)">100</span><span style="color: black">);</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">} </span><strong><span style="color: rgb(127,0,85)">catch </span></strong><span style="color: black">(InterruptedException e) {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">}</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">};</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">}</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">};</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">Thread thread = </span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">Thread(runOne);</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">thread.start();</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">}</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">};</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">BusyIndicator.showWhile(shell.getDisplay(), refresh);//</span></span><span style="font-size: 12pt; color: black">这一句很关键</span><span style="font-size: 12pt"><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">}</span><br>
            <span style="color: white">&nbsp;&nbsp;</span><span style="color: black">}</span><br>
            <br>
            <span style="color: white">&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">public </span></strong><span style="color: black">Shell open(</span><strong><span style="color: rgb(127,0,85)">final </span></strong><span style="color: black">Display display) {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">shell = </span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">Shell(display, SWT.DIALOG_TRIM | SWT.MIN);</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">shell.setText(</span><span style="color: rgb(42,0,255)">"SWT Thread Test"</span><span style="color: black">);</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">shell.setLayout(</span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">GridLayout(</span><span style="color: rgb(153,0,0)">1</span><span style="color: black">, </span><strong><span style="color: rgb(127,0,85)">true</span></strong><span style="color: black">));</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">list = </span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">List(shell, SWT.BORDER);</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">list.setLayoutData(</span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">GridData(SWT.FILL, SWT.FILL, true, </span><strong><span style="color: rgb(127,0,85)">true</span></strong><span style="color: black">));</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">for </span></strong><span style="color: black">(</span><strong><span style="color: rgb(127,0,85)">int </span></strong><span style="color: black">index = </span><span style="color: rgb(153,0,0)">0</span><span style="color: black">; index &lt; size; index++)</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">list.add(</span><span style="color: rgb(42,0,255)">"String " </span><span style="color: black">+ (index + </span><span style="color: rgb(153,0,0)">1</span><span style="color: black">));</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">Button startBtn = </span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">Button(shell, SWT.PUSH);</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">startBtn.setLayoutData(</span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">GridData(SWT.FILL, SWT.CENTER, true, </span><strong><span style="color: rgb(127,0,85)">false</span></strong><span style="color: black">));</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">startBtn.setText(</span><span style="color: rgb(42,0,255)">"Start"</span><span style="color: black">);</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">SelectionAdapter selection = </span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">SelectionAdapter() {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">public void </span></strong><span style="color: black">widgetSelected(SelectionEvent e) {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">startThread();</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">}</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">};</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">startBtn.addSelectionListener(selection);</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">shell.setSize(</span><span style="color: rgb(153,0,0)">400</span><span style="color: black">, </span><span style="color: rgb(153,0,0)">300</span><span style="color: black">);</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">shell.open();</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">return </span></strong><span style="color: black">shell;</span><br>
            <span style="color: white">&nbsp;&nbsp;</span><span style="color: black">}</span><br>
            <br>
            <span style="color: white">&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">public static void </span></strong><span style="color: black">main(String[] args) {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">Display display = </span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">Display();</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">SWTThread application = </span><strong><span style="color: rgb(127,0,85)">new </span></strong><span style="color: black">SWTThread();</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">Shell shell = application.open(display);</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">while </span></strong><span style="color: black">(!shell.isDisposed()) {</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><strong><span style="color: rgb(127,0,85)">if </span></strong><span style="color: black">(!display.readAndDispatch())</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">display.sleep();</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">}</span><br>
            <span style="color: white">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: black">display.dispose();</span><br>
            <span style="color: white">&nbsp;&nbsp;</span><span style="color: black">}</span><br>
            <span style="color: black">}</span></span></p>
            </td>
        </tr>
    </tbody>
</table>
<p class="MsoNormal"><strong><span>说明：</span></strong></p>
<p class="MsoNormal"><span>下面分析</span><span>startThread</span><span>（）</span></p>
<p class="MsoNormal"><span>这个方法可以用于当这个方法的执行需要很长时间，而在其执行期间又不会影响其他方法的执行。本方法中的最后一句：</span></p>
<p class="MsoNormal"><span style="font-size: 10pt; color: black">BusyIndicator.<em>showWhile</em>(shell.getDisplay(), refresh);</span></p>
<p class="MsoNormal"><span style="font-size: 10pt; color: black">是关键，如果没有这一句则，执行此方法时，其他方法不能运行。</span></p>
<p class="MsoNormal"><span style="font-size: 10pt; color: black">这个方法的必须包含两个</span><span style="font-size: 10pt; color: black">Runnable</span><span style="font-size: 10pt; color: black">的是实现：其中外层用于</span></p>
<p class="MsoNormal"><span style="font-size: 10pt; color: black">BusyIndicator.<em>showWhile</em></span><em><span style="font-size: 10pt; color: black">（）</span></em><span style="font-size: 10pt; color: black">方法中作为参数</span></p>
<p class="MsoNormal"><span style="font-size: 10pt; color: black">长时间的运行代码应该放在里面的一个</span><span style="font-size: 10pt; color: black">runnable</span><span style="font-size: 10pt; color: black">实现的</span><span style="font-size: 10pt; color: black">run</span><span style="font-size: 10pt; color: black">（）方法中，例如：</span></p>
<p class="MsoNormal" style="text-align: left" align="left"> </p>
<p class="MsoNormal" style="text-align: left" align="left"><strong><span style="font-size: 10pt; color: rgb(127,0,85)">final</span></strong><span style="font-size: 10pt; color: black"> Runnable runOne = </span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">new</span></strong><span style="font-size: 10pt; color: black"> Runnable() {</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;  </span></span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">public</span></strong><span style="font-size: 10pt; color: black"> </span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">void</span></strong><span style="font-size: 10pt; color: black"> run() {</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;  </span></span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">final</span></strong><span style="font-size: 10pt; color: black"> </span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">long</span></strong><span style="font-size: 10pt; color: black"> start = System.<em>currentTimeMillis</em>();</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;  </span></span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">while</span></strong><span style="font-size: 10pt; color: black"> ((System.<em>currentTimeMillis</em>() - start) &lt; 1000*10) {</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span><span style="font-size: 10pt; color: rgb(0,0,192)">cnt</span><span style="font-size: 10pt; color: black">++;</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span>}<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;</span>};</span></p>
<p class="MsoNormal"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;  </span>};<span>&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;  </span></span></p>
<p class="MsoNormal"> </p>
<p class="MsoNormal"><span style="font-size: 10pt; color: black">startThread</span><span style="font-size: 10pt; color: black">方法可以简化为：（这个方法更清晰）</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span></span></p>
<p class="MsoNormal" style="text-align: left" align="left"><strong><span style="font-size: 10pt; color: rgb(127,0,85)">public</span></strong><span style="font-size: 10pt; color: black"> </span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">void</span></strong><span style="font-size: 10pt; color: black"> startThread() {</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">final</span></strong><span style="font-size: 10pt; color: black"> Runnable refresh = </span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">new</span></strong><span style="font-size: 10pt; color: black"> Runnable() {</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">public</span></strong><span style="font-size: 10pt; color: black"> </span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">void</span></strong><span style="font-size: 10pt; color: black"> run() { </span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">final</span></strong><span style="font-size: 10pt; color: black"> Runnable runOne = </span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">new</span></strong><span style="font-size: 10pt; color: black"> Runnable() {</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">public</span></strong><span style="font-size: 10pt; color: black"> </span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">void</span></strong><span style="font-size: 10pt; color: black"> run() {</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">final</span></strong><span style="font-size: 10pt; color: black"> </span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">long</span></strong><span style="font-size: 10pt; color: black"> start = System.<em>currentTimeMillis</em>();</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">while</span></strong><span style="font-size: 10pt; color: black"> ((System.<em>currentTimeMillis</em>() - start) &lt; 1000*10) {</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;</span></span><span style="font-size: 10pt; color: rgb(0,0,192)">cnt</span><span style="font-size: 10pt; color: black">++;</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span>}<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span>};</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span>};<span>&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span></span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span>Thread thread = </span><strong><span style="font-size: 10pt; color: rgb(127,0,85)">new</span></strong><span style="font-size: 10pt; color: black"> Thread(runOne);</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span>thread.start();</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span>}</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span>};</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span>BusyIndicator.<em>showWhile</em>(</span><span style="font-size: 10pt; color: rgb(0,0,192)">shell</span><span style="font-size: 10pt; color: black">.getDisplay(), refresh);</span></p>
<p class="MsoNormal" style="text-align: left" align="left"><span style="font-size: 10pt; color: black"><span>&nbsp;&nbsp;&nbsp;  </span><span>&nbsp;&nbsp;&nbsp;  </span>}</span></p>
<p class="MsoNormal"> </p>
<p class="MsoNormal"><span style="font-size: 10pt; color: black">//hxzon有问题，主界面并不能响应鼠标动作</span></p>
</div>
</div></div></body></html>