<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>SWT中的FormLayout     选择自 starshus 的 Blog</title></head><body><h1>SWT中的FormLayout     选择自 starshus 的 Blog</h1><div><p><span><strong>SWT中的FormLayout</strong></span>&nbsp;&nbsp;&nbsp;&nbsp;  选择自 <a href="http://dev.csdn.net/user/starshus">starshus</a> 的 Blog</p><p>象其它的layout类一样，FormLayout用的data类是:FormData。FormData用另外一个类来控制窗口小部件的大小和位 置:  FormAttachment.一个FormData最多用4个FormAttachment,它们分别对应这个小部件的4个面:顶部，底部，左边和右 边。FormAttachment定义了小部件在parent composite或是这个composite里其它部件的位置。</p><p><span style="font-size: 16px">FormAttachment计算位置和大小的方法:</span></p><p><span style="font-size: 16px">y=ax+b<br></span></p><p><span style="font-size: 16px">在这个等式中,在数学上y代表的是纵坐标,x是横坐标值.a是斜率,b是偏移量.按照FormAttachment的规则,y是高,x是宽度,a是一个相对其它部件的百分率,b是偏移量.FormAttachment实例中的每个数据成员分别代表这些值.</span></p><p><span style="font-size: 16px">以下(表一)是FormAttachment的数据成员表和相应的意思:</span></p><p><span style="font-size: 16px">表一:FormAttachment数据成员</span></p><p><table border="1"><thead><tr><th align="left"><br></th><th align="left"><br></th></tr></thead><tbody><tr><td align="left"><p><span style="font-size: 16px"><span>int alignment</span></span></p></td><td align="left"><p><span style="font-size: 16px">指定是以另外一个部件的哪一边为基准的.可能的值是:<span>SWT.TOP</span>, <span>SWT.CENTER</span>, 和 <span>SWT.BOTTOM.默认是以最近的一边为基准.</span></span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>Control control</span></span></p></td><td align="left"><p><span style="font-size: 16px">指定FormAttachment是以哪个部件为参照物.</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>int denominator</span></span></p></td><td align="left"><p><span style="font-size: 16px">指定分母.默认值为100</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>int numerator</span></span></p></td><td align="left"><p><span style="font-size: 16px">指定分子</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>int offset</span></span></p></td><td align="left"><p><span style="font-size: 16px">指定离composite边界或部件的边界的偏移量.单位是象素.</span></p></td></tr></tbody></table></p><p><span style="font-size: 16px">　</span></p><p><span style="font-size: 16px"><span>FormAttachment</span> 拥有5个构造函数,没有一个是空的,它们如下表(表二)所示:</span></p><p><span style="font-size: 16px">表二:<span>FormAttachment</span>的构造函数:</span></p><p><table border="1"><thead><tr><th align="left"><br></th><th align="left"><br></th></tr></thead><tbody><tr><td align="left"><p><span style="font-size: 16px"><span>FormAttachment(Control control)</span></span></p></td><td align="left"><p><span style="font-size: 16px">以另外的某个部件为参照物.</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>FormAttachment(Control control, int offset)</span></span></p></td><td align="left"><p><span style="font-size: 16px">以另外的某个部件为参照物,加上偏移量.</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>FormAttachment(Control control, int offset, int alignment)</span></span></p></td><td align="left"><p><span style="font-size: 16px">以另外的某个部件为参照物,加上偏移量和alignment</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>FormAttachment(int numerator)</span></span></p></td><td align="left"><p><span style="font-size: 16px">设定分子.分母为100,没有偏移量</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>FormAttachment(int numerator, int offset)</span></span></p></td><td align="left"><p><span style="font-size: 16px">指定分子和偏移量和100的分母</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>FormAttachment(int numerator, int denominator, int offset)</span></span></p></td><td align="left"><p><span style="font-size: 16px">特定的分子,分母,偏移量</span></p></td></tr></tbody></table></p><p><span style="font-size: 16px">FormData最多包含4个<span>FormAttachment实例,每个对应了与它联系的部件的一边.另外,FormData也可以指定宽和高.表四列出了FormData的数据成员:</span></span></p><p><table border="1"><thead><tr><th align="left"><br></th><th align="left"><br></th></tr></thead><tbody><tr><td align="left"><p><span style="font-size: 16px"><span>FormAttachment bottom</span></span></p></td><td align="left"><p><span style="font-size: 16px">The <span>FormAttachment</span> corresponding to the bottom side of the control.</span></p><p><span style="font-size: 16px">这个<span>FormAttachment</span>用来指定部件的底部位置</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>int height</span></span></p></td><td align="left"><p><span style="font-size: 16px">这个部件的高度.单位为象素.</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>FormAttachment left</span></span></p></td><td align="left"><p><span style="font-size: 16px">这个<span>FormAttachment</span>用来指定部件的左部位置</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>FormAttachment right</span></span></p></td><td align="left"><p><span style="font-size: 16px">这个<span>FormAttachment</span>用来指定部件的右部位置</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>FormAttachment top</span></span></p></td><td align="left"><p><span style="font-size: 16px">这个<span>FormAttachment</span>用来指定部件的顶部位置</span></p></td></tr><tr><td align="left"><p><span style="font-size: 16px"><span>int width</span></span></p></td><td align="left"><p><span style="font-size: 16px">这个部件的宽度.单位为象素.</span></p></td></tr></tbody></table></p><p>&nbsp;</p><p><span style="font-size: 10.5pt">当你生成一个FormData对象,你可以自己传给它宽和高的值.如果你没有指定FormAttachment对象,部件会自动以parent composite的上边界和左边为起始边界.如果你这样定义了多个部件,它们会都在composite的左上角.<br>FormLayout有两个数据成员 marginHeight和marginWidth,用来以象素为单位来指定大小.它们用来指定包围composite里所有内容的空白. marginHeight对应的是顶部和底部的空白大小,marginWidth对应的是左边和右边的空白大小.空白的默认值是0.<br>以上的话如果你看得不大懂也没有关系,我们按照具体的例子来看就知道了.<br>用到FormLayout的最简单的例子就是一个窗口里一个按钮,并且不用FormData.<br>//FormLayoutSimple.java</span></p><p><span style="font-size: 10.5pt">import org.eclipse.swt.widgets.*;<br>import org.eclipse.swt.layout.FormLayout;<br>import org.eclipse.swt.SWT;</span></p><p><span style="font-size: 10.5pt">public class FormLayoutSimple {<br>public static void main(String[] args) {<br>&nbsp;&nbsp;&nbsp;    Display display = new Display();<br>&nbsp;&nbsp;&nbsp;    Shell shell = new Shell(display);<br>&nbsp;&nbsp;&nbsp;    shell.setLayout(new FormLayout());<br>&nbsp;&nbsp;&nbsp;    new Button(shell, SWT.PUSH).setText("Button");<br>&nbsp;&nbsp;&nbsp;    shell.pack();<br>&nbsp;&nbsp;&nbsp;    shell.open();<br>&nbsp;&nbsp;&nbsp;    while (!shell.isDisposed()) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (!display.readAndDispatch()) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    display.sleep();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    }<br>&nbsp;&nbsp;&nbsp;    }<br>&nbsp;&nbsp;&nbsp;    display.dispose();<br>}<br>}<br>你可以通过设定marginHeight和marginWidth值改变周围的空白.<br>代码象这样: <br>FormLayout layout = new FormLayout();<br>layout.marginHeight = 5;<br>layout.marginWidth = 10;<br>shell.setLayout(layout);</span></p><p><span style="font-size: 10.5pt">结果象这样: <br></span></p><p><span style="font-size: 10.5pt">但是,只有用FormData和FormAttachment你才能做更多的事. <br>试着使用FormData,但是不用FormAttachments,FormData有公共成员属性height和width用来改变按钮的大小.</span></p><p><span style="font-size: 10.5pt">Button button = new Button(shell, SWT.PUSH);<br>button.setText("Button");<br>FormData data = new FormData();<br>data.height = 50;<br>data.width = 50;<br>button.setLayoutData(data);&nbsp;</span></p><p><span style="font-size: 10.5pt">结果象这样:&nbsp;</span></p><p><span style="font-size: 10.5pt">按钮在窗口中的位置是静态的,也就是说改变窗口的大小不影响按钮的位置. <br>我们举个例子,比如说,你希望这个按钮始终离窗口的右边界50个象素的话,你必须在你刚刚产生的FormData上添加一个FormAttachment.<br>因为你现在要指定这个按钮的右边的具体情况了.所以你现在要设置FormData的right属性,还记得FormData的right属性是一个FormAttachment对象吧.<br>当与parent composite产生联系时,如果是顶部和左边的话,分子设置为0,如果是顶部和右边的话,分子设置为100,分别代表了0%和100%.可以在<br>构造函数中设置分子.我们现在把分子设置为100,偏移量设置为-50.我们不需要设置分母,因为它的默认大小是100.代码象这样: <br>data.right = new FormAttachment(100, -50); <br>现在编译并运行程序,按钮离右边刚好50个象素.缩小窗口也不会有任何影响,按钮离右边始终是50象素. <br></span></p><p><span style="font-size: 10.5pt">改变窗口大小： <br></span></p><p><span style="font-size: 10.5pt">现在按钮总是维持它离右边50个象素,但是我们需要它始终保持位置不变,并且随着窗口的伸缩而伸缩.要实现这个要求,我们必须设置它的左边,所以可以这样实现:<br>data.left = new FormAttachment(0, 10);<br>把分子的值设置为0表示它是以窗口的最左边来计算偏移量的.偏移量设置为10表示它始终离窗口最左边10个象素.重新编译运行程序,初始界面好象和刚刚差不多,但是改变窗口大小就可以看到按钮离窗口左边的大小始终没有改变.<br><br>离左边和离右边的值已经设置好了,所以它的宽度自然也定下来了，我们可以把原来FormData设置的按钮宽度那行代码删掉了.<br>现在有点熟悉了吧,现在我们把按钮联系到窗口的顶部和底部.我们可以把它放到离窗口顶部25%的距离.我们可以简单的表示为1/4,而不是0.25让分母保持为默认值(这样也可以).我们把偏移量设置为0.加上这句代码:<br>data.top = new FormAttachment(1, 4, 0);<br>现在按钮保持与顶部1/4的距离了.无论怎么改变窗口大小都是这样.<br><br>让我们在这个按钮下面再添加一个按钮.我们把这个按钮布置在现在的按钮下面,添加按钮的顶部在现在的按钮的底部下面5个象素.并且左边和右边分别和现在的按钮对齐.从下面的代码开始:</span></p><p><span style="font-size: 10.5pt">Button button2 = new Button(shell, SWT.PUSH);<br>button2.setText("Button 2");</span></p><p><span style="font-size: 10.5pt">然后我们产生一个FormData对象,设置它的bottom成员.我们把分子设置为0,偏移量为0&nbsp;</span></p><p><span style="font-size: 10.5pt">data = new FormData();<br>button2.setLayoutData(data);<br>data.bottom = new FormAttachment(100, 0);<br><br>为了以现在的按钮为标准来算偏移量,我们只需要把第一个按钮传个FormAttachment的构造函数就可以了,那么现在就不是以窗口边界来计算,而是以传递给它的按钮来计算了.我们要把这个按钮加到以有按钮的下面5个象素处,所以偏移量是5.</span></p><p><span style="font-size: 10.5pt">data.top = new FormAttachment(button, 5);</span></p><p><span style="font-size: 10.5pt">我们不需要设置为以按钮的底部为界,因为默认情况下,边界被自动设是离这个按钮最近的边界.因为我们指定的FormAttachment是用来<br>指定新按钮的顶部的,而且新按钮是在第一个按钮后面加上去的,新按钮离第一个按钮的地方最近的就是底部. <br><br>你可能就用同样的构造函数来设置新按钮的左边界,甚至就用只需要一个Control对象的构造函数,因为偏移量是0.象这样:</span></p><p><span style="font-size: 10.5pt">data.left = new FormAttachment(button); <br></span></p><p><span style="font-size: 10.5pt">但是这句代码是以第一个按钮的右边为基准来计算的,如上图所示:因为新添加的按钮左边离第一个按钮最近的边界是它的右边.所以我们<br>必须清楚地指定按第一个按钮的左边界为基准.只需要传给构造函数SWT.LEFT值给FromData对象的alignment成员:</span></p><p><span style="font-size: 10.5pt">data.left = new FormAttachment(button, 0, SWT.LEFT); <br><br>我们同样的方法设置新按钮的右边,完成任务.</span></p><p><span style="font-size: 10.5pt">data.right = new FormAttachment(button, 0, SWT.RIGHT);</span></p><p><span style="font-size: 10.5pt">编译运行程序,你可以看到我们预期的结果,如下图: <br></span></p><p><span style="font-size: 10.5pt">完整的代码如下:<br>import org.eclipse.swt.widgets.*;<br>import org.eclipse.swt.layout.FormAttachment;<br>import org.eclipse.swt.layout.FormData;<br>import org.eclipse.swt.layout.FormLayout;<br>import org.eclipse.swt.SWT;</span></p><p><span style="font-size: 10.5pt">public class FormLayoutFormAttachment {<br>public static void main(String[] args) {<br>&nbsp;&nbsp;&nbsp;    Display display = new Display();<br>&nbsp;&nbsp;&nbsp;    Shell shell = new Shell(display);<br>&nbsp;&nbsp;&nbsp;    FormLayout layout = new FormLayout();<br>&nbsp;&nbsp;&nbsp;    layout.marginHeight = 5;<br>&nbsp;&nbsp;&nbsp;    layout.marginWidth = 10;<br>&nbsp;&nbsp;&nbsp;    shell.setLayout(layout);<br>&nbsp;&nbsp;&nbsp;    Button button = new Button(shell, SWT.PUSH);<br>&nbsp;&nbsp;&nbsp;    button.setText("Button");<br>&nbsp;&nbsp;&nbsp;    FormData data = new FormData();<br>&nbsp;&nbsp;&nbsp;    data.height = 50;<br>&nbsp;&nbsp;&nbsp;    data.right = new FormAttachment(100, -50);<br>&nbsp;&nbsp;&nbsp;    data.left = new FormAttachment(0, 10);<br>&nbsp;&nbsp;&nbsp;    data.top = new FormAttachment(1, 4, 0);<br>&nbsp;&nbsp;&nbsp;    button.setLayoutData(data);</span></p><p><span style="font-size: 10.5pt">&nbsp;&nbsp;&nbsp;    Button button2 = new Button(shell, SWT.PUSH);<br>&nbsp;&nbsp;&nbsp;    button2.setText("Button 2");<br>&nbsp;&nbsp;&nbsp;    data = new FormData();<br>&nbsp;&nbsp;&nbsp;    button2.setLayoutData(data);<br>&nbsp;&nbsp;&nbsp;    data.bottom = new FormAttachment(100, 0);<br>&nbsp;&nbsp;&nbsp;    data.top = new FormAttachment(button, 5);<br>&nbsp;&nbsp;&nbsp;    data.left = new FormAttachment(button, 0, SWT.LEFT);<br>&nbsp;&nbsp;&nbsp;    data.right = new FormAttachment(button, 0, SWT.RIGHT);</span></p><p><span style="font-size: 10.5pt">&nbsp;&nbsp;&nbsp;    shell.pack();<br>&nbsp;&nbsp;&nbsp;    shell.open();<br>&nbsp;&nbsp;&nbsp;    while (!shell.isDisposed()) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (!display.readAndDispatch()) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    display.sleep();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    }<br>&nbsp;&nbsp;&nbsp;    }<br>&nbsp;&nbsp;&nbsp;    display.dispose();<br>}<br>} <br><br>Now that you understand the fundamentals of FormLayout, FormData, and FormAttachment, <br>现在我们搞清楚了FormLayout,FormData和FormAttachment的基本概念. <br><br>下面写一个更加复杂的程序,代码如下:我就不多解释了,应该都看得懂,运行结果出来后,无论怎么改变窗口的大小,所有按钮的位置都没有<br>改变. <br>import org.eclipse.swt.widgets.*;<br>import org.eclipse.swt.layout.FormAttachment;<br>import org.eclipse.swt.layout.FormData;<br>import org.eclipse.swt.layout.FormLayout;<br>import org.eclipse.swt.layout.GridData;<br>import org.eclipse.swt.layout.GridLayout;<br>import org.eclipse.swt.SWT;</span></p><p><span style="font-size: 10.5pt">public class FormLayoutComplex {<br>public static void main(String[] args) {<br>&nbsp;&nbsp;&nbsp;    Display display = new Display();<br>&nbsp;&nbsp;&nbsp;    Shell shell = new Shell(display);<br>&nbsp;&nbsp;&nbsp;    FormLayout layout = new FormLayout();<br>&nbsp;&nbsp;&nbsp;    shell.setLayout(layout);<br>&nbsp;&nbsp;&nbsp;    Button one = new Button(shell, SWT.PUSH);<br>&nbsp;&nbsp;&nbsp;    one.setText("One");<br>&nbsp;&nbsp;&nbsp;    FormData data = new FormData();<br>&nbsp;&nbsp;&nbsp;    data.top = new FormAttachment(0, 5);<br>&nbsp;&nbsp;&nbsp;    data.left = new FormAttachment(0, 5);<br>&nbsp;&nbsp;&nbsp;    data.bottom = new FormAttachment(50, -5);<br>&nbsp;&nbsp;&nbsp;    data.right = new FormAttachment(50, -5);<br>&nbsp;&nbsp;&nbsp;    one.setLayoutData(data);</span></p><p><span style="font-size: 10.5pt">&nbsp;&nbsp;&nbsp;    Composite composite = new Composite(shell, SWT.NONE);<br>&nbsp;&nbsp;&nbsp;    GridLayout gridLayout = new GridLayout();<br>&nbsp;&nbsp;&nbsp;    gridLayout.marginHeight = 0;<br>&nbsp;&nbsp;&nbsp;    gridLayout.marginWidth = 0;<br>&nbsp;&nbsp;&nbsp;    composite.setLayout(gridLayout);<br>&nbsp;&nbsp;&nbsp;    Button two = new Button(composite, SWT.PUSH);<br>&nbsp;&nbsp;&nbsp;    two.setText("two");<br>&nbsp;&nbsp;&nbsp;    GridData gridData = new GridData(GridData.FILL_BOTH);<br>&nbsp;&nbsp;&nbsp;    two.setLayoutData(gridData);<br>&nbsp;&nbsp;&nbsp;    Button three = new Button(composite, SWT.PUSH);<br>&nbsp;&nbsp;&nbsp;    three.setText("three");<br>&nbsp;&nbsp;&nbsp;    gridData = new GridData(GridData.FILL_BOTH);<br>&nbsp;&nbsp;&nbsp;    three.setLayoutData(gridData);<br>&nbsp;&nbsp;&nbsp;    Button four = new Button(composite, SWT.PUSH);<br>&nbsp;&nbsp;&nbsp;    four.setText("four");<br>&nbsp;&nbsp;&nbsp;    gridData = new GridData(GridData.FILL_BOTH);<br>&nbsp;&nbsp;&nbsp;    four.setLayoutData(gridData);<br>&nbsp;&nbsp;&nbsp;    data = new FormData();<br>&nbsp;&nbsp;&nbsp;    data.top = new FormAttachment(0, 5);<br>&nbsp;&nbsp;&nbsp;    data.left = new FormAttachment(one, 5);<br>&nbsp;&nbsp;&nbsp;    data.bottom = new FormAttachment(50, -5);<br>&nbsp;&nbsp;&nbsp;    data.right = new FormAttachment(100, -5);<br>&nbsp;&nbsp;&nbsp;    composite.setLayoutData(data);</span></p><p><span style="font-size: 10.5pt">&nbsp;&nbsp;&nbsp;    Button five = new Button(shell, SWT.PUSH);<br>&nbsp;&nbsp;&nbsp;    five.setText("five");<br>&nbsp;&nbsp;&nbsp;    data = new FormData();<br>&nbsp;&nbsp;&nbsp;    data.top = new FormAttachment(one, 5);<br>&nbsp;&nbsp;&nbsp;    data.left = new FormAttachment(0, 5);<br>&nbsp;&nbsp;&nbsp;    data.bottom = new FormAttachment(100, -5);<br>&nbsp;&nbsp;&nbsp;    data.right = new FormAttachment(100, -5);<br>&nbsp;&nbsp;&nbsp;    five.setLayoutData(data);<br>&nbsp;&nbsp;&nbsp;    shell.pack();<br>&nbsp;&nbsp;&nbsp;    shell.open();<br>&nbsp;&nbsp;&nbsp;    while (!shell.isDisposed()) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    if (!display.readAndDispatch()) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    display.sleep();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    }<br>&nbsp;&nbsp;&nbsp;    }<br>&nbsp;&nbsp;&nbsp;    display.dispose();<br>}<br>}</span></p><p><span style="font-size: 10.5pt">运行结果： <br></span></p><p><span style="font-size: 10.5pt">改变窗口大小： <br></span></p><p><span style="font-size: 10.5pt">转载请注明来自:blog.csdn.net/starshus</span></p><p><span style="font-size: 10.5pt"><br></span></p></div></body></html>