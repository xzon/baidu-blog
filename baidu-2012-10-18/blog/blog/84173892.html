<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>.NET设计模式（7）：创建型模式专题总结（Creational Pattern） （续2）</title></head><body><h1>.NET设计模式（7）：创建型模式专题总结（Creational Pattern） （续2）</h1><div><p> </p>
<p><a href="http://www.cnblogs.com/Terrylee/archive/2006/01/16/318285.html"><font color="#e58712">.NET设计模式（7）：创建型模式专题总结（Creational Pattern）</font></a>（续2）</p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">如果在游戏场景中，构成某一个场景的算法比较稳定，例如：这个场景就是用四堵墙，一个屋子，一扇门来构成的，但具体是用什么风格的墙、屋子和门则是不停的变化的，这就是一个生成器模式的例子。解决的是&ldquo;对象部分&rdquo;的需求变化问题。</span></p>
<p class="MsoNormal" style="line-height: 150%; text-align: center" align="center"><span style="font-size: 10pt; line-height: 150%"><img height="168" hspace="0" width="414" src="http://terrylee.cnblogs.com/images/cnblogs_com/terrylee/PIC084.jpg"></span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">示例代码：</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">using System;</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">using System.Collections;</span></p>
<p class="MsoNormal" style="line-height: 150%"> </p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">public class Director</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">{</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public void Construct( Builder builder )</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  {</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  builder.BuildWall();</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  builder.BuildRoom();</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  builder.BuildDoor();</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  }</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">}</span></p>
<p class="MsoNormal" style="line-height: 150%"> </p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">public abstract class Builder</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">{</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public abstract void BuildWall();</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public abstract void BuildRoom();</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public abstract void BuildDoor();</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public abstract GameScene GetResult();</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">}</span></p>
<p class="MsoNormal" style="line-height: 150%"> </p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">public class GameBuilder : Builder</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">{</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  private GameScene g;</span></p>
<p class="MsoNormal" style="line-height: 150%"> </p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public override void BuildWall()</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  {</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  g = new GameScene();</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  g.Add( &quot;Wall&quot; );</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  }</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public override void BuildRoom()</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  {</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  g.Add( &quot;Room&quot; );</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  }</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public override void BuildDoor()</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  {</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  g.Add( &quot;Door&quot; );</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  }</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public override GameScene GetResult()</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  {</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  return g;</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  }</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">}</span></p>
<p class="MsoNormal" style="line-height: 150%"> </p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">public class GameScene</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">{</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  ArrayList parts = new ArrayList();</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public void Add( string part )</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  {</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  parts.Add( part );</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  }</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public void Display()</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  {</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Console.WriteLine( &quot; GameScene Parts：&quot; );</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  foreach( string part in parts )</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Console.WriteLine( part );</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  }</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">}</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">如果在游戏中，需要大量的古典风格或现代风格的墙或屋子，这时可以通过拷贝一个已有的原型对象来生成新对象，就是一个原型模式的例子了。通过克隆来解决&ldquo;易变对象&rdquo;的创建问题。</span></p>
<p class="MsoNormal" style="line-height: 150%; text-align: center" align="center"><span style="font-size: 10pt; line-height: 150%"><img height="149" hspace="0" width="359" src="http://terrylee.cnblogs.com/images/cnblogs_com/terrylee/PIC085.jpg"></span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">示例代码：</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">using System;</span></p>
<p class="MsoNormal" style="line-height: 150%"> </p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">public abstract class RoomPrototype</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">{</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public abstract RoomPrototype Clone();</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">}</span></p>
<p class="MsoNormal" style="line-height: 150%"> </p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">public class ModernPrototype:RoomPrototype</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">{</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public override RoomPrototype Clone()</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  {</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  return (RoomPrototype)this.MemberwiseClone();</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  }</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">}</span></p>
<p class="MsoNormal" style="line-height: 150%"> </p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">public class ClassicalPrototype:RoomPrototype</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">{</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  public override RoomPrototype Clone()</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  {</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  return (RoomPrototype)this.MemberwiseClone();</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">&nbsp;&nbsp;&nbsp;  }</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">}</span></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">究竟选用哪一种模式最好取决于很多的因素。使用</span><span style="font-size: 10pt; line-height: 150%">Abstract Factory</span><span style="font-size: 10pt; line-height: 150%">、</span><span style="font-size: 10pt; line-height: 150%">Prototype Pattern</span><span style="font-size: 10pt; line-height: 150%">或</span><span style="font-size: 10pt; line-height: 150%">Builder Pattern</span><span style="font-size: 10pt; line-height: 150%">的设计比使用</span><span style="font-size: 10pt; line-height: 150%">Factory Method</span><span style="font-size: 10pt; line-height: 150%">的设计更加灵活，但是也更加复杂，尤其</span><span style="font-size: 10pt; line-height: 150%">Abstract Factory</span><span style="font-size: 10pt; line-height: 150%">需要庞大的工厂类来支持。通常，设计以使用</span><span style="font-size: 10pt; line-height: 150%">Factory Method</span><span style="font-size: 10pt; line-height: 150%">开始，并且当设计者发现需要更大的灵活性时，设计便会向其他设计模式演化，当你在多个设计模式之间进行权衡的时候，了解多个设计模式可以给你提供更多的选择余地。</span></p>
<p class="MsoNormal" style="line-height: 150%"><strong style="mso-bidi-font-weight: normal"><span style="font-size: 10pt; color: #006699; line-height: 150%">总结</span></strong></p>
<p class="MsoNormal" style="line-height: 150%"><span style="font-size: 10pt; line-height: 150%">使用创建者模式是为了提高系统的可维护性和可扩展性，提高应对需求变化的能力！<br>
</span><span style="font-size: 10pt; line-height: 150%"><br>
参考文献：<br>
《设计模式中文版》<br>
《DesignPatternsExplained》<br>
<font color="#223355">idior</font> 的《<font color="#e58712">你了解创建者模式了吗? --- 创建者模式详解</font> 》http://idior.cnblogs.com/archive/2005/04/14/137913.html<br>
MSDN WebCast：<font color="#e58712">http://www.microsoft.com/china/msdn/events/webcasts/shared/Webcast/MSDNWebCast.aspx</font><br>
</span></p>
<div>作者：<font color="#e58712">TerryLee</font><br>
出处：<font color="#e58712">http://terrylee.cnblogs.com</font>&nbsp;&nbsp;  http://terrylee.cnblogs.com/archive/2006/06/01/334911.html</div></div></body></html>