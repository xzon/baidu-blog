<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>java版本的飞鸽编写</title></head><body><h1>java版本的飞鸽编写</h1><div><p>java版本的飞鸽编写</p>
<p>终于给学生上完java了:)</p>
<p>但离考试还有三周时间（太长了）:(</p>
<p>想了半天，是教学生JDBC还是网络编程了 :~</p>
<p>最终还是决定教网络编程好了，因为他们都在用&ldquo;飞鸽&rdquo;传文件或信息</p>
<p>*************飞鸽解释**************<br>
一个在局域网中的传递信息的软件</p>
<p>因为那个软件是用C++做的</p>
<p>那么现在做一个用Java写的</p>
<p>***********************************</p>
<p> </p>
<p>于是仔细的分析了一下，&ldquo;飞鸽&rdquo;的执行流程</p>
<p>当打开飞鸽的时候，就显示了在线的用户（当然对方也得打开飞鸽才能看到）</p>
<p>然后花了一天时间，就写了个大概的功能出来了</p>
<p>现在就开始分享我的设计子旅好了啊，哈哈。。。</p>
<p>首先分析了一下网络原理</p>
<p>决定用UDP来发送信息，</p>
<p>TCP来实现传文件</p>
<p>因传送任何消息之前要确定主机名----IP地址之间的对应关系</p>
<p>而获取对应的关系，只有通过DNS的方式，来获取</p>
<p>于是开始踏上了行程，例如某局域网的IP地址为172.16.6.71</p>
<p>那么地址的分配那么该局域网的IP地址应为172.16.6.1-----17.16.6.254</p>
<p>于是只有通过遍历来做，从1到254</p>
<p>但是发现速度太慢，因为用的是DNS每次都要去解析</p>
<p>后来决定开动20个thread</p>
<p>每一个thread负责一个IP段</p>
<p>例如第一个thread负责172.16.6.1--172.16.6.10</p>
<p>但是速度虽然有些提高，但是仍然不是满意的时间</p>
<p>所以决定换一个思路</p>
<p>用广播来做</p>
<p>那么该局域网的广播地址为172.16.6.255或172.16.255.255(要看具体的子网掩码地址是什么)</p>
<p>于是改网的每太机器必定会收到一个广播包，</p>
<p>收到广播包，就将自己的主机名称和本机IP地址组装成一个新的包，返回给信息发送者</p>
<p>那么必定要在每个机上打开一个端口，来接受广播包和回复操作</p>
<p>因为不知道用户什么时候发送广播，所以要用线程来做，要不断的监听广播端口</p>
<p>代码如下</p>
<p>//端口8888用来发送广播包和用户收到广播包的反馈信息<br>
//端口8889用来接受广播包<br>
//监听广播信息,如故收到信息则将自己的主机地址和IP地址反馈给发包者</p>
<p>import java.io.*;<br>
import java.net.*;</p>
<p>class Listeningbroad extends Thread{<br>
<br>
&nbsp;&nbsp;&nbsp;  DatagramSocket s;&nbsp;&nbsp;  //打开相应Socket的类<br>
&nbsp;&nbsp;&nbsp;  DatagramPacket p;&nbsp;&nbsp;  //封装相应数据包的类<br>
&nbsp;&nbsp;&nbsp;  InetAddress ip;&nbsp;&nbsp;&nbsp;&nbsp;  //封装IP地址的类（例如要得到已知IP地址对应的主机名，就需要要改类）<br>
&nbsp;&nbsp;&nbsp;  byte[] data= new byte[5];</p>
<p><br>
Listeningbroad(){<br>
try{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  s=new DatagramSocket(8889); //打开接收广播包的端口<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  p=new DatagramPacket(data,5); //接受的广播包的大小为5Byte<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;  }catch(IOException e){<br>
&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println (e.getMessage());<br>
&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
<br>
<br>
}<br>
<br>
<br>
public void run(){<br>
<br>
while(true){ <br>
&nbsp;&nbsp;&nbsp;  //功能:收到用户的请求广播包后,将本机的主机名+IP地址发给请求者<br>
&nbsp;&nbsp;&nbsp;  try{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  s.receive(p);&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ip=InetAddress.getLocalHost();<br>
&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  String temp=ip.getHostName()+&quot;@&quot;+ip.getHostAddress();<br>
&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  data=temp.getBytes(); //因为数据包是以byte的形式构造和发送的，固必须转换<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  p.setAddress(p.getAddress()); //从收到的UDP的包中，获取发送者的IP地址设计为包的接受地址<br>
&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  p.setData(data);&nbsp;&nbsp;  //设置包的数据部分<br>
&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  p.setPort(8888); //设置包到目的地址的哪个端口<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  s.send(p); <br>
&nbsp;&nbsp;&nbsp;&nbsp;  }catch(IOException e){<br>
&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println (e.getMessage());<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;  try{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Thread.sleep(300); //尝试让线程休眠300毫秒，这样做可以降低CPU的使用率<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;  }catch(InterruptedException e){}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
&nbsp;&nbsp;  }<br>
&nbsp;&nbsp;  <br>
}</p>
<p>那么我们将在</p>
<p>下一篇中将讲诉如何发送一个广播的UDP数据包</p>
<p>希望大家看到这边贴子，能对大家有所提高</p>
<p>当然不明白的地方也可以在回复中留言</p>
<p>我会回答哟===================================================================</p>
<p>上篇讲到了，接收到了广播包，应该如何去做</p>
<p>因为不知道用户什么时候发送广播包</p>
<p>所以也要用个线程来不断的监听广播端口</p>
<p>当收到一个请求包后，将自己的信息反馈给发送者</p>
<p>现在就讲用户如何发送广播包</p>
<p>我定义了一个发送消息的一个类(Sendmes)</p>
<p>这个类有两个构造方法</p>
<p>默认的构造方法发送广播包</p>
<p>有参数的构造方法Sendmes(byte[] ip,byte data[])</p>
<p>其中IP表示接收者的IP地址，data表示将要发送的数据</p>
<p>源代码如下</p>
<p>//用来发送短信息<br>
//端口9001为信息发送端口<br>
//端口9000为信息接收端口<br>
//端口8888为广播发送端口<br>
//端口8889为广播接收端口<br>
//默认构造方法是发送广播包</p>
<p> </p>
<p>import java.net.*;<br>
import java.io.*;</p>
<p><br>
class Sendmes{</p>
<p>&nbsp;&nbsp;  DatagramSocket trans;<br>
&nbsp;&nbsp;  DatagramPacket udpmess;<br>
&nbsp;&nbsp;  InetAddress addre;<br>
&nbsp;&nbsp;  byte[] ip= new byte[4]; //存储接收方的IP地址<br>
&nbsp;&nbsp;  byte[] data=new byte[300];//存储用户发送的信息,最大信息长度为300字节<br>
&nbsp;&nbsp;  byte[] data1={1,1,1,1,1}; //发送广播包里的信息为全&quot;1&quot;<br>
&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  Sendmes(){<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;  try{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  trans= new DatagramSocket(8880); <br>
&nbsp;&nbsp;&nbsp;&nbsp;  }catch(SocketException e){<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println (&quot;无法打开端口&quot;);<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  new Newmess(&quot;无法打开端口&quot;);<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
&nbsp;&nbsp;  try{<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  addre=InetAddress.getLocalHost();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ip=Convert(addre.getHostAddress()); //获取自己所在局域网的IP，好自适应形成对应的广播地址<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  switch(ip[0])&nbsp;&nbsp;&nbsp;&nbsp;  //自适应过程<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  {<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  case 10: ip[1]=(byte)255;<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ip[2]=(byte)255;<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ip[3]=(byte)255;<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  break;<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  case (byte)172:ip[2]=(byte)255;<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ip[3]=(byte)255;<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  break;<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  case (byte)192:ip[2]=(byte)255;<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ip[3]=(byte)255;<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  break;<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  addre= InetAddress.getByAddress(ip);<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }catch(UnknownHostException e){<br>
&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println (&quot;找不到目的主机&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  new Newmess(&quot;找不到目的主机&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  udpmess = new DatagramPacket(data1,5,addre,8889);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  try{<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  trans.send(udpmess);&nbsp;&nbsp;  //发送消息<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;  }catch(IOException e){<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println (&quot;数据传输错误&quot;);<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println (e.getMessage());<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  } <br>
&nbsp;&nbsp;  trans.close();<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  }<br>
&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  //参数ip为接收方的IP地址,data为发送的数据<br>
&nbsp;&nbsp;  //从本机的9001端口出去,发送到目的方的9000端口<br>
&nbsp;&nbsp;  Sendmes(byte[] ip,byte data[]){<br>
&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;  this.ip=ip;<br>
&nbsp;&nbsp;&nbsp;&nbsp;  this.data=data;<br>
&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;  try{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  trans= new DatagramSocket(9001);&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;  }catch(SocketException e){<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println (&quot;无法打开端口&quot;);<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
&nbsp;&nbsp;  try{<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  addre= InetAddress.getByAddress(ip);<br>
&nbsp;&nbsp;&nbsp;&nbsp;  }catch(UnknownHostException e){<br>
&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println (&quot;找不到目的主机&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  udpmess = new DatagramPacket(data,data.length,addre,9000);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  try{<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  trans.send(udpmess);<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;  }catch(IOException e){<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println (&quot;数据传输错误&quot;);<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  } <br>
&nbsp;&nbsp;  trans.close();<br>
&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  }<br>
&nbsp;&nbsp;  <br>
&nbsp;&nbsp;  <br>
&nbsp;&nbsp;&nbsp;  byte[] Convert(String temp){&nbsp;&nbsp;&nbsp;&nbsp;  //将IP地址转换为byte[]数组里面去<br>
&nbsp;&nbsp;&nbsp;  byte[] b=new byte[4];<br>
&nbsp;&nbsp;&nbsp;  int i,j,k;<br>
&nbsp;&nbsp;&nbsp;  for(i=0,j=0,k=0;i&lt;temp.length();i++){<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  if(temp.charAt(i)=='.'){<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  b[k++]=(byte)Integer.parseInt(temp.substring(j,i));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  j=i+1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  if(k==3) break;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  } <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  b[k]=(byte)Integer.parseInt(temp.substring(j,temp.length()));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  return b;<br>
&nbsp;&nbsp;&nbsp;  }<br>
<br>
&nbsp;&nbsp;  <br>
}</p>
<p>下一贴我们讲介绍</p>
<p>如何根据广播包后收到的反馈信息</p>
<p>形成相应的图形化界面 <a href="http://blog.csdn.net/alajl/archive/2006/12/22/1453640.aspx">http://blog.csdn.net/alajl/archive/2006/12/22/1453640.aspx</a></p></div></body></html>