<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>dom4j学习总结（二）</title></head><body><h1>dom4j学习总结（二）</h1><div>dom4j学习总结（二）
<p><strong>（一）移除节点及属性</strong></p>
<div style="border-bottom: windowtext 0.5pt solid; border-left: windowtext 0.5pt solid; padding-bottom: 4px; padding-left: 5.4pt; width: 95%; padding-right: 5.4pt; background: rgb(230,230,230) 0% 50%; border-top: windowtext 0.5pt solid; border-right: windowtext 0.5pt solid; padding-top: 4px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">
<div><img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockStart.gif"><img style="display: none" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedBlock.gif"><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="border-bottom: rgb(128,128,128) 1px solid; border-left: rgb(128,128,128) 1px solid; background-color: rgb(255,255,255); display: none; border-top: rgb(128,128,128) 1px solid; border-right: rgb(128,128,128) 1px solid">/** */</span><span><span style="color: rgb(0,128,0)">/**</span><span style="color: rgb(0,128,0)">移除节点和属性的操作<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  * </span><span style="color: rgb(128,128,128)">@throws</span><span style="color: rgb(0,128,0)"> DocumentException<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockEnd.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">*/</span></span><span style="color: rgb(0,0,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockStart.gif"><img style="display: none" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,0,255)">public</span><span style="color: rgb(0,0,0)"> </span><span style="color: rgb(0,0,255)">void</span><span style="color: rgb(0,0,0)"> RemoveOperator() </span><span style="color: rgb(0,0,255)">throws</span><span style="color: rgb(0,0,0)"> DocumentException</span><span style="border-bottom: rgb(128,128,128) 1px solid; border-left: rgb(128,128,128) 1px solid; background-color: rgb(255,255,255); display: none; border-top: rgb(128,128,128) 1px solid; border-right: rgb(128,128,128) 1px solid">...</span><span><span style="color: rgb(0,0,0)">{<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">待生成xml的字符串</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  String str</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">&lt;root&gt;&lt;book type='science'&gt;&lt;Name&gt;Java&lt;/Name&gt;&lt;price&gt;100&lt;/price&gt;&lt;/book&gt;</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,0,0)">+</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">&lt;book type='society'&gt;&lt;Name&gt;Society security&lt;/Name&gt;&lt;price&gt;130&lt;/price&gt;&lt;/book&gt;</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,0,0)">+</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">&lt;author&gt;&lt;name&gt;chb&lt;/name&gt;&lt;sex&gt;boy&lt;/sex&gt;&lt;/author&gt;&lt;/root&gt;</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">生成一个Document</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Document document </span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)"> DocumentHelper.parseText(str);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Element root</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">document.getRootElement();<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">删除类型为society的book节点</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Element book_society</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">(Element)document.selectSingleNode(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">//book[@type='society']</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  root.remove(book_society);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">1。正确的删除了类型为society的book节点</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println(document.asXML());<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">删除sex节点</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Element sex</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">(Element)root.selectSingleNode(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">//sex</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">从root节点删除</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  root.remove(sex);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">2。这样是不能删除sex节点的</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println(document.asXML());<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">从author节点删除</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  root.element(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">author</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">).remove(sex);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">3。这样就可以正确删除sex节点</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println(document.asXML());<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">删除属性</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Attribute type</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">root.element(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">book</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">).attribute(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">type</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  root.element(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">book</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">).remove(type);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">4。正确删除book节点的type属性</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println(document.asXML());<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockEnd.gif">&nbsp;&nbsp;&nbsp;&nbsp;  }</span></span></div>
</div>
<p>输出结果为：</p>
<p>1。正确的删除了类型为society的book节点<br>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>
&lt;root&gt;&lt;book type=&quot;science&quot;&gt;&lt;Name&gt;Java&lt;/Name&gt;&lt;price&gt;100&lt;/price&gt;&lt;/book&gt;&lt;author&gt;&lt;name&gt;chb&lt;/name&gt;&lt;sex&gt;boy&lt;/sex&gt;&lt;/author&gt;&lt;/root&gt;<br>
2。这样是不能删除sex节点的<br>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>
&lt;root&gt;&lt;book type=&quot;science&quot;&gt;&lt;Name&gt;Java&lt;/Name&gt;&lt;price&gt;100&lt;/price&gt;&lt;/book&gt;&lt;author&gt;&lt;name&gt;chb&lt;/name&gt;&lt;sex&gt;boy&lt;/sex&gt;&lt;/author&gt;&lt;/root&gt;<br>
3。这样就可以正确删除sex节点<br>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>
&lt;root&gt;&lt;book type=&quot;science&quot;&gt;&lt;Name&gt;Java&lt;/Name&gt;&lt;price&gt;100&lt;/price&gt;&lt;/book&gt;&lt;author&gt;&lt;name&gt;chb&lt;/name&gt;&lt;/author&gt;&lt;/root&gt;<br>
4。正确删除book节点的type属性<br>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>
&lt;root&gt;&lt;book&gt;&lt;Name&gt;Java&lt;/Name&gt;&lt;price&gt;100&lt;/price&gt;&lt;/book&gt;&lt;author&gt;&lt;name&gt;chb&lt;/name&gt;&lt;/author&gt;&lt;/root&gt;</p>
<p><strong>分析：</strong></p>
<p>第二个输出结果不能删除sex节点，我们需要看dom4j的API</p>
<h3>remove</h3>
<pre>public boolean <strong>remove</strong>(<a title="interface in org.dom4j" href="http://www.dom4j.org/apidocs/org/dom4j/Element.html">Element</a> element)</pre>
<dl><dd>Removes the given <code><font face="NSimsun">Element</font></code> if the node is an <font color="#ff0000">immediate child</font> of this branch. If the given node is not an immediate child of this branch then the <a href="http://www.dom4j.org/apidocs/org/dom4j/Node.html#detach()"><code><font face="NSimsun">Node.detach()</font></code></a>method should be used instead.
<p> </p>
</dd><dd><dl></dl></dd><dd><dl><dt><strong>Parameters:</strong> </dt><dd><code><font face="NSimsun">element</font></code> - is the element to be removed </dd><dt><strong>Returns:</strong> </dt><dd>true if the element was removed</dd></dl></dd></dl>
<p>从中我们可以看出，remove只能用在它自己的直接孩子节点上，不能用在孙子节点上，因为sex节点不是root节点的直接孩子节点，所以不能删除；而sex节点却是author节点的直接孩子节点，所以第三个输出可以删除。</p>
<p><strong>（二）将两个Document合并为一个Document</strong></p>
<p>先看一个错误的情况</p>
<p>（1）使用add()方法添加</p>
<div style="border-bottom: windowtext 0.5pt solid; border-left: windowtext 0.5pt solid; padding-bottom: 4px; padding-left: 5.4pt; width: 95%; padding-right: 5.4pt; background: rgb(230,230,230) 0% 50%; border-top: windowtext 0.5pt solid; border-right: windowtext 0.5pt solid; padding-top: 4px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">
<div><img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockStart.gif"><img style="display: none" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedBlock.gif"><span style="color: rgb(0,0,255)">public</span><span style="color: rgb(0,0,0)"> </span><span style="color: rgb(0,0,255)">void</span><span style="color: rgb(0,0,0)"> CombineDocument() </span><span style="color: rgb(0,0,255)">throws</span><span style="color: rgb(0,0,0)"> DocumentException</span><span style="border-bottom: rgb(128,128,128) 1px solid; border-left: rgb(128,128,128) 1px solid; background-color: rgb(255,255,255); display: none; border-top: rgb(128,128,128) 1px solid; border-right: rgb(128,128,128) 1px solid">...</span><span><span style="color: rgb(0,0,0)">{<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">待生成两个Document的字符串</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  String str_book</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">&lt;root&gt;&lt;book type='science'&gt;&lt;Name&gt;Java&lt;/Name&gt;&lt;price&gt;100&lt;/price&gt;&lt;/book&gt;</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,0,0)">+</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">&lt;book type='society'&gt;&lt;Name&gt;Society security&lt;/Name&gt;&lt;price&gt;130&lt;/price&gt;&lt;/book&gt;</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,0,0)">+</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">&lt;/root&gt;</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  String str_author</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">&lt;root&gt;&lt;author&gt;&lt;name&gt;chb&lt;/name&gt;&lt;sex&gt;boy&lt;/sex&gt;&lt;/author&gt;&lt;/root&gt;</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">生成两个Document</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Document doc_book</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">DocumentHelper.parseText(str_book);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Document doc_author</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">DocumentHelper.parseText(str_author);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">取出doc_author的author节点，添加到doc_book的根结点</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Element author</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">(Element)doc_author.selectSingleNode(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">//author</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  doc_book.getRootElement().add(author);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println(doc_book.asXML());<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockEnd.gif">&nbsp;&nbsp;&nbsp;&nbsp;  }</span></span></div>
</div>
<p>调用CombineDocument函数，会出现以下错误：</p>
<p><font color="#ff0000">org.dom4j.IllegalAddException</font>: The node &quot;<a href="mailto:org.dom4j.tree.DefaultElement@17bd6a1">org.dom4j.tree.DefaultElement@17bd6a1</a> [Element: &lt;author attributes: []/&gt;]&quot; could not be added to the element &quot;root&quot; because: <font color="#ff0000">The Node already has an existing parent of &quot;root&quot;<br>
</font>at org.dom4j.tree.AbstractElement.addNode(AbstractElement.java:1521)<br>
at org.dom4j.tree.AbstractElement.add(AbstractElement.java:1002)<br>
at xml_chb.dom4j_chb.CombineDocument(dom4j_chb.java:189)<br>
at xml_chb.dom4j_chb.main(dom4j_chb.java:199)<br>
Exception in thread &quot;main&quot;</p>
<p>即提示author节点已经有一个root节点了，不能再添加到另一个节点上去。</p>
<p>（2）使用appendContent()方法</p>
<p>即将doc_book.getRootElement().add(author);</p>
<p>改为：doc_book.getRootElement().appendContent(author);</p>
<p>输出结果为：</p>
<p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>
&lt;root&gt;<br>
&lt;book type=&quot;science&quot;&gt;&lt;Name&gt;Java&lt;/Name&gt;&lt;price&gt;100&lt;/price&gt;&lt;/book&gt;<br>
&lt;book type=&quot;society&quot;&gt;&lt;Name&gt;Society security&lt;/Name&gt;&lt;price&gt;130&lt;/price&gt;&lt;/book&gt;<br>
<font color="#0000ff">&lt;name&gt;chb&lt;/name&gt;&lt;sex&gt;boy&lt;/sex&gt;</font><br>
&lt;/root&gt;</p>
<p>可以看出，缺少了author节点，只是把author节点的子节点添加上去了，但是由此可见，appendContent方法是有希望的。</p>
<p>我们看一下dom4j的API:</p>
<h3>appendContent</h3>
<pre>public void <strong>appendContent</strong>(<a title="interface in org.dom4j" href="http://www.dom4j.org/apidocs/org/dom4j/Branch.html">Branch</a> branch)</pre>
<dl><dd>Appends<font color="#ff0000"> the content of the given branch</font> to this branch instance. This method behaves like the <a title="class or interface in java.util" href="http://java.sun.com/j2se/1.3/docs/api/java/util/Collection.html#addAll(java.util.Collection)"><code><font face="NSimsun">Collection.addAll(java.util.Collection)</font></code></a> method.
<p> </p>
</dd><dd><dl></dl></dd><dd><dl><dt><strong>Parameters:</strong> </dt><dd><code><font face="NSimsun">branch</font></code> - is the branch whose content will be added to me.</dd></dl></dd></dl><hr>
<p>（3）使用正确的appendContent方法</p>
<p>将：Element author=(Element)doc_author.selectSingleNode(&quot;//author&quot;);</p>
<p>doc_book.getRootElement().appendContent(author);</p>
<p>改为：doc_book.getRootElement().appendContent(doc_author.getRootElement());</p>
<p>输出：</p>
<p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>
&lt;root&gt;<br>
&lt;book type=&quot;science&quot;&gt;&lt;Name&gt;Java&lt;/Name&gt;&lt;price&gt;100&lt;/price&gt;&lt;/book&gt;<br>
&lt;book type=&quot;society&quot;&gt;&lt;Name&gt;Society security&lt;/Name&gt;&lt;price&gt;130&lt;/price&gt;&lt;/book&gt;<br>
&lt;author&gt;&lt;name&gt;chb&lt;/name&gt;&lt;sex&gt;boy&lt;/sex&gt;&lt;/author&gt;<br>
&lt;/root&gt;</p>
<p>是正确结果</p>
<p>（4）另一种可行的方法</p>
<div style="border-bottom: windowtext 0.5pt solid; border-left: windowtext 0.5pt solid; padding-bottom: 4px; padding-left: 5.4pt; width: 95%; padding-right: 5.4pt; background: rgb(230,230,230) 0% 50%; border-top: windowtext 0.5pt solid; border-right: windowtext 0.5pt solid; padding-top: 4px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">
<div><img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockStart.gif"><img style="display: none" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedBlock.gif"><span style="color: rgb(0,0,255)">public</span><span style="color: rgb(0,0,0)"> </span><span style="color: rgb(0,0,255)">void</span><span style="color: rgb(0,0,0)"> CombineDocument() </span><span style="color: rgb(0,0,255)">throws</span><span style="color: rgb(0,0,0)"> DocumentException</span><span style="border-bottom: rgb(128,128,128) 1px solid; border-left: rgb(128,128,128) 1px solid; background-color: rgb(255,255,255); display: none; border-top: rgb(128,128,128) 1px solid; border-right: rgb(128,128,128) 1px solid">...</span><span><span style="color: rgb(0,0,0)">{<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">待生成两个Document的字符串</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  String str_book</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">&lt;root&gt;&lt;book type='science'&gt;&lt;Name&gt;Java&lt;/Name&gt;&lt;price&gt;100&lt;/price&gt;&lt;/book&gt;</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,0,0)">+</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">&lt;book type='society'&gt;&lt;Name&gt;Society security&lt;/Name&gt;&lt;price&gt;130&lt;/price&gt;&lt;/book&gt;</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,0,0)">+</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">&lt;/root&gt;</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  String str_author</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">&lt;root&gt;&lt;author&gt;&lt;name&gt;chb&lt;/name&gt;&lt;sex&gt;boy&lt;/sex&gt;&lt;/author&gt;&lt;/root&gt;</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">生成两个Document</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Document doc_book</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">DocumentHelper.parseText(str_book);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Document doc_author</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">DocumentHelper.parseText(str_author);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">新生成一个Document</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Element author</span><span style="color: rgb(0,0,0)">=</span><span style="color: rgb(0,0,0)">DocumentHelper.createElement(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">author</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  author.appendContent((Element)doc_author.selectSingleNode(</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">//author</span><span style="color: rgb(0,0,0)">&quot;</span><span style="color: rgb(0,0,0)">));<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0,128,0)">//</span><span style="color: rgb(0,128,0)">当前author尚无父节点，所以可以使用add方法添加</span><span style="color: rgb(0,128,0)"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"></span><span style="color: rgb(0,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  doc_book.getRootElement().add(author);<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif"><br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  System.out.println(doc_book.asXML());<br>
<img align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockEnd.gif">&nbsp;&nbsp;&nbsp;&nbsp;  }</span></span></div>
</div>
<p> </p>
<p><a href="http://dev.csdn.net/author/hbcui1984/5a88d63577914532a20f0c3845625422.html">http://dev.csdn.net/author/hbcui1984/5a88d63577914532a20f0c3845625422.html</a></p></div></body></html>